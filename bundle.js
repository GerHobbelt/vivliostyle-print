!function(){"use strict";var t="/*\n * Copyright 2015 Trim-marks Inc.\n * Copyright 2019 Vivliostyle Foundation\n *\n * Vivliostyle.js is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * Vivliostyle.js is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Vivliostyle.js.  If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\n[data-vivliostyle-layout-box] {\n    position: absolute;\n    left: 0;\n    top: 0;\n    right: 0;\n    bottom: 0;\n    overflow: hidden;\n    z-index: -1;\n}\n\n[data-vivliostyle-debug] [data-vivliostyle-layout-box] {\n    right: auto;\n    bottom: auto;\n    overflow: visible;\n    z-index: auto;\n}\n\n[data-vivliostyle-page-container] {\n    position: relative;\n    overflow: hidden;\n}\n\n[data-vivliostyle-bleed-box] {\n    position: absolute;\n    overflow: hidden;\n    max-width: 100%;\n    max-height: 100%;\n    box-sizing: border-box;\n}\n\n[data-vivliostyle-page-box] ~ [data-vivliostyle-page-box] {\n    display: none;\n}\n\n[data-vivliostyle-toc-box] {\n    position: absolute;\n    left: 3px;\n    top: 3px;\n    overflow: scroll;\n    overflow-x: hidden;\n    background: rgba(248,248,248,0.9);\n    border-radius: 2px;\n    box-shadow: 1px 1px 2px rgba(0,0,0,0.4);\n}\n\n@media print {\n    [data-vivliostyle-toc-box] {\n        display: none;\n    }\n\n    [data-vivliostyle-outer-zoom-box], [data-vivliostyle-spread-container] {\n        width: 100% !important;\n        height: 100% !important;\n    }\n\n    [data-vivliostyle-spread-container], [data-vivliostyle-page-container] {\n        -moz-transform: none !important;\n        -ms-transform: none !important;\n        -webkit-transform: none !important;\n        transform: none !important;\n    }\n\n    [data-vivliostyle-page-container] {\n        display: block !important;\n        max-width: 100%;\n        height: 100% !important;\n        max-height: 100%;\n    }\n\n    /* Workaround for Chrome printing problem */\n    /* [data-vivliostyle-page-box] {\n        padding-bottom: 0 !important;\n        overflow: visible !important;\n    } */\n    [data-vivliostyle-bleed-box] > div > div::before {\n        display: block;\n        content: \"\";\n        padding-top: 0.015625px;\n        margin-bottom: -0.015625px;\n    }\n\n    /* Gecko-only hack, see https://bugzilla.mozilla.org/show_bug.cgi?id=267029#c17 */\n    @-moz-document regexp('.*') {\n        [data-vivliostyle-page-container]:nth-last-child(n+2) {\n            top: -1px;\n            margin-top: 1px;\n            margin-bottom: -1px;\n        }\n    }\n}\n",e="/*\n * Copyright 2017 Trim-marks Inc.\n *\n * Vivliostyle.js is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * Vivliostyle.js is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Vivliostyle.js.  If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\n@media screen {\n\n    [data-vivliostyle-viewer-viewport] {\n        background: #AAAAAA;\n    }\n\n    [data-vivliostyle-page-container] {\n        background: white;\n    }\n\n    [data-vivliostyle-viewer-viewport] {\n        display: -webkit-flex;\n        display: flex;\n        overflow: auto;\n        position: relative;\n    }\n\n    [data-vivliostyle-outer-zoom-box] {\n        margin: auto;\n        overflow: hidden;\n        -webkit-flex: none;\n        flex: none;\n    }\n\n    [data-vivliostyle-viewer-viewport] [data-vivliostyle-spread-container] {\n        display: -webkit-flex;\n        display: flex;\n        -webkit-flex: none;\n        flex: none;\n        -webkit-justify-content: center;\n        justify-content: center;\n        -moz-transform-origin: left top;\n        -ms-transform-origin: left top;\n        -webkit-transform-origin: left top;\n        transform-origin: left top;\n    }\n\n    [data-vivliostyle-viewer-viewport][data-vivliostyle-page-progression=ltr] [data-vivliostyle-spread-container] {\n        -webkit-flex-direction: row;\n        flex-direction: row;\n    }\n\n    [data-vivliostyle-viewer-viewport][data-vivliostyle-page-progression=rtl] [data-vivliostyle-spread-container] {\n        -webkit-flex-direction: row-reverse;\n        flex-direction: row-reverse;\n    }\n\n    [data-vivliostyle-viewer-viewport] [data-vivliostyle-page-container] {\n        margin: 0 auto;\n        -webkit-flex: none;\n        flex: none;\n        transform-origin: center top;\n    }\n\n    [data-vivliostyle-viewer-viewport][data-vivliostyle-spread-view=true] [data-vivliostyle-page-container][data-vivliostyle-page-side=left] {\n        margin-right: 1px;\n        transform-origin: right top;\n    }\n\n    [data-vivliostyle-viewer-viewport][data-vivliostyle-spread-view=true] [data-vivliostyle-page-container][data-vivliostyle-page-side=right] {\n        margin-left: 1px;\n        transform-origin: left top;\n    }\n\n    [data-vivliostyle-viewer-viewport][data-vivliostyle-spread-view=true] [data-vivliostyle-page-container][data-vivliostyle-unpaired-page=true] {\n        margin-left: auto;\n        margin-right: auto;\n        transform-origin: center top;\n    }\n\n}\n";var n,i=function(t,e){return t(e={exports:{}},e.exports),e.exports}(function(t,e){window,t.exports=function(t){var e={};function n(i){if(e[i])return e[i].exports;var o=e[i]={i:i,l:!1,exports:{}};return t[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(i,o,function(e){return t[e]}.bind(null,o));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=32)}([function(t,e,n){n.d(e,"m",function(){return s}),n.d(e,"d",function(){return l}),n.d(e,"o",function(){return c}),n.d(e,"w",function(){return h}),n.d(e,"k",function(){return p}),n.d(e,"f",function(){return d}),n.d(e,"r",function(){return g}),n.d(e,"i",function(){return m}),n.d(e,"h",function(){return y}),n.d(e,"g",function(){return v}),n.d(e,"a",function(){return E}),n.d(e,"l",function(){return b}),n.d(e,"j",function(){return N}),n.d(e,"b",function(){return C}),n.d(e,"e",function(){return S}),n.d(e,"c",function(){return T}),n.d(e,"x",function(){return x}),n.d(e,"n",function(){return I}),n.d(e,"t",function(){return P}),n.d(e,"s",function(){return A}),n.d(e,"q",function(){return R}),n.d(e,"p",function(){return O}),n.d(e,"u",function(){return L}),n.d(e,"v",function(){return F});var i,o=n(1),r=n(4),a=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),s=function(){function t(){}return t.prototype.visitValues=function(t){for(var e=0;e<t.length;e++)t[e].visit(this)},t.prototype.visitEmpty=function(t){throw new Error("E_CSS_EMPTY_NOT_ALLOWED")},t.prototype.visitSlash=function(t){throw new Error("E_CSS_SLASH_NOT_ALLOWED")},t.prototype.visitStr=function(t){throw new Error("E_CSS_STR_NOT_ALLOWED")},t.prototype.visitIdent=function(t){throw new Error("E_CSS_IDENT_NOT_ALLOWED")},t.prototype.visitNumeric=function(t){throw new Error("E_CSS_NUMERIC_NOT_ALLOWED")},t.prototype.visitNum=function(t){throw new Error("E_CSS_NUM_NOT_ALLOWED")},t.prototype.visitInt=function(t){return this.visitNum(t)},t.prototype.visitColor=function(t){throw new Error("E_CSS_COLOR_NOT_ALLOWED")},t.prototype.visitURL=function(t){throw new Error("E_CSS_URL_NOT_ALLOWED")},t.prototype.visitSpaceList=function(t){throw new Error("E_CSS_LIST_NOT_ALLOWED")},t.prototype.visitCommaList=function(t){throw new Error("E_CSS_COMMA_NOT_ALLOWED")},t.prototype.visitFunc=function(t){throw new Error("E_CSS_FUNC_NOT_ALLOWED")},t.prototype.visitExpr=function(t){throw new Error("E_CSS_EXPR_NOT_ALLOWED")},t}(),l=function(t){function e(){return t.call(this)||this}return a(e,t),e.prototype.visitValues=function(t){for(var e=null,n=0;n<t.length;n++){var i=t[n],o=i.visit(this);if(e)e[n]=o;else if(i!==o){e=new Array(t.length);for(var r=0;r<n;r++)e[r]=t[r];e[n]=o}}return e||t},e.prototype.visitStr=function(t){return t},e.prototype.visitIdent=function(t){return t},e.prototype.visitSlash=function(t){return t},e.prototype.visitNumeric=function(t){return t},e.prototype.visitNum=function(t){return t},e.prototype.visitInt=function(t){return t},e.prototype.visitColor=function(t){return t},e.prototype.visitURL=function(t){return t},e.prototype.visitSpaceList=function(t){var e=this.visitValues(t.values);return e===t.values?t:new N(e)},e.prototype.visitCommaList=function(t){var e=this.visitValues(t.values);return e===t.values?t:new C(e)},e.prototype.visitFunc=function(t){var e=this.visitValues(t.values);return e===t.values?t:new S(t.name,e)},e.prototype.visitExpr=function(t){return t},e}(s),u=function(){function t(){}return t.prototype.toString=function(){var t=new o.d;return this.appendTo(t,!0),t.toString()},t.prototype.stringValue=function(){var t=new o.d;return this.appendTo(t,!1),t.toString()},t.prototype.toExpr=function(t,e){throw new Error("F_ABSTRACT")},t.prototype.appendTo=function(t,e){t.append("[error]")},t.prototype.isExpr=function(){return!1},t.prototype.isNumeric=function(){return!1},t.prototype.isNum=function(){return!1},t.prototype.isIdent=function(){return!1},t.prototype.isSpaceList=function(){return!1},t.prototype.visit=function(t){throw new Error("F_ABSTRACT")},t}(),c=function(t){function e(){return t.call(this)||this}return a(e,t),Object.defineProperty(e,"instance",{get:function(){return this.empty||(this.empty=new e),this.empty},enumerable:!0,configurable:!0}),e.prototype.toExpr=function(t,e){return new r.f(t,"")},e.prototype.appendTo=function(t,e){},e.prototype.visit=function(t){return t.visitEmpty(this)},e}(u).instance,h=function(t){function e(){return t.call(this)||this}return a(e,t),Object.defineProperty(e,"instance",{get:function(){return this.slash||(this.slash=new e),this.slash},enumerable:!0,configurable:!0}),e.prototype.toExpr=function(t,e){return new r.f(t,"/")},e.prototype.appendTo=function(t,e){t.append("/")},e.prototype.visit=function(t){return t.visitSlash(this)},e}(u).instance,p=function(t){function e(e){var n=t.call(this)||this;return n.str=e,n}return a(e,t),e.prototype.toExpr=function(t,e){return new r.f(t,this.str)},e.prototype.appendTo=function(t,e){e?(t.append('"'),t.append(o.q(this.str)),t.append('"')):t.append(this.str)},e.prototype.visit=function(t){return t.visitStr(this)},e}(u),f={},d=function(t){function e(e){var n=t.call(this)||this;if(n.name=e,f[e])throw new Error("E_INVALID_CALL");return f[e]=n,n}return a(e,t),e.prototype.toExpr=function(t,e){return new r.f(t,this.name)},e.prototype.appendTo=function(t,e){e?t.append(o.p(this.name)):t.append(this.name)},e.prototype.visit=function(t){return t.visitIdent(this)},e.prototype.isIdent=function(){return!0},e}(u);function g(t){var e=f[t];return e||(e=new d(t)),e}var m=function(t){function e(e,n){var i=t.call(this)||this;return i.num=e,i.unit=n.toLowerCase(),i}return a(e,t),e.prototype.toExpr=function(t,e){return 0==this.num?t.zero:e&&"%"==this.unit?100==this.num?e:new r.r(t,e,new r.f(t,this.num/100)):new r.x(t,this.num,this.unit)},e.prototype.appendTo=function(t,e){t.append(this.num.toString()),t.append(this.unit)},e.prototype.visit=function(t){return t.visitNumeric(this)},e.prototype.isNumeric=function(){return!0},e}(u),y=function(t){function e(e){var n=t.call(this)||this;return n.num=e,n}return a(e,t),e.prototype.toExpr=function(t,e){return 0==this.num?t.zero:1==this.num?t.one:new r.f(t,this.num)},e.prototype.appendTo=function(t,e){t.append(this.num.toString())},e.prototype.visit=function(t){return t.visitNum(this)},e.prototype.isNum=function(){return!0},e}(u),v=function(t){function e(e){return t.call(this,e)||this}return a(e,t),e.prototype.visit=function(t){return t.visitInt(this)},e}(y),E=function(t){function e(e){var n=t.call(this)||this;return n.rgb=e,n}return a(e,t),e.prototype.appendTo=function(t,e){t.append("#");var n=this.rgb.toString(16);t.append("000000".substr(n.length)),t.append(n)},e.prototype.visit=function(t){return t.visitColor(this)},e}(u),b=function(t){function e(e){var n=t.call(this)||this;return n.url=e,n}return a(e,t),e.prototype.appendTo=function(t,e){t.append('url("'),t.append(o.q(this.url)),t.append('")')},e.prototype.visit=function(t){return t.visitURL(this)},e}(u);function w(t,e,n,i){var o=e.length;e[0].appendTo(t,i);for(var r=1;r<o;r++)t.append(n),e[r].appendTo(t,i)}var N=function(t){function e(e){var n=t.call(this)||this;return n.values=e,n}return a(e,t),e.prototype.appendTo=function(t,e){w(t,this.values," ",e)},e.prototype.visit=function(t){return t.visitSpaceList(this)},e.prototype.isSpaceList=function(){return!0},e}(u),C=function(t){function e(e){var n=t.call(this)||this;return n.values=e,n}return a(e,t),e.prototype.appendTo=function(t,e){w(t,this.values,",",e)},e.prototype.visit=function(t){return t.visitCommaList(this)},e}(u),S=function(t){function e(e,n){var i=t.call(this)||this;return i.name=e,i.values=n,i}return a(e,t),e.prototype.appendTo=function(t,e){t.append(o.p(this.name)),t.append("("),w(t,this.values,",",e),t.append(")")},e.prototype.visit=function(t){return t.visitFunc(this)},e}(u),T=function(t){function e(e){var n=t.call(this)||this;return n.expr=e,n}return a(e,t),e.prototype.toExpr=function(){return this.expr},e.prototype.appendTo=function(t,e){t.append("-epubx-expr("),this.expr.appendTo(t,0),t.append(")")},e.prototype.visit=function(t){return t.visitExpr(this)},e.prototype.isExpr=function(){return!0},e}(u);function x(t,e){if(t){if(t.isNumeric()){var n=t;return e.queryUnitSize(n.unit,!1)*n.num}if(t.isNum())return t.num}return 0}function I(t,e){return new m(x(t,e),"px")}var P={absolute:g("absolute"),all:g("all"),always:g("always"),auto:g("auto"),avoid:g("avoid"),balance:g("balance"),balance_all:g("balance-all"),block:g("block"),block_end:g("block-end"),block_start:g("block-start"),both:g("both"),bottom:g("bottom"),border_box:g("border-box"),break_all:g("break-all"),break_word:g("break-word"),crop:g("crop"),cross:g("cross"),column:g("column"),exclusive:g("exclusive"),_false:g("false"),fixed:g("fixed"),flex:g("flex"),footnote:g("footnote"),footer:g("footer"),header:g("header"),hidden:g("hidden"),horizontal_tb:g("horizontal-tb"),inherit:g("inherit"),inline:g("inline"),inline_block:g("inline-block"),inline_end:g("inline-end"),inline_start:g("inline-start"),landscape:g("landscape"),left:g("left"),line:g("line"),list_item:g("list-item"),ltr:g("ltr"),manual:g("manual"),none:g("none"),normal:g("normal"),oeb_page_foot:g("oeb-page-foot"),oeb_page_head:g("oeb-page-head"),page:g("page"),relative:g("relative"),right:g("right"),same:g("same"),scale:g("scale"),snap_block:g("snap-block"),spread:g("spread"),_static:g("static"),rtl:g("rtl"),table:g("table"),table_caption:g("table-caption"),table_cell:g("table-cell"),table_footer_group:g("table-footer-group"),table_header_group:g("table-header-group"),table_row:g("table-row"),top:g("top"),transparent:g("transparent"),vertical_lr:g("vertical-lr"),vertical_rl:g("vertical-rl"),visible:g("visible"),_true:g("true")},A=new m(100,"%"),R=new m(100,"pvw"),O=new m(100,"pvh"),L=new m(0,"px"),k={"font-size":1,color:2};function F(t,e){return(k[t]||Number.MAX_VALUE)-(k[e]||Number.MAX_VALUE)}},function(t,e,n){n.d(e,"o",function(){return o}),n.d(e,"H",function(){return r}),n.d(e,"I",function(){return a}),n.d(e,"h",function(){return s}),n.d(e,"E",function(){return l}),n.d(e,"D",function(){return c}),n.d(e,"G",function(){return h}),n.d(e,"C",function(){return p}),n.d(e,"n",function(){return f}),n.d(e,"a",function(){return u}),n.d(e,"g",function(){return d}),n.d(e,"b",function(){return g}),n.d(e,"v",function(){return E}),n.d(e,"F",function(){return b}),n.d(e,"t",function(){return w}),n.d(e,"u",function(){return N}),n.d(e,"d",function(){return C}),n.d(e,"p",function(){return T}),n.d(e,"q",function(){return x}),n.d(e,"y",function(){return I}),n.d(e,"x",function(){return P}),n.d(e,"r",function(){return A}),n.d(e,"s",function(){return R}),n.d(e,"J",function(){return O}),n.d(e,"i",function(){return L}),n.d(e,"B",function(){return k}),n.d(e,"e",function(){return _}),n.d(e,"w",function(){return D}),n.d(e,"f",function(){return B}),n.d(e,"A",function(){return M}),n.d(e,"z",function(){return U}),n.d(e,"c",function(){return V}),n.d(e,"m",function(){return z}),n.d(e,"j",function(){return W}),n.d(e,"k",function(){return j}),n.d(e,"l",function(){return q});var i=n(6),o={};function r(t){return JSON.parse(t)}function a(t){var e=t.match(/^([^#]*)/);return e?e[1]:t}var s=window.location.href;function l(t){s=t}var u,c=window.location.href;function h(t){c=t}function p(t,e){if(e.startsWith("data:"))return t||e;if(!e||t.match(/^\w{2,}:/))return t.toLowerCase().match("^javascript:")?"#":(t.match(/^\w{2,}:\/\/[^\/]+$/)&&(t+="/"),t);var n;if(e.match(/^\w{2,}:\/\/[^\/]+$/)&&(e+="/"),t.match(/^\/\//))return(n=e.match(/^(\w{2,}:)\/\//))?n[1]+t:t;if(t.match(/^\//))return(n=e.match(/^(\w{2,}:\/\/[^\/]+)\//))?n[1]+t:t;if(t.match(/^\.(\/|$)/)&&(t=t.substr(2)),e=function(t){var e=t.match(/^([^#?]*)/);return e?e[1]:t}(e),t.match(/^#/))return e+t;var i=e.lastIndexOf("/");if(i<0)return t;if(i<e.length-1&&(r=e.lastIndexOf("."))<i){if(""==t)return e;i=(e+="/").length-1}for(var o=e.substr(0,i+1)+t;!((i=o.indexOf("/../"))<=0);){var r;if((r=o.lastIndexOf("/",i-1))<=0)break;o=o.substr(0,r)+o.substr(i+3)}return o.replace(/\/(\.\/)+/g,"/")}function f(t){var e;return(e=/^(https?:)\/\/github\.com\/([^\/]+\/[^\/]+)\/(blob\/|tree\/|raw\/)?(.*)$/.exec(t))?t=e[1]+"//raw.githubusercontent.com/"+e[2]+"/"+(e[3]?"":"master/")+e[4]:(e=/^(https?:)\/\/www\.aozora\.gr\.jp\/(cards\/[^\/]+\/files\/[^\/.]+\.html)$/.exec(t))?t=e[1]+"//raw.githubusercontent.com/aozorabunko/aozorabunko/master/"+e[2]:(e=/^(https?:)\/\/gist\.github\.com\/([^\/]+\/\w+)(\/|$)(raw(\/|$))?(.*)$/.exec(t))?t=e[1]+"//gist.githubusercontent.com/"+e[2]+"/raw/"+e[6]:(e=/^(https?:)\/\/(?:[^\/.]+\.)?jsbin\.com\/(?!(?:blog|help)\b)(\w+)((\/\d+)?).*$/.exec(t))&&(t=e[1]+"//output.jsbin.com/"+e[2]+e[3]+"/"),t}function d(t){return null==t?t:t.toString()}!function(t){t.FB2="http://www.gribuser.ru/xml/fictionbook/2.0",t.epub="http://www.idpf.org/2007/ops",t.EV="http://www.w3.org/2001/xml-events",t.MATHML="http://www.w3.org/1998/Math/MathML",t.XML="http://www.w3.org/XML/1998/namespace",t.XHTML="http://www.w3.org/1999/xhtml",t.XLINK="http://www.w3.org/1999/xlink",t.SHADOW="http://www.pyroxy.com/ns/shadow",t.SVG="http://www.w3.org/2000/svg",t.DC="http://purl.org/dc/elements/1.1/",t.NCX="http://www.daisy.org/z3986/2005/ncx/",t.SSE="http://example.com/sse"}(u||(u={}));var g=function(){function t(){this.queue=[null]}return t.prototype.length=function(){return this.queue.length-1},t.prototype.add=function(t){for(var e=this.queue.length;e>1;){var n=Math.floor(e/2),i=this.queue[n];if(i.compare(t)>0)return void(this.queue[e]=t);this.queue[e]=i,e=n}this.queue[1]=t},t.prototype.peek=function(){return this.queue[1]},t.prototype.remove=function(){var t=this.queue[1],e=this.queue.pop(),n=this.queue.length;if(n>1){for(var i=1;;){var o=2*i;if(o>=n)break;if(this.queue[o].compare(e)>0)o+1<n&&this.queue[o+1].compare(this.queue[o])>0&&o++;else{if(!(o+1<n&&this.queue[o+1].compare(e)>0))break;o++}this.queue[i]=this.queue[o],i=o}this.queue[i]=e}return t},t}(),m=["","-webkit-","-moz-","-ms-","-o-","-epub-"],y={};function v(t,e){if("writing-mode"===e){var n=document.createElement("span");return"-ms-"===t?(n.style.setProperty(t+e,"tb-rl"),"tb-rl"===n.style["writing-mode"]):(n.style.setProperty(t+e,"vertical-rl"),"vertical-rl"===n.style[t+e])}return"string"==typeof document.documentElement.style[function(t,e){return t&&(e="-"+e,"moz"===(t=t.replace(/-/g,""))&&(t="Moz")),t+e.replace(/-[a-z]/g,function(t){return t.substr(1).toUpperCase()})}(t,e)]}function E(t){var e=y[t];if(e||null===e)return e;switch(t){case"text-combine-upright":if(v("-webkit-","text-combine")&&!v("","text-combine-upright"))return y[t]=["-webkit-text-combine"],["-webkit-text-combine"];break;case"writing-mode":if(v("-ms-","writing-mode"))return y[t]=["-ms-writing-mode"],["-ms-writing-mode"];break;case"filter":if(v("-webkit-","filter"))return y[t]=["-webkit-filter"],["-webkit-filter"];break;case"clip-path":if(v("-webkit-","clip-path"))return y[t]=["-webkit-clip-path","clip-path"];break;case"margin-inline-start":if(v("-webkit-","margin-start"))return y[t]=["-webkit-margin-start"],["-webkit-margin-start"];break;case"margin-inline-end":if(v("-webkit-","margin-end"))return y[t]=["-webkit-margin-end"],["-webkit-margin-end"];break;case"padding-inline-start":if(v("-webkit-","padding-start"))return y[t]=["-webkit-padding-start"],["-webkit-padding-start"];break;case"padding-inline-end":if(v("-webkit-","padding-end"))return y[t]=["-webkit-padding-end"],["-webkit-padding-end"]}for(var n=0,o=m;n<o.length;n++){var r=o[n];if(v(r,t))return e=r+t,y[t]=[e],[e]}return i.b.warn("Property not supported by the browser: ",t),y[t]=null,null}function b(t,e,n){try{var o=E(e);if(!o)return;o.forEach(function(e){if("-ms-writing-mode"===e)switch(n){case"horizontal-tb":n="lr-tb";break;case"vertical-rl":n="tb-rl";break;case"vertical-lr":n="tb-lr"}else if("-webkit-text-combine"===e)switch(n){case"all":n="horizontal"}t&&t.style&&t.style.setProperty(e,n)})}catch(t){i.b.warn(t)}}function w(t,e,n){try{var i=y[e];return t.style.getPropertyValue(i?i[0]:e)}catch(t){}return n||""}function N(t){var e=t.getAttributeNS(u.XML,"lang");return e||t.namespaceURI!=u.XHTML||(e=t.getAttribute("lang")),e}var C=function(){function t(){this.list=[]}return t.prototype.append=function(t){return this.list.push(t),this},t.prototype.clear=function(){this.list=[]},t.prototype.toString=function(){var t=this.list.join("");return this.list=[t],t},t}();function S(t){return"\\"+t.charCodeAt(0).toString(16)+" "}function T(t){return t.replace(/[^-_a-zA-Z0-9\u0080-\uFFFF]/g,S)}function x(t){return t.replace(/[\u0000-\u001F"\\]/g,S)}function I(t){return t.replace(/[\s+&?=#\u007F-\uFFFF]+/g,encodeURIComponent)}function P(t){return!!t.match(/^[a-zA-Z\u009E\u009F\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u024F\u037B-\u037D\u0386\u0388-\u0482\u048A-\u0527]$/)}function A(t,e){return t.replace(/[^-a-zA-Z0-9_]/g,function(t){return function(t,e){return(e="string"==typeof e?e:"\\u")+(65536|t.charCodeAt(0)).toString(16).substr(1)}(t,e)})}function R(t){return A(t)}function O(t,e){e="string"==typeof e?e:"\\u";var n=new RegExp(R(e)+"[0-9a-fA-F]{4}","g");return t.replace(n,function(t){return function(t,e){return e="string"==typeof e?e:"\\u",0===t.indexOf(e)?String.fromCharCode(parseInt(t.substring(e.length),16)):t}(t,e)})}function L(t,e){for(var n=0,i=t;;){if(n==i)return n;var o=n+i>>1;e(o)?i=o:n=o+1}}function k(t,e){return t-e}var F="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";function _(t,e){for(var n=e.length,i=3*Math.floor(n/3),o=0;o<i;o+=3){var r=255&e.charCodeAt(o),a=255&e.charCodeAt(o+1),s=255&e.charCodeAt(o+2);t.append(F.charAt(r>>2)),t.append(F.charAt(63&(r<<4|a>>4))),t.append(F.charAt(63&(a<<2|s>>6))),t.append(F.charAt(63&s))}switch(n-i){case 1:var l=255&e.charCodeAt(i);t.append(F.charAt(l>>2)),t.append(F.charAt(l<<4&63)),t.append("==");break;case 2:var u=255&e.charCodeAt(i),c=255&e.charCodeAt(i+1);t.append(F.charAt(u>>2)),t.append(F.charAt(63&(u<<4|c>>4))),t.append(F.charAt(c<<2&63)),t.append("=")}}function D(t,e){for(var n={},i=0,o=t;i<o.length;i++){var r=o[i],a=e(r);a&&!n[a]&&(n[a]=r)}return n}function B(t){for(var e={},n=0;n<t.length;n++)e[t[n]]=!0;return e}function M(t,e){for(var n={},i=0,o=t;i<o.length;i++){var r=o[i],a=e(r);a&&(n[a]?n[a].push(r):n[a]=[r])}return n}function U(t,e){var n={};for(var i in t)n[i]=e(t[i],i);return n}var V=function(){function t(){this.listeners={}}return t.prototype.dispatchEvent=function(t){var e=this.listeners[t.type];if(e){t.target=this,t.currentTarget=this;for(var n=0;n<e.length;n++)e[n](t)}},t.prototype.addEventListener=function(t,e,n){if(!n){var i=this.listeners[t];i?i.push(e):this.listeners[t]=[e]}},t.prototype.removeEventListener=function(t,e,n){if(!n){var i=this.listeners[t];if(i){var o=i.indexOf(e);o>=0&&i.splice(o,1)}}},t}(),H=null;function z(t){if(null==H){var e=t.ownerDocument,n=e.createElement("div");n.style.position="absolute",n.style.top="0px",n.style.left="0px",n.style.width="100px",n.style.height="100px",n.style.overflow="hidden",n.style.lineHeight="16px",n.style.fontSize="16px",b(n,"writing-mode","vertical-rl"),t.appendChild(n);var i=e.createTextNode("a a a a a a a a a a a a a a a a");n.appendChild(i);var o=e.createRange();o.setStart(i,0),o.setEnd(i,1);var r=o.getBoundingClientRect();H=r.right-r.left<10,t.removeChild(n)}return H}var G=null;function W(t){if(null===G){var e=t.ownerDocument,n=e.createElement("div");n.style.position="absolute",n.style.top="0px",n.style.left="0px",n.style.width="30px",n.style.height="100px",n.style.lineHeight="16px",n.style.fontSize="16px",n.style.textAlign="justify",t.appendChild(n);var i=e.createTextNode("a | ");n.appendChild(i);var o=e.createElement("span");o.style.display="inline-block",o.style.width="30px",n.appendChild(o);var r=e.createRange();r.setStart(i,0),r.setEnd(i,3);var a=r.getBoundingClientRect();G=a.right<27,t.removeChild(n)}return G}var X=null;function j(t){if(null===X){var e=t.ownerDocument,n=e.createElement("div");n.style.position="absolute",n.style.top="0px",n.style.left="0px",n.style.width="40px",n.style.height="100px",n.style.lineHeight="16px",n.style.fontSize="16px",n.style.textAlign="justify",t.appendChild(n);var i=e.createTextNode("a a-");n.appendChild(i);var o=e.createElement("span");o.style.display="inline-block",o.style.width="40px",n.appendChild(o);var r=e.createRange();r.setStart(i,2),r.setEnd(i,4);var a=r.getBoundingClientRect();X=a.right<37,t.removeChild(n)}return X}var Y=null;function q(t){if(null===Y){var e=t.ownerDocument,n=e.createElement("div");n.style.position="absolute",n.style.top="0px",n.style.left="0px",n.style.width="40px",n.style.height="100px",n.style.lineHeight="16px",n.style.fontSize="16px",n.style.textAlign="justify",t.appendChild(n);var i=e.createTextNode("a a-");n.appendChild(i),n.appendChild(e.createElement("wbr"));var o=e.createElement("span");o.style.display="inline-block",o.style.width="40px",n.appendChild(o);var r=e.createRange();r.setStart(i,2),r.setEnd(i,4);var a=r.getBoundingClientRect();Y=a.right<37,t.removeChild(n)}return Y}},function(t,e,n){function i(t){if((t=t.substr(1)).match(/^[^0-9a-fA-F\n\r]$/))return t;var e=parseInt(t,16);return isNaN(e)?"":e<=65535?String.fromCharCode(e):e<=1114111?String.fromCharCode(55296|e>>10&1023,56320|1023&e):"�"}function o(t){return t.replace(/\\([0-9a-fA-F]{0,6}(\r\n|[ \n\r\t\f])?|[^0-9a-fA-F\n\r])/g,i)}var r;n.d(e,"a",function(){return r}),n.d(e,"b",function(){return M}),function(t){t[t.EOF=0]="EOF",t[t.IDENT=1]="IDENT",t[t.STR=2]="STR",t[t.NUMERIC=3]="NUMERIC",t[t.NUM=4]="NUM",t[t.INT=5]="INT",t[t.FUNC=6]="FUNC",t[t.HASH=7]="HASH",t[t.URL=8]="URL",t[t.CLASS=9]="CLASS",t[t.O_PAR=10]="O_PAR",t[t.C_PAR=11]="C_PAR",t[t.O_BRC=12]="O_BRC",t[t.C_BRC=13]="C_BRC",t[t.O_BRK=14]="O_BRK",t[t.C_BRK=15]="C_BRK",t[t.COMMA=16]="COMMA",t[t.SEMICOL=17]="SEMICOL",t[t.COLON=18]="COLON",t[t.SLASH=19]="SLASH",t[t.AT=20]="AT",t[t.PERCENT=21]="PERCENT",t[t.QMARK=22]="QMARK",t[t.PLUS=23]="PLUS",t[t.MINUS=24]="MINUS",t[t.BAR_BAR=25]="BAR_BAR",t[t.AMP_AMP=26]="AMP_AMP",t[t.BANG=31]="BANG",t[t.DOLLAR=32]="DOLLAR",t[t.HAT=33]="HAT",t[t.BAR=34]="BAR",t[t.TILDE=35]="TILDE",t[t.STAR=36]="STAR",t[t.GT=37]="GT",t[t.LT=38]="LT",t[t.EQ=39]="EQ",t[t.BANG_EQ=41]="BANG_EQ",t[t.DOLLAR_EQ=42]="DOLLAR_EQ",t[t.HAT_EQ=43]="HAT_EQ",t[t.BAR_EQ=44]="BAR_EQ",t[t.TILDE_EQ=45]="TILDE_EQ",t[t.STAR_EQ=46]="STAR_EQ",t[t.GT_EQ=47]="GT_EQ",t[t.LT_EQ=48]="LT_EQ",t[t.EQ_EQ=49]="EQ_EQ",t[t.COL_COL=50]="COL_COL",t[t.INVALID=51]="INVALID",t[t.LAST=51]="LAST"}(r||(r={}));var a,s=function(){this.precededBySpace=!1,this.num=0,this.text="",this.position=0,this.type=r.EOF};function l(t,e){var n,i=Array(128);for(n=0;n<128;n++)i[n]=t;for(i.NaN=t==a.END?a.END:a.INVALID,n=0;n<e.length;n+=2)i[e[n]]=e[n+1];return i}!function(t){t[t.SPACE=1]="SPACE",t[t.INT=2]="INT",t[t.IDENT=3]="IDENT",t[t.BANG=4]="BANG",t[t.HASH=6]="HASH",t[t.DOLLAR=7]="DOLLAR",t[t.PERCENT=8]="PERCENT",t[t.AMP=9]="AMP",t[t.O_PAR=10]="O_PAR",t[t.C_PAR=11]="C_PAR",t[t.STAR=12]="STAR",t[t.PLUS=13]="PLUS",t[t.COMMA=14]="COMMA",t[t.MINUS=15]="MINUS",t[t.DOT=16]="DOT",t[t.SLASH=17]="SLASH",t[t.COLON=18]="COLON",t[t.SEMICOL=19]="SEMICOL",t[t.LT=20]="LT",t[t.EQ=21]="EQ",t[t.GT=22]="GT",t[t.QMARK=23]="QMARK",t[t.AT=24]="AT",t[t.O_BRK=25]="O_BRK",t[t.C_BRK=26]="C_BRK",t[t.O_BRC=27]="O_BRC",t[t.C_BRC=28]="C_BRC",t[t.BSLASH=29]="BSLASH",t[t.HAT=30]="HAT",t[t.BAR=31]="BAR",t[t.TILDE=32]="TILDE",t[t.STR1=33]="STR1",t[t.STR2=34]="STR2",t[t.END=35]="END",t[t.EQTAIL=36]="EQTAIL",t[t.ENDINT=37]="ENDINT",t[t.ENDNUM=38]="ENDNUM",t[t.CONT=39]="CONT",t[t.UNIT=40]="UNIT",t[t.PCUNIT=41]="PCUNIT",t[t.NUMBER=42]="NUMBER",t[t.ENDIDNT=43]="ENDIDNT",t[t.IDNTESC=44]="IDNTESC",t[t.ENDIDES=45]="ENDIDES",t[t.ENDSTR=46]="ENDSTR",t[t.ENDESTR=47]="ENDESTR",t[t.STR1ESC=48]="STR1ESC",t[t.STR2ESC=49]="STR2ESC",t[t.BAR_BAR=50]="BAR_BAR",t[t.AMP_AMP=51]="AMP_AMP",t[t.FUNC=52]="FUNC",t[t.FUNCES=53]="FUNCES",t[t.COMMENT=54]="COMMENT",t[t.COMMST=55]="COMMST",t[t.ENDNOTK=56]="ENDNOTK",t[t.MINMIN=57]="MINMIN",t[t.TOINT=58]="TOINT",t[t.TONUM=59]="TONUM",t[t.TOIDENT=60]="TOIDENT",t[t.TOIDES=61]="TOIDES",t[t.KILL1=62]="KILL1",t[t.KILL2=63]="KILL2",t[t.URL=64]="URL",t[t.URL1=65]="URL1",t[t.URL2=66]="URL2",t[t.ENDURL=67]="ENDURL",t[t.TERMURL=68]="TERMURL",t[t.FINURL=69]="FINURL",t[t.LT_BG=70]="LT_BG",t[t.LT_BG_M=71]="LT_BG_M",t[t.INVALID=72]="INVALID",t[t.CHKPOSS=73]="CHKPOSS",t[t.CHKPOSN=74]="CHKPOSN",t[t.URLESC=75]="URLESC",t[t.IDESCH=76]="IDESCH",t[t.COL_COL=77]="COL_COL",t[t.TOCLASS=78]="TOCLASS",t[t.CHKSP=79]="CHKSP",t[t.EOF=80]="EOF"}(a||(a={}));var u=[a.INVALID,a.INVALID,a.INVALID,a.INVALID,a.INVALID,a.INVALID,a.INVALID,a.INVALID,a.INVALID,a.SPACE,a.SPACE,a.INVALID,a.SPACE,a.SPACE,a.INVALID,a.INVALID,a.INVALID,a.INVALID,a.INVALID,a.INVALID,a.INVALID,a.INVALID,a.INVALID,a.INVALID,a.INVALID,a.INVALID,a.INVALID,a.INVALID,a.INVALID,a.INVALID,a.INVALID,a.INVALID,a.SPACE,a.BANG,a.STR2,a.HASH,a.DOLLAR,a.PERCENT,a.AMP,a.STR1,a.O_PAR,a.C_PAR,a.STAR,a.PLUS,a.COMMA,a.MINUS,a.DOT,a.SLASH,a.INT,a.INT,a.INT,a.INT,a.INT,a.INT,a.INT,a.INT,a.INT,a.INT,a.COLON,a.SEMICOL,a.LT,a.EQ,a.GT,a.QMARK,a.AT,a.IDENT,a.IDENT,a.IDENT,a.IDENT,a.IDENT,a.IDENT,a.IDENT,a.IDENT,a.IDENT,a.IDENT,a.IDENT,a.IDENT,a.IDENT,a.IDENT,a.IDENT,a.IDENT,a.IDENT,a.IDENT,a.IDENT,a.IDENT,a.IDENT,a.IDENT,a.IDENT,a.IDENT,a.IDENT,a.IDENT,a.O_BRK,a.BSLASH,a.C_BRK,a.HAT,a.IDENT,a.INVALID,a.IDENT,a.IDENT,a.IDENT,a.IDENT,a.IDENT,a.IDENT,a.IDENT,a.IDENT,a.IDENT,a.IDENT,a.IDENT,a.IDENT,a.IDENT,a.IDENT,a.IDENT,a.IDENT,a.IDENT,a.IDENT,a.IDENT,a.IDENT,a.IDENT,a.IDENT,a.IDENT,a.IDENT,a.IDENT,a.IDENT,a.O_BRC,a.BAR,a.C_BRC,a.TILDE,a.INVALID];u.NaN=a.EOF;var c=[a.ENDIDNT,a.ENDIDNT,a.ENDIDNT,a.ENDIDNT,a.ENDIDNT,a.ENDIDNT,a.ENDIDNT,a.ENDIDNT,a.ENDIDNT,a.ENDIDNT,a.ENDIDNT,a.ENDIDNT,a.ENDIDNT,a.ENDIDNT,a.ENDIDNT,a.ENDIDNT,a.ENDIDNT,a.ENDIDNT,a.ENDIDNT,a.ENDIDNT,a.ENDIDNT,a.ENDIDNT,a.ENDIDNT,a.ENDIDNT,a.ENDIDNT,a.ENDIDNT,a.ENDIDNT,a.ENDIDNT,a.ENDIDNT,a.ENDIDNT,a.ENDIDNT,a.ENDIDNT,a.ENDIDNT,a.ENDIDNT,a.ENDIDNT,a.ENDIDNT,a.ENDIDNT,a.ENDIDNT,a.ENDIDNT,a.ENDIDNT,a.FUNC,a.ENDIDNT,a.ENDIDNT,a.ENDIDNT,a.ENDIDNT,a.CONT,a.ENDIDNT,a.ENDIDNT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.ENDIDNT,a.ENDIDNT,a.ENDIDNT,a.ENDIDNT,a.ENDIDNT,a.ENDIDNT,a.ENDIDNT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.ENDIDNT,a.IDNTESC,a.ENDIDNT,a.ENDIDNT,a.CONT,a.ENDIDNT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.ENDIDNT,a.ENDIDNT,a.ENDIDNT,a.ENDIDNT,a.ENDIDNT];c.NaN=a.ENDIDNT;var h=[a.INVALID,a.INVALID,a.INVALID,a.INVALID,a.INVALID,a.INVALID,a.INVALID,a.INVALID,a.INVALID,a.INVALID,a.INVALID,a.INVALID,a.INVALID,a.INVALID,a.INVALID,a.INVALID,a.INVALID,a.INVALID,a.INVALID,a.INVALID,a.INVALID,a.INVALID,a.INVALID,a.INVALID,a.INVALID,a.INVALID,a.INVALID,a.INVALID,a.INVALID,a.INVALID,a.INVALID,a.INVALID,a.INVALID,a.INVALID,a.INVALID,a.INVALID,a.INVALID,a.INVALID,a.INVALID,a.INVALID,a.INVALID,a.INVALID,a.INVALID,a.INVALID,a.INVALID,a.TOCLASS,a.TONUM,a.INVALID,a.TONUM,a.TONUM,a.TONUM,a.TONUM,a.TONUM,a.TONUM,a.TONUM,a.TONUM,a.TONUM,a.TONUM,a.INVALID,a.INVALID,a.INVALID,a.INVALID,a.INVALID,a.INVALID,a.INVALID,a.TOCLASS,a.TOCLASS,a.TOCLASS,a.TOCLASS,a.TOCLASS,a.TOCLASS,a.TOCLASS,a.TOCLASS,a.TOCLASS,a.TOCLASS,a.TOCLASS,a.TOCLASS,a.TOCLASS,a.TOCLASS,a.TOCLASS,a.TOCLASS,a.TOCLASS,a.TOCLASS,a.TOCLASS,a.TOCLASS,a.TOCLASS,a.TOCLASS,a.TOCLASS,a.TOCLASS,a.TOCLASS,a.TOCLASS,a.INVALID,a.TOIDES,a.INVALID,a.INVALID,a.TOCLASS,a.INVALID,a.TOCLASS,a.TOCLASS,a.TOCLASS,a.TOCLASS,a.TOCLASS,a.TOCLASS,a.TOCLASS,a.TOCLASS,a.TOCLASS,a.TOCLASS,a.TOCLASS,a.TOCLASS,a.TOCLASS,a.TOCLASS,a.TOCLASS,a.TOCLASS,a.TOCLASS,a.TOCLASS,a.TOCLASS,a.TOCLASS,a.TOCLASS,a.TOCLASS,a.TOCLASS,a.TOCLASS,a.TOCLASS,a.TOCLASS,a.INVALID,a.INVALID,a.INVALID,a.INVALID,a.INVALID];c.NaN=a.ENDIDNT;var p=[a.END,a.END,a.END,a.END,a.END,a.END,a.END,a.END,a.END,a.END,a.END,a.END,a.END,a.END,a.END,a.END,a.END,a.END,a.END,a.END,a.END,a.END,a.END,a.END,a.END,a.END,a.END,a.END,a.END,a.END,a.END,a.END,a.END,a.END,a.END,a.END,a.END,a.END,a.END,a.END,a.END,a.END,a.END,a.END,a.END,a.MINMIN,a.TONUM,a.END,a.TOINT,a.TOINT,a.TOINT,a.TOINT,a.TOINT,a.TOINT,a.TOINT,a.TOINT,a.TOINT,a.TOINT,a.END,a.END,a.END,a.END,a.END,a.END,a.END,a.TOIDENT,a.TOIDENT,a.TOIDENT,a.TOIDENT,a.TOIDENT,a.TOIDENT,a.TOIDENT,a.TOIDENT,a.TOIDENT,a.TOIDENT,a.TOIDENT,a.TOIDENT,a.TOIDENT,a.TOIDENT,a.TOIDENT,a.TOIDENT,a.TOIDENT,a.TOIDENT,a.TOIDENT,a.TOIDENT,a.TOIDENT,a.TOIDENT,a.TOIDENT,a.TOIDENT,a.TOIDENT,a.TOIDENT,a.END,a.TOIDES,a.END,a.END,a.TOIDENT,a.END,a.TOIDENT,a.TOIDENT,a.TOIDENT,a.TOIDENT,a.TOIDENT,a.TOIDENT,a.TOIDENT,a.TOIDENT,a.TOIDENT,a.TOIDENT,a.TOIDENT,a.TOIDENT,a.TOIDENT,a.TOIDENT,a.TOIDENT,a.TOIDENT,a.TOIDENT,a.TOIDENT,a.TOIDENT,a.TOIDENT,a.TOIDENT,a.TOIDENT,a.TOIDENT,a.TOIDENT,a.TOIDENT,a.TOIDENT,a.END,a.END,a.END,a.END,a.END];p.NaN=a.END;var f=[a.ENDIDES,a.ENDIDES,a.ENDIDES,a.ENDIDES,a.ENDIDES,a.ENDIDES,a.ENDIDES,a.ENDIDES,a.ENDIDES,a.CHKPOSS,a.ENDIDES,a.ENDIDES,a.ENDIDES,a.ENDIDES,a.ENDIDES,a.ENDIDES,a.ENDIDES,a.ENDIDES,a.ENDIDES,a.ENDIDES,a.ENDIDES,a.ENDIDES,a.ENDIDES,a.ENDIDES,a.ENDIDES,a.ENDIDES,a.ENDIDES,a.ENDIDES,a.ENDIDES,a.ENDIDES,a.ENDIDES,a.ENDIDES,a.CHKPOSS,a.ENDIDES,a.ENDIDES,a.ENDIDES,a.ENDIDES,a.ENDIDES,a.ENDIDES,a.ENDIDES,a.FUNCES,a.ENDIDES,a.ENDIDES,a.ENDIDES,a.ENDIDES,a.ENDIDES,a.ENDIDES,a.ENDIDES,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.ENDIDES,a.ENDIDES,a.ENDIDES,a.ENDIDES,a.ENDIDES,a.ENDIDES,a.ENDIDES,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.ENDIDES,a.IDNTESC,a.ENDIDES,a.ENDIDES,a.CONT,a.ENDIDES,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.ENDIDES,a.ENDIDES,a.ENDIDES,a.ENDIDES,a.ENDIDES];f.NaN=a.ENDIDES;var d=[a.ENDINT,a.ENDINT,a.ENDINT,a.ENDINT,a.ENDINT,a.ENDINT,a.ENDINT,a.ENDINT,a.ENDINT,a.ENDINT,a.ENDINT,a.ENDINT,a.ENDINT,a.ENDINT,a.ENDINT,a.ENDINT,a.ENDINT,a.ENDINT,a.ENDINT,a.ENDINT,a.ENDINT,a.ENDINT,a.ENDINT,a.ENDINT,a.ENDINT,a.ENDINT,a.ENDINT,a.ENDINT,a.ENDINT,a.ENDINT,a.ENDINT,a.ENDINT,a.ENDINT,a.ENDINT,a.ENDINT,a.ENDINT,a.ENDINT,a.PCUNIT,a.ENDINT,a.ENDINT,a.ENDINT,a.ENDINT,a.ENDINT,a.ENDINT,a.ENDINT,a.ENDINT,a.NUMBER,a.ENDINT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.ENDINT,a.ENDINT,a.ENDINT,a.ENDINT,a.ENDINT,a.ENDINT,a.ENDINT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.ENDINT,a.ENDINT,a.ENDINT,a.ENDINT,a.UNIT,a.ENDINT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.ENDINT,a.ENDINT,a.ENDINT,a.ENDINT,a.ENDINT];d.NaN=a.ENDINT;var g=[a.ENDNUM,a.ENDNUM,a.ENDNUM,a.ENDNUM,a.ENDNUM,a.ENDNUM,a.ENDNUM,a.ENDNUM,a.ENDNUM,a.ENDNUM,a.ENDNUM,a.ENDNUM,a.ENDNUM,a.ENDNUM,a.ENDNUM,a.ENDNUM,a.ENDNUM,a.ENDNUM,a.ENDNUM,a.ENDNUM,a.ENDNUM,a.ENDNUM,a.ENDNUM,a.ENDNUM,a.ENDNUM,a.ENDNUM,a.ENDNUM,a.ENDNUM,a.ENDNUM,a.ENDNUM,a.ENDNUM,a.ENDNUM,a.ENDNUM,a.ENDNUM,a.ENDNUM,a.ENDNUM,a.ENDNUM,a.PCUNIT,a.ENDNUM,a.ENDNUM,a.ENDNUM,a.ENDNUM,a.ENDNUM,a.ENDNUM,a.ENDNUM,a.ENDNUM,a.ENDNUM,a.ENDNUM,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.ENDNUM,a.ENDNUM,a.ENDNUM,a.ENDNUM,a.ENDNUM,a.ENDNUM,a.ENDNUM,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.ENDNUM,a.ENDNUM,a.ENDNUM,a.ENDNUM,a.UNIT,a.ENDNUM,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.ENDNUM,a.ENDNUM,a.ENDNUM,a.ENDNUM,a.ENDNUM];g.NaN=a.ENDNUM;var m=l(a.END,[61,a.EQTAIL]),y=l(a.END,[58,a.COL_COL]),v=l(a.END,[61,a.EQTAIL,124,a.BAR_BAR]),E=l(a.END,[38,a.AMP_AMP]),b=l(a.END,[42,a.COMMENT]),w=l(a.CONT,[42,a.COMMST]),N=l(a.COMMENT,[42,a.COMMST,47,a.ENDNOTK]),C=l(a.KILL1,[62,a.ENDNOTK]),S=l(a.END,[61,a.EQTAIL,33,a.LT_BG]),T=l(a.KILL1,[45,a.LT_BG_M]),x=l(a.KILL2,[45,a.ENDNOTK]),I=l(a.IDESCH,[9,a.INVALID,10,a.INVALID,13,a.INVALID,32,a.INVALID]),P=l(a.CONT,[39,a.ENDSTR,10,a.INVALID,13,a.INVALID,92,a.STR1ESC]),A=l(a.CONT,[34,a.ENDSTR,10,a.INVALID,13,a.INVALID,92,a.STR2ESC]),R=l(a.CONT,[39,a.ENDESTR,10,a.CHKPOSN,13,a.CHKPOSN,92,a.STR1ESC]),O=l(a.CONT,[34,a.ENDESTR,10,a.CHKPOSN,13,a.CHKPOSN,92,a.STR2ESC]),L=l(a.URL,[9,a.CONT,32,a.CONT,34,a.URL2,39,a.URL1,41,a.INVALID,10,a.CONT,13,a.CONT]),k=l(a.CONT,[41,a.ENDURL,9,a.CHKSP,10,a.CHKSP,13,a.CHKSP,32,a.CHKSP,92,a.URLESC,40,a.INVALID,91,a.INVALID,93,a.INVALID,123,a.INVALID,125,a.INVALID,NaN,a.ENDURL]),F=l(a.CONT,[39,a.TERMURL,10,a.CHKPOSN,13,a.CHKPOSN,92,a.URLESC,NaN,a.ENDURL]),_=l(a.CONT,[34,a.TERMURL,10,a.CHKPOSN,13,a.CHKPOSN,92,a.URLESC,NaN,a.ENDURL]),D=l(a.INVALID,[9,a.CONT,10,a.CONT,13,a.CONT,32,a.CONT,41,a.FINURL]),B=15,M=function(){function t(t,e){this.input=t,this.handler=e,this.head=-1,this.tail=0,this.curr=0,this.position=0,this.indexMask=B,this.buffer=Array(this.indexMask+1);for(var n=0;n<=this.indexMask;n++)this.buffer[n]=new s}return t.prototype.token=function(){return this.tail==this.curr&&this.fillBuffer(),this.buffer[this.curr]},t.prototype.nthToken=function(t){return(this.tail-this.curr&this.indexMask)<=t&&this.fillBuffer(),this.buffer[this.curr+t&this.indexMask]},t.prototype.consume=function(){this.curr=this.curr+1&this.indexMask},t.prototype.mark=function(){if(this.head>=0)throw new Error("F_CSSTOK_BAD_CALL mark");this.head=this.curr},t.prototype.reset=function(){if(this.head<0)throw new Error("F_CSSTOK_BAD_CALL reset");this.curr=this.head,this.head=-1},t.prototype.unmark=function(){this.head=-1},t.prototype.hasMark=function(){return this.head>=0},t.prototype.reallocate=function(){for(var t=2*(this.indexMask+1)-1,e=Array(t+1),n=this.head,i=0;n!=this.tail;)e[i]=this.buffer[n],n==this.curr&&(this.curr=i),n=n+1&this.indexMask,i++;for(this.head=0,this.tail=i,this.indexMask=t,this.buffer=e;i<=t;)e[i++]=new s},t.prototype.error=function(t,e,n){this.handler&&this.handler.error(n,e)},t.prototype.fillBuffer=function(){var t=this.tail,e=this.head>=0?this.head:this.curr,n=this.indexMask;if(t>=e?e+=n:e--,e==t){if(this.head<0)throw new Error("F_CSSTOK_INTERNAL");this.reallocate(),t=this.tail,e=n=this.indexMask}for(var i=u,s=this.input,l=this.position,B=this.buffer,M=r.EOF,U=0,V="",H=0,z=!1,G=B[t],W=-9;;){var X=s.charCodeAt(l);switch(i[X]||i[65]){case a.INVALID:M=r.INVALID,V=isNaN(X)?"E_CSS_UNEXPECTED_EOF":"E_CSS_UNEXPECTED_CHAR",i=u,l++;break;case a.SPACE:l++,z=!0;continue;case a.INT:U=l++,i=d;continue;case a.IDENT:M=r.IDENT,U=l++,i=c;continue;case a.BANG:U=l++,M=r.BANG,i=m;continue;case a.STR1:M=r.STR,U=++l,i=P;continue;case a.STR2:M=r.STR,U=++l,i=A;continue;case a.HASH:U=++l,M=r.HASH,i=c;continue;case a.DOLLAR:U=l++,M=r.DOLLAR,i=m;continue;case a.PERCENT:U=l++,M=r.PERCENT;break;case a.AMP:U=l++,M=r.DOLLAR,i=E;continue;case a.O_PAR:U=l++,M=r.O_PAR;break;case a.C_PAR:U=l++,M=r.C_PAR;break;case a.STAR:U=l++,M=r.STAR,i=m;continue;case a.PLUS:U=l++,M=r.PLUS;break;case a.COMMA:U=l++,M=r.COMMA;break;case a.MINUS:M=r.MINUS,U=l++,i=p;continue;case a.DOT:U=l++,i=h;continue;case a.TOCLASS:U=l++,M=r.CLASS,i=c;continue;case a.SLASH:U=l++,M=r.SLASH,i=b;continue;case a.COLON:U=l++,M=r.COLON,i=y;continue;case a.COL_COL:l++,M=r.COL_COL;break;case a.SEMICOL:U=l++,M=r.SEMICOL;break;case a.LT:U=l++,M=r.LT,i=S;continue;case a.EQ:U=l++,M=r.EQ,i=m;continue;case a.GT:U=l++,M=r.GT,i=m;continue;case a.QMARK:U=l++,M=r.QMARK;break;case a.AT:U=++l,M=r.AT,i=c;continue;case a.O_BRK:U=l++,M=r.O_BRK;break;case a.C_BRK:U=l++,M=r.C_BRK;break;case a.O_BRC:U=l++,M=r.O_BRC;break;case a.C_BRC:U=l++,M=r.C_BRC;break;case a.BSLASH:W=U=l++,M=r.IDENT,i=I;continue;case a.HAT:U=l++,M=r.HAT,i=m;continue;case a.BAR:U=l++,M=r.BAR,i=v;continue;case a.TILDE:U=l++,M=r.TILDE,i=m;continue;case a.END:break;case a.EQTAIL:l++,M=M+r.BANG_EQ-r.BANG;break;case a.ENDINT:M=r.INT,H=parseInt(s.substring(U,l),10);break;case a.ENDNUM:M=r.NUM,H=parseFloat(s.substring(U,l));break;case a.CONT:l++;continue;case a.UNIT:M=r.NUMERIC,H=parseFloat(s.substring(U,l)),U=l++,i=c;continue;case a.PCUNIT:M=r.NUMERIC,H=parseFloat(s.substring(U,l)),V="%",U=l++;break;case a.NUMBER:l++,i=g;continue;case a.ENDIDNT:V=s.substring(U,l);break;case a.IDNTESC:W=l++,i=I;continue;case a.ENDIDES:V=o(s.substring(U,l));break;case a.ENDSTR:V=s.substring(U,l),l++;break;case a.ENDESTR:V=o(s.substring(U,l)),l++;break;case a.STR1ESC:W=l,l+=2,i=R;continue;case a.STR2ESC:W=l,l+=2,i=O;continue;case a.BAR_BAR:l++,M=r.BAR_BAR;break;case a.AMP_AMP:l++,M=r.AMP_AMP;break;case a.FUNC:if(V=s.substring(U,l),M==r.IDENT){if(l++,"url"==V.toLowerCase()){i=L;continue}M=r.FUNC}break;case a.FUNCES:if(V=o(s.substring(U,l)),M==r.IDENT){if(l++,"url"==V.toLowerCase()){i=L;continue}M=r.FUNC}break;case a.COMMENT:i=w,l++;continue;case a.COMMST:i=N,l++;continue;case a.ENDNOTK:i=u,l++;continue;case a.MINMIN:i=C,l++;continue;case a.TOINT:M=r.INT,i=d,l++;continue;case a.TONUM:M=r.NUM,i=g,l++;continue;case a.TOIDENT:M=r.IDENT,i=c,l++;continue;case a.TOIDES:M=r.IDENT,i=I,W=l++;continue;case a.KILL1:l--;break;case a.KILL2:l-=2;break;case a.URL:U=l++,i=k;continue;case a.URL1:U=++l,i=F;continue;case a.URL2:U=++l,i=_;continue;case a.ENDURL:M=r.URL,V=o(s.substring(U,l)),l++;break;case a.FINURL:l++;break;case a.LT_BG:i=T,l++;continue;case a.LT_BG_M:i=x,l++;continue;case a.CHKSP:if(l-W<8&&s.substring(W+1,l+1).match(/^[0-9a-fA-F]{0,6}(\r\n|[\n\r])|[ \t]$/)){l++;continue}case a.TERMURL:M=r.URL,V=o(s.substring(U,l)),l++,i=D;continue;case a.CHKPOSN:if(++l-W<9&&s.substring(W+1,l).match(/^[0-9a-fA-F]{0,6}(\r\n|[\n\r])$/))continue;M=r.INVALID,V="E_CSS_UNEXPECTED_NEWLINE",i=u;break;case a.CHKPOSS:if(l-W<9&&s.substring(W+1,l+1).match(/^[0-9a-fA-F]{0,6}[ \t]$/)){l++;continue}V=o(s.substring(U,l));break;case a.URLESC:W=l++;continue;case a.IDESCH:l++,i=f;continue;default:if(i!==u){M=r.INVALID,V="E_CSS_UNEXPECTED_STATE";break}U=l,M=r.EOF}if(G.type=M,G.precededBySpace=z,G.num=H,G.text=V,G.position=U,++t>=e)break;i=u,z=!1,G=B[t&n]}this.position=l,this.tail=t&n},t}()},function(t,e,n){n.d(e,"a",function(){return c}),n.d(e,"c",function(){return h}),n.d(e,"d",function(){return p}),n.d(e,"b",function(){return f}),n.d(e,"e",function(){return d});var i,o,r=n(1),a=n(6),s=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),l=null,u=null;function c(){return l}function h(t){if(!l)throw new Error("E_TASK_NO_CONTEXT");l.name||(l.name=t);var e=l,n=new w(e,e.top,t);return e.top=n,n.state=o.ACTIVE,n}function p(t){return new E(t)}function f(t,e,n){var i=h(t);i.handler=n;try{e(i)}catch(t){i.task.raise(t,i)}return i.result()}function d(t,e){return(l?l.getScheduler():u||new m(new g)).run(t,e)}!function(t){t[t.INIT=0]="INIT",t[t.ACTIVE=1]="ACTIVE",t[t.FINISHED=2]="FINISHED",t[t.DEAD=3]="DEAD"}(o||(o={}));var g=function(){function t(){}return t.prototype.currentTime=function(){return(new Date).valueOf()},t.prototype.setTimeout=function(t,e){return setTimeout(t,e)},t.prototype.clearTimeout=function(t){clearTimeout(t)},t}(),m=function(){function t(t){this.timer=t,this.timeout=1,this.slice=25,this.sliceOverTime=0,this.wakeupTime=null,this.timeoutToken=null,this.inTimeSlice=!1,this.order=0,this.queue=new r.b,u||(u=this)}return t.prototype.setSlice=function(t){this.slice=t},t.prototype.setTimeout=function(t){this.timeout=t},t.prototype.isTimeSliceOver=function(){return this.timer.currentTime()>=this.sliceOverTime},t.prototype.arm=function(){if(!this.inTimeSlice){var t=this.queue.peek().scheduledTime,e=this.timer.currentTime();if(null!=this.timeoutToken){if(e+this.timeout>this.wakeupTime)return;this.timer.clearTimeout(this.timeoutToken)}var n=t-e;n<=this.timeout&&(n=this.timeout),this.wakeupTime=e+n;var i=this;this.timeoutToken=this.timer.setTimeout(function(){i.timeoutToken=null,i.doTimeSlice()},n)}},t.prototype.schedule=function(t,e){var n=t,i=this.timer.currentTime();n.order=this.order++,n.scheduledTime=i+(e||0),this.queue.add(n),this.arm()},t.prototype.doTimeSlice=function(){null!=this.timeoutToken&&(this.timer.clearTimeout(this.timeoutToken),this.timeoutToken=null),this.inTimeSlice=!0;try{var t=this.timer.currentTime();for(this.sliceOverTime=t+this.slice;this.queue.length();){var e=this.queue.peek();if(e.scheduledTime>t)break;if(this.queue.remove(),e.canceled||e.resumeInternal(),(t=this.timer.currentTime())>=this.sliceOverTime)break}}catch(t){a.b.error(t)}this.inTimeSlice=!1,this.queue.length()&&this.arm()},t.prototype.run=function(t,e){var n=new v(this,e||"");n.top=new w(n,null,"bootstrap"),n.top.state=o.ACTIVE,n.top.then(function(){var e=function(){n.running=!1;for(var t=0,e=n.callbacks;t<e.length;t++){var i=e[t];try{i()}catch(t){a.b.error(t)}}};try{t().then(function(t){n.result=t,e()})}catch(t){n.raise(t),e()}});var i=l;return l=n,this.schedule(n.top.suspend("bootstrap")),l=i,n},t}(),y=function(){function t(t){this.task=t,this.scheduledTime=0,this.order=0,this.result=null,this.canceled=!1}return t.prototype.compare=function(t){var e=t;return e.scheduledTime-this.scheduledTime||e.order-this.order},t.prototype.getTask=function(){return this.task},t.prototype.schedule=function(t,e){this.result=t,this.task.scheduler.schedule(this,e)},t.prototype.resumeInternal=function(){var t=this.task;if(this.task=null,t&&t.continuation==this){t.continuation=null;var e=l;return l=t,t.top.finish(this.result),l=e,!0}return!1},t.prototype.cancel=function(){this.canceled=!0},t}(),v=function(){function t(t,e){this.scheduler=t,this.name=e,this.callbacks=[],this.exception=null,this.running=!0,this.result=null,this.waitTarget=null,this.top=null,this.continuation=null}return t.prototype.getName=function(){return this.name},t.prototype.interrupt=function(t){if(this.raise(t||new Error("E_TASK_INTERRUPT")),this!==l&&this.continuation){this.continuation.cancel();var e=new y(this);this.waitTarget="interrupt",this.continuation=e,this.scheduler.schedule(e)}},t.prototype.getScheduler=function(){return this.scheduler},t.prototype.isRunning=function(){return this.running},t.prototype.whenDone=function(t){this.callbacks.push(t)},t.prototype.join=function(){var t=h("Task.join");if(this.running){var e=t.suspend(this),n=this;this.whenDone(function(){e.schedule(n.result)})}else t.finish(this.result);return t.result()},t.prototype.unwind=function(){for(;this.top&&!this.top.handler;)this.top=this.top.parent;if(this.top&&this.top.handler&&this.exception){var t=this.exception;this.exception=null,this.top.handler(this.top,t)}else this.exception&&a.b.error(this.exception,"Unhandled exception in task",this.name)},t.prototype.raise=function(t,e){if(this.fillStack(t),e){for(var n=this.top;n&&n!=e;)n=n.parent;n==e&&(this.top=n)}this.exception=t,this.unwind()},t.prototype.fillStack=function(t){var e=t.frameTrace;if(!e){e=t.stack?t.stack+"\n\t---- async ---\n":"";for(var n=this.top;n;n=n.parent)e+="\t",e+=n.getName(),e+="\n";t.frameTrace=e}},t}(),E=function(){function t(t){this.value=t}return t.prototype.then=function(t){t(this.value)},t.prototype.thenAsync=function(t){return t(this.value)},t.prototype.thenReturn=function(e){return new t(e)},t.prototype.thenFinish=function(t){t.finish(this.value)},t.prototype.isPending=function(){return!1},t.prototype.get=function(){return this.value},t}(),b=function(){function t(t){this.frame=t}return t.prototype.then=function(t){this.frame.then(t)},t.prototype.thenAsync=function(t){if(this.isPending()){var e=new w(this.frame.task,this.frame.parent,"AsyncResult.thenAsync");return e.state=o.ACTIVE,this.frame.parent=e,this.frame.then(function(n){t(n).then(function(t){e.finish(t)})}),e.result()}return t(this.frame.res)},t.prototype.thenReturn=function(t){return this.isPending()?this.thenAsync(function(){return new E(t)}):new E(t)},t.prototype.thenFinish=function(t){this.isPending()?this.then(function(e){t.finish(e)}):t.finish(this.frame.res)},t.prototype.isPending=function(){return this.frame.state==o.ACTIVE},t.prototype.get=function(){if(this.isPending())throw new Error("Result is pending");return this.frame.res},t}(),w=function(){function t(t,e,n){this.task=t,this.parent=e,this.name=n,this.res=null,this.callback=null,this.handler=null,this.state=o.INIT}return t.prototype.checkEnvironment=function(){if(!l)throw new Error("F_TASK_NO_CONTEXT");if(this!==l.top)throw new Error("F_TASK_NOT_TOP_FRAME")},t.prototype.result=function(){return new b(this)},t.prototype.finish=function(t){this.checkEnvironment(),l&&!l.exception&&(this.res=t),this.state=o.FINISHED;var e=this.parent;if(l&&(l.top=e),this.callback){try{this.callback(t)}catch(t){this.task.raise(t,e)}this.state=o.DEAD}},t.prototype.getTask=function(){return this.task},t.prototype.getName=function(){return this.name},t.prototype.getScheduler=function(){return this.task.scheduler},t.prototype.then=function(t){switch(this.state){case o.ACTIVE:if(this.callback)throw new Error("F_TASK_FRAME_ALREADY_HAS_CALLBACK");this.callback=t;break;case o.FINISHED:var e=this.task,n=this.parent;try{t(this.res),this.state=o.DEAD}catch(t){this.state=o.DEAD,e.raise(t,n)}break;case o.DEAD:throw new Error("F_TASK_DEAD_FRAME");default:throw new Error("F_TASK_UNEXPECTED_FRAME_STATE "+this.state)}},t.prototype.timeSlice=function(){var t=h("Frame.timeSlice");return t.getScheduler().isTimeSliceOver()?(a.b.debug("-- time slice --"),t.suspend().schedule(!0)):t.finish(!0),t.result()},t.prototype.sleep=function(t){var e=h("Frame.sleep");return e.suspend().schedule(!0,t),e.result()},t.prototype.loop=function(t){var e=h("Frame.loop"),n=function(i){try{for(;i;){var o=t();if(o.isPending())return void o.then(n);o.then(function(t){i=t})}e.finish(!0)}catch(t){e.task.raise(t,e)}};return n(!0),e.result()},t.prototype.loopWithFrame=function(t){var e=l;if(!e)throw new Error("E_TASK_NO_CONTEXT");return this.loop(function(){var n;do{var i=new N(e,e.top);e.top=i,i.state=o.ACTIVE,t(i),n=i.result()}while(!n.isPending()&&n.get());return n})},t.prototype.suspend=function(t){if(this.checkEnvironment(),this.task.continuation)throw new Error("E_TASK_ALREADY_SUSPENDED");var e=new y(this.task);return this.task.continuation=e,l=null,this.task.waitTarget=t||null,e},t}(),N=function(t){function e(e,n){return t.call(this,e,n,"loop")||this}return s(e,t),e.prototype.continueLoop=function(){this.finish(!0)},e.prototype.breakLoop=function(){this.finish(!1)},e}(w)},function(t,e,n){n.d(e,"F",function(){return a}),n.d(e,"E",function(){return s}),n.d(e,"L",function(){return c}),n.d(e,"M",function(){return f}),n.d(e,"m",function(){return g}),n.d(e,"I",function(){return m}),n.d(e,"K",function(){return y}),n.d(e,"J",function(){return v}),n.d(e,"G",function(){return E}),n.d(e,"O",function(){return b}),n.d(e,"g",function(){return w}),n.d(e,"w",function(){return A}),n.d(e,"v",function(){return R}),n.d(e,"b",function(){return O}),n.d(e,"c",function(){return L}),n.d(e,"y",function(){return k}),n.d(e,"z",function(){return F}),n.d(e,"n",function(){return _}),n.d(e,"l",function(){return D}),n.d(e,"k",function(){return B}),n.d(e,"j",function(){return M}),n.d(e,"i",function(){return U}),n.d(e,"u",function(){return V}),n.d(e,"a",function(){return H}),n.d(e,"B",function(){return z}),n.d(e,"r",function(){return G}),n.d(e,"h",function(){return W}),n.d(e,"q",function(){return X}),n.d(e,"x",function(){return j}),n.d(e,"s",function(){return Y}),n.d(e,"o",function(){return q}),n.d(e,"t",function(){return K}),n.d(e,"d",function(){return Q}),n.d(e,"e",function(){return Z}),n.d(e,"f",function(){return $}),n.d(e,"p",function(){return J}),n.d(e,"A",function(){return tt}),n.d(e,"D",function(){return et}),n.d(e,"C",function(){return nt}),n.d(e,"P",function(){return it}),n.d(e,"N",function(){return ot}),n.d(e,"H",function(){return rt});var i,o=n(1),r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});function a(){return{fontFamily:"serif",lineHeight:1.25,margin:8,hyphenate:!1,columnWidth:25,horizontal:!1,nightMode:!1,spreadView:!1,pageBorder:1,enabledMediaTypes:{vivliostyle:!0,print:!0},defaultPaperSize:void 0}}function s(t){return{fontFamily:t.fontFamily,lineHeight:t.lineHeight,margin:t.margin,hyphenate:t.hyphenate,columnWidth:t.columnWidth,horizontal:t.horizontal,nightMode:t.nightMode,spreadView:t.spreadView,pageBorder:t.pageBorder,enabledMediaTypes:Object.assign({},t.enabledMediaTypes),defaultPaperSize:t.defaultPaperSize?Object.assign({},t.defaultPaperSize):void 0}}var l={fontFamily:"serif",lineHeight:1.25,margin:8,hyphenate:!1,columnWidth:25,horizontal:!1,nightMode:!1,spreadView:!1,pageBorder:1,enabledMediaTypes:{vivliostyle:!0,print:!0},defaultPaperSize:void 0},u={};function c(t,e,n,i){var o=Math.min((t-0)/n,(e-0)/i);return"matrix("+o+",0,0,"+o+",0,0)"}function h(t){return'"'+o.q(""+t)+'"'}function p(t){return o.p(""+t)}function f(t,e){return t?o.p(t)+"."+o.p(e):o.p(e)}var d=0,g=function(){function t(t,e){if(this.parent=t,this.resolver=e,this.children=[],this.values={},this.funcs={},this.builtIns={},this.scopeKey="S"+d++,this.zero=new $(this,0),this.one=new $(this,1),this._true=new $(this,!0),this._false=new $(this,!1),t&&t.children.push(this),!t){var n=this.builtIns;n.floor=Math.floor,n.ceil=Math.ceil,n.round=Math.round,n.sqrt=Math.sqrt,n.min=Math.min,n.max=Math.max,n.letterbox=c,n["css-string"]=h,n["css-name"]=p,n.typeof=function(t){return typeof t},this.defineBuiltInName("page-width",function(){return this.pageWidth()}),this.defineBuiltInName("page-height",function(){return this.pageHeight()}),this.defineBuiltInName("pref-font-family",function(){return this.pref.fontFamily}),this.defineBuiltInName("pref-night-mode",function(){return this.pref.nightMode}),this.defineBuiltInName("pref-hyphenate",function(){return this.pref.hyphenate}),this.defineBuiltInName("pref-margin",function(){return this.pref.margin}),this.defineBuiltInName("pref-line-height",function(){return this.pref.lineHeight}),this.defineBuiltInName("pref-column-width",function(){return this.pref.columnWidth*this.fontSize}),this.defineBuiltInName("pref-horizontal",function(){return this.pref.horizontal}),this.defineBuiltInName("pref-spread-view",function(){return this.pref.spreadView}),this.defineBuiltInName("pub-title",function(){return h(this.pubTitle?this.pubTitle:"")}),this.defineBuiltInName("doc-title",function(){return h(this.docTitle?this.docTitle:"")})}}return t.prototype.defineBuiltInName=function(t,e){this.values[t]=new K(this,e,t)},t.prototype.defineName=function(t,e){this.values[t]=e},t.prototype.defineFunc=function(t,e){this.funcs[t]=e},t.prototype.defineBuiltIn=function(t,e){this.builtIns[t]=e},t}();function m(t){switch(t.toLowerCase()){case"px":case"in":case"pt":case"pc":case"cm":case"mm":case"q":return!0;default:return!1}}function y(t){switch(t.toLowerCase()){case"vw":case"vh":case"vi":case"vb":case"vmin":case"vmax":case"pvw":case"pvh":case"pvi":case"pvb":case"pvmin":case"pvmax":return!0;default:return!1}}function v(t){switch(t.toLowerCase()){case"em":case"ex":case"rem":return!0;default:return!1}}var E={px:1,in:96,pt:4/3,pc:16,cm:96/2.54,mm:96/25.4,q:96/2.54/40,em:16,rem:16,ex:8,dppx:1,dpi:1/96,dpcm:2.54/96};function b(t){switch(t){case"q":case"rem":return!0;default:return!1}}var w=function(){function t(t,e,n,i){this.rootScope=t,this.viewportWidth=e,this.viewportHeight=n,this.actualPageWidth=null,this.actualPageHeight=null,this.rootFontSize=null,this.scopes={},this.pageAreaWidth=null,this.pageAreaHeight=null,this.pageVertical=null,this.pubTitle=null,this.docTitle=null,this.pageWidth=function(){return this.actualPageWidth?this.actualPageWidth:this.pref.spreadView?Math.floor(e/2)-this.pref.pageBorder:e},this.pageHeight=function(){return this.actualPageHeight?this.actualPageHeight:n},this.initialFontSize=i,this.fontSize=function(){return this.rootFontSize?this.rootFontSize:i},this.pref=l}return t.prototype.getScopeContext=function(t){var e=this.scopes[t.scopeKey];return e||(e={},this.scopes[t.scopeKey]=e),e},t.prototype.clearScope=function(t){this.scopes[t.scopeKey]={};for(var e=0;e<t.children.length;e++)this.clearScope(t.children[e])},t.prototype.queryUnitSize=function(t,e){if(y(t)){var n=this.pageWidth()/100,i=this.pageHeight()/100,o=null!=this.pageAreaWidth?this.pageAreaWidth/100:n,r=null!=this.pageAreaHeight?this.pageAreaHeight/100:i;switch(t){case"vw":return o;case"vh":return r;case"vi":return this.pageVertical?r:o;case"vb":return this.pageVertical?o:r;case"vmin":return o<r?o:r;case"vmax":return o>r?o:r;case"pvw":return n;case"pvh":return i;case"pvi":return this.pageVertical?i:n;case"pvb":return this.pageVertical?n:i;case"pvmin":return n<i?n:i;case"pvmax":return n>i?n:i}}return"em"==t||"rem"==t?e?this.initialFontSize:this.fontSize():"ex"==t?E.ex*(e?this.initialFontSize:this.fontSize())/E.em:E[t]},t.prototype.evalName=function(t,e){do{var n=t.values[e];if(n)return n;if(t.resolver&&(n=t.resolver.call(this,e,!1)))return n;t=t.parent}while(t);throw new Error("Name '"+e+"' is undefined")},t.prototype.evalCall=function(t,e,n,i){do{var o=t.funcs[e];if(o)return o;if(t.resolver&&(o=t.resolver.call(this,e,!0)))return o;var r=t.builtIns[e];if(r){if(i)return t.zero;for(var a=Array(n.length),s=0;s<n.length;s++)a[s]=n[s].evaluate(this);return new $(t,r.apply(this,a))}t=t.parent}while(t);throw new Error("Function '"+e+"' is undefined")},t.prototype.evalMediaName=function(t,e){var n="all"===t||!!this.pref.enabledMediaTypes[t];return e?!n:n},t.prototype.evalMediaTest=function(t,e){var n="",i=t.match(/^(min|max)-(.*)$/);i&&(n=i[1],t=i[2]);var o=null,r=null;switch(t){case"width":case"height":case"device-width":case"device-height":case"color":e&&(o=e.evaluate(this))}switch(t){case"width":r=this.pageWidth();break;case"height":r=this.pageHeight();break;case"device-width":r=window.screen.availWidth;break;case"device-height":r=window.screen.availHeight;break;case"color":r=window.screen.pixelDepth}if(null!=r&&null!=o)switch(n){case"min":return r>=o;case"max":return r<=o;default:return r==o}else if(null!=r&&null==e)return 0!==r;return!1},t.prototype.queryVal=function(t,e){var n=this.scopes[t.scopeKey];return n?n[e]:void 0},t.prototype.storeVal=function(t,e,n){this.getScopeContext(t)[e]=n},t}(),N=function(){function t(t){this.scope=t,this.scope=t,this.key="_"+d++}return t.prototype.toString=function(){var t=new o.d;return this.appendTo(t,0),t.toString()},t.prototype.appendTo=function(t,e){throw new Error("F_ABSTRACT")},t.prototype.evaluateCore=function(t){throw new Error("F_ABSTRACT")},t.prototype.expand=function(t,e){return this},t.prototype.dependCore=function(t,e,n){return t===this},t.prototype.dependOuter=function(t,e,n){var i=n[this.key];if(null!=i)return i!==u&&i;n[this.key]=u;var o=this.dependCore(t,e,n);return n[this.key]=o,o},t.prototype.depend=function(t,e){return this.dependOuter(t,e,{})},t.prototype.evaluate=function(t){var e=t.queryVal(this.scope,this.key);return void 0!==e?e:(e=this.evaluateCore(t),t.storeVal(this.scope,this.key,e),e)},t.prototype.isMediaName=function(){return!1},t}(),C=function(t){function e(e,n){var i=t.call(this,e)||this;return i.val=n,i}return r(e,t),e.prototype.getOp=function(){throw new Error("F_ABSTRACT")},e.prototype.evalPrefix=function(t){throw new Error("F_ABSTRACT")},e.prototype.evaluateCore=function(t){var e=this.val.evaluate(t);return this.evalPrefix(e)},e.prototype.dependCore=function(t,e,n){return t===this||this.val.dependOuter(t,e,n)},e.prototype.appendTo=function(t,e){10<e&&t.append("("),t.append(this.getOp()),this.val.appendTo(t,10),10<e&&t.append(")")},e.prototype.expand=function(t,e){var n=this.val.expand(t,e);return n===this.val?this:new this.constructor(this.scope,n)},e}(N),S=function(t){function e(e,n,i){var o=t.call(this,e)||this;return o.lhs=n,o.rhs=i,o}return r(e,t),e.prototype.getPriority=function(){throw new Error("F_ABSTRACT")},e.prototype.getOp=function(){throw new Error("F_ABSTRACT")},e.prototype.evalInfix=function(t,e){throw new Error("F_ABSTRACT")},e.prototype.evaluateCore=function(t){var e=this.lhs.evaluate(t),n=this.rhs.evaluate(t);return this.evalInfix(e,n)},e.prototype.dependCore=function(t,e,n){return t===this||this.lhs.dependOuter(t,e,n)||this.rhs.dependOuter(t,e,n)},e.prototype.appendTo=function(t,e){var n=this.getPriority();n<=e&&t.append("("),this.lhs.appendTo(t,n),t.append(this.getOp()),this.rhs.appendTo(t,n),n<=e&&t.append(")")},e.prototype.expand=function(t,e){var n=this.lhs.expand(t,e),i=this.rhs.expand(t,e);return n===this.lhs&&i===this.rhs?this:new this.constructor(this.scope,n,i)},e}(N),T=function(t){function e(e,n,i){return t.call(this,e,n,i)||this}return r(e,t),e.prototype.getPriority=function(){return 1},e}(S),x=function(t){function e(e,n,i){return t.call(this,e,n,i)||this}return r(e,t),e.prototype.getPriority=function(){return 2},e}(S),I=function(t){function e(e,n,i){return t.call(this,e,n,i)||this}return r(e,t),e.prototype.getPriority=function(){return 3},e}(S),P=function(t){function e(e,n,i){return t.call(this,e,n,i)||this}return r(e,t),e.prototype.getPriority=function(){return 4},e}(S),A=function(t){function e(e,n){return t.call(this,e,n)||this}return r(e,t),e.prototype.getOp=function(){return"!"},e.prototype.evalPrefix=function(t){return!t},e}(C),R=function(t){function e(e,n){return t.call(this,e,n)||this}return r(e,t),e.prototype.getOp=function(){return"-"},e.prototype.evalPrefix=function(t){return-t},e}(C),O=function(t){function e(e,n,i){return t.call(this,e,n,i)||this}return r(e,t),e.prototype.getOp=function(){return"&&"},e.prototype.evaluateCore=function(t){return this.lhs.evaluate(t)&&this.rhs.evaluate(t)},e}(T),L=function(t){function e(e,n,i){return t.call(this,e,n,i)||this}return r(e,t),e.prototype.getOp=function(){return" and "},e}(O),k=function(t){function e(e,n,i){return t.call(this,e,n,i)||this}return r(e,t),e.prototype.getOp=function(){return"||"},e.prototype.evaluateCore=function(t){return this.lhs.evaluate(t)||this.rhs.evaluate(t)},e}(T),F=function(t){function e(e,n,i){return t.call(this,e,n,i)||this}return r(e,t),e.prototype.getOp=function(){return", "},e}(k),_=function(t){function e(e,n,i){return t.call(this,e,n,i)||this}return r(e,t),e.prototype.getOp=function(){return"<"},e.prototype.evalInfix=function(t,e){return t<e},e}(x),D=function(t){function e(e,n,i){return t.call(this,e,n,i)||this}return r(e,t),e.prototype.getOp=function(){return"<="},e.prototype.evalInfix=function(t,e){return t<=e},e}(x),B=function(t){function e(e,n,i){return t.call(this,e,n,i)||this}return r(e,t),e.prototype.getOp=function(){return">"},e.prototype.evalInfix=function(t,e){return t>e},e}(x),M=function(t){function e(e,n,i){return t.call(this,e,n,i)||this}return r(e,t),e.prototype.getOp=function(){return">="},e.prototype.evalInfix=function(t,e){return t>=e},e}(x),U=function(t){function e(e,n,i){return t.call(this,e,n,i)||this}return r(e,t),e.prototype.getOp=function(){return"=="},e.prototype.evalInfix=function(t,e){return t==e},e}(x),V=function(t){function e(e,n,i){return t.call(this,e,n,i)||this}return r(e,t),e.prototype.getOp=function(){return"!="},e.prototype.evalInfix=function(t,e){return t!=e},e}(x),H=function(t){function e(e,n,i){return t.call(this,e,n,i)||this}return r(e,t),e.prototype.getOp=function(){return"+"},e.prototype.evalInfix=function(t,e){return t+e},e}(I),z=function(t){function e(e,n,i){return t.call(this,e,n,i)||this}return r(e,t),e.prototype.getOp=function(){return" - "},e.prototype.evalInfix=function(t,e){return t-e},e}(I),G=function(t){function e(e,n,i){return t.call(this,e,n,i)||this}return r(e,t),e.prototype.getOp=function(){return"*"},e.prototype.evalInfix=function(t,e){return t*e},e}(P),W=function(t){function e(e,n,i){return t.call(this,e,n,i)||this}return r(e,t),e.prototype.getOp=function(){return"/"},e.prototype.evalInfix=function(t,e){return t/e},e}(P),X=function(t){function e(e,n,i){return t.call(this,e,n,i)||this}return r(e,t),e.prototype.getOp=function(){return"%"},e.prototype.evalInfix=function(t,e){return t%e},e}(P),j=function(t){function e(e,n,i){var o=t.call(this,e)||this;return o.num=n,o.unit=i.toLowerCase(),o}return r(e,t),e.prototype.appendTo=function(t,e){t.append(this.num.toString()),t.append(o.p(this.unit))},e.prototype.evaluateCore=function(t){return this.num*t.queryUnitSize(this.unit,!1)},e}(N),Y=function(t){function e(e,n){var i=t.call(this,e)||this;return i.qualifiedName=n,i}return r(e,t),e.prototype.appendTo=function(t,e){t.append(this.qualifiedName)},e.prototype.evaluateCore=function(t){return t.evalName(this.scope,this.qualifiedName).evaluate(t)},e.prototype.dependCore=function(t,e,n){return t===this||e.evalName(this.scope,this.qualifiedName).dependOuter(t,e,n)},e}(N),q=function(t){function e(e,n,i){var o=t.call(this,e)||this;return o.not=n,o.name=i,o}return r(e,t),e.prototype.appendTo=function(t,e){this.not&&t.append("not "),t.append(o.p(this.name))},e.prototype.evaluateCore=function(t){return t.evalMediaName(this.name,this.not)},e.prototype.dependCore=function(t,e,n){return t===this||this.value.dependOuter(t,e,n)},e.prototype.isMediaName=function(){return!0},e}(N),K=function(t){function e(e,n,i){var o=t.call(this,e)||this;return o.fn=n,o.str=i,o}return r(e,t),e.prototype.appendTo=function(t,e){t.append(this.str)},e.prototype.evaluateCore=function(t){return this.fn.call(t)},e}(N),Q=function(t){function e(e,n,i){var o=t.call(this,e)||this;return o.qualifiedName=n,o.params=i,o}return r(e,t),e.prototype.appendTo=function(t,e){t.append(this.qualifiedName),function(t,e){t.append("(");for(var n=0;n<e.length;n++)n&&t.append(","),e[n].appendTo(t,0);t.append(")")}(t,this.params)},e.prototype.evaluateCore=function(t){return t.evalCall(this.scope,this.qualifiedName,this.params,!1).expand(t,this.params).evaluate(t)},e.prototype.dependCore=function(t,e,n){if(t===this)return!0;for(var i=0;i<this.params.length;i++)if(this.params[i].dependOuter(t,e,n))return!0;return e.evalCall(this.scope,this.qualifiedName,this.params,!0).dependOuter(t,e,n)},e.prototype.expand=function(t,n){var i=function(t,e,n){for(var i=e,o=0;o<e.length;o++){var r=e[o].expand(t,n);if(e!==i)i[o]=r;else if(r!==e[o]){i=Array(e.length);for(var a=0;a<o;a++)i[a]=e[a];i[o]=r}}return i}(t,this.params,n);return i===this.params?this:new e(this.scope,this.qualifiedName,i)},e}(N),Z=function(t){function e(e,n,i,o){var r=t.call(this,e)||this;return r.cond=n,r.ifTrue=i,r.ifFalse=o,r}return r(e,t),e.prototype.appendTo=function(t,e){e>0&&t.append("("),this.cond.appendTo(t,0),t.append("?"),this.ifTrue.appendTo(t,0),t.append(":"),this.ifFalse.appendTo(t,0),e>0&&t.append(")")},e.prototype.evaluateCore=function(t){return this.cond.evaluate(t)?this.ifTrue.evaluate(t):this.ifFalse.evaluate(t)},e.prototype.dependCore=function(t,e,n){return t===this||this.cond.dependOuter(t,e,n)||this.ifTrue.dependOuter(t,e,n)||this.ifFalse.dependOuter(t,e,n)},e.prototype.expand=function(t,n){var i=this.cond.expand(t,n),o=this.ifTrue.expand(t,n),r=this.ifFalse.expand(t,n);return i===this.cond&&o===this.ifTrue&&r===this.ifFalse?this:new e(this.scope,i,o,r)},e}(N),$=function(t){function e(e,n){var i=t.call(this,e)||this;return i.val=n,i}return r(e,t),e.prototype.appendTo=function(t,e){switch(typeof this.val){case"number":case"boolean":t.append(this.val.toString());break;case"string":t.append('"'),t.append(o.q(this.val)),t.append('"');break;default:throw new Error("F_UNEXPECTED_STATE")}},e.prototype.evaluateCore=function(t){return this.val},e}(N),J=function(t){function e(e,n,i){var o=t.call(this,e)||this;return o.name=n,o.value=i,o}return r(e,t),e.prototype.appendTo=function(t,e){t.append("("),t.append(o.q(this.name.name)),t.append(":"),this.value.appendTo(t,0),t.append(")")},e.prototype.evaluateCore=function(t){return t.evalMediaTest(this.name.name,this.value)},e.prototype.dependCore=function(t,e,n){return t===this||this.value.dependOuter(t,e,n)},e.prototype.expand=function(t,n){var i=this.value.expand(t,n);return i===this.value?this:new e(this.scope,this.name,i)},e}(N),tt=function(t){function e(e,n){var i=t.call(this,e)||this;return i.index=n,i}return r(e,t),e.prototype.appendTo=function(t,e){t.append("$"),t.append(this.index.toString())},e.prototype.expand=function(t,e){var n=e[this.index];if(!n)throw new Error("Parameter missing: "+this.index);return n},e}(N);function et(t,e,n){return e===t._false||e===t.zero||n==t._false||n==t.zero?t._false:e===t._true||e===t.one?n:n===t._true||n===t.one?e:new O(t,e,n)}function nt(t,e,n){return e===t.zero?n:n===t.zero?e:new H(t,e,n)}function it(t,e,n){return e===t.zero?new R(t,n):n===t.zero?e:new z(t,e,n)}function ot(t,e,n){return e===t.zero||n===t.zero?t.zero:e===t.one?n:n===t.one?e:new G(t,e,n)}function rt(t,e,n){return e===t.zero?t.zero:n===t.one?e:new W(t,e,n)}},function(t,e,n){n.d(e,"v",function(){return g}),n.d(e,"r",function(){return y}),n.d(e,"H",function(){return v}),n.d(e,"m",function(){return C}),n.d(e,"l",function(){return S}),n.d(e,"c",function(){return I}),n.d(e,"i",function(){return A}),n.d(e,"x",function(){return L}),n.d(e,"w",function(){return k}),n.d(e,"s",function(){return F}),n.d(e,"F",function(){return _}),n.d(e,"u",function(){return D}),n.d(e,"q",function(){return B}),n.d(e,"t",function(){return U}),n.d(e,"B",function(){return H}),n.d(e,"A",function(){return z}),n.d(e,"g",function(){return W}),n.d(e,"j",function(){return X}),n.d(e,"a",function(){return K}),n.d(e,"d",function(){return Q}),n.d(e,"e",function(){return Ot}),n.d(e,"G",function(){return Gt}),n.d(e,"b",function(){return Wt}),n.d(e,"f",function(){return qt}),n.d(e,"h",function(){return Kt}),n.d(e,"p",function(){return Zt}),n.d(e,"D",function(){return $t}),n.d(e,"E",function(){return Jt}),n.d(e,"z",function(){return te}),n.d(e,"y",function(){return ee}),n.d(e,"n",function(){return ne}),n.d(e,"o",function(){return ie}),n.d(e,"C",function(){return oe}),n.d(e,"k",function(){return re});var i,o=n(7),r=n(1),a=n(0),s=n(10),l=n(20),u=n(2),c=n(4),h=n(6),p=n(25),f=n(9),d=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),g={azimuth:!0,"border-collapse":!0,"border-spacing":!0,"caption-side":!0,"clip-rule":!0,color:!0,"color-interpolation":!0,"color-rendering":!0,cursor:!0,direction:!0,elevation:!0,"empty-cells":!0,fill:!0,"fill-opacity":!0,"fill-rule":!0,"font-kerning":!0,"font-size":!0,"font-size-adjust":!0,"font-family":!0,"font-feature-settings":!0,"font-style":!0,"font-stretch":!0,"font-variant":!0,"font-weight":!0,"glyph-orientation-vertical":!0,hyphens:!0,"hyphenate-character":!0,"hyphenate-limit-chars":!0,"hyphenate-limit-last":!0,"image-rendering":!0,"image-resolution":!0,"letter-spacing":!0,"line-break":!0,"line-height":!0,"list-style-image":!0,"list-style-position":!0,"list-style-type":!0,marker:!0,"marker-end":!0,"marker-mid":!0,"marker-start":!0,orphans:!0,"overflow-wrap":!0,"paint-order":!0,"pointer-events":!0,"pitch-range":!0,quotes:!0,richness:!0,"ruby-align":!0,"ruby-position":!0,"speak-header":!0,"speak-numeral":!0,"speak-punctuation":!0,"speech-rate":!0,"shape-rendering":!0,stress:!0,stroke:!0,"stroke-dasharray":!0,"stroke-dashoffset":!0,"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-miterlimit":!0,"stroke-opacity":!0,"stroke-width":!0,"tab-size":!0,"text-align":!0,"text-align-last":!0,"text-anchor":!0,"text-decoration-skip":!0,"text-emphasis-color":!0,"text-emphasis-position":!0,"text-emphasis-style":!0,"text-combine-upright":!0,"text-indent":!0,"text-justify":!0,"text-rendering":!0,"text-size-adjust":!0,"text-transform":!0,"text-underline-position":!0,visibility:!0,"voice-family":!0,volume:!0,"white-space":!0,widows:!0,"word-break":!0,"word-spacing":!0,"word-wrap":!0,"writing-mode":!0},m=["box-decoration-break","image-resolution","orphans","widows"];function y(){return f.b(f.a.POLYFILLED_INHERITED_PROPS).reduce(function(t,e){return t.concat(e())},[].concat(m))}var v={"http://www.idpf.org/2007/ops":!0,"http://www.w3.org/1999/xhtml":!0,"http://www.w3.org/2000/svg":!0},E=["margin-%","padding-%","border-%-width","border-%-style","border-%-color","%"],b=["max-%","min-%","%"],w=function(){for(var t=["left","right","top","bottom"],e={width:!0,height:!0,"max-width":!0,"max-height":!0,"min-width":!0,"min-height":!0},n=0;n<E.length;n++)for(var i=0;i<t.length;i++)e[E[n].replace("%",t[i])]=!0;return e}();function N(t,e){for(var n={},i=0,o=E;i<o.length;i++){var r=o[i];for(var a in t){var s=r.replace("%",a),l=r.replace("%",t[a]);n[s]=l,n[l]=s}}for(var u=0,c=b;u<c.length;u++){var h=c[u];for(var p in e)s=h.replace("%",p),l=h.replace("%",e[p]),n[s]=l,n[l]=s}return n}var C=N({"block-start":"right","block-end":"left","inline-start":"top","inline-end":"bottom"},{"block-size":"width","inline-size":"height"}),S=N({"block-start":"top","block-end":"bottom","inline-start":"left","inline-end":"right"},{"block-size":"height","inline-size":"width"}),T=N({"block-start":"right","block-end":"left","inline-start":"bottom","inline-end":"top"},{"block-size":"width","inline-size":"height"}),x=N({"block-start":"top","block-end":"bottom","inline-start":"right","inline-end":"left"},{"block-size":"height","inline-size":"width"}),I=function(){function t(t,e){this.value=t,this.priority=e}return t.prototype.getBaseValue=function(){return this},t.prototype.filterValue=function(e){var n=this.value.visit(e);return n===this.value?this:new t(n,this.priority)},t.prototype.increaseSpecificity=function(e){return 0==e?this:new t(this.value,this.priority+e)},t.prototype.evaluate=function(t,e){return s.i(t,this.value,e)},t.prototype.isEnabled=function(t){return!0},t}(),P=function(t){function e(e,n,i){var o=t.call(this,e,n)||this;return o.condition=i,o}return d(e,t),e.prototype.getBaseValue=function(){return new I(this.value,this.priority)},e.prototype.filterValue=function(t){var n=this.value.visit(t);return n===this.value?this:new e(n,this.priority,this.condition)},e.prototype.increaseSpecificity=function(t){return 0==t?this:new e(this.value,this.priority+t,this.condition)},e.prototype.isEnabled=function(t){return!!this.condition.evaluate(t)},e}(I);function A(t,e,n){return(null==e||n.priority>e.priority)&&n.isEnabled(t)?n.getBaseValue():e}var R={"region-id":!0,"fragment-selector-id":!0};function O(t){return!!R[t]}function L(t){return"_"!=t.charAt(0)&&!R[t]}function k(t){return!!g[t]}function F(t,e){return t[e]}function _(t,e,n){n?t[e]=n:delete t[e]}function D(t,e){return t[e]}function B(t,e){var n=t[e];return n||(n={},t[e]=n),n}var M=function(t){var e=t._viewConditionalStyles;return e||(e=[],t._viewConditionalStyles=e),e};function U(t,e){return t[e]}function V(t,e){var n=t[e];return n||(n=[],t[e]=n),n}function H(t,e,n,i,o,r,a){if([{id:o,styleKey:"_pseudos"},{id:r,styleKey:"_regions"}].forEach(function(t){if(t.id){var n=B(e,t.styleKey);(e=n[t.id])||(e={},n[t.id]=e)}}),a){var s=M(e);e={},s.push({styles:e,matcher:a})}for(var l in n)if("_"!=l.charAt(0))if(O(l)){var u=U(n,l),c=V(e,l);Array.prototype.push.apply(c,u)}else{var h=F(n,l).increaseSpecificity(i),p=F(e,l);_(e,l,A(t,p,h))}}function z(t,e){for(var n={},i=0;i<e.length;i++)H(t,n,e[i],0,null,null,null);return n}function G(t,e){if(t.length>0){t.sort(function(t,e){return e.getPriority()-t.getPriority()});for(var n=null,i=t.length-1;i>=0;i--)(n=t[i]).chained=e,e=n;return n}return e}var W=function(t){function e(e,n){var i=t.call(this)||this;return i.props=e,i.context=n,i.propName="",i}return d(e,t),e.prototype.setPropName=function(t){this.propName=t},e.prototype.getFontSize=function(){var t=F(this.props,"font-size").value;if(!c.I(t.unit))throw new Error("Unexpected state");return t.num*c.G[t.unit]},e.prototype.visitNumeric=function(t){if(o.a(this.context),"font-size"===this.propName)return function(t,e,n){var i=(t=X(t,e,n)).unit,o=t.num;return"px"===i?t:"%"===i?new a.i(o/100*e,"px"):new a.i(o*n.queryUnitSize(i,!1),"px")}(t,this.getFontSize(),this.context);if("em"==t.unit||"ex"==t.unit||"rem"==t.unit)return X(t,this.getFontSize(),this.context);if("%"==t.unit){if("line-height"===this.propName)return t;var e=this.propName.match(/height|^(top|bottom)$/)?"vh":"vw";return new a.i(t.num,e)}return t},e.prototype.visitExpr=function(t){return"font-size"==this.propName?s.i(this.context,t,this.propName).visit(this):t},e}(a.d);function X(t,e,n){var i=t.unit,o=t.num;if("em"===i||"ex"===i){var r=c.G[i]/c.G.em;return new a.i(o*r*e,"px")}return"rem"===i?new a.i(o*n.fontSize(),"px"):t}var j=function(){function t(){}return t.prototype.apply=function(t){},t.prototype.mergeWith=function(t){return new q([this,t])},t.prototype.clone=function(){return this},t}(),Y=function(t){function e(e){var n=t.call(this)||this;return n.conditionItem=e,n}return d(e,t),e.prototype.apply=function(t){t.pushConditionItem(this.conditionItem.fresh(t))},e}(j),q=function(t){function e(e){var n=t.call(this)||this;return n.list=e,n}return d(e,t),e.prototype.apply=function(t){for(var e=0;e<this.list.length;e++)this.list[e].apply(t)},e.prototype.mergeWith=function(t){return this.list.push(t),this},e.prototype.clone=function(){return new e([].concat(this.list))},e}(j),K=function(t){function e(e,n,i,o,r){var a=t.call(this)||this;return a.style=e,a.specificity=n,a.pseudoelement=i,a.regionId=o,a.viewConditionId=r,a}return d(e,t),e.prototype.apply=function(t){H(t.context,t.currentStyle,this.style,this.specificity,this.pseudoelement,this.regionId,t.buildViewConditionMatcher(this.viewConditionId))},e}(j),Q=function(t){function e(){var e=t.call(this)||this;return e.chained=null,e}return d(e,t),e.prototype.apply=function(t){this.chained.apply(t)},e.prototype.getPriority=function(){return 0},e.prototype.makePrimary=function(t){return!1},e}(j),Z=function(t){function e(e){var n=t.call(this)||this;return n.className=e,n}return d(e,t),e.prototype.apply=function(t){t.currentClassNames.includes(this.className)&&this.chained.apply(t)},e.prototype.getPriority=function(){return 10},e.prototype.makePrimary=function(t){return this.chained&&t.insertInTable(t.classes,this.className,this.chained),!0},e}(Q),$=function(t){function e(e){var n=t.call(this)||this;return n.id=e,n}return d(e,t),e.prototype.apply=function(t){t.currentId!=this.id&&t.currentXmlId!=this.id||this.chained.apply(t)},e.prototype.getPriority=function(){return 11},e.prototype.makePrimary=function(t){return this.chained&&t.insertInTable(t.ids,this.id,this.chained),!0},e}(Q),J=function(t){function e(e){var n=t.call(this)||this;return n.localName=e,n}return d(e,t),e.prototype.apply=function(t){t.currentLocalName==this.localName&&this.chained.apply(t)},e.prototype.getPriority=function(){return 8},e.prototype.makePrimary=function(t){return this.chained&&t.insertInTable(t.tags,this.localName,this.chained),!0},e}(Q),tt=function(t){function e(e,n){var i=t.call(this)||this;return i.ns=e,i.localName=n,i}return d(e,t),e.prototype.apply=function(t){t.currentLocalName==this.localName&&t.currentNamespace==this.ns&&this.chained.apply(t)},e.prototype.getPriority=function(){return 8},e.prototype.makePrimary=function(t){if(this.chained){var e=t.nsPrefix[this.ns];e||(e="ns"+t.nsCount+++":",t.nsPrefix[this.ns]=e);var n=e+this.localName;t.insertInTable(t.nstags,n,this.chained)}return!0},e}(Q),et=function(t){function e(e){var n=t.call(this)||this;return n.epubTypePatt=e,n}return d(e,t),e.prototype.apply=function(t){var e=t.currentElement;if(e&&"a"==t.currentLocalName){var n=e.getAttribute("href");if(n&&n.match(/^#/)){var i=n.substring(1),o=e.ownerDocument.getElementById(i);if(o){var a=o.getAttributeNS(r.a.epub,"type");a&&a.match(this.epubTypePatt)&&this.chained.apply(t)}}}},e}(Q),nt=function(t){function e(e){var n=t.call(this)||this;return n.ns=e,n}return d(e,t),e.prototype.apply=function(t){t.currentNamespace==this.ns&&this.chained.apply(t)},e}(Q),it=function(t){function e(e,n){var i=t.call(this)||this;return i.ns=e,i.name=n,i}return d(e,t),e.prototype.apply=function(t){t.currentElement&&t.currentElement.hasAttributeNS(this.ns,this.name)&&this.chained.apply(t)},e}(Q),ot=function(t){function e(e,n,i){var o=t.call(this)||this;return o.ns=e,o.name=n,o.value=i,o}return d(e,t),e.prototype.apply=function(t){t.currentElement&&t.currentElement.getAttributeNS(this.ns,this.name)==this.value&&this.chained.apply(t)},e.prototype.getPriority=function(){return"type"==this.name&&this.ns==r.a.epub?9:0},e.prototype.makePrimary=function(t){return"type"==this.name&&this.ns==r.a.epub&&(this.chained&&t.insertInTable(t.epubtypes,this.value,this.chained),!0)},e}(Q),rt=function(t){function e(e,n){var i=t.call(this)||this;return i.ns=e,i.name=n,i}return d(e,t),e.prototype.apply=function(t){if(t.currentElement){var e=t.currentElement.getAttributeNS(this.ns,this.name);e&&v[e]&&this.chained.apply(t)}},e.prototype.getPriority=function(){return 0},e.prototype.makePrimary=function(t){return!1},e}(Q),at=function(t){function e(e,n,i){var o=t.call(this)||this;return o.ns=e,o.name=n,o.regexp=i,o}return d(e,t),e.prototype.apply=function(t){if(t.currentElement){var e=t.currentElement.getAttributeNS(this.ns,this.name);e&&e.match(this.regexp)&&this.chained.apply(t)}},e}(Q),st=function(t){function e(e){var n=t.call(this)||this;return n.langRegExp=e,n}return d(e,t),e.prototype.apply=function(t){t.lang.match(this.langRegExp)&&this.chained.apply(t)},e}(Q),lt=function(t){function e(){return t.call(this)||this}return d(e,t),e.prototype.apply=function(t){t.isFirst&&this.chained.apply(t)},e.prototype.getPriority=function(){return 6},e}(Q),ut=function(t){function e(){return t.call(this)||this}return d(e,t),e.prototype.apply=function(t){t.isRoot&&this.chained.apply(t)},e.prototype.getPriority=function(){return 12},e}(Q),ct=function(t){function e(e,n){var i=t.call(this)||this;return i.a=e,i.b=n,i}return d(e,t),e.prototype.matchANPlusB=function(t){return p.c(t,this.a,this.b)},e}(Q),ht=function(t){function e(e,n){return t.call(this,e,n)||this}return d(e,t),e.prototype.apply=function(t){this.matchANPlusB(t.currentSiblingOrder)&&this.chained.apply(t)},e.prototype.getPriority=function(){return 5},e}(ct),pt=function(t){function e(e,n){return t.call(this,e,n)||this}return d(e,t),e.prototype.apply=function(t){var e=t.currentSiblingTypeCounts[t.currentNamespace][t.currentLocalName];this.matchANPlusB(e)&&this.chained.apply(t)},e.prototype.getPriority=function(){return 5},e}(ct),ft=function(t){function e(e,n){return t.call(this,e,n)||this}return d(e,t),e.prototype.apply=function(t){var e=t.currentFollowingSiblingOrder;null===e&&(e=t.currentFollowingSiblingOrder=t.currentElement.parentNode.childElementCount-t.currentSiblingOrder+1),this.matchANPlusB(e)&&this.chained.apply(t)},e.prototype.getPriority=function(){return 4},e}(ct),dt=function(t){function e(e,n){return t.call(this,e,n)||this}return d(e,t),e.prototype.apply=function(t){var e=t.currentFollowingSiblingTypeCounts;if(!e[t.currentNamespace]){var n=t.currentElement;do{var i=n.namespaceURI,o=n.localName,r=e[i];r||(r=e[i]={}),r[o]=(r[o]||0)+1}while(n=n.nextElementSibling)}this.matchANPlusB(e[t.currentNamespace][t.currentLocalName])&&this.chained.apply(t)},e.prototype.getPriority=function(){return 4},e}(ct),gt=function(t){function e(){return t.call(this)||this}return d(e,t),e.prototype.apply=function(t){for(var e=t.currentElement.firstChild;e;){switch(e.nodeType){case Node.ELEMENT_NODE:return;case Node.TEXT_NODE:if(e.length>0)return}e=e.nextSibling}this.chained.apply(t)},e.prototype.getPriority=function(){return 4},e}(Q),mt=function(t){function e(){return t.call(this)||this}return d(e,t),e.prototype.apply=function(t){!1===t.currentElement.disabled&&this.chained.apply(t)},e.prototype.getPriority=function(){return 5},e}(Q),yt=function(t){function e(){return t.call(this)||this}return d(e,t),e.prototype.apply=function(t){!0===t.currentElement.disabled&&this.chained.apply(t)},e.prototype.getPriority=function(){return 5},e}(Q),vt=function(t){function e(){return t.call(this)||this}return d(e,t),e.prototype.apply=function(t){var e=t.currentElement;!0!==e.selected&&!0!==e.checked||this.chained.apply(t)},e.prototype.getPriority=function(){return 5},e}(Q),Et=function(t){function e(e){var n=t.call(this)||this;return n.condition=e,n}return d(e,t),e.prototype.apply=function(t){if(t.conditions[this.condition])try{t.dependentConditions.push(this.condition),this.chained.apply(t)}finally{t.dependentConditions.pop()}},e.prototype.getPriority=function(){return 5},e}(Q),bt=function(t){function e(){var e=t.call(this)||this;return e.applied=!1,e}return d(e,t),e.prototype.apply=function(t){this.applied=!0},e.prototype.clone=function(){var t=new e;return t.applied=this.applied,t},e}(j),wt=function(t){function e(e){var n=t.call(this)||this;return n.checkAppliedAction=new bt,n.firstAction=G(e,n.checkAppliedAction),n}return d(e,t),e.prototype.apply=function(t){this.firstAction.apply(t),this.checkAppliedAction.applied||this.chained.apply(t),this.checkAppliedAction.applied=!1},e.prototype.getPriority=function(){return this.firstAction.getPriority()},e}(Q),Nt=function(){function t(t,e,n){this.condition=t,this.viewConditionId=e,this.viewCondition=n}return t.prototype.increment=function(t){t.increment(this.condition,this.viewCondition)},t.prototype.decrement=function(t){t.decrement(this.condition,this.viewCondition)},t.prototype.buildViewConditionMatcher=function(t){return t.buildViewConditionMatcher(this.viewConditionId)},t}(),Ct=function(t){function e(e,n,i){return t.call(this,e,n,i)||this}return d(e,t),e.prototype.fresh=function(t){return new e(this.condition,this.viewConditionId,this.buildViewConditionMatcher(t))},e.prototype.push=function(t,e){return 0==e&&this.increment(t),!1},e.prototype.pop=function(t,e){return 0==e&&(this.decrement(t),!0)},e}(Nt),St=function(t){function e(e,n,i){return t.call(this,e,n,i)||this}return d(e,t),e.prototype.fresh=function(t){return new e(this.condition,this.viewConditionId,this.buildViewConditionMatcher(t))},e.prototype.push=function(t,e){return 0==e?this.increment(t):1==e&&this.decrement(t),!1},e.prototype.pop=function(t,e){return 0==e?(this.decrement(t),!0):(1==e&&this.increment(t),!1)},e}(Nt),Tt=function(t){function e(e,n,i){var o=t.call(this,e,n,i)||this;return o.fired=!1,o}return d(e,t),e.prototype.fresh=function(t){return new e(this.condition,this.viewConditionId,this.buildViewConditionMatcher(t))},e.prototype.push=function(t,e){return!!this.fired&&(this.decrement(t),!0)},e.prototype.pop=function(t,e){return this.fired?(this.decrement(t),!0):(0==e&&(this.fired=!0,this.increment(t)),!1)},e}(Nt),xt=function(t){function e(e,n,i){var o=t.call(this,e,n,i)||this;return o.fired=!1,o}return d(e,t),e.prototype.fresh=function(t){return new e(this.condition,this.viewConditionId,this.buildViewConditionMatcher(t))},e.prototype.push=function(t,e){return this.fired&&(-1==e?this.increment(t):0==e&&this.decrement(t)),!1},e.prototype.pop=function(t,e){if(this.fired){if(-1==e)return this.decrement(t),!0;0==e&&this.increment(t)}else 0==e&&(this.fired=!0,this.increment(t));return!1},e}(Nt),It=function(){function t(t,e){this.afterprop=t,this.element=e}return t.prototype.fresh=function(t){return this},t.prototype.push=function(t,e){return!1},t.prototype.pop=function(t,e){return 0==e&&(t.processPseudoelementProps(this.afterprop,this.element),!0)},t}(),Pt=function(){function t(t){this.lang=t}return t.prototype.fresh=function(t){return this},t.prototype.push=function(t,e){return!1},t.prototype.pop=function(t,e){return 0==e&&(t.lang=this.lang,!0)},t}(),At=function(){function t(t){this.oldQuotes=t}return t.prototype.fresh=function(t){return this},t.prototype.push=function(t,e){return!1},t.prototype.pop=function(t,e){return 0==e&&(t.quotes=this.oldQuotes,!0)},t}(),Rt=function(t){function e(e){var n=t.call(this)||this;return n.element=e,n}return d(e,t),e.prototype.createValueFromString=function(t,e){switch(e){case"url":return t?new a.l(t):new a.l("about:invalid");case"string":default:return t?new a.k(t):new a.k("")}},e.prototype.visitFunc=function(e){if("attr"!==e.name)return t.prototype.visitFunc.call(this,e);var n,i="string",o=null;if(e.values[0]instanceof a.j){var r=e.values[0].values;r.length>=2&&(i=r[1].stringValue()),o=r[0].stringValue()}else o=e.values[0].stringValue();return n=e.values.length>1?this.createValueFromString(e.values[1].stringValue(),i):this.createValueFromString(null,i),this.element&&this.element.hasAttribute(o)?this.createValueFromString(this.element.getAttribute(o),i):n},e}(a.d),Ot=function(t){function e(e,n,i){var o=t.call(this)||this;return o.cascade=e,o.element=n,o.counterResolver=i,o}return d(e,t),e.prototype.visitIdent=function(t){var e=this.cascade,n=e.quotes,i=Math.floor(n.length/2)-1;switch(t.name){case"open-quote":var o=n[2*Math.min(i,e.quoteDepth)];return e.quoteDepth++,o;case"close-quote":return e.quoteDepth>0&&e.quoteDepth--,n[2*Math.min(i,e.quoteDepth)+1];case"no-open-quote":return e.quoteDepth++,new a.k("");case"no-close-quote":return e.quoteDepth>0&&e.quoteDepth--,new a.k("")}return t},e.prototype.format=function(t,e){var n,i=!1,o=!1;null!=(n=e.match(/^upper-(.*)/))?(i=!0,e=n[1]):null!=(n=e.match(/^lower-(.*)/))&&(o=!0,e=n[1]);var a="";return Lt[e]?a=function(t,e){if(e>t[0]||e<=0||e!=Math.round(e))return"";for(var n="",i=1;i<t.length;i+=2){var o=t[i],r=Math.floor(e/o);if(r>20)return"";for(e-=r*o;r>0;)n+=t[i+1],r--}return n}(Lt[e],t):kt[e]?a=function(t,e){if(e<=0||e!=Math.round(e))return"";var n=function(t){for(var e=[],n=0;n<t.length;)if("-"==t.substr(n+1,1)){var i=t.charCodeAt(n),o=t.charCodeAt(n+2);n+=3;for(var r=i;r<=o;r++)e.push(String.fromCharCode(r))}else e.push(t.substr(n++,1));return e}(t),i="";do{var o=--e%n.length;i=n[o]+i,e=(e-o)/n.length}while(e>0);return i}(kt[e],t):null!=Ft[e]?a=Ft[e]:"decimal-leading-zero"==e?1==(a=""+t).length&&(a="0"+a):a="cjk-ideographic"==e||"trad-chinese-informal"==e?function(t,e){if(t>9999||t<-9999)return""+t;if(0==t)return e.digits.charAt(0);var n=new r.d;if(t<0&&(n.append(e.negative),t=-t),t<10)n.append(e.digits.charAt(t));else if(!e.formal&&t<=19)n.append(e.markers.charAt(0)),0!=t&&n.append(e.digits.charAt(t-10));else{var i=Math.floor(t/1e3);i&&(n.append(e.digits.charAt(i)),n.append(e.markers.charAt(2)));var o=Math.floor(t/100)%10;o&&(n.append(e.digits.charAt(o)),n.append(e.markers.charAt(1)));var a=Math.floor(t/10)%10;a&&(n.append(e.digits.charAt(a)),n.append(e.markers.charAt(0)));var s=t%10;s&&n.append(e.digits.charAt(s))}return n.toString()}(t,_t):""+t,i?a.toUpperCase():o?a.toLowerCase():a},e.prototype.visitFuncCounter=function(t){var e=t[0].toString(),n=t.length>1?t[1].stringValue():"decimal",i=this.cascade.counters[e];if(i&&i.length){var o=i&&i.length&&i[i.length-1]||0;return new a.k(this.format(o,n))}var r=this,s=new a.c(this.counterResolver.getPageCounterVal(e,function(t){return r.format(t||0,n)}));return new a.j([s])},e.prototype.visitFuncCounters=function(t){var e=t[0].toString(),n=t[1].stringValue(),i=t.length>2?t[2].stringValue():"decimal",o=this.cascade.counters[e],s=new r.d;if(o&&o.length)for(var l=0;l<o.length;l++)l>0&&s.append(n),s.append(this.format(o[l],i));var u=this,c=new a.c(this.counterResolver.getPageCountersVal(e,function(t){var e=[];if(t.length)for(var o=0;o<t.length;o++)e.push(u.format(t[o],i));var r=s.toString();return r.length&&e.push(r),e.length?e.join(n):u.format(0,i)}));return new a.j([c])},e.prototype.visitFuncTargetCounter=function(t){var e,n=t[0];e=n instanceof a.l?n.url:n.stringValue();var i=t[1].toString(),o=t.length>2?t[2].stringValue():"decimal",r=this,s=new a.c(this.counterResolver.getTargetCounterVal(e,i,function(t){return r.format(t||0,o)}));return new a.j([s])},e.prototype.visitFuncTargetCounters=function(t){var e,n=t[0];e=n instanceof a.l?n.url:n.stringValue();var i=t[1].toString(),o=t[2].stringValue(),r=t.length>3?t[3].stringValue():"decimal",s=this,l=new a.c(this.counterResolver.getTargetCountersVal(e,i,function(t){var e=t.map(function(t){return s.format(t,r)});return e.length?e.join(o):s.format(0,r)}));return new a.j([l])},e.prototype.visitFunc=function(t){switch(t.name){case"counter":if(t.values.length<=2)return this.visitFuncCounter(t.values);break;case"counters":if(t.values.length<=3)return this.visitFuncCounters(t.values);break;case"target-counter":if(t.values.length<=3)return this.visitFuncTargetCounter(t.values);break;case"target-counters":if(t.values.length<=4)return this.visitFuncTargetCounters(t.values)}return h.b.warn("E_CSS_CONTENT_PROP:",t.toString()),new a.k("")},e}(a.d),Lt={roman:[4999,1e3,"M",900,"CM",500,"D",400,"CD",100,"C",90,"XC",50,"L",40,"XL",10,"X",9,"IX",5,"V",4,"IV",1,"I"],armenian:[9999,9e3,"ք",8e3,"փ",7e3,"ւ",6e3,"ց",5e3,"ր",4e3,"տ",3e3,"վ",2e3,"ս",1e3,"ռ",900,"ջ",800,"պ",700,"չ",600,"ո",500,"շ",400,"ն",300,"յ",200,"մ",100,"ճ",90,"ղ",80,"ձ",70,"հ",60,"կ",50,"ծ",40,"խ",30,"լ",20,"ի",10,"ժ",9,"թ",8,"ը",7,"է",6,"զ",5,"ե",4,"դ",3,"գ",2,"բ",1,"ա"],georgian:[19999,1e4,"ჵ",9e3,"ჰ",8e3,"ჯ",7e3,"ჴ",6e3,"ხ",5e3,"ჭ",4e3,"წ",3e3,"ძ",2e3,"ც",1e3,"ჩ",900,"შ",800,"ყ",700,"ღ",600,"ქ",500,"ფ",400,"ჳ",300,"ტ",200,"ს",100,"რ",90,"ჟ",80,"პ",70,"ო",60,"ჲ",50,"ნ",40,"მ",30,"ლ",20,"კ",10,"ი",9,"თ",8,"ჱ",7,"ზ",6,"ვ",5,"ე",4,"დ",3,"გ",2,"ბ",1,"ა"],hebrew:[999,400,"ת",300,"ש",200,"ר",100,"ק",90,"צ",80,"פ",70,"ע",60,"ס",50,"נ",40,"מ",30,"ל",20,"כ",19,"יט",18,"יח",17,"יז",16,"טז",15,"טו",10,"י",9,"ט",8,"ח",7,"ז",6,"ו",5,"ה",4,"ד",3,"ג",2,"ב",1,"א"]},kt={latin:"a-z",alpha:"a-z",greek:"α-ρσ-ω",russian:"а-ик-щэ-я"},Ft={square:"■",disc:"•",circle:"◦",none:""},_t={formal:!1,digits:"零一二三四五六七八九",markers:"十百千",negative:"負"};function Dt(t,e){for(var n in t)e[n]=t[n].clone()}var Bt,Mt=function(){function t(){this.nsCount=0,this.nsPrefix={},this.tags={},this.nstags={},this.epubtypes={},this.classes={},this.ids={},this.pagetypes={},this.order=0}return t.prototype.clone=function(){var e=new t;for(var n in e.nsCount=this.nsCount,this.nsPrefix)e.nsPrefix[n]=this.nsPrefix[n];return Dt(this.tags,e.tags),Dt(this.nstags,e.nstags),Dt(this.epubtypes,e.epubtypes),Dt(this.classes,e.classes),Dt(this.ids,e.ids),Dt(this.pagetypes,e.pagetypes),e.order=this.order,e},t.prototype.insertInTable=function(t,e,n){var i=t[e];i&&(n=i.mergeWith(n)),t[e]=n},t.prototype.createInstance=function(t,e,n,i){return new Ut(this,t,e,n,i)},t.prototype.nextOrder=function(){return this.order+=1/1048576},t}(),Ut=function(){function t(t,e,n,i,o){this.context=e,this.counterListener=n,this.counterResolver=i,this.stack=[[],[]],this.conditions={},this.currentElement=null,this.currentElementOffset=null,this.currentStyle=null,this.currentClassNames=null,this.currentLocalName="",this.currentNamespace="",this.currentId="",this.currentXmlId="",this.currentNSTag="",this.currentEpubTypes=null,this.currentPageType=null,this.isFirst=!0,this.isRoot=!0,this.counters={},this.counterScoping=[{}],this.quoteDepth=0,this.lang="",this.siblingOrderStack=[0],this.currentSiblingOrder=0,this.siblingTypeCountsStack=[{}],this.currentFollowingSiblingOrder=null,this.followingSiblingTypeCountsStack=[{}],this.viewConditions={},this.dependentConditions=[],this.code=t,this.quotes=[new a.k("“"),new a.k("”"),new a.k("‘"),new a.k("’")],this.currentSiblingTypeCounts=this.siblingTypeCountsStack[0],this.followingSiblingOrderStack=[this.currentFollowingSiblingOrder],this.currentFollowingSiblingTypeCounts=this.siblingTypeCountsStack[0]}return t.prototype.pushConditionItem=function(t){this.stack[this.stack.length-1].push(t)},t.prototype.increment=function(t,e){this.conditions[t]=(this.conditions[t]||0)+1,e&&(this.viewConditions[t]?this.viewConditions[t].push(e):this.viewConditions[t]=[e])},t.prototype.decrement=function(t,e){this.conditions[t]--,this.viewConditions[t]&&(this.viewConditions[t]=this.viewConditions[t].filter(function(t){return t!==e}),0===this.viewConditions[t].length&&delete this.viewConditions[t])},t.prototype.buildViewConditionMatcher=function(t){var e=this,n=null;t&&(o.a(this.currentElementOffset),n=p.a.buildViewConditionMatcher(this.currentElementOffset,t));var i=this.dependentConditions.map(function(t){var n=e.viewConditions[t];return n&&n.length>0?1===n.length?n[0]:p.a.buildAnyMatcher([].concat(n)):null}).filter(function(t){return t});return i.length<=0?n:null===n?1===i.length?i[0]:p.a.buildAllMatcher(i):p.a.buildAllMatcher([n].concat(i))},t.prototype.applyAction=function(t,e){var n=t[e];n&&n.apply(this)},t.prototype.pushRule=function(t,e,n){this.currentElement=null,this.currentElementOffset=null,this.currentStyle=n,this.currentNamespace="",this.currentLocalName="",this.currentId="",this.currentXmlId="",this.currentClassNames=t,this.currentNSTag="",this.currentEpubTypes=Vt,this.currentPageType=e,this.applyActions()},t.prototype.defineCounter=function(t,e){this.counters[t]?this.counters[t].push(e):this.counters[t]=[e];var n=this.counterScoping[this.counterScoping.length-1];n||(n={},this.counterScoping[this.counterScoping.length-1]=n),n[t]=!0},t.prototype.pushCounters=function(t){var e=a.t.inline,n=t.display;n&&(e=n.evaluate(this.context));var i=null,o=null,s=null,u=t["counter-reset"];if(u){var c=u.evaluate(this.context);c&&(i=l.b(c,!0))}var h=t["counter-set"];if(h){var p=h.evaluate(this.context);p&&(s=l.b(p,!1))}var f=t["counter-increment"];if(f){var d=f.evaluate(this.context);d&&(o=l.b(d,!1))}if("ol"!=this.currentLocalName&&"ul"!=this.currentLocalName||this.currentNamespace!=r.a.XHTML||(i||(i={}),i["ua-list-item"]=0),e===a.t.list_item&&(o||(o={}),o["ua-list-item"]=1),i)for(var g in i)this.defineCounter(g,i[g]);if(s)for(var m in s)this.counters[m]?(v=this.counters[m])[v.length-1]=s[m]:this.defineCounter(m,s[m]);if(o)for(var y in o){var v;this.counters[y]||this.defineCounter(y,0),(v=this.counters[y])[v.length-1]+=o[y]}if(e===a.t.list_item){var E=this.counters["ua-list-item"],b=E[E.length-1];t["ua-list-item-count"]=new I(new a.h(b),0)}this.counterScoping.push(null)},t.prototype.popCounters=function(){var t=this.counterScoping.pop();if(t)for(var e in t){var n=this.counters[e];n&&(1==n.length?delete this.counters[e]:n.pop())}},t.prototype.processPseudoelementProps=function(t,e){this.pushCounters(t),t.content&&(t.content=t.content.filterValue(new Ot(this,e,this.counterResolver))),this.popCounters()},t.prototype.pushElement=function(t,e,n){var i=this;this.currentPageType=null,this.currentElement=t,this.currentElementOffset=n,this.currentStyle=e,this.currentNamespace=t.namespaceURI,this.currentLocalName=t.localName;var o=this.code.nsPrefix[this.currentNamespace];this.currentNSTag=o?o+this.currentLocalName:"",this.currentId=t.getAttribute("id"),this.currentXmlId=t.getAttributeNS(r.a.XML,"id");var s=t.getAttribute("class");this.currentClassNames=s?s.split(/\s+/):Vt;var l=t.getAttributeNS(r.a.epub,"type");if(this.currentEpubTypes=l?l.split(/\s+/):Vt,"style"==this.currentLocalName&&this.currentNamespace==r.a.FB2){var u=t.getAttribute("name")||"";this.currentClassNames=[u]}var c=r.u(t);c&&(this.stack[this.stack.length-1].push(new Pt(this.lang)),this.lang=c.toLowerCase());var h=this.isRoot,p=this.siblingOrderStack;this.currentSiblingOrder=++p[p.length-1],p.push(0);var f=this.siblingTypeCountsStack,d=this.currentSiblingTypeCounts=f[f.length-1],g=d[this.currentNamespace];g||(g=d[this.currentNamespace]={}),g[this.currentLocalName]=(g[this.currentLocalName]||0)+1,f.push({});var m=this.followingSiblingOrderStack;null!==m[m.length-1]?this.currentFollowingSiblingOrder=--m[m.length-1]:this.currentFollowingSiblingOrder=null,m.push(null);var y=this.followingSiblingTypeCountsStack,v=this.currentFollowingSiblingTypeCounts=y[y.length-1];v&&v[this.currentNamespace]&&v[this.currentNamespace][this.currentLocalName]--,y.push({}),this.applyActions(),this.applyAttrFilter(t);var E=e.quotes,b=null;if(E){var w=E.evaluate(this.context);w&&(b=new At(this.quotes),w===a.t.none?this.quotes=[new a.k(""),new a.k("")]:w instanceof a.j&&(this.quotes=w.values))}this.pushCounters(this.currentStyle);var N=this.currentId||this.currentXmlId||t.getAttribute("name")||"";if(h||N){var C={};Object.keys(this.counters).forEach(function(t){C[t]=Array.from(i.counters[t])}),this.counterListener.countersOfId(N,C)}var S=D(this.currentStyle,"_pseudos");if(S)for(var T=!0,x=0,I=Ht;x<I.length;x++){var P=I[x];P||(T=!1);var A=S[P];A&&(T?this.processPseudoelementProps(A,t):this.stack[this.stack.length-2].push(new It(A,t)))}b&&this.stack[this.stack.length-2].push(b)},t.prototype.applyAttrFilterInner=function(t,e){for(var n in e)L(n)&&(e[n]=e[n].filterValue(t))},t.prototype.applyAttrFilter=function(t){var e=new Rt(t),n=this.currentStyle,i=D(n,"_pseudos");for(var o in i)this.applyAttrFilterInner(e,i[o]);this.applyAttrFilterInner(e,n)},t.prototype.applyActions=function(){var t;for(t=0;t<this.currentClassNames.length;t++)this.applyAction(this.code.classes,this.currentClassNames[t]);for(t=0;t<this.currentEpubTypes.length;t++)this.applyAction(this.code.epubtypes,this.currentEpubTypes[t]);this.applyAction(this.code.ids,this.currentId),this.applyAction(this.code.tags,this.currentLocalName),""!=this.currentLocalName&&this.applyAction(this.code.tags,"*"),this.applyAction(this.code.nstags,this.currentNSTag),null!==this.currentPageType&&(this.applyAction(this.code.pagetypes,this.currentPageType),this.applyAction(this.code.pagetypes,"*")),this.currentElement=null,this.currentDoc=null,this.stack.push([]);for(var e=1;e>=-1;--e){var n=this.stack[this.stack.length-e-2];for(t=0;t<n.length;)n[t].push(this,e)?n.splice(t,1):t++}this.isFirst=!0,this.isRoot=!1},t.prototype.pop=function(){for(var t=1;t>=-1;--t)for(var e=this.stack[this.stack.length-t-2],n=0;n<e.length;)e[n].pop(this,t)?e.splice(n,1):n++;this.stack.pop(),this.isFirst=!1},t.prototype.popRule=function(){this.pop()},t.prototype.popElement=function(t){this.siblingOrderStack.pop(),this.siblingTypeCountsStack.pop(),this.followingSiblingOrderStack.pop(),this.followingSiblingTypeCountsStack.pop(),this.pop(),this.popCounters()},t}(),Vt=[],Ht=["before","transclusion-before","footnote-call","footnote-marker","inner","first-letter","first-line","","transclusion-after","after"];!function(t){t[t.TOP=0]="TOP",t[t.SELECTOR=1]="SELECTOR",t[t.RULE=2]="RULE"}(Bt||(Bt={}));var zt=null;function Gt(t){zt=t}var Wt=function(t){function e(e,n,i,o,r,a,s){var l=t.call(this,e,n,s)||this;return l.condition=i,l.regionId=r,l.validatorSet=a,l.chain=null,l.specificity=0,l.elementStyle=null,l.conditionCount=0,l.pseudoelement=null,l.footnoteContent=!1,l.viewConditionId=null,l.cascade=o?o.cascade:zt?zt.clone():new Mt,l.state=Bt.TOP,l}return d(e,t),e.prototype.insertNonPrimary=function(t){this.cascade.insertInTable(this.cascade.tags,"*",t)},e.prototype.processChain=function(t){var e=G(this.chain,t);e!==t&&e.makePrimary(this.cascade)||this.insertNonPrimary(e)},e.prototype.isInsideSelectorRule=function(t){return this.state!=Bt.TOP&&(this.reportAndSkip(t),!0)},e.prototype.tagSelector=function(t,e){(e||t)&&(this.specificity+=1,e&&t?this.chain.push(new tt(t,e.toLowerCase())):e?this.chain.push(new J(e.toLowerCase())):this.chain.push(new nt(t)))},e.prototype.classSelector=function(t){if(this.pseudoelement)return h.b.warn("::"+this.pseudoelement,"followed by ."+t),void this.chain.push(new Et(""));this.specificity+=256,this.chain.push(new Z(t))},e.prototype.pseudoclassSelector=function(t,e){if(this.pseudoelement)return h.b.warn("::"+this.pseudoelement,"followed by :"+t),void this.chain.push(new Et(""));switch(t.toLowerCase()){case"enabled":this.chain.push(new mt);break;case"disabled":this.chain.push(new yt);break;case"checked":this.chain.push(new vt);break;case"root":this.chain.push(new ut);break;case"link":this.chain.push(new J("a")),this.chain.push(new it("","href"));break;case"-adapt-href-epub-type":case"href-epub-type":if(e&&1==e.length&&"string"==typeof e[0]){var n=e[0],i=new RegExp("(^|s)"+r.s(n)+"($|s)");this.chain.push(new et(i))}else this.chain.push(new Et(""));break;case"-adapt-footnote-content":case"footnote-content":this.footnoteContent=!0;break;case"visited":case"active":case"hover":case"focus":this.chain.push(new Et(""));break;case"lang":if(e&&1==e.length&&"string"==typeof e[0]){var o=e[0];this.chain.push(new st(new RegExp("^"+r.s(o.toLowerCase())+"($|-)")))}else this.chain.push(new Et(""));break;case"nth-child":case"nth-last-child":case"nth-of-type":case"nth-last-of-type":var a=Xt[t.toLowerCase()];e&&2==e.length?this.chain.push(new a(e[0],e[1])):this.chain.push(new Et(""));break;case"first-child":this.chain.push(new lt);break;case"last-child":this.chain.push(new ft(0,1));break;case"first-of-type":this.chain.push(new pt(0,1));break;case"last-of-type":this.chain.push(new dt(0,1));break;case"only-child":this.chain.push(new lt),this.chain.push(new ft(0,1));break;case"only-of-type":this.chain.push(new pt(0,1)),this.chain.push(new dt(0,1));break;case"empty":this.chain.push(new gt);break;case"before":case"after":case"first-line":case"first-letter":return void this.pseudoelementSelector(t,e);default:h.b.warn("unknown pseudo-class selector: "+t),this.chain.push(new Et(""))}this.specificity+=256},e.prototype.pseudoelementSelector=function(t,e){switch(t){case"before":case"after":case"first-line":case"first-letter":case"footnote-call":case"footnote-marker":case"inner":case"after-if-continues":this.pseudoelement?(h.b.warn("Double pseudoelement ::"+this.pseudoelement+"::"+t),this.chain.push(new Et(""))):this.pseudoelement=t;break;case"first-n-lines":if(e&&1==e.length&&"number"==typeof e[0]){var n=Math.round(e[0]);if(n>0&&n==e[0]){this.pseudoelement?(h.b.warn("Double pseudoelement ::"+this.pseudoelement+"::"+t),this.chain.push(new Et(""))):this.pseudoelement="first-"+n+"-lines";break}}this.chain.push(new Et(""));break;case"nth-fragment":e&&2==e.length?this.viewConditionId="NFS_"+e[0]+"_"+e[1]:this.chain.push(new Et(""));break;default:h.b.warn("Unrecognized pseudoelement: ::"+t),this.chain.push(new Et(""))}this.specificity+=1},e.prototype.idSelector=function(t){this.specificity+=65536,this.chain.push(new $(t))},e.prototype.attributeSelector=function(t,e,n,i){var o;switch(this.specificity+=256,e=e.toLowerCase(),i=i||"",n){case u.a.EOF:o=new it(t,e);break;case u.a.EQ:o=new ot(t,e,i);break;case u.a.TILDE_EQ:o=!i||i.match(/\s/)?new Et(""):new at(t,e,new RegExp("(^|\\s)"+r.s(i)+"($|\\s)"));break;case u.a.BAR_EQ:o=new at(t,e,new RegExp("^"+r.s(i)+"($|-)"));break;case u.a.HAT_EQ:o=i?new at(t,e,new RegExp("^"+r.s(i))):new Et("");break;case u.a.DOLLAR_EQ:o=i?new at(t,e,new RegExp(r.s(i)+"$")):new Et("");break;case u.a.STAR_EQ:o=i?new at(t,e,new RegExp(r.s(i))):new Et("");break;case u.a.COL_COL:"supported"==i?o=new rt(t,e):(h.b.warn("Unsupported :: attr selector op:",i),o=new Et(""));break;default:h.b.warn("Unsupported attr selector:",n),o=new Et("")}this.chain.push(o)},e.prototype.descendantSelector=function(){var t="d"+jt++;this.processChain(new Y(new Ct(t,this.viewConditionId,null))),this.chain=[new Et(t)],this.viewConditionId=null},e.prototype.childSelector=function(){var t="c"+jt++;this.processChain(new Y(new St(t,this.viewConditionId,null))),this.chain=[new Et(t)],this.viewConditionId=null},e.prototype.adjacentSiblingSelector=function(){var t="a"+jt++;this.processChain(new Y(new Tt(t,this.viewConditionId,null))),this.chain=[new Et(t)],this.viewConditionId=null},e.prototype.followingSiblingSelector=function(){var t="f"+jt++;this.processChain(new Y(new xt(t,this.viewConditionId,null))),this.chain=[new Et(t)],this.viewConditionId=null},e.prototype.nextSelector=function(){this.finishChain(),this.pseudoelement=null,this.footnoteContent=!1,this.specificity=0,this.chain=[]},e.prototype.startSelectorRule=function(){this.isInsideSelectorRule("E_CSS_UNEXPECTED_SELECTOR")||(this.state=Bt.SELECTOR,this.elementStyle={},this.pseudoelement=null,this.specificity=0,this.footnoteContent=!1,this.chain=[])},e.prototype.error=function(e,n){t.prototype.error.call(this,e,n),this.state==Bt.SELECTOR&&(this.state=Bt.TOP)},e.prototype.startStylesheet=function(e){t.prototype.startStylesheet.call(this,e),this.state=Bt.TOP},e.prototype.startRuleBody=function(){this.finishChain(),t.prototype.startRuleBody.call(this),this.state==Bt.SELECTOR&&(this.state=Bt.TOP)},e.prototype.endRule=function(){t.prototype.endRule.call(this),this.insideSelectorRule=Bt.TOP},e.prototype.finishChain=function(){if(this.chain){var t=this.specificity+this.cascade.nextOrder();this.processChain(this.makeApplyRuleAction(t)),this.chain=null,this.pseudoelement=null,this.viewConditionId=null,this.footnoteContent=!1,this.specificity=0}},e.prototype.makeApplyRuleAction=function(t){var e=this.regionId;return this.footnoteContent&&(e=e?"xxx-bogus-xxx":"footnote"),new K(this.elementStyle,t,this.pseudoelement,e,this.viewConditionId)},e.prototype.special=function(t,e){var n;n=this.condition?new P(e,0,this.condition):new I(e,0),V(this.elementStyle,t).push(n)},e.prototype.property=function(t,e,n){this.validatorSet.validatePropertyAndHandleShorthand(t,e,n,this)},e.prototype.invalidPropertyValue=function(t,e){this.report("E_INVALID_PROPERTY_VALUE "+t+": "+e.toString())},e.prototype.unknownProperty=function(t,e){this.report("E_INVALID_PROPERTY "+t+": "+e.toString())},e.prototype.simpleProperty=function(t,e,n){"display"!=t||e!==a.t.oeb_page_head&&e!==a.t.oeb_page_foot||(this.simpleProperty("flow-options",new a.j([a.t.exclusive,a.t._static]),n),this.simpleProperty("flow-into",e,n),e=a.t.block),f.b("SIMPLE_PROPERTY").forEach(function(i){var o=i({name:t,value:e,important:n});t=o.name,e=o.value,n=o.important});var i=n?this.getImportantSpecificity():this.getBaseSpecificity(),o=this.condition?new P(e,i,this.condition):new I(e,i);_(this.elementStyle,t,o)},e.prototype.finish=function(){return this.cascade},e.prototype.startFuncWithSelector=function(t){switch(t){case"not":var e=new Yt(this);e.startSelectorRule(),this.owner.pushHandler(e)}},e}(s.f),Xt={"nth-child":ht,"nth-of-type":pt,"nth-last-child":ft,"nth-last-of-type":dt},jt=0,Yt=function(t){function e(e){var n=t.call(this,e.scope,e.owner,e.condition,e,e.regionId,e.validatorSet,!1)||this;return n.parent=e,n.parentChain=e.chain,n}return d(e,t),e.prototype.startFuncWithSelector=function(t){"not"==t&&this.reportAndSkip("E_CSS_UNEXPECTED_NOT")},e.prototype.startRuleBody=function(){this.reportAndSkip("E_CSS_UNEXPECTED_RULE_BODY")},e.prototype.nextSelector=function(){this.reportAndSkip("E_CSS_UNEXPECTED_NEXT_SELECTOR")},e.prototype.endFuncWithSelector=function(){this.chain&&this.chain.length>0&&this.parentChain.push(new wt(this.chain)),this.parent.specificity+=this.specificity,this.owner.popHandler()},e.prototype.error=function(e,n){t.prototype.error.call(this,e,n),this.owner.popHandler()},e}(Wt),qt=function(t){function e(e,n){return t.call(this,e,n,!1)||this}return d(e,t),e.prototype.property=function(t,e,n){if(this.scope.values[t])this.error("E_CSS_NAME_REDEFINED "+t,this.getCurrentToken());else{var i=t.match(/height|^(top|bottom)$/)?"vh":"vw",o=new c.x(this.scope,100,i);this.scope.defineName(t,e.toExpr(this.scope,o))}},e}(s.f),Kt=function(t){function e(e,n,i,o,r){var a=t.call(this,e,n,!1)||this;return a.condition=i,a.elementStyle=o,a.validatorSet=r,a.order=0,a}return d(e,t),e.prototype.property=function(t,e,n){n?h.b.warn("E_IMPORTANT_NOT_ALLOWED"):this.validatorSet.validatePropertyAndHandleShorthand(t,e,n,this)},e.prototype.invalidPropertyValue=function(t,e){h.b.warn("E_INVALID_PROPERTY_VALUE",t+":",e.toString())},e.prototype.unknownProperty=function(t,e){h.b.warn("E_INVALID_PROPERTY",t+":",e.toString())},e.prototype.simpleProperty=function(t,e,n){var i=n?this.getImportantSpecificity():this.getBaseSpecificity();i+=this.order,this.order+=1/1048576;var o=this.condition?new P(e,i,this.condition):new I(e,i);_(this.elementStyle,t,o)},e}(s.f),Qt=function(t){function e(e,n){var i=t.call(this,e)||this;return i.validatorSet=n,i.elementStyle={},i.order=0,i}return d(e,t),e.prototype.property=function(t,e,n){this.validatorSet.validatePropertyAndHandleShorthand(t,e,n,this)},e.prototype.invalidPropertyValue=function(t,e){h.b.warn("E_INVALID_PROPERTY_VALUE",t+":",e.toString())},e.prototype.unknownProperty=function(t,e){h.b.warn("E_INVALID_PROPERTY",t+":",e.toString())},e.prototype.simpleProperty=function(t,e,n){var i=n?s.e:s.d;i+=this.order,this.order+=1/1048576;var o=new I(e,i);_(this.elementStyle,t,o)},e}(s.b);function Zt(t,e){var n=M(t);n&&n.forEach(function(t){t.matcher.matches()&&e(t.styles)})}function $t(t,e,n){Zt(n,function(n){oe(t,n,e)})}function Jt(t,e,n,i){var o=new Qt(t,e),r=new u.b(i,o);try{s.j(r,o,n)}catch(t){h.b.warn(t,"Style attribute parse error:")}return o.elementStyle}function te(t,e,n){var i=t["writing-mode"];if(i){var o=i.evaluate(e,"writing-mode");if(o&&o!==a.t.inherit)return o===a.t.vertical_rl}return n}function ee(t,e,n){var i=t.direction;if(i){var o=i.evaluate(e,"direction");if(o&&o!==a.t.inherit)return o===a.t.rtl}return n}function ne(t,e,n,i,o){var r={};for(var a in t)L(a)&&(r[a]=F(t,a));return $t(r,e,t),ie(t,n,i,function(t,n){oe(r,n,e),$t(r,e,n)}),r}function ie(t,e,n,i){var o=D(t,"_regions");if((e||n)&&o){if(n){var r=["footnote"];e=e?e.concat(r):r}for(var a=0,s=e;a<s.length;a++){var l=s[a],u=o[l];u&&i(l,u)}}}function oe(t,e,n){for(var i in e)if(L(i)){var o=F(e,i),r=t[i];t[i]=A(n,r,o)}}var re=function(t,e,n,i,o){var r=n?i?T:C:i?x:S;for(var a in t)if(t.hasOwnProperty(a)){var s=t[a];if(!s)continue;var l=r[a],u=void 0;if(l){var c=t[l];if(c&&c.priority>s.priority)continue;u=w[l]?l:a}else u=a;e[u]=o(a,s)}}},function(t,e,n){var i;function o(t){var e=Array.from(t),n=null;return e[0]instanceof Error&&(n=e.shift()),{error:n,messages:e}}function r(t){var e=t.error,n=e&&(e.frameTrace||e.stack),i=[].concat(t.messages);return e&&(i.length>0&&(i=i.concat(["\n"])),i=i.concat([e.toString()]),n&&(i=i.concat(["\n"]).concat(n))),i}n.d(e,"a",function(){return i}),n.d(e,"b",function(){return a}),function(t){t[t.DEBUG=1]="DEBUG",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR"}(i||(i={}));var a=new(function(){function t(t){this.opt_console=t,this.listeners={}}return t.prototype.consoleDebug=function(t){var e,n;this.opt_console&&(this.opt_console.debug?(e=this.opt_console).debug.apply(e,t):(n=this.opt_console).log.apply(n,t))},t.prototype.consoleInfo=function(t){var e,n;this.opt_console&&(this.opt_console.info?(e=this.opt_console).info.apply(e,t):(n=this.opt_console).log.apply(n,t))},t.prototype.consoleWarn=function(t){var e,n;this.opt_console&&(this.opt_console.warn?(e=this.opt_console).warn.apply(e,t):(n=this.opt_console).log.apply(n,t))},t.prototype.consoleError=function(t){var e,n;this.opt_console&&(this.opt_console.error?(e=this.opt_console).error.apply(e,t):(n=this.opt_console).log.apply(n,t))},t.prototype.triggerListeners=function(t,e){var n=this.listeners[t];n&&n.forEach(function(t){t(e)})},t.prototype.addListener=function(t,e){var n=this.listeners[t];n||(n=this.listeners[t]=[]),n.push(e)},t.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=o(arguments);this.consoleDebug(r(n)),this.triggerListeners(i.DEBUG,n)},t.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=o(arguments);this.consoleInfo(r(n)),this.triggerListeners(i.INFO,n)},t.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=o(arguments);this.consoleWarn(r(n)),this.triggerListeners(i.WARN,n)},t.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=o(arguments);this.consoleError(r(n)),this.triggerListeners(i.ERROR,n)},t}())},function(t,e,n){function i(t){}function o(t){}n.d(e,"a",function(){return i}),n.d(e,"b",function(){return o})},function(t,e,n){n.d(e,"s",function(){return g}),n.d(e,"t",function(){return m}),n.d(e,"d",function(){return y}),n.d(e,"l",function(){return b}),n.d(e,"m",function(){return w}),n.d(e,"z",function(){return C}),n.d(e,"p",function(){return S}),n.d(e,"f",function(){return T}),n.d(e,"g",function(){return x}),n.d(e,"r",function(){return I}),n.d(e,"q",function(){return P}),n.d(e,"u",function(){return R}),n.d(e,"w",function(){return O}),n.d(e,"x",function(){return L}),n.d(e,"v",function(){return k}),n.d(e,"o",function(){return F}),n.d(e,"n",function(){return _}),n.d(e,"e",function(){return B}),n.d(e,"k",function(){return M}),n.d(e,"a",function(){return U}),n.d(e,"h",function(){return V}),n.d(e,"i",function(){return H}),n.d(e,"j",function(){return z}),n.d(e,"b",function(){return G}),n.d(e,"c",function(){return W}),n.d(e,"y",function(){return X});var i,o=n(7),r=n(1),a=n(0),s=n(10),l=n(20),u=n(2),c=n(27),h=n(4),p=n(11),f=n(15),d=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),g={transform:!0,"transform-origin":!0},m={top:!0,bottom:!0,left:!0,right:!0},y=function(t,e,n){this.target=t,this.name=e,this.value=n},v={show:function(t){t.style.visibility="visible"},hide:function(t){t.style.visibility="hidden"},play:function(t){t.currentTime=0,t.play()},pause:function(t){t.pause()},resume:function(t){t.play()},mute:function(t){t.muted=!0},unmute:function(t){t.muted=!1}};function E(t,e){var n=v[e];return n?function(){for(var e=0;e<t.length;e++)try{n(t[e])}catch(t){}}:null}var b=function(t){function e(e,n){var i=t.call(this)||this;i.container=e,i.bleedBox=n,i.pageAreaElement=null,i.delayedItems=[],i.elementsById={},i.dimensions={width:0,height:0},i.isFirstPage=!1,i.isLastPage=!1,i.isAutoPageWidth=!0,i.isAutoPageHeight=!0,i.spineIndex=0,i.position=null,i.offset=-1,i.side=null,i.fetchers=[],i.marginBoxes={top:{},bottom:{},left:{},right:{}};var o=i;return i.hrefHandler=function(t){var e=t.currentTarget,n=e.getAttribute("href")||e.getAttributeNS(r.a.XLINK,"href");if(n){var i={type:"hyperlink",target:null,currentTarget:null,anchorElement:e,href:n,preventDefault:function(){t.preventDefault()}};o.dispatchEvent(i)}},i}return d(e,t),e.prototype.setAutoPageWidth=function(t){this.isAutoPageWidth=t,t?this.container.setAttribute(e.AUTO_PAGE_WIDTH_ATTRIBUTE,"true"):this.container.removeAttribute(e.AUTO_PAGE_WIDTH_ATTRIBUTE)},e.prototype.setAutoPageHeight=function(t){this.isAutoPageHeight=t,t?this.container.setAttribute(e.AUTO_PAGE_HEIGHT_ATTRIBUTE,"true"):this.container.removeAttribute(e.AUTO_PAGE_HEIGHT_ATTRIBUTE)},e.prototype.registerElementWithId=function(t,e){var n=this.elementsById[e];n?n.push(t):this.elementsById[e]=[t]},e.prototype.finish=function(t,e){var n=this;Object.keys(this.elementsById).forEach(function(t){for(var e=n.elementsById[t],i=0;i<e.length;)n.container.contains(e[i])?i++:e.splice(i,1);0===e.length&&delete n.elementsById[t]});for(var i=this.delayedItems,o=0;o<i.length;o++){var a=i[o];(a.target!==this.container||"transform"!==a.name||this.isAutoPageWidth||this.isAutoPageHeight)&&r.F(a.target,a.name,a.value.toString())}var s=e.getElementClientRect(this.container);for(this.dimensions.width=s.width,this.dimensions.height=s.height,o=0;o<t.length;o++){var l=t[o],u=this.elementsById[l.ref],c=this.elementsById[l.observer];if(u&&c){var h=E(u,l.action);if(h)for(var p=0;p<c.length;p++)c[p].addEventListener(l.event,h,!1)}}},e.prototype.zoom=function(t){r.F(this.container,"transform","scale("+t+")")},e.prototype.getPageAreaElement=function(){return this.pageAreaElement||this.container},e.AUTO_PAGE_WIDTH_ATTRIBUTE="data-vivliostyle-auto-page-width",e.AUTO_PAGE_HEIGHT_ATTRIBUTE="data-vivliostyle-auto-page-height",e}(r.c),w="data-adapt-spec",N=f.f.Whitespace;function C(t){switch(t){case"normal":case"nowrap":return N.IGNORE;case"pre-line":return N.NEWLINE;case"pre":case"pre-wrap":return N.PRESERVE;default:return null}}function S(t,e){if(1==t.nodeType)return!1;var n=t.textContent;switch(e){case N.IGNORE:return!!n.match(/^\s*$/);case N.NEWLINE:return!!n.match(/^[ \t\f]*$/);case N.PRESERVE:return 0==n.length}throw new Error("Unexpected whitespace: "+e)}var T=function(t,e){this.flowName=t,this.parentFlowName=e,this.forcedBreakOffsets=[],this.formattingContext=null},x=function(){function t(t,e,n,i,o,r,a,s,l){this.flowName=t,this.element=e,this.startOffset=n,this.priority=i,this.linger=o,this.exclusive=r,this.repeated=a,this.last=s,this.breakBefore=l,this.startPage=-1}return t.prototype.isBetter=function(t){return!!this.exclusive&&(!t.exclusive||this.priority>t.priority||this.last)},t}();function I(t,e){return t.top-e.top}function P(t,e){return e.right-t.right}function A(t,e){return t===e||!(!t||!e)&&t.node===e.node&&t.shadowType===e.shadowType&&D(t.shadowContext,e.shadowContext)&&D(t.nodeShadow,e.nodeShadow)&&A(t.shadowSibling,e.shadowSibling)}function R(t,e){if(t===e)return!0;if(!t||!e)return!1;if(t.offsetInNode!==e.offsetInNode||t.after!==e.after||t.steps.length!==e.steps.length)return!1;for(var n=0;n<t.steps.length;n++)if(!A(t.steps[n],e.steps[n]))return!1;return!0}function O(t){return{steps:[{node:t,shadowType:F.NONE,shadowContext:null,nodeShadow:null,shadowSibling:null,formattingContext:null,fragmentIndex:0}],offsetInNode:0,after:!1,preprocessedTextContent:null}}function L(t,e){return{steps:[{node:t.sourceNode,shadowType:F.NONE,shadowContext:t.shadowContext,nodeShadow:null,shadowSibling:null,formattingContext:null,fragmentIndex:null!=e?e:t.fragmentIndex}],offsetInNode:0,after:!1,preprocessedTextContent:t.preprocessedTextContent}}function k(t,e){var n=new M(t.node,e,0);return n.shadowType=t.shadowType,n.shadowContext=t.shadowContext,n.nodeShadow=t.nodeShadow,n.shadowSibling=t.shadowSibling?k(t.shadowSibling,e.copy()):null,n.formattingContext=t.formattingContext,n.fragmentIndex=t.fragmentIndex+1,n}var F=f.f.ShadowType,_=function(){function t(t,e,n,i,o,r,a){this.owner=t,this.root=e,this.xmldoc=n,this.parentShadow=i,this.type=r,this.styler=a,this.subShadow=null,o&&(o.subShadow=this)}return t.prototype.equals=function(t){return!!t&&this.owner===t.owner&&this.xmldoc===t.xmldoc&&this.type===t.type&&D(this.parentShadow,t.parentShadow)},t}();function D(t,e){return t===e||!!t&&!!e&&t.equals(e)}var B=function(t,e){this.outer=t,this.count=e},M=function(){function t(t,e,n){this.sourceNode=t,this.parent=e,this.boxOffset=n,this.offsetInNode=0,this.after=!1,this.nodeShadow=null,this.shadowSibling=null,this.shared=!1,this.inline=!0,this.overflow=!1,this.display=null,this.floatSide=null,this.clearSide=null,this.floatMinWrapBlock=null,this.columnSpan=null,this.verticalAlign="baseline",this.captionSide="top",this.inlineBorderSpacing=0,this.blockBorderSpacing=0,this.flexContainer=!1,this.establishesBFC=!1,this.containingBlockForAbsolute=!1,this.breakBefore=null,this.breakAfter=null,this.viewNode=null,this.clearSpacer=null,this.lang=null,this.preprocessedTextContent=null,this.repeatOnBreak=null,this.pluginProps={},this.fragmentIndex=1,this.afterIfContinues=null,this.footnotePolicy=null,this.shadowType=F.NONE,this.shadowContext=e?e.shadowContext:null,this.breakPenalty=e?e.breakPenalty:0,this.floatReference=f.b.FloatReference.INLINE,this.whitespace=e?e.whitespace:N.IGNORE,this.hyphenateCharacter=e?e.hyphenateCharacter:null,this.breakWord=!!e&&e.breakWord,this.inheritedProps=e?e.inheritedProps:{},this.vertical=!!e&&e.vertical,this.direction=e?e.direction:"ltr",this.firstPseudo=e?e.firstPseudo:null,this.formattingContext=e?e.formattingContext:null}return t.prototype.resetView=function(){this.inline=!0,this.breakPenalty=this.parent?this.parent.breakPenalty:0,this.viewNode=null,this.clearSpacer=null,this.offsetInNode=0,this.after=!1,this.display=null,this.floatReference=f.b.FloatReference.INLINE,this.floatSide=null,this.clearSide=null,this.floatMinWrapBlock=null,this.columnSpan=null,this.verticalAlign="baseline",this.flexContainer=!1,this.whitespace=this.parent?this.parent.whitespace:N.IGNORE,this.hyphenateCharacter=this.parent?this.parent.hyphenateCharacter:null,this.breakWord=!!this.parent&&this.parent.breakWord,this.breakBefore=null,this.breakAfter=null,this.nodeShadow=null,this.establishesBFC=!1,this.containingBlockForAbsolute=!1,this.vertical=!!this.parent&&this.parent.vertical,this.nodeShadow=null,this.preprocessedTextContent=null,this.formattingContext=this.parent?this.parent.formattingContext:null,this.repeatOnBreak=null,this.pluginProps={},this.fragmentIndex=1,this.afterIfContinues=null,this.footnotePolicy=null},t.prototype.cloneItem=function(){var e=new t(this.sourceNode,this.parent,this.boxOffset);return e.offsetInNode=this.offsetInNode,e.after=this.after,e.nodeShadow=this.nodeShadow,e.shadowType=this.shadowType,e.shadowContext=this.shadowContext,e.shadowSibling=this.shadowSibling,e.inline=this.inline,e.breakPenalty=this.breakPenalty,e.display=this.display,e.floatReference=this.floatReference,e.floatSide=this.floatSide,e.clearSide=this.clearSide,e.floatMinWrapBlock=this.floatMinWrapBlock,e.columnSpan=this.columnSpan,e.verticalAlign=this.verticalAlign,e.captionSide=this.captionSide,e.inlineBorderSpacing=this.inlineBorderSpacing,e.blockBorderSpacing=this.blockBorderSpacing,e.establishesBFC=this.establishesBFC,e.containingBlockForAbsolute=this.containingBlockForAbsolute,e.flexContainer=this.flexContainer,e.whitespace=this.whitespace,e.hyphenateCharacter=this.hyphenateCharacter,e.breakWord=this.breakWord,e.breakBefore=this.breakBefore,e.breakAfter=this.breakAfter,e.viewNode=this.viewNode,e.clearSpacer=this.clearSpacer,e.firstPseudo=this.firstPseudo,e.vertical=this.vertical,e.overflow=this.overflow,e.preprocessedTextContent=this.preprocessedTextContent,e.formattingContext=this.formattingContext,e.repeatOnBreak=this.repeatOnBreak,e.pluginProps=Object.create(this.pluginProps),e.fragmentIndex=this.fragmentIndex,e.afterIfContinues=this.afterIfContinues,e.footnotePolicy=this.footnotePolicy,e},t.prototype.modify=function(){return this.shared?this.cloneItem():this},t.prototype.copy=function(){var t=this;do{if(t.shared)break;t.shared=!0,t=t.parent}while(t);return this},t.prototype.clone=function(){for(var t,e=this.cloneItem(),n=e;null!=(t=n.parent);)t=t.cloneItem(),n.parent=t,n=t;return e},t.prototype.toNodePositionStep=function(){return{node:this.sourceNode,shadowType:this.shadowType,shadowContext:this.shadowContext,nodeShadow:this.nodeShadow,shadowSibling:this.shadowSibling?this.shadowSibling.toNodePositionStep():null,formattingContext:this.formattingContext,fragmentIndex:this.fragmentIndex}},t.prototype.toNodePosition=function(){var t=this,e=[];do{t.firstPseudo&&t.parent&&t.parent.firstPseudo!==t.firstPseudo||e.push(t.toNodePositionStep()),t=t.parent}while(t);return{steps:e,offsetInNode:this.preprocessedTextContent?c.c(this.preprocessedTextContent,this.offsetInNode):this.offsetInNode,after:this.after,preprocessedTextContent:this.preprocessedTextContent}},t.prototype.isInsideBFC=function(){for(var t=this.parent;t;){if(t.establishesBFC)return!0;t=t.parent}return!1},t.prototype.getContainingBlockForAbsolute=function(){for(var t=this.parent;t;){if(t.containingBlockForAbsolute)return t;t=t.parent}return null},t.prototype.walkUpBlocks=function(t){for(var e=this;e;)e.inline||t(e),e=e.parent},t.prototype.belongsTo=function(t){return this.formattingContext===t&&!!this.parent&&this.parent.formattingContext===t},t}(),U=function(){function t(t){this.primary=t,this.floats=null}return t.prototype.clone=function(){var e=new t(this.primary);if(this.floats){e.floats=[];for(var n=0;n<this.floats.length;++n)e.floats[n]=this.floats[n]}return e},t.prototype.isSamePosition=function(t){if(!t)return!1;if(this===t)return!0;if(!R(this.primary,t.primary))return!1;if(this.floats){if(!t.floats||this.floats.length!==t.floats.length)return!1;for(var e=0;e<this.floats.length;e++)if(!R(this.floats[e],t.floats[e]))return!1}else if(t.floats)return!1;return!0},t}(),V=function(){function t(t,e){this.chunkPosition=t,this.flowChunk=e}return t.prototype.clone=function(){return new t(this.chunkPosition.clone(),this.flowChunk)},t.prototype.isSamePosition=function(t){return!!t&&(this===t||this.chunkPosition.isSamePosition(t.chunkPosition))},t}(),H=function(){function t(){this.positions=[],this.startSide="any",this.breakAfter=null}return t.prototype.clone=function(){for(var e=new t,n=this.positions,i=e.positions,o=0;o<n.length;o++)i[o]=n[o].clone();return e.startSide=this.startSide,e.breakAfter=this.breakAfter,e},t.prototype.isSamePosition=function(t){if(this===t)return!0;if(!t||this.positions.length!==t.positions.length)return!1;for(var e=0;e<this.positions.length;e++)if(!this.positions[e].isSamePosition(t.positions[e]))return!1;return!0},t.prototype.hasContent=function(t){return this.positions.length>0&&this.positions[0].flowChunk.startOffset<=t},t}(),z=function(){function t(){this.page=0,this.flows={},this.flowPositions={},this.highestSeenOffset=0}return t.prototype.clone=function(){var e=new t;for(var n in e.page=this.page,e.highestSeenNode=this.highestSeenNode,e.highestSeenOffset=this.highestSeenOffset,e.lookupPositionOffset=this.lookupPositionOffset,e.flows=this.flows,this.flowPositions)e.flowPositions[n]=this.flowPositions[n].clone();return e},t.prototype.isSamePosition=function(t){if(this===t)return!0;if(!t||this.page!==t.page||this.highestSeenOffset!==t.highestSeenOffset)return!1;var e=Object.keys(this.flowPositions),n=Object.keys(t.flowPositions);if(e.length!==n.length)return!1;for(var i=0,o=e;i<o.length;i++){var r=o[i];if(!this.flowPositions[r].isSamePosition(t.flowPositions[r]))return!1}return!0},t.prototype.hasContent=function(t,e){var n=this.flowPositions[t];return!!n&&n.hasContent(e)},t.prototype.startSideOfFlow=function(t){var e=this.flowPositions[t];return e?e.startSide:"any"},t.prototype.firstFlowChunkOfFlow=function(t){var e=this.flowPositions[t];if(!e)return null;var n=e.positions[0];return n?n.flowChunk:null},t}(),G=function(){function t(t){this.element=t,this.left=0,this.top=0,this.marginLeft=0,this.marginRight=0,this.marginTop=0,this.marginBottom=0,this.borderLeft=0,this.borderRight=0,this.borderTop=0,this.borderBottom=0,this.paddingLeft=0,this.paddingRight=0,this.paddingTop=0,this.paddingBottom=0,this.width=0,this.height=0,this.originX=0,this.originY=0,this.exclusions=null,this.innerShape=null,this.computedBlockSize=0,this.snapWidth=0,this.snapHeight=0,this.snapOffsetX=0,this.snapOffsetY=0,this.vertical=!1}return t.prototype.getInsetTop=function(){return this.marginTop+this.borderTop+this.paddingTop},t.prototype.getInsetBottom=function(){return this.marginBottom+this.borderBottom+this.paddingBottom},t.prototype.getInsetLeft=function(){return this.marginLeft+this.borderLeft+this.paddingLeft},t.prototype.getInsetRight=function(){return this.marginRight+this.borderRight+this.paddingRight},t.prototype.getInsetBefore=function(){return this.vertical?this.getInsetRight():this.getInsetTop()},t.prototype.getInsetAfter=function(){return this.vertical?this.getInsetLeft():this.getInsetBottom()},t.prototype.getInsetStart=function(){return this.vertical?this.getInsetTop():this.getInsetLeft()},t.prototype.getInsetEnd=function(){return this.vertical?this.getInsetBottom():this.getInsetRight()},t.prototype.getBeforeEdge=function(t){return this.vertical?t.right:t.top},t.prototype.getAfterEdge=function(t){return this.vertical?t.left:t.bottom},t.prototype.getStartEdge=function(t){return this.vertical?t.top:t.left},t.prototype.getEndEdge=function(t){return this.vertical?t.bottom:t.right},t.prototype.getInlineSize=function(t){return this.vertical?t.bottom-t.top:t.right-t.left},t.prototype.getBoxSize=function(t){return this.vertical?t.right-t.left:t.bottom-t.top},t.prototype.getBoxDir=function(){return this.vertical?-1:1},t.prototype.getInlineDir=function(){return 1},t.prototype.copyFrom=function(t){this.element=t.element,this.left=t.left,this.top=t.top,this.marginLeft=t.marginLeft,this.marginRight=t.marginRight,this.marginTop=t.marginTop,this.marginBottom=t.marginBottom,this.borderLeft=t.borderLeft,this.borderRight=t.borderRight,this.borderTop=t.borderTop,this.borderBottom=t.borderBottom,this.paddingLeft=t.paddingLeft,this.paddingRight=t.paddingRight,this.paddingTop=t.paddingTop,this.paddingBottom=t.paddingBottom,this.width=t.width,this.height=t.height,this.originX=t.originX,this.originY=t.originY,this.innerShape=t.innerShape,this.exclusions=t.exclusions,this.computedBlockSize=t.computedBlockSize,this.snapWidth=t.snapWidth,this.snapHeight=t.snapHeight,this.vertical=t.vertical},t.prototype.setVerticalPosition=function(t,e){this.top=t,this.height=e,r.F(this.element,"top",t+"px"),r.F(this.element,"height",e+"px")},t.prototype.setHorizontalPosition=function(t,e){this.left=t,this.width=e,r.F(this.element,"left",t+"px"),r.F(this.element,"width",e+"px")},t.prototype.setBlockPosition=function(t,e){this.vertical?this.setHorizontalPosition(t+e*this.getBoxDir(),e):this.setVerticalPosition(t,e)},t.prototype.setInlinePosition=function(t,e){this.vertical?this.setVerticalPosition(t,e):this.setHorizontalPosition(t,e)},t.prototype.clear=function(){for(var t,e=this.element;t=e.lastChild;)e.removeChild(t)},t.prototype.getInnerShape=function(){var t=this.getInnerRect();return this.innerShape?this.innerShape.withOffset(t.x1,t.y1):p.k(t.x1,t.y1,t.x2,t.y2)},t.prototype.getInnerRect=function(){var t=this.originX+this.left+this.getInsetLeft(),e=this.originY+this.top+this.getInsetTop();return new p.c(t,e,t+this.width,e+this.height)},t.prototype.getPaddingRect=function(){var t=this.originX+this.left+this.marginLeft+this.borderLeft,e=this.originY+this.top+this.marginTop+this.borderTop,n=this.paddingLeft+this.width+this.paddingRight,i=this.paddingTop+this.height+this.paddingBottom;return new p.c(t,e,t+n,e+i)},t.prototype.getOuterShape=function(t,e){var n=this.getOuterRect();return l.e(t,n.x1,n.y1,n.x2-n.x1,n.y2-n.y1,e)},t.prototype.getOuterRect=function(){var t=this.originX+this.left,e=this.originY+this.top,n=this.getInsetLeft()+this.width+this.getInsetRight(),i=this.getInsetTop()+this.height+this.getInsetBottom();return new p.c(t,e,t+n,e+i)},t}(),W=function(t){function e(e,n,i,o){var r=t.call(this)||this;return r.elem=e,r.context=n,r.rootContentValue=i,r.exprContentListener=o,r}return d(e,t),e.prototype.visitStrInner=function(t,e){e||(e=this.elem.ownerDocument.createTextNode(t)),this.elem.appendChild(e)},e.prototype.visitStr=function(t){return this.visitStrInner(t.str),null},e.prototype.visitURL=function(t){if(this.rootContentValue.url)this.elem.setAttribute("src",t.url);else{var e=this.elem.ownerDocument.createElementNS(r.a.XHTML,"img");e.setAttribute("src",t.url),this.elem.appendChild(e)}return null},e.prototype.visitSpaceList=function(t){return this.visitValues(t.values),null},e.prototype.visitExpr=function(t){var e=t.toExpr(),n=e.evaluate(this.context);if("string"==typeof n){e instanceof h.s&&(n=s.m(e.scope,new u.b(n,null),"").stringValue()),o.a(this.elem.ownerDocument);var i=this.exprContentListener(e,n,this.elem.ownerDocument);this.visitStrInner(n,i)}return null},e}(a.m);function X(t){return null!=t&&t!==a.t.normal&&t!==a.t.none&&t!==a.t.inherit}},function(t,e,n){n.d(e,"a",function(){return i}),n.d(e,"d",function(){return a}),n.d(e,"b",function(){return s}),n.d(e,"c",function(){return l});var i,o=n(6);!function(t){t.SIMPLE_PROPERTY="SIMPLE_PROPERTY",t.PREPROCESS_SINGLE_DOCUMENT="PREPROCESS_SINGLE_DOCUMENT",t.PREPROCESS_TEXT_CONTENT="PREPROCESS_TEXT_CONTENT",t.PREPROCESS_ELEMENT_STYLE="PREPROCESS_ELEMENT_STYLE",t.POLYFILLED_INHERITED_PROPS="POLYFILLED_INHERITED_PROPS",t.CONFIGURATION="CONFIGURATION",t.RESOLVE_TEXT_NODE_BREAKER="RESOLVE_TEXT_NODE_BREAKER",t.RESOLVE_FORMATTING_CONTEXT="RESOLVE_FORMATTING_CONTEXT",t.RESOLVE_LAYOUT_PROCESSOR="RESOLVE_LAYOUT_PROCESSOR",t.POST_LAYOUT_BLOCK="POST_LAYOUT_BLOCK"}(i||(i={}));var r={};function a(t,e){if(i[t]){var n=r[t];n||(n=r[t]=[]),n.push(e)}else o.b.warn(new Error("Skipping unknown plugin hook '"+t+"'."))}function s(t){return r[t]||[]}var l={registerHook:a,removeHook:function(t,e){if(i[t]){var n=r[t];if(n){var a=n.indexOf(e);a>=0&&n.splice(a,1)}}else o.b.warn(new Error("Ignoring unknown plugin hook '"+t+"'."))}}},function(t,e,n){n.d(e,"c",function(){return f}),n.d(e,"d",function(){return d}),n.d(e,"e",function(){return g}),n.d(e,"g",function(){return o}),n.d(e,"h",function(){return m}),n.d(e,"a",function(){return E}),n.d(e,"f",function(){return w}),n.d(e,"b",function(){return M}),n.d(e,"k",function(){return V}),n.d(e,"l",function(){return H}),n.d(e,"m",function(){return z}),n.d(e,"j",function(){return G}),n.d(e,"i",function(){return X});var i,o,r=n(1),a=n(0),s=n(2),l=n(4),u=n(6),c=n(16),h=n(3),p=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),f=33554432,d=50331648,g=67108864;function m(t){var e=parseInt(t,16);if(isNaN(e))throw new Error("E_CSS_COLOR");if(6==t.length)return new a.a(e);if(3==t.length)return e=15&e|(15&e)<<4|(240&e)<<4|(240&e)<<8|(3840&e)<<8|(3840&e)<<12,new a.a(e);throw new Error("E_CSS_COLOR")}!function(t){t.USER_AGENT="UA",t.USER="User",t.AUTHOR="Author"}(o||(o={}));var y,v=function(){function t(t){this.scope=t,this.flavor=o.AUTHOR}return t.prototype.getCurrentToken=function(){return null},t.prototype.getScope=function(){return this.scope},t.prototype.error=function(t,e){},t.prototype.startStylesheet=function(t){this.flavor=t},t.prototype.tagSelector=function(t,e){},t.prototype.classSelector=function(t){},t.prototype.pseudoclassSelector=function(t,e){},t.prototype.pseudoelementSelector=function(t,e){},t.prototype.idSelector=function(t){},t.prototype.attributeSelector=function(t,e,n,i){},t.prototype.descendantSelector=function(){},t.prototype.childSelector=function(){},t.prototype.adjacentSiblingSelector=function(){},t.prototype.followingSiblingSelector=function(){},t.prototype.nextSelector=function(){},t.prototype.startSelectorRule=function(){},t.prototype.startFontFaceRule=function(){},t.prototype.startFootnoteRule=function(t){},t.prototype.startViewportRule=function(){},t.prototype.startDefineRule=function(){},t.prototype.startRegionRule=function(){},t.prototype.startPageRule=function(){},t.prototype.startPageMarginBoxRule=function(t){},t.prototype.startWhenRule=function(t){},t.prototype.startMediaRule=function(t){this.startWhenRule(t)},t.prototype.startFlowRule=function(t){},t.prototype.startPageTemplateRule=function(){},t.prototype.startPageMasterRule=function(t,e,n){},t.prototype.startPartitionRule=function(t,e,n){},t.prototype.startPartitionGroupRule=function(t,e,n){},t.prototype.startRuleBody=function(){},t.prototype.property=function(t,e,n){},t.prototype.endRule=function(){},t.prototype.startFuncWithSelector=function(t){},t.prototype.endFuncWithSelector=function(){},t.prototype.getImportantSpecificity=function(){switch(this.flavor){case o.USER_AGENT:return 0;case o.USER:return 100663296;default:return 83886080}},t.prototype.getBaseSpecificity=function(){switch(this.flavor){case o.USER_AGENT:return 0;case o.USER:return 16777216;default:return f}},t}(),E=function(t){function e(){var e=t.call(this,null)||this;return e.stack=[],e.tokenizer=null,e.slave=null,e}return p(e,t),e.prototype.pushHandler=function(t){this.stack.push(this.slave),this.slave=t},e.prototype.popHandler=function(){this.slave=this.stack.pop()},e.prototype.getCurrentToken=function(){return this.tokenizer?this.tokenizer.token():null},e.prototype.getScope=function(){return this.slave.getScope()},e.prototype.error=function(t,e){this.slave.error(t,e)},e.prototype.errorMsg=function(t,e){u.b.warn(t)},e.prototype.startStylesheet=function(e){t.prototype.startStylesheet.call(this,e),this.stack.length>0&&(this.slave=this.stack[0],this.stack=[]),this.slave.startStylesheet(e)},e.prototype.tagSelector=function(t,e){this.slave.tagSelector(t,e)},e.prototype.classSelector=function(t){this.slave.classSelector(t)},e.prototype.pseudoclassSelector=function(t,e){this.slave.pseudoclassSelector(t,e)},e.prototype.pseudoelementSelector=function(t,e){this.slave.pseudoelementSelector(t,e)},e.prototype.idSelector=function(t){this.slave.idSelector(t)},e.prototype.attributeSelector=function(t,e,n,i){this.slave.attributeSelector(t,e,n,i)},e.prototype.descendantSelector=function(){this.slave.descendantSelector()},e.prototype.childSelector=function(){this.slave.childSelector()},e.prototype.adjacentSiblingSelector=function(){this.slave.adjacentSiblingSelector()},e.prototype.followingSiblingSelector=function(){this.slave.followingSiblingSelector()},e.prototype.nextSelector=function(){this.slave.nextSelector()},e.prototype.startSelectorRule=function(){this.slave.startSelectorRule()},e.prototype.startFontFaceRule=function(){this.slave.startFontFaceRule()},e.prototype.startFootnoteRule=function(t){this.slave.startFootnoteRule(t)},e.prototype.startViewportRule=function(){this.slave.startViewportRule()},e.prototype.startDefineRule=function(){this.slave.startDefineRule()},e.prototype.startRegionRule=function(){this.slave.startRegionRule()},e.prototype.startPageRule=function(){this.slave.startPageRule()},e.prototype.startPageMarginBoxRule=function(t){this.slave.startPageMarginBoxRule(t)},e.prototype.startWhenRule=function(t){this.slave.startWhenRule(t)},e.prototype.startFlowRule=function(t){this.slave.startFlowRule(t)},e.prototype.startPageTemplateRule=function(){this.slave.startPageTemplateRule()},e.prototype.startPageMasterRule=function(t,e,n){this.slave.startPageMasterRule(t,e,n)},e.prototype.startPartitionRule=function(t,e,n){this.slave.startPartitionRule(t,e,n)},e.prototype.startPartitionGroupRule=function(t,e,n){this.slave.startPartitionGroupRule(t,e,n)},e.prototype.startRuleBody=function(){this.slave.startRuleBody()},e.prototype.property=function(t,e,n){this.slave.property(t,e,n)},e.prototype.endRule=function(){this.slave.endRule()},e.prototype.startFuncWithSelector=function(t){this.slave.startFuncWithSelector(t)},e.prototype.endFuncWithSelector=function(){this.slave.endFuncWithSelector()},e}(v),b=function(t){function e(e,n,i){var o=t.call(this,e)||this;return o.owner=n,o.topLevel=i,o.depth=0,n&&(o.flavor=n.flavor),o}return p(e,t),e.prototype.getCurrentToken=function(){return this.owner.getCurrentToken()},e.prototype.error=function(t,e){this.owner.errorMsg(t,e)},e.prototype.startRuleBody=function(){this.depth++},e.prototype.endRule=function(){0!=--this.depth||this.topLevel||this.owner.popHandler()},e}(v),w=function(t){function e(e,n,i){return t.call(this,e,n,i)||this}return p(e,t),e.prototype.report=function(t){this.error(t,this.getCurrentToken())},e.prototype.reportAndSkip=function(t){this.report(t),this.owner.pushHandler(new b(this.scope,this.owner,!1))},e.prototype.startSelectorRule=function(){this.reportAndSkip("E_CSS_UNEXPECTED_SELECTOR")},e.prototype.startFontFaceRule=function(){this.reportAndSkip("E_CSS_UNEXPECTED_FONT_FACE")},e.prototype.startFootnoteRule=function(t){this.reportAndSkip("E_CSS_UNEXPECTED_FOOTNOTE")},e.prototype.startViewportRule=function(){this.reportAndSkip("E_CSS_UNEXPECTED_VIEWPORT")},e.prototype.startDefineRule=function(){this.reportAndSkip("E_CSS_UNEXPECTED_DEFINE")},e.prototype.startRegionRule=function(){this.reportAndSkip("E_CSS_UNEXPECTED_REGION")},e.prototype.startPageRule=function(){this.reportAndSkip("E_CSS_UNEXPECTED_PAGE")},e.prototype.startWhenRule=function(t){this.reportAndSkip("E_CSS_UNEXPECTED_WHEN")},e.prototype.startFlowRule=function(t){this.reportAndSkip("E_CSS_UNEXPECTED_FLOW")},e.prototype.startPageTemplateRule=function(){this.reportAndSkip("E_CSS_UNEXPECTED_PAGE_TEMPLATE")},e.prototype.startPageMasterRule=function(t,e,n){this.reportAndSkip("E_CSS_UNEXPECTED_PAGE_MASTER")},e.prototype.startPartitionRule=function(t,e,n){this.reportAndSkip("E_CSS_UNEXPECTED_PARTITION")},e.prototype.startPartitionGroupRule=function(t,e,n){this.reportAndSkip("E_CSS_UNEXPECTED_PARTITION_GROUP")},e.prototype.startFuncWithSelector=function(t){this.reportAndSkip("E_CSS_UNEXPECTED_SELECTOR_FUNC")},e.prototype.endFuncWithSelector=function(){this.reportAndSkip("E_CSS_UNEXPECTED_END_SELECTOR_FUNC")},e.prototype.property=function(t,e,n){this.error("E_CSS_UNEXPECTED_PROPERTY",this.getCurrentToken())},e}(b),N=[],C=[],S=[],T=[],x=[],I=[],P=[],A=[],R=[],O=[],L=[],k=[],F=[];!function(t){t[t.SELECTOR_NAME_1=1]="SELECTOR_NAME_1",t[t.SELECTOR_NAME=2]="SELECTOR_NAME",t[t.SELECTOR_ANY_1=3]="SELECTOR_ANY_1",t[t.SELECTOR_ANY=4]="SELECTOR_ANY",t[t.SELECTOR_ID_1=5]="SELECTOR_ID_1",t[t.SELECTOR_ID=6]="SELECTOR_ID",t[t.SELECTOR_CLASS_1=7]="SELECTOR_CLASS_1",t[t.SELECTOR_CLASS=8]="SELECTOR_CLASS",t[t.SELECTOR_ATTR_1=9]="SELECTOR_ATTR_1",t[t.SELECTOR_ATTR=10]="SELECTOR_ATTR",t[t.SELECTOR_CHILD=11]="SELECTOR_CHILD",t[t.SELECTOR_SIBLING=12]="SELECTOR_SIBLING",t[t.SELECTOR_BODY=13]="SELECTOR_BODY",t[t.SELECTOR_PSEUDOCLASS=14]="SELECTOR_PSEUDOCLASS",t[t.VAL_IDENT=15]="VAL_IDENT",t[t.VAL_HASH=16]="VAL_HASH",t[t.VAL_NUM=17]="VAL_NUM",t[t.VAL_INT=18]="VAL_INT",t[t.VAL_NUMERIC=19]="VAL_NUMERIC",t[t.VAL_STR=20]="VAL_STR",t[t.VAL_URL=21]="VAL_URL",t[t.VAL_COMMA=22]="VAL_COMMA",t[t.VAL_SLASH=23]="VAL_SLASH",t[t.VAL_FUNC=24]="VAL_FUNC",t[t.VAL_C_PAR=25]="VAL_C_PAR",t[t.VAL_END=26]="VAL_END",t[t.RULE_END=27]="RULE_END",t[t.IDENT=28]="IDENT",t[t.SELECTOR_START=29]="SELECTOR_START",t[t.AT=30]="AT",t[t.EXPR_IDENT=31]="EXPR_IDENT",t[t.EXPR_NUM=32]="EXPR_NUM",t[t.EXPR_NUMERIC=33]="EXPR_NUMERIC",t[t.EXPR_STR=34]="EXPR_STR",t[t.EXPR_PARAM=35]="EXPR_PARAM",t[t.EXPR_PREFIX=36]="EXPR_PREFIX",t[t.EXPR_INFIX=37]="EXPR_INFIX",t[t.EXPR_FUNC=38]="EXPR_FUNC",t[t.EXPR_C_PAR=39]="EXPR_C_PAR",t[t.EXPR_O_PAR=40]="EXPR_O_PAR",t[t.SELECTOR_NEXT=41]="SELECTOR_NEXT",t[t.SELECTOR_PSEUDOELEM=42]="SELECTOR_PSEUDOELEM",t[t.EXPR_O_BRC=43]="EXPR_O_BRC",t[t.VAL_FINISH=44]="VAL_FINISH",t[t.EXPR_INFIX_NAME=45]="EXPR_INFIX_NAME",t[t.PROP=46]="PROP",t[t.VAL_BANG=47]="VAL_BANG",t[t.VAL_BRC=48]="VAL_BRC",t[t.EXPR_SEMICOL=49]="EXPR_SEMICOL",t[t.ERROR_PUSH=50]="ERROR_PUSH",t[t.ERROR_POP=51]="ERROR_POP",t[t.ERROR_POP_DECL=52]="ERROR_POP_DECL",t[t.ERROR_SEMICOL=53]="ERROR_SEMICOL",t[t.VAL_PLUS=54]="VAL_PLUS",t[t.SELECTOR_PSEUDOCLASS_1=55]="SELECTOR_PSEUDOCLASS_1",t[t.SELECTOR_FOLLOWING_SIBLING=56]="SELECTOR_FOLLOWING_SIBLING",t[t.DONE=200]="DONE"}(y||(y={}));var _,D=s.a.LAST+1;N[s.a.IDENT]=y.IDENT,N[s.a.STAR]=y.SELECTOR_START,N[s.a.HASH]=y.SELECTOR_START,N[s.a.CLASS]=y.SELECTOR_START,N[s.a.O_BRK]=y.SELECTOR_START,N[s.a.COLON]=y.SELECTOR_START,N[s.a.AT]=y.AT,N[s.a.C_BRC]=y.RULE_END,N[s.a.EOF]=y.DONE,C[s.a.IDENT]=y.PROP,C[s.a.EOF]=y.DONE,I[s.a.IDENT]=y.SELECTOR_NAME,I[s.a.STAR]=y.SELECTOR_ANY,I[s.a.HASH]=y.SELECTOR_ID,I[s.a.CLASS]=y.SELECTOR_CLASS,I[s.a.O_BRK]=y.SELECTOR_ATTR,I[s.a.COLON]=y.SELECTOR_PSEUDOCLASS,S[s.a.GT]=y.SELECTOR_CHILD,S[s.a.PLUS]=y.SELECTOR_SIBLING,S[s.a.TILDE]=y.SELECTOR_FOLLOWING_SIBLING,S[s.a.IDENT]=y.SELECTOR_NAME_1,S[s.a.STAR]=y.SELECTOR_ANY_1,S[s.a.HASH]=y.SELECTOR_ID_1,S[s.a.CLASS]=y.SELECTOR_CLASS_1,S[s.a.O_BRK]=y.SELECTOR_ATTR_1,S[s.a.O_BRC]=y.SELECTOR_BODY,S[s.a.COLON]=y.SELECTOR_PSEUDOCLASS_1,S[s.a.COL_COL]=y.SELECTOR_PSEUDOELEM,S[s.a.COMMA]=y.SELECTOR_NEXT,T[s.a.IDENT]=y.SELECTOR_NAME_1,T[s.a.STAR]=y.SELECTOR_ANY_1,T[s.a.HASH]=y.SELECTOR_ID_1,T[s.a.CLASS]=y.SELECTOR_CLASS_1,T[s.a.O_BRK]=y.SELECTOR_ATTR_1,T[s.a.C_PAR]=y.DONE,T[s.a.COLON]=y.SELECTOR_PSEUDOCLASS_1,x[s.a.IDENT]=y.SELECTOR_NAME,x[s.a.STAR]=y.SELECTOR_ANY,x[s.a.HASH]=y.SELECTOR_ID,x[s.a.CLASS]=y.SELECTOR_CLASS,x[s.a.COLON]=y.SELECTOR_PSEUDOCLASS,x[s.a.COL_COL]=y.SELECTOR_PSEUDOELEM,x[s.a.O_BRK]=y.SELECTOR_ATTR,x[s.a.O_BRC]=y.SELECTOR_BODY,P[s.a.IDENT]=y.VAL_IDENT,P[s.a.HASH]=y.VAL_HASH,P[s.a.NUM]=y.VAL_NUM,P[s.a.INT]=y.VAL_INT,P[s.a.NUMERIC]=y.VAL_NUMERIC,P[s.a.STR]=y.VAL_STR,P[s.a.URL]=y.VAL_URL,P[s.a.COMMA]=y.VAL_COMMA,P[s.a.SLASH]=y.VAL_SLASH,P[s.a.FUNC]=y.VAL_FUNC,P[s.a.C_PAR]=y.VAL_C_PAR,P[s.a.SEMICOL]=y.VAL_END,P[s.a.C_BRC]=y.VAL_BRC,P[s.a.BANG]=y.VAL_BANG,P[s.a.PLUS]=y.VAL_PLUS,P[s.a.EOF]=y.VAL_FINISH,A[s.a.IDENT]=y.EXPR_IDENT,A[s.a.NUM]=y.EXPR_NUM,A[s.a.INT]=y.EXPR_NUM,A[s.a.NUMERIC]=y.EXPR_NUMERIC,A[s.a.STR]=y.EXPR_STR,A[s.a.O_PAR]=y.EXPR_O_PAR,A[s.a.FUNC]=y.EXPR_FUNC,A[s.a.BANG]=y.EXPR_PREFIX,A[s.a.MINUS]=y.EXPR_PREFIX,A[s.a.DOLLAR]=y.EXPR_PARAM,R[s.a.IDENT]=y.EXPR_INFIX_NAME,R[s.a.COMMA]=y.EXPR_INFIX,R[s.a.GT]=y.EXPR_INFIX,R[s.a.LT]=y.EXPR_INFIX,R[s.a.GT_EQ]=y.EXPR_INFIX,R[s.a.LT_EQ]=y.EXPR_INFIX,R[s.a.EQ]=y.EXPR_INFIX,R[s.a.EQ_EQ]=y.EXPR_INFIX,R[s.a.BANG_EQ]=y.EXPR_INFIX,R[s.a.AMP_AMP]=y.EXPR_INFIX,R[s.a.BAR_BAR]=y.EXPR_INFIX,R[s.a.PLUS]=y.EXPR_INFIX,R[s.a.MINUS]=y.EXPR_INFIX,R[s.a.SLASH]=y.EXPR_INFIX,R[s.a.PERCENT]=y.EXPR_INFIX,R[s.a.STAR]=y.EXPR_INFIX,R[s.a.COLON]=y.EXPR_INFIX,R[s.a.QMARK]=y.EXPR_INFIX,R[s.a.C_PAR]=y.EXPR_C_PAR,R[s.a.O_BRC]=y.EXPR_O_BRC,R[s.a.SEMICOL]=y.EXPR_SEMICOL,O[s.a.EOF]=y.DONE,O[s.a.O_BRC]=y.ERROR_PUSH,O[s.a.C_BRC]=y.ERROR_POP,O[s.a.O_BRK]=y.ERROR_PUSH,O[s.a.C_BRK]=y.ERROR_POP,O[s.a.O_PAR]=y.ERROR_PUSH,O[s.a.C_PAR]=y.ERROR_POP,O[s.a.SEMICOL]=y.ERROR_SEMICOL,L[s.a.EOF]=y.DONE,L[s.a.O_BRC]=y.ERROR_PUSH,L[s.a.C_BRC]=y.ERROR_POP_DECL,L[s.a.O_BRK]=y.ERROR_PUSH,L[s.a.C_BRK]=y.ERROR_POP,L[s.a.O_PAR]=y.ERROR_PUSH,L[s.a.C_PAR]=y.ERROR_POP,L[s.a.SEMICOL]=y.ERROR_SEMICOL,k[s.a.EOF]=y.DONE,k[s.a.O_BRC]=y.ERROR_PUSH,k[s.a.C_BRC]=y.ERROR_POP,k[s.a.O_BRK]=y.ERROR_PUSH,k[s.a.C_BRK]=y.ERROR_POP,k[s.a.O_PAR]=y.ERROR_PUSH,k[s.a.C_PAR]=y.ERROR_POP,F[s.a.C_PAR]=0,F[s.a.COMMA]=0,F[s.a.QMARK]=1,F[s.a.COLON]=1,F[s.a.AMP_AMP]=2,F[s.a.BAR_BAR]=2,F[s.a.LT]=3,F[s.a.GT]=3,F[s.a.LT_EQ]=3,F[s.a.GT_EQ]=3,F[s.a.EQ]=3,F[s.a.EQ_EQ]=3,F[s.a.BANG_EQ]=3,F[s.a.PLUS]=4,F[s.a.MINUS]=4,F[s.a.STAR]=5,F[s.a.SLASH]=5,F[s.a.PERCENT]=5,F[s.a.EOF]=6,F[D]=2,function(t){t[t.PROP=0]="PROP",t[t.WHEN=1]="WHEN",t[t.MEDIA=2]="MEDIA",t[t.IMPORT=3]="IMPORT"}(_||(_={}));var B=function(){function t(t,e,n,i){this.actions=t,this.tokenizer=e,this.handler=n,this.baseURL=i,this.valStack=[],this.namespacePrefixToURI={},this.defaultNamespaceURI=null,this.propName=null,this.propImportant=!1,this.result=null,this.importReady=!1,this.importURL=null,this.importCondition=null,this.errorBrackets=[],this.ruleStack=[],this.regionRule=!1,this.pageRule=!1,this.exprContext=_.MEDIA}return t.prototype.extractVals=function(t,e){for(var n=[],i=this.valStack;n.push(i[e++]),e!=i.length;)if(i[e++]!=t)throw new Error("Unexpected state");return n},t.prototype.valStackReduce=function(t,e){var n,i=this.valStack,o=i.length;do{n=i[--o]}while(void 0!==n&&"string"!=typeof n);var r=i.length-(o+1);if(r>1&&i.splice(o+1,r,new a.j(i.slice(o+1,i.length))),","==t)return null;o++;do{n=i[--o]}while(void 0!==n&&("string"!=typeof n||","==n));if(r=i.length-(o+1),"("==n){if(")"!=t)return this.handler.error("E_CSS_MISMATCHED_C_PAR",e),this.actions=L,null;var s=new a.e(i[o-1],this.extractVals(",",o+1));return i.splice(o-1,r+2,s),null}return";"!=t||o>=0?(this.handler.error("E_CSS_UNEXPECTED_VAL_END",e),this.actions=L,null):r>1?new a.b(this.extractVals(",",o+1)):i[0]},t.prototype.exprError=function(t,e){this.actions=this.propName?L:O,this.handler.error(t,e)},t.prototype.exprStackReduce=function(t,e){for(var n,i=this.valStack,o=this.handler,r=i.pop();;){var u=i.pop();if(t==s.a.C_PAR){for(var c=[r];u==s.a.COMMA;)c.unshift(i.pop()),u=i.pop();if("string"==typeof u){if("{"==u){for(;c.length>=2;){var h=c.shift(),p=c.shift(),f=new l.z(o.getScope(),h,p);c.unshift(f)}return i.push(new a.c(c[0])),!0}if("("==u){var d=i.pop(),g=i.pop();r=new l.d(o.getScope(),l.M(g,d),c),t=s.a.EOF;continue}}if(u==s.a.O_PAR){r.isMediaName()&&(r=new l.p(o.getScope(),r,null)),t=s.a.EOF;continue}}else if("string"==typeof u){i.push(u);break}if(u<0)if(u==-s.a.BANG)r=new l.w(o.getScope(),r);else{if(u!=-s.a.MINUS)return this.exprError("F_UNEXPECTED_STATE",e),!1;r=new l.v(o.getScope(),r)}else{if(F[t]>F[u]){i.push(u);break}switch(n=i.pop(),u){case s.a.AMP_AMP:r=new l.b(o.getScope(),n,r);break;case D:r=new l.c(o.getScope(),n,r);break;case s.a.BAR_BAR:r=new l.y(o.getScope(),n,r);break;case s.a.LT:r=new l.n(o.getScope(),n,r);break;case s.a.GT:r=new l.k(o.getScope(),n,r);break;case s.a.LT_EQ:r=new l.l(o.getScope(),n,r);break;case s.a.GT_EQ:r=new l.j(o.getScope(),n,r);break;case s.a.EQ:case s.a.EQ_EQ:r=new l.i(o.getScope(),n,r);break;case s.a.BANG_EQ:r=new l.u(o.getScope(),n,r);break;case s.a.PLUS:r=new l.a(o.getScope(),n,r);break;case s.a.MINUS:r=new l.B(o.getScope(),n,r);break;case s.a.STAR:r=new l.r(o.getScope(),n,r);break;case s.a.SLASH:r=new l.h(o.getScope(),n,r);break;case s.a.PERCENT:r=new l.q(o.getScope(),n,r);break;case s.a.COLON:if(!(i.length>1))return this.exprError("E_CSS_EXPR_COND",e),!1;switch(i[i.length-1]){case s.a.QMARK:i.pop(),r=new l.e(o.getScope(),i.pop(),n,r);break;case s.a.O_PAR:if(!n.isMediaName())return this.exprError("E_CSS_MEDIA_TEST",e),!1;r=new l.p(o.getScope(),n,r)}break;case s.a.QMARK:if(t!=s.a.COLON)return this.exprError("E_CSS_EXPR_COND",e),!1;case s.a.O_PAR:return i.push(n),i.push(u),i.push(r),!1;default:return this.exprError("F_UNEXPECTED_STATE",e),!1}}}return i.push(r),!1},t.prototype.readPseudoParams=function(){for(var t=[];;){var e=this.tokenizer.token();switch(e.type){case s.a.IDENT:t.push(e.text);break;case s.a.PLUS:t.push("+");break;case s.a.NUM:case s.a.INT:t.push(e.num);break;default:return t}this.tokenizer.consume()}},t.prototype.readNthPseudoParams=function(){var t=!1,e=this.tokenizer.token();if(e.type===s.a.PLUS)t=!0,this.tokenizer.consume(),e=this.tokenizer.token();else if(e.type===s.a.IDENT&&("even"===e.text||"odd"===e.text))return this.tokenizer.consume(),[2,"odd"===e.text?1:0];switch(e.type){case s.a.NUMERIC:if(t&&e.num<0)return null;case s.a.IDENT:if(t&&"-"===e.text.charAt(0))return null;if("n"===e.text||"-n"===e.text){if(t&&e.precededBySpace)return null;var n="-n"===e.text?-1:1;e.type===s.a.NUMERIC&&(n=e.num);var i=0;this.tokenizer.consume();var o=(e=this.tokenizer.token()).type===s.a.MINUS,r=e.type===s.a.PLUS||o;if(r&&(this.tokenizer.consume(),e=this.tokenizer.token()),e.type===s.a.INT){if(1/(i=e.num)==-1/0){if(i=0,r)return null}else if(i<0){if(r)return null}else if(i>=0&&!r)return null;this.tokenizer.consume()}else if(r)return null;return[n,o&&i>0?-i:i]}if("n-"===e.text||"-n-"===e.text){if(t&&e.precededBySpace)return null;if(n="-n-"===e.text?-1:1,e.type===s.a.NUMERIC&&(n=e.num),this.tokenizer.consume(),(e=this.tokenizer.token()).type===s.a.INT)return e.num<0||1/e.num==-1/0?null:(this.tokenizer.consume(),[n,e.num])}else{var a=e.text.match(/^n(-[0-9]+)$/);if(a)return t&&e.precededBySpace?null:(this.tokenizer.consume(),[e.type===s.a.NUMERIC?e.num:1,parseInt(a[1],10)]);if(a=e.text.match(/^-n(-[0-9]+)$/))return this.tokenizer.consume(),[-1,parseInt(a[1],10)]}return null;case s.a.INT:return t&&(e.precededBySpace||e.num<0)?null:(this.tokenizer.consume(),[0,e.num])}return null},t.prototype.makeCondition=function(t,e){var n=this.handler.getScope();if(!n)return null;if(e=e||n._true,t)for(var i=0,o=t.split(/\s+/);i<o.length;i++)switch(o[i]){case"vertical":e=l.D(n,e,new l.w(n,new l.s(n,"pref-horizontal")));break;case"horizontal":e=l.D(n,e,new l.s(n,"pref-horizontal"));break;case"day":e=l.D(n,e,new l.w(n,new l.s(n,"pref-night-mode")));break;case"night":e=l.D(n,e,new l.s(n,"pref-night-mode"));break;default:e=n._false}return e===n._true?null:new a.c(e)},t.prototype.isInsidePropertyOnlyRule=function(){switch(this.ruleStack[this.ruleStack.length-1]){case"[selector]":case"font-face":case"-epubx-flow":case"-epubx-viewport":case"-epubx-define":case"-adapt-footnote-area":return!0}return!1},t.prototype.runParser=function(t,e,n,i,o){var u,c,h,p,f,d,g,v=this.handler,E=this.tokenizer,b=this.valStack;i&&(this.exprContext=_.MEDIA,this.valStack.push("{"));t:for(;t>0;--t)switch(u=E.token(),this.actions[u.type]){case y.IDENT:if(E.nthToken(1).type!=s.a.COLON){this.isInsidePropertyOnlyRule()?(v.error("E_CSS_COLON_EXPECTED",E.nthToken(1)),this.actions=L):(this.actions=I,v.startSelectorRule());continue}(c=E.nthToken(2)).precededBySpace||c.type!=s.a.IDENT&&c.type!=s.a.FUNC||E.mark(),this.propName=u.text,this.propImportant=!1,E.consume(),E.consume(),this.actions=P,b.splice(0,b.length);continue;case y.PROP:if(E.nthToken(1).type!=s.a.COLON){this.actions=L,v.error("E_CSS_COLON_EXPECTED",E.nthToken(1));continue}this.propName=u.text,this.propImportant=!1,E.consume(),E.consume(),this.actions=P,b.splice(0,b.length);continue;case y.SELECTOR_START:this.actions=I,v.startSelectorRule();continue;case y.SELECTOR_NAME_1:if(!u.precededBySpace){this.actions=k,v.error("E_CSS_SPACE_EXPECTED",u);continue}v.descendantSelector();case y.SELECTOR_NAME:if(E.nthToken(1).type==s.a.BAR)if(E.consume(),E.consume(),null!=(h=this.namespacePrefixToURI[u.text]))switch((u=E.token()).type){case s.a.IDENT:v.tagSelector(h,u.text),this.actions=o?T:S,E.consume();break;case s.a.STAR:v.tagSelector(h,null),this.actions=o?T:S,E.consume();break;default:this.actions=O,v.error("E_CSS_NAMESPACE",u)}else this.actions=O,v.error("E_CSS_UNDECLARED_PREFIX",u);else v.tagSelector(this.defaultNamespaceURI,u.text),this.actions=o?T:S,E.consume();continue;case y.SELECTOR_ANY_1:if(!u.precededBySpace){this.actions=k,v.error("E_CSS_SPACE_EXPECTED",u);continue}v.descendantSelector();case y.SELECTOR_ANY:if(E.nthToken(1).type==s.a.BAR)switch(E.consume(),E.consume(),(u=E.token()).type){case s.a.IDENT:v.tagSelector(null,u.text),this.actions=o?T:S,E.consume();break;case s.a.STAR:v.tagSelector(null,null),this.actions=o?T:S,E.consume();break;default:this.actions=O,v.error("E_CSS_NAMESPACE",u)}else v.tagSelector(this.defaultNamespaceURI,null),this.actions=o?T:S,E.consume();continue;case y.SELECTOR_ID_1:u.precededBySpace&&v.descendantSelector();case y.SELECTOR_ID:v.idSelector(u.text),this.actions=o?T:S,E.consume();continue;case y.SELECTOR_CLASS_1:u.precededBySpace&&v.descendantSelector();case y.SELECTOR_CLASS:v.classSelector(u.text),this.actions=o?T:S,E.consume();continue;case y.SELECTOR_PSEUDOCLASS_1:u.precededBySpace&&v.descendantSelector();case y.SELECTOR_PSEUDOCLASS:E.consume();e:switch((u=E.token()).type){case s.a.IDENT:v.pseudoclassSelector(u.text,null),E.consume(),this.actions=o?T:S;continue;case s.a.FUNC:switch(p=u.text,E.consume(),p){case"not":this.actions=I,v.startFuncWithSelector("not"),this.runParser(Number.POSITIVE_INFINITY,!1,!1,!1,!0)?this.actions=S:this.actions=k;break t;case"lang":case"href-epub-type":if((u=E.token()).type===s.a.IDENT){g=[u.text],E.consume();break}break e;case"nth-child":case"nth-of-type":case"nth-last-child":case"nth-last-of-type":if(g=this.readNthPseudoParams())break;break e;default:g=this.readPseudoParams()}if((u=E.token()).type==s.a.C_PAR){v.pseudoclassSelector(p,g),E.consume(),this.actions=o?T:S;continue}}v.error("E_CSS_PSEUDOCLASS_SYNTAX",u),this.actions=O;continue;case y.SELECTOR_PSEUDOELEM:switch(E.consume(),(u=E.token()).type){case s.a.IDENT:v.pseudoelementSelector(u.text,null),this.actions=o?T:S,E.consume();continue;case s.a.FUNC:if(p=u.text,E.consume(),"nth-fragment"==p){if(null===(g=this.readNthPseudoParams()))break}else g=this.readPseudoParams();if((u=E.token()).type==s.a.C_PAR){v.pseudoelementSelector(p,g),this.actions=o?T:S,E.consume();continue}}v.error("E_CSS_PSEUDOELEM_SYNTAX",u),this.actions=O;continue;case y.SELECTOR_ATTR_1:u.precededBySpace&&v.descendantSelector();case y.SELECTOR_ATTR:if(E.consume(),(u=E.token()).type==s.a.IDENT)p=u.text,E.consume();else if(u.type==s.a.STAR)p=null,E.consume();else{if(u.type!=s.a.BAR){this.actions=k,v.error("E_CSS_ATTR",u),E.consume();continue}p=""}if((u=E.token()).type==s.a.BAR){if(null==(h=p?this.namespacePrefixToURI[p]:p)){this.actions=k,v.error("E_CSS_UNDECLARED_PREFIX",u),E.consume();continue}if(E.consume(),(u=E.token()).type!=s.a.IDENT){this.actions=k,v.error("E_CSS_ATTR_NAME_EXPECTED",u);continue}p=u.text,E.consume(),u=E.token()}else h="";switch(u.type){case s.a.EQ:case s.a.TILDE_EQ:case s.a.BAR_EQ:case s.a.HAT_EQ:case s.a.DOLLAR_EQ:case s.a.STAR_EQ:case s.a.COL_COL:f=u.type,E.consume(),u=E.token();break;case s.a.C_BRK:v.attributeSelector(h,p,s.a.EOF,null),this.actions=o?T:S,E.consume();continue;default:this.actions=k,v.error("E_CSS_ATTR_OP_EXPECTED",u);continue}switch(u.type){case s.a.IDENT:case s.a.STR:v.attributeSelector(h,p,f,u.text),E.consume(),u=E.token();break;default:this.actions=k,v.error("E_CSS_ATTR_VAL_EXPECTED",u);continue}if(u.type!=s.a.C_BRK){this.actions=k,v.error("E_CSS_ATTR",u);continue}this.actions=o?T:S,E.consume();continue;case y.SELECTOR_CHILD:v.childSelector(),this.actions=x,E.consume();continue;case y.SELECTOR_SIBLING:v.adjacentSiblingSelector(),this.actions=x,E.consume();continue;case y.SELECTOR_FOLLOWING_SIBLING:v.followingSiblingSelector(),this.actions=x,E.consume();continue;case y.SELECTOR_BODY:this.regionRule?(this.ruleStack.push("-epubx-region"),this.regionRule=!1):this.pageRule?(this.ruleStack.push("page"),this.pageRule=!1):this.ruleStack.push("[selector]"),v.startRuleBody(),this.actions=N,E.consume();continue;case y.SELECTOR_NEXT:v.nextSelector(),this.actions=I,E.consume();continue;case y.VAL_IDENT:b.push(a.r(u.text)),E.consume();continue;case y.VAL_HASH:f=parseInt(u.text,16);try{b.push(m(u.text))}catch(t){v.error("E_CSS_COLOR",u),this.actions=O}E.consume();continue;case y.VAL_NUM:b.push(new a.h(u.num)),E.consume();continue;case y.VAL_INT:b.push(new a.g(u.num)),E.consume();continue;case y.VAL_NUMERIC:l.K(u.text)?b.push(new a.c(new l.x(v.getScope(),u.num,u.text))):b.push(new a.i(u.num,u.text)),E.consume();continue;case y.VAL_STR:b.push(new a.k(u.text)),E.consume();continue;case y.VAL_URL:b.push(new a.l(r.C(u.text,this.baseURL))),E.consume();continue;case y.VAL_COMMA:this.valStackReduce(",",u),b.push(","),E.consume();continue;case y.VAL_SLASH:b.push(a.w),E.consume();continue;case y.VAL_FUNC:"-epubx-expr"==(p=u.text.toLowerCase())||"calc"==p||"env"==p?(this.actions=A,this.exprContext=_.PROP,b.push("{")):(b.push(p),b.push("(")),E.consume();continue;case y.VAL_C_PAR:this.valStackReduce(")",u),E.consume();continue;case y.VAL_BANG:if(E.consume(),u=E.token(),c=E.nthToken(1),u.type==s.a.IDENT&&"important"==u.text.toLowerCase()&&(c.type==s.a.SEMICOL||c.type==s.a.EOF||c.type==s.a.C_BRC)){E.consume(),this.propImportant=!0;continue}this.exprError("E_CSS_SYNTAX",u);continue;case y.VAL_PLUS:switch((c=E.nthToken(1)).type){case s.a.NUM:case s.a.NUMERIC:case s.a.INT:if(!c.precededBySpace){E.consume();continue}}if(this.actions===P&&E.hasMark()){E.reset(),this.actions=I,v.startSelectorRule();continue}this.exprError("E_CSS_UNEXPECTED_PLUS",u);continue;case y.VAL_END:E.consume();case y.VAL_BRC:E.unmark(),(d=this.valStackReduce(";",u))&&this.propName&&v.property(this.propName,d,this.propImportant),this.actions=n?C:N;continue;case y.VAL_FINISH:if(E.consume(),E.unmark(),d=this.valStackReduce(";",u),e)return this.result=d,!0;if(this.propName&&d&&v.property(this.propName,d,this.propImportant),n)return!0;this.exprError("E_CSS_SYNTAX",u);continue;case y.EXPR_IDENT:(c=E.nthToken(1)).type==s.a.CLASS?(E.nthToken(2).type!=s.a.O_PAR||E.nthToken(2).precededBySpace?(b.push(new l.s(v.getScope(),l.M(u.text,c.text))),this.actions=R):(b.push(u.text,c.text,"("),E.consume()),E.consume()):(this.exprContext==_.MEDIA||this.exprContext==_.IMPORT?"not"==u.text.toLowerCase()?(E.consume(),b.push(new l.o(v.getScope(),!0,c.text))):("only"==u.text.toLowerCase()&&(E.consume(),u=c),b.push(new l.o(v.getScope(),!1,u.text))):b.push(new l.s(v.getScope(),u.text)),this.actions=R),E.consume();continue;case y.EXPR_FUNC:b.push(null,u.text,"("),E.consume();continue;case y.EXPR_NUM:b.push(new l.f(v.getScope(),u.num)),E.consume(),this.actions=R;continue;case y.EXPR_NUMERIC:"%"==(p=u.text)&&(p=this.propName&&this.propName.match(/height|^(top|bottom)$/)?"vh":"vw"),b.push(new l.x(v.getScope(),u.num,p)),E.consume(),this.actions=R;continue;case y.EXPR_STR:b.push(new l.f(v.getScope(),u.text)),E.consume(),this.actions=R;continue;case y.EXPR_PARAM:E.consume(),(u=E.token()).type!=s.a.INT||u.precededBySpace?this.exprError("E_CSS_SYNTAX",u):(b.push(new l.A(v.getScope(),u.num)),E.consume(),this.actions=R);continue;case y.EXPR_PREFIX:b.push(-u.type),E.consume();continue;case y.EXPR_INFIX:this.actions=A,this.exprStackReduce(u.type,u),b.push(u.type),E.consume();continue;case y.EXPR_INFIX_NAME:"and"==u.text.toLowerCase()?(this.actions=A,this.exprStackReduce(D,u),b.push(D),E.consume()):this.exprError("E_CSS_SYNTAX",u);continue;case y.EXPR_C_PAR:this.exprStackReduce(u.type,u)&&(this.propName?this.actions=P:this.exprError("E_CSS_UNBALANCED_PAR",u)),E.consume();continue;case y.EXPR_O_BRC:this.exprStackReduce(s.a.C_PAR,u)&&(this.propName||this.exprContext==_.IMPORT?this.exprError("E_CSS_UNEXPECTED_BRC",u):(this.exprContext==_.WHEN?v.startWhenRule(b.pop()):v.startMediaRule(b.pop()),this.ruleStack.push("media"),v.startRuleBody(),this.actions=N)),E.consume();continue;case y.EXPR_SEMICOL:if(this.exprStackReduce(s.a.C_PAR,u)){if(!this.propName&&this.exprContext==_.IMPORT)return this.importCondition=b.pop(),this.importReady=!0,this.actions=N,E.consume(),!1;this.exprError("E_CSS_UNEXPECTED_SEMICOL",u)}E.consume();continue;case y.EXPR_O_PAR:b.push(u.type),E.consume();continue;case y.RULE_END:this.actions=N,E.consume(),v.endRule(),this.ruleStack.length&&this.ruleStack.pop();continue;case y.AT:switch(p=u.text.toLowerCase()){case"import":if(E.consume(),(u=E.token()).type==s.a.STR||u.type==s.a.URL){if(this.importURL=u.text,E.consume(),(u=E.token()).type==s.a.SEMICOL||u.type==s.a.EOF)return this.importReady=!0,E.consume(),!1;this.propName=null,this.exprContext=_.IMPORT,this.actions=A,b.push("{");continue}v.error("E_CSS_IMPORT_SYNTAX",u),this.actions=O;continue;case"namespace":switch(E.consume(),(u=E.token()).type){case s.a.IDENT:if(p=u.text,E.consume(),((u=E.token()).type==s.a.STR||u.type==s.a.URL)&&E.nthToken(1).type==s.a.SEMICOL){this.namespacePrefixToURI[p]=u.text,E.consume(),E.consume();continue}break;case s.a.STR:case s.a.URL:if(E.nthToken(1).type==s.a.SEMICOL){this.defaultNamespaceURI=u.text,E.consume(),E.consume();continue}}v.error("E_CSS_NAMESPACE_SYNTAX",u),this.actions=O;continue;case"charset":if(E.consume(),(u=E.token()).type==s.a.STR&&E.nthToken(1).type==s.a.SEMICOL){"utf-8"!=(p=u.text.toLowerCase())&&"utf-16"!=p&&v.error("E_CSS_UNEXPECTED_CHARSET "+p,u),E.consume(),E.consume();continue}v.error("E_CSS_CHARSET_SYNTAX",u),this.actions=O;continue;case"font-face":case"-epubx-page-template":case"-epubx-define":case"-epubx-viewport":if(E.nthToken(1).type==s.a.O_BRC){switch(E.consume(),E.consume(),p){case"font-face":v.startFontFaceRule();break;case"-epubx-page-template":v.startPageTemplateRule();break;case"-epubx-define":v.startDefineRule();break;case"-epubx-viewport":v.startViewportRule()}this.ruleStack.push(p),v.startRuleBody();continue}break;case"-adapt-footnote-area":switch(E.consume(),(u=E.token()).type){case s.a.O_BRC:E.consume(),v.startFootnoteRule(null),this.ruleStack.push(p),v.startRuleBody();continue;case s.a.COL_COL:if(E.consume(),(u=E.token()).type==s.a.IDENT&&E.nthToken(1).type==s.a.O_BRC){p=u.text,E.consume(),E.consume(),v.startFootnoteRule(p),this.ruleStack.push("-adapt-footnote-area"),v.startRuleBody();continue}}break;case"-epubx-region":E.consume(),v.startRegionRule(),this.regionRule=!0,this.actions=I;continue;case"page":E.consume(),v.startPageRule(),this.pageRule=!0,this.actions=x;continue;case"top-left-corner":case"top-left":case"top-center":case"top-right":case"top-right-corner":case"right-top":case"right-middle":case"right-bottom":case"bottom-right-corner":case"bottom-right":case"bottom-center":case"bottom-left":case"bottom-left-corner":case"left-bottom":case"left-middle":case"left-top":if(E.consume(),(u=E.token()).type==s.a.O_BRC){E.consume(),v.startPageMarginBoxRule(p),this.ruleStack.push(p),v.startRuleBody();continue}break;case"-epubx-when":E.consume(),this.propName=null,this.exprContext=_.WHEN,this.actions=A,b.push("{");continue;case"media":E.consume(),this.propName=null,this.exprContext=_.MEDIA,this.actions=A,b.push("{");continue;case"-epubx-flow":if(E.nthToken(1).type==s.a.IDENT&&E.nthToken(2).type==s.a.O_BRC){v.startFlowRule(E.nthToken(1).text),E.consume(),E.consume(),E.consume(),this.ruleStack.push(p),v.startRuleBody();continue}break;case"-epubx-page-master":case"-epubx-partition":case"-epubx-partition-group":E.consume();var w=null,F=null,B=[];for((u=E.token()).type==s.a.IDENT&&(w=u.text,E.consume(),u=E.token()),u.type==s.a.COLON&&E.nthToken(1).type==s.a.IDENT&&(F=E.nthToken(1).text,E.consume(),E.consume(),u=E.token());u.type==s.a.FUNC&&"class"==u.text.toLowerCase()&&E.nthToken(1).type==s.a.IDENT&&E.nthToken(2).type==s.a.C_PAR;)B.push(E.nthToken(1).text),E.consume(),E.consume(),E.consume(),u=E.token();if(u.type==s.a.O_BRC){switch(E.consume(),p){case"-epubx-page-master":v.startPageMasterRule(w,F,B);break;case"-epubx-partition":v.startPartitionRule(w,F,B);break;case"-epubx-partition-group":v.startPartitionGroupRule(w,F,B)}this.ruleStack.push(p),v.startRuleBody();continue}break;case"":v.error("E_CSS_UNEXPECTED_AT"+p,u),this.actions=k;continue;default:v.error("E_CSS_AT_UNKNOWN "+p,u),this.actions=O;continue}v.error("E_CSS_AT_SYNTAX "+p,u),this.actions=O;continue;case y.ERROR_PUSH:if(e||n)return!0;this.errorBrackets.push(u.type+1),E.consume();continue;case y.ERROR_POP_DECL:if(e||n)return!0;if(0==this.errorBrackets.length){this.actions=N;continue}case y.ERROR_POP:this.errorBrackets.length>0&&this.errorBrackets[this.errorBrackets.length-1]==u.type&&this.errorBrackets.pop(),0==this.errorBrackets.length&&u.type==s.a.C_BRC&&(this.actions=N),E.consume();continue;case y.ERROR_SEMICOL:if(e||n)return!0;0==this.errorBrackets.length&&(this.actions=N),E.consume();continue;case y.DONE:return o&&(E.consume(),v.endFuncWithSelector()),!0;default:if(e||n)return!0;if(i)return!!this.exprStackReduce(s.a.C_PAR,u)&&(this.result=b.pop(),!0);if(o)return u.type==s.a.INVALID?v.error(u.text,u):v.error("E_CSS_SYNTAX",u),!1;if(this.actions===P&&E.hasMark()){E.reset(),this.actions=I,v.startSelectorRule();continue}if(this.actions!==O&&this.actions!==k&&this.actions!==L){u.type==s.a.INVALID?v.error(u.text,u):v.error("E_CSS_SYNTAX",u),this.isInsidePropertyOnlyRule()?this.actions=L:this.actions=k;continue}E.consume();continue}return!1},t}(),M=function(t){function e(e){var n=t.call(this,null)||this;return n.scope=e,n}return p(e,t),e.prototype.error=function(t,e){throw new Error(t)},e.prototype.getScope=function(){return this.scope},e}(v);function U(t,e,n,i,o){var a=h.c("parseStylesheet"),l=new B(N,t,e,n),u=null;return o&&(u=function(t,e,n){var i=new B(A,t,e,n);return i.runParser(Number.POSITIVE_INFINITY,!1,!1,!0,!1),i.result}(new s.b(o,e),e,n)),(u=l.makeCondition(i,u&&u.toExpr()))&&(e.startMediaRule(u),e.startRuleBody()),a.loop(function(){for(var t=function(){if(l.importReady){var t=r.C(l.importURL,n);l.importCondition&&(e.startMediaRule(l.importCondition),e.startRuleBody());var i=h.c("parseStylesheet.import");return H(t,e,null,null).then(function(){l.importCondition&&e.endRule(),l.importReady=!1,l.importURL=null,l.importCondition=null,i.finish(!0)}),{value:i.result()}}var o=a.timeSlice();if(o.isPending)return{value:o}};!l.runParser(100,!1,!1,!1,!1);){var i=t();if("object"==typeof i)return i.value}return h.d(!1)}).then(function(){u&&e.endRule(),a.finish(!0)}),a.result()}function V(t,e,n,i,o){return h.b("parseStylesheetFromText",function(r){U(new s.b(t,e),e,n,i,o).thenFinish(r)},function(e,n){u.b.warn(n,"Failed to parse stylesheet text: "+t),e.finish(!1)})}function H(t,e,n,i){return h.b("parseStylesheetFromURL",function(o){c.c(t).then(function(r){r.responseText?V(r.responseText,e,t,n,i).then(function(e){e||u.b.warn("Failed to parse stylesheet from "+t),o.finish(!0)}):o.finish(!0)})},function(e,n){u.b.warn(n,"Exception while fetching and parsing:",t),e.finish(!0)})}function z(t,e,n){var i=new B(P,e,new M(t),n);return i.runParser(Number.POSITIVE_INFINITY,!0,!1,!1,!1),i.result}function G(t,e,n){new B(C,t,e,n).runParser(Number.POSITIVE_INFINITY,!1,!0,!1,!1)}var W={"z-index":!0,"column-count":!0,"flow-linger":!0,opacity:!0,page:!0,"flow-priority":!0,utilization:!0};function X(t,e,n){return e.isExpr()?function(t,e,n){var i=e.evaluate(t);switch(typeof i){case"number":return W[n]?i==Math.round(i)?new a.g(i):new a.h(i):new a.i(i,"px");case"string":return i?z(e.scope,new s.b(i,null),""):a.o;case"boolean":return i?a.t._true:a.t._false;case"undefined":return a.o}throw new Error("E_UNEXPECTED")}(t,e.expr,n):e}},function(t,e,n){n.d(e,"c",function(){return o}),n.d(e,"b",function(){return r}),n.d(e,"a",function(){return a}),n.d(e,"d",function(){return c}),n.d(e,"j",function(){return h}),n.d(e,"k",function(){return p}),n.d(e,"i",function(){return v}),n.d(e,"m",function(){return E}),n.d(e,"l",function(){return w}),n.d(e,"g",function(){return S}),n.d(e,"f",function(){return T}),n.d(e,"h",function(){return x}),n.d(e,"e",function(){return I});var i=n(6),o=function(t,e,n,i){this.x1=t,this.y1=e,this.x2=n,this.y2=i},r=function(t,e){this.x=t,this.y=e},a=function(t,e,n,i){this.left=t,this.top=e,this.right=n,this.bottom=i},s=function(t,e,n,i){this.low=t,this.high=e,this.winding=n,this.shapeId=i},l=function(t,e,n,i){this.y1=t,this.y2=e,this.x1=n,this.x2=i,this.left=null,this.right=null};function u(t,e){return t.low.y-e.low.y||t.low.x-e.low.x}var c=function(){function t(t){this.points=t}return t.prototype.addSegments=function(t,e){for(var n=this.points,i=n.length,o=n[i-1],r=0;r<i;r++){var a,l=n[r];a=o.y<l.y?new s(o,l,1,e):new s(l,o,-1,e),t.push(a),o=l}},t.prototype.withOffset=function(e,n){for(var i=[],o=0,a=this.points;o<a.length;o++){var s=a[o];i.push(new r(s.x+e,s.y+n))}return new t(i)},t}();function h(t,e,n,i){for(var o=[],a=0;a<20;a++){var s=2*a*Math.PI/20;o.push(new r(t+n*Math.sin(s),e+i*Math.cos(s)))}return new c(o)}function p(t,e,n,i){return new c([new r(t,e),new r(n,e),new r(n,i),new r(t,i)])}var f=function(t,e,n,i){this.x=t,this.winding=e,this.shapeId=n,this.lowOrHigh=i};function d(t,e){var n=t.low.x+(t.high.x-t.low.x)*(e-t.low.y)/(t.high.y-t.low.y);if(isNaN(n))throw new Error("Bad intersection");return n}function g(t,e,n,o){var r,a,s,l;e.high.y<n&&i.b.warn("Error: inconsistent segment (1)"),e.low.y<=n?(r=d(e,n),a=e.winding):(r=e.low.x,a=0),e.high.y>=o?(s=d(e,o),l=e.winding):(s=e.high.x,l=0),r<s?(t.push(new f(r,a,e.shapeId,-1)),t.push(new f(s,l,e.shapeId,1))):(t.push(new f(s,l,e.shapeId,-1)),t.push(new f(r,a,e.shapeId,1)))}function m(t,e,n){var i,o=e+n,r=Array(o),a=Array(o);for(i=0;i<=o;i++)r[i]=0,a[i]=0;for(var s=[],l=!1,u=t.length,c=0;c<u;c++){var h=t[c];r[h.shapeId]+=h.winding,a[h.shapeId]+=h.lowOrHigh;var p=!1;for(i=0;i<e;i++)if(r[i]&&!a[i]){p=!0;break}if(p)for(i=e;i<=o;i++)if(r[i]||a[i]){p=!1;break}l!=p&&(s.push(h.x),l=p)}return s}function y(t,e){return e?Math.floor(t/e)*e:t}function v(t){return new o(t.y1,-t.x2,t.y2,-t.x1)}function E(t){return new o(-t.y2,t.x1,-t.y1,t.x2)}function b(t){return new c(t.points.map(function(t){return function(t){return new r(t.y,-t.x)}(t)}))}function w(t,e,n,i,o,r){r&&(t=v(t),e=e.map(function(t){return b(t)}),n=n.map(function(t){return b(t)}));var a,s,c,h=e.length,p=n?n.length:0,f=[],d=[];for(a=0;a<h;a++)e[a].addSegments(d,a);for(a=0;a<p;a++)n[a].addSegments(d,a+h);var E=d.length;d.sort(u);for(var w=0;d[w].shapeId>=h;)w++;var C=d[w].low.y;C>t.y1&&f.push(new l(t.y1,C,t.x2,t.x2));for(var S,T,x=0,I=[];x<E&&(c=d[x]).low.y<C;)c.high.y>C&&I.push(c),x++;for(;x<E||I.length>0;){var P=t.y2,A=Math.min((S=Math.ceil(C+i),(T=o)?Math.ceil(S/T)*T:S),t.y2);for(s=0;s<I.length&&P>A;s++)(c=I[s]).low.x==c.high.x?c.high.y<P&&(P=Math.max(y(c.high.y,o),A)):c.low.x!=c.high.x&&(P=A);for(P>t.y2&&(P=t.y2);x<E&&(c=d[x]).low.y<P;)if(c.high.y<C)x++;else{if(!(c.low.y<A)){var R=y(c.low.y,o);R<P&&(P=R);break}c.low.y==c.high.y&&c.low.y==C||(I.push(c),P=A),x++}var O=[];for(s=0;s<I.length;s++)g(O,I[s],C,P);O.sort(function(t,e){return t.x-e.x||t.lowOrHigh-e.lowOrHigh});var L=m(O,h,p);if(0==L.length)f.push(new l(C,P,t.x2,t.x2));else{var k=0,F=t.x1;for(s=0;s<L.length;s+=2){var _=Math.max(t.x1,L[s]),D=Math.min(t.x2,L[s+1])-_;D>k&&(k=D,F=_)}0==k?f.push(new l(C,P,t.x2,t.x2)):f.push(new l(C,P,Math.max(F,t.x1),Math.min(F+k,t.x2)))}if(P==t.y2)break;for(C=P,s=I.length-1;s>=0;s--)I[s].high.y<=P&&I.splice(s,1)}return N(t,f),f}function N(t,e){for(var n=e.length-1,i=new l(t.y2,t.y2,t.x1,t.x2);n>=0;){var o=i;((i=e[n]).y2-i.y1<1||i.x1==o.x1&&i.x2==o.x2)&&(o.y1=i.y1,e.splice(n,1),i=o),n--}}function C(t,e){for(var n=0,i=t.length;n<i;){var o=Math.floor((n+i)/2);e>=t[o].y2?n=o+1:i=o}return n}function S(t,e){if(!t.length)return e;var n,i,r=e.y1;for(i=0;i<t.length&&!((n=t[i]).y2>e.y1&&n.x1-.1<=e.x1&&n.x2+.1>=e.x2);i++)r=Math.max(r,n.y2);for(var a=r;i<t.length&&!((n=t[i]).y1>=e.y2||n.x1-.1>e.x1||n.x2+.1<e.x2);i++)a=n.y2;return(a=i===t.length?e.y2:Math.min(a,e.y2))<=r?null:new o(e.x1,r,e.x2,a)}function T(t,e){if(!t.length)return e;var n,i,r=e.y2;for(i=t.length-1;i>=0&&(n=t[i],!(i===t.length-1&&n.y2<e.y2))&&!(n.y1<e.y2&&n.x1-.1<=e.x1&&n.x2+.1>=e.x2);i--)r=Math.min(r,n.y1);for(var a=Math.min(r,n.y2);i>=0&&!((n=t[i]).y2<=e.y1||n.x1-.1>e.x1||n.x2+.1<e.x2);i--)a=n.y1;return r<=(a=Math.max(a,e.y1))?null:new o(e.x1,a,e.x2,r)}function x(t,e,n,i){for(var o=n.y1,r=n.x2-n.x1,a=n.y2-n.y1,s=C(e,o);;){var l=o+a;if(l>t.y2)return!1;for(var u=t.x1,c=t.x2,h=s;h<e.length&&e[h].y1<l;h++){var p=e[h];p.x1>u&&(u=p.x1),p.x2<c&&(c=p.x2)}if(u+r<=c||s>=e.length)return"left"==i?(n.x1=u,n.x2=u+r):(n.x1=c-r,n.x2=c),n.y2+=o-n.y1,n.y1=o,!0;o=e[s].y2,s++}}function I(t,e,n,i,o){for(i||(i=[new l(n.y1,n.y2,n.x1,n.x2)]);i.length>0&&i[0].y2<=t.y1;)i.shift();if(0!=i.length){var r;i[0].y1<t.y1&&(i[0].y1=t.y1);var a=0==e.length?t.y1:e[e.length-1].y2;a<t.y2&&e.push(new l(a,t.y2,t.x1,t.x2));for(var s=C(e,i[0].y1),u=0,c=i;u<c.length;u++){var h=c[u];if(s==e.length)break;for(e[s].y1<h.y1&&(r=e[s],s++,e.splice(s,0,new l(h.y1,r.y2,r.x1,r.x2)),r.y2=h.y1);s<e.length&&((r=e[s++]).y2>h.y2&&(e.splice(s,0,new l(h.y2,r.y2,r.x1,r.x2)),r.y2=h.y2),h.x1!=h.x2&&("left"==o?r.x1=Math.min(h.x2,t.x2):r.x2=Math.max(h.x1,t.x1)),r.y2!=h.y2););}N(t,e)}}},function(t,e,n){var i=n(7),o=n(0),r=n(11);function a(t,e){var n={};return Object.keys(t).forEach(function(i){var o=n[i]={},r=t[i];Object.keys(r).forEach(function(t){o[t]=r[t].map(function(t){var n=e?t.logical:t.physical,i=e?t.physical:t.logical;return{regexp:new RegExp("(-?)"+n+"(-?)"),to:"$1"+i+"$2"}})})}),n}function s(t,e,n,i){var o=i[e];if(!o)throw new Error("unknown writing-mode: "+e);var r=o[n||"ltr"];if(!r)throw new Error("unknown direction: "+n);for(var a=0,s=r;a<s.length;a++){var l=s[a],u=t.replace(l.regexp,l.to);if(u!==t)return u}return t}n(6);var l={"horizontal-tb":{ltr:[{logical:"inline-start",physical:"left"},{logical:"inline-end",physical:"right"},{logical:"block-start",physical:"top"},{logical:"block-end",physical:"bottom"},{logical:"inline-size",physical:"width"},{logical:"block-size",physical:"height"}],rtl:[{logical:"inline-start",physical:"right"},{logical:"inline-end",physical:"left"},{logical:"block-start",physical:"top"},{logical:"block-end",physical:"bottom"},{logical:"inline-size",physical:"width"},{logical:"block-size",physical:"height"}]},"vertical-rl":{ltr:[{logical:"inline-start",physical:"top"},{logical:"inline-end",physical:"bottom"},{logical:"block-start",physical:"right"},{logical:"block-end",physical:"left"},{logical:"inline-size",physical:"height"},{logical:"block-size",physical:"width"}],rtl:[{logical:"inline-start",physical:"bottom"},{logical:"inline-end",physical:"top"},{logical:"block-start",physical:"right"},{logical:"block-end",physical:"left"},{logical:"inline-size",physical:"height"},{logical:"block-size",physical:"width"}]},"vertical-lr":{ltr:[{logical:"inline-start",physical:"top"},{logical:"inline-end",physical:"bottom"},{logical:"block-start",physical:"left"},{logical:"block-end",physical:"right"},{logical:"inline-size",physical:"height"},{logical:"block-size",physical:"width"}],rtl:[{logical:"inline-start",physical:"bottom"},{logical:"inline-end",physical:"top"},{logical:"block-start",physical:"left"},{logical:"block-end",physical:"right"},{logical:"inline-size",physical:"height"},{logical:"block-size",physical:"width"}]}},u=a(l,!0),c=a(l,!1),h=n(19),p=n(3),f=n(8),d=n(15);n.d(e,"a",function(){return g}),n.d(e,"g",function(){return m}),n.d(e,"h",function(){return y}),n.d(e,"b",function(){return v}),n.d(e,"d",function(){return b}),n.d(e,"c",function(){return w}),n.d(e,"e",function(){return N}),n.d(e,"f",function(){return S});var g=d.b.FloatReference;function m(t){switch(t){case"inline":return g.INLINE;case"column":return g.COLUMN;case"region":return g.REGION;case"page":return g.PAGE;default:throw new Error("Unknown float-reference: "+t)}}function y(t){switch(t){case g.INLINE:return!1;case g.COLUMN:case g.REGION:case g.PAGE:return!0;default:throw new Error("Unknown float-reference: "+t)}}var v=function(){function t(t,e,n,i,o,r){this.nodePosition=t,this.floatReference=e,this.floatSide=n,this.clearSide=i,this.flowName=o,this.floatMinWrapBlock=r,this.order=null,this.id=null}return t.prototype.getOrder=function(){if(null===this.order)throw new Error("The page float is not yet added");return this.order},t.prototype.getId=function(){if(!this.id)throw new Error("The page float is not yet added");return this.id},t.prototype.isAllowedOnContext=function(t){return t.isAnchorAlreadyAppeared(this.getId())},t.prototype.isAllowedToPrecede=function(t){return!1},t}(),E=function(){function t(){this.floats=[],this.nextPageFloatIndex=0}return t.prototype.nextOrder=function(){return this.nextPageFloatIndex++},t.prototype.createPageFloatId=function(t){return"pf"+t},t.prototype.addPageFloat=function(t){if(this.floats.findIndex(function(e){return f.u(e.nodePosition,t.nodePosition)})>=0)throw new Error("A page float with the same source node is already registered");var e=t.order=this.nextOrder();t.id=this.createPageFloatId(e),this.floats.push(t)},t.prototype.findPageFloatByNodePosition=function(t){var e=this.floats.findIndex(function(e){return f.u(e.nodePosition,t)});return e>=0?this.floats[e]:null},t.prototype.findPageFloatById=function(t){var e=this.floats.findIndex(function(e){return e.id===t});return e>=0?this.floats[e]:null},t}(),b=function(){function t(t,e,n,i,o){this.floatReference=t,this.floatSide=e,this.continuations=n,this.area=i,this.continues=o}return t.prototype.hasFloat=function(t){return this.continuations.some(function(e){return e.float===t})},t.prototype.findNotAllowedFloat=function(t){for(var e=this.continuations.length-1;e>=0;e--){var n=this.continuations[e].float;if(!n.isAllowedOnContext(t))return n}return null},t.prototype.getOuterShape=function(){return this.area.getOuterShape(null,null)},t.prototype.getOuterRect=function(){return this.area.getOuterRect()},t.prototype.getOrder=function(){var t=this.continuations.map(function(t){return t.float});return Math.min.apply(null,t.map(function(t){return t.getOrder()}))},t.prototype.shouldBeStashedBefore=function(t){return this.getOrder()<t.getOrder()},t.prototype.addContinuations=function(t){var e=this;t.forEach(function(t){e.continuations.push(t)})},t.prototype.getFlowName=function(){var t=this.continuations[0].float.flowName;return i.a(this.continuations.every(function(e){return e.float.flowName===t})),t},t}(),w=function(){function t(t,e){this.float=t,this.nodePosition=e}return t.prototype.equals=function(t){return!!t&&(this===t||this.float===t.float&&f.u(this.nodePosition,t.nodePosition))},t}(),N=function(){function t(t,e,n,i,r,a,s){this.parent=t,this.floatReference=e,this.container=n,this.flowName=i,this.generatingNodePosition=r,this.children=[],this.invalidated=!1,this.forbiddenFloats=[],this.floatFragments=[],this.stashedFloatFragments=[],this.floatAnchors={},this.floatsDeferredToNext=[],this.layoutConstraints=[],this.locked=!1,t&&t.children.push(this),this.writingMode=a||t&&t.writingMode||o.t.horizontal_tb,this.direction=s||t&&t.direction||o.t.ltr,this.floatStore=t?t.floatStore:new E;var l=this.getPreviousSibling();this.floatsDeferredFromPrevious=l?[].concat(l.floatsDeferredToNext):[]}return t.prototype.getParent=function(t){if(!this.parent)throw new Error("No PageFloatLayoutContext for "+t);return this.parent},t.prototype.getPreviousSiblingOf=function(t,e,n,i){var o=this.children.indexOf(t);o<0&&(o=this.children.length);for(var r=o-1;r>=0;r--){var a=this.children[r];if(a.floatReference===e&&a.flowName===n&&f.u(a.generatingNodePosition,i))return a;if(a=a.getPreviousSiblingOf(null,e,n,i))return a}return null},t.prototype.getPreviousSibling=function(){for(var t,e=this,n=this.parent;n;){if(t=n.getPreviousSiblingOf(e,this.floatReference,this.flowName,this.generatingNodePosition))return t;e=n,n=n.parent}return null},t.prototype.getContainer=function(t){return t&&t!==this.floatReference?this.getParent(t).getContainer(t):this.container},t.prototype.setContainer=function(t){this.container=t,this.reattachFloatFragments()},t.prototype.addPageFloat=function(t){this.floatStore.addPageFloat(t)},t.prototype.getPageFloatLayoutContext=function(t){return t===this.floatReference?this:this.getParent(t).getPageFloatLayoutContext(t)},t.prototype.findPageFloatByNodePosition=function(t){return this.floatStore.findPageFloatByNodePosition(t)},t.prototype.forbid=function(t){var e=t.getId(),n=t.floatReference;n===this.floatReference?this.forbiddenFloats.includes(e)||(this.forbiddenFloats.push(e),(new S).findByFloat(t).forbid(t,this)):this.getParent(n).forbid(t)},t.prototype.isForbidden=function(t){var e=t.getId(),n=t.floatReference;return n===this.floatReference?this.forbiddenFloats.includes(e):this.getParent(n).isForbidden(t)},t.prototype.addPageFloatFragment=function(t,e){var n=t.floatReference;n!==this.floatReference?this.getParent(n).addPageFloatFragment(t,e):this.floatFragments.includes(t)||(this.floatFragments.push(t),this.floatFragments.sort(function(t,e){return t.getOrder()-e.getOrder()})),e||this.invalidate()},t.prototype.removePageFloatFragment=function(t,e){var n=t.floatReference;if(n!==this.floatReference)this.getParent(n).removePageFloatFragment(t,e);else{var i=this.floatFragments.indexOf(t);if(i>=0){var o=this.floatFragments.splice(i,1)[0],r=o.area&&o.area.element;r&&r.parentNode&&r.parentNode.removeChild(r),e||this.invalidate()}}},t.prototype.findPageFloatFragment=function(t){if(t.floatReference!==this.floatReference)return this.getParent(t.floatReference).findPageFloatFragment(t);var e=this.floatFragments.findIndex(function(e){return e.hasFloat(t)});return e>=0?this.floatFragments[e]:null},t.prototype.hasFloatFragments=function(t){return!(!(this.floatFragments.length>0)||t&&!this.floatFragments.some(t))||!!this.parent&&this.parent.hasFloatFragments(t)},t.prototype.hasContinuingFloatFragmentsInFlow=function(t){return this.hasFloatFragments(function(e){return e.continues&&e.getFlowName()===t})},t.prototype.registerPageFloatAnchor=function(t,e){this.floatAnchors[t.getId()]=e},t.prototype.collectPageFloatAnchors=function(){var t=Object.assign({},this.floatAnchors);return this.children.reduce(function(t,e){return Object.assign(t,e.collectPageFloatAnchors())},t)},t.prototype.isAnchorAlreadyAppeared=function(t){if(this.getDeferredPageFloatContinuations().some(function(e){return e.float.getId()===t}))return!0;var e=this.collectPageFloatAnchors()[t];return!!e&&!(!this.container||!this.container.element)&&this.container.element.contains(e)},t.prototype.deferPageFloat=function(t){var e=t.float;if(e.floatReference===this.floatReference){var n=this.floatsDeferredToNext.findIndex(function(t){return t.float===e});n>=0?this.floatsDeferredToNext.splice(n,1,t):this.floatsDeferredToNext.push(t)}else this.getParent(e.floatReference).deferPageFloat(t)},t.prototype.hasPrecedingFloatsDeferredToNext=function(t,e){if(!e&&t.floatReference!==this.floatReference)return this.getParent(t.floatReference).hasPrecedingFloatsDeferredToNext(t,!1);var n=t.getOrder();return!!this.floatsDeferredToNext.some(function(e){return e.float.getOrder()<n&&!t.isAllowedToPrecede(e.float)})||!!this.parent&&this.parent.hasPrecedingFloatsDeferredToNext(t,!0)},t.prototype.getLastFollowingFloatInFragments=function(t){var e=t.getOrder(),n=null;if(this.floatFragments.forEach(function(t){t.continuations.forEach(function(t){var i=t.float,o=i.getOrder();o>e&&(!n||o>n.getOrder())&&(n=i)})}),this.parent){var i=this.parent.getLastFollowingFloatInFragments(t);i&&(!n||i.getOrder()>n.getOrder())&&(n=i)}return n},t.prototype.getDeferredPageFloatContinuations=function(t){t=t||this.flowName;var e=this.floatsDeferredFromPrevious.filter(function(e){return!t||e.float.flowName===t});return this.parent&&(e=this.parent.getDeferredPageFloatContinuations(t).concat(e)),e.sort(function(t,e){return t.float.getOrder()-e.float.getOrder()})},t.prototype.getPageFloatContinuationsDeferredToNext=function(t){t=t||this.flowName;var e=this.floatsDeferredToNext.filter(function(e){return!t||e.float.flowName===t});return this.parent?this.parent.getPageFloatContinuationsDeferredToNext(t).concat(e):e},t.prototype.getFloatsDeferredToNextInChildContexts=function(){for(var t=[],e=[],n=this.children.length-1;n>=0;n--){var i=this.children[n];e.includes(i.flowName)||(e.push(i.flowName),t=(t=t.concat(i.floatsDeferredToNext.map(function(t){return t.float}))).concat(i.getFloatsDeferredToNextInChildContexts()))}return t},t.prototype.checkAndForbidNotAllowedFloat=function(){if(this.checkAndForbidFloatFollowingDeferredFloat())return!0;for(var t=this.floatFragments.length-1;t>=0;t--){var e=this.floatFragments[t],n=e.findNotAllowedFloat(this);if(n)return this.locked?this.invalidate():(this.removePageFloatFragment(e),this.forbid(n),this.removeEndFloatFragments(e.floatSide)),!0}return!(this.floatReference!==g.REGION||!this.parent.locked)&&this.parent.checkAndForbidNotAllowedFloat()},t.prototype.checkAndForbidFloatFollowingDeferredFloat=function(){var t=this.getFloatsDeferredToNextInChildContexts(),e=this.floatFragments.reduce(function(t,e){return t.concat(e.continuations.map(function(t){return t.float}))},[]);e.sort(function(t,e){return e.getOrder()-t.getOrder()});for(var n=function(e){var n=e.getOrder();if(t.some(function(t){return!e.isAllowedToPrecede(t)&&n>t.getOrder()})){if(o.locked)o.invalidate();else{o.forbid(e);var r=o.findPageFloatFragment(e);i.a(r),o.removePageFloatFragment(r)}return{value:!0}}},o=this,r=0,a=e;r<a.length;r++){var s=n(a[r]);if("object"==typeof s)return s.value}return!1},t.prototype.finish=function(){var t=this;if(!this.checkAndForbidNotAllowedFloat()){for(var e=this.floatsDeferredToNext.length-1;e>=0;e--)if(!this.floatsDeferredToNext[e].float.isAllowedOnContext(this)){if(this.locked)return void this.invalidate();this.floatsDeferredToNext.splice(e,1)}this.floatsDeferredFromPrevious.forEach(function(e){t.floatsDeferredToNext.findIndex(function(t){return e.equals(t)})>=0||t.floatFragments.some(function(t){return t.hasFloat(e.float)})||t.floatsDeferredToNext.push(e)})}},t.prototype.hasSameContainerAs=function(t){return!!this.container&&!!t.container&&this.container.element===t.container.element},t.prototype.invalidate=function(){var t=this;this.invalidated=!0,this.locked||(this.container&&(this.children.forEach(function(e){t.hasSameContainerAs(e)&&e.floatFragments.forEach(function(t){var e=t.area.element;e&&e.parentNode&&e.parentNode.removeChild(e)})}),this.container.clear()),this.children.forEach(function(t){t.layoutConstraints.splice(0)}),this.children.splice(0),Object.keys(this.floatAnchors).forEach(function(e){delete t.floatAnchors[e]}))},t.prototype.detachChildren=function(){var t=this.children.splice(0);return t.forEach(function(t){t.floatFragments.forEach(function(t){var e=t.area.element;e&&e.parentNode&&e.parentNode.removeChild(e)})}),t},t.prototype.attachChildren=function(t){var e=this;t.forEach(function(t){e.children.push(t),t.reattachFloatFragments()})},t.prototype.isInvalidated=function(){return this.invalidated||!!this.parent&&this.parent.isInvalidated()},t.prototype.validate=function(){this.invalidated=!1},t.prototype.toLogical=function(t){return function(t,e,n){return s(t,e,n||null,c)}(t,this.writingMode.toString(),this.direction.toString())},t.prototype.toPhysical=function(t){return function(t,e,n){return s(t,e,n||null,u)}(t,this.writingMode.toString(),this.direction.toString())},t.prototype.removeEndFloatFragments=function(t){var e=this.toLogical(t);if("block-end"===e||"inline-end"===e)for(var n=0;n<this.floatFragments.length;){var i=this.floatFragments[n];this.toLogical(i.floatSide)===e?this.removePageFloatFragment(i):n++}},t.prototype.stashEndFloatFragments=function(t){var e=t.floatReference;if(e===this.floatReference){var n=this.toLogical(t.floatSide);if("block-end"===n||"snap-block"===n||"inline-end"===n)for(var i=0;i<this.floatFragments.length;){var o=this.floatFragments[i],r=this.toLogical(o.floatSide);(r===n||"snap-block"===n&&"block-end"===r)&&o.shouldBeStashedBefore(t)?(this.stashedFloatFragments.push(o),this.floatFragments.splice(i,1)):i++}}else this.getParent(e).stashEndFloatFragments(t)},t.prototype.restoreStashedFragments=function(t){var e=this;t===this.floatReference?(this.stashedFloatFragments.forEach(function(t){e.addPageFloatFragment(t,!0)}),this.stashedFloatFragments.splice(0)):this.getParent(t).restoreStashedFragments(t)},t.prototype.discardStashedFragments=function(t){t===this.floatReference?this.stashedFloatFragments.splice(0):this.getParent(t).discardStashedFragments(t)},t.prototype.getStashedFloatFragments=function(t){return t===this.floatReference?this.stashedFloatFragments.concat().sort(function(t,e){return e.getOrder()-t.getOrder()}):this.getParent(t).getStashedFloatFragments(t)},t.prototype.getLimitValue=function(t,e,n,o){i.a(this.container);var r=this.toLogical(t),a=this.toPhysical(t),s=this.getLimitValueInner(r,e,n,o);if(this.parent&&this.parent.container){var l=this.parent.getLimitValue(a,e,n,o);switch(a){case"top":case"left":return Math.max(s,l);case"bottom":case"right":return Math.min(s,l);default:i.b("Should be unreachable")}}return s},t.prototype.getLimitValueInner=function(t,e,n,o){i.a(this.container);var r=this.getLimitValuesInner(e,n,o);switch(t){case"block-start":return this.container.vertical?r.right:r.top;case"block-end":return this.container.vertical?r.left:r.bottom;case"inline-start":return this.container.vertical?r.top:r.left;case"inline-end":return this.container.vertical?r.bottom:r.right;default:throw new Error("Unknown logical side: "+t)}},t.prototype.getLimitValuesInner=function(t,e,n){var o=this;i.a(this.container);var r=this.container.originX,a=this.container.originY,s=this.container.getPaddingRect(),l={top:s.y1-a,left:s.x1-r,bottom:s.y2-a,right:s.x2-r,floatMinWrapBlockStart:0,floatMinWrapBlockEnd:0};function u(n,i,o){return"%"===n.unit?o*n.num/100:t.convertLengthToPx(n,i,e)}var c=this.floatFragments;return c.length>0&&(l=c.reduce(function(t,e){if(n&&!n(e,o))return t;var i=o.toLogical(e.floatSide),r=e.area,a=e.continuations[0].float.floatMinWrapBlock,l=t.top,c=t.left,h=t.bottom,p=t.right,f=t.floatMinWrapBlockStart,d=t.floatMinWrapBlockEnd;switch(i){case"inline-start":r.vertical?l=Math.max(l,r.top+r.height):c=Math.max(c,r.left+r.width);break;case"block-start":r.vertical?(a&&r.left<p&&(f=u(a,r.rootViewNodes[0],s.x2-s.x1)),p=Math.min(p,r.left)):(a&&r.top+r.height>l&&(f=u(a,r.rootViewNodes[0],s.y2-s.y1)),l=Math.max(l,r.top+r.height));break;case"inline-end":r.vertical?h=Math.min(h,r.top):p=Math.min(p,r.left);break;case"block-end":r.vertical?(a&&r.left+r.width>c&&(d=u(a,r.rootViewNodes[0],s.x2-s.x1)),c=Math.max(c,r.left+r.width)):(a&&r.top<h&&(d=u(a,r.rootViewNodes[0],s.y2-s.y1)),h=Math.min(h,r.top));break;default:throw new Error("Unknown logical float side: "+i)}return{top:l,left:c,bottom:h,right:p,floatMinWrapBlockStart:f,floatMinWrapBlockEnd:d}},l)),l.left+=r,l.right+=r,l.top+=a,l.bottom+=a,l},t.prototype.setFloatAreaDimensions=function(t,e,n,o,a,s,l){if(e!==this.floatReference)return this.getParent(e).setFloatAreaDimensions(t,e,n,o,a,s,l);var u=this.toLogical(n);if("snap-block"===u){if(!l["block-start"]&&!l["block-end"])return null}else if(!l[u])return null;i.a(t.clientLayout);var c,p,f,d,g=this.getLimitValue("block-start",t.layoutContext,t.clientLayout),m=this.getLimitValue("block-end",t.layoutContext,t.clientLayout),y=this.getLimitValue("inline-start",t.layoutContext,t.clientLayout),v=this.getLimitValue("inline-end",t.layoutContext,t.clientLayout),E=t.vertical?t.originX:t.originY,b=t.vertical?t.originY:t.originX;function w(e,n){var i=e(t.bands,n);return i?(t.vertical&&(i=r.m(i)),g=t.vertical?Math.min(g,i.x2):Math.max(g,i.y1),m=t.vertical?Math.max(m,i.x1):Math.min(m,i.y2),!0):s}if(g=t.vertical?Math.min(g,t.left+t.getInsetLeft()+t.width+t.getInsetRight()+E):Math.max(g,t.top+E),m=t.vertical?Math.max(m,t.left+E):Math.min(m,t.top+t.getInsetTop()+t.height+t.getInsetBottom()+E),a){var N=t.vertical?r.i(new r.c(m,y,g,v)):new r.c(y,g,v,m);if(("block-start"===u||"snap-block"===u||"inline-start"===u)&&!w(r.g,N))return null;if(("block-end"===u||"snap-block"===u||"inline-end"===u)&&!w(r.f,N))return null;if(c=(f=(m-g)*t.getBoxDir())-t.getInsetBefore()-t.getInsetAfter(),p=(d=v-y)-t.getInsetStart()-t.getInsetEnd(),!s&&(c<=0||p<=0))return null}else{f=(c=t.computedBlockSize)+t.getInsetBefore()+t.getInsetAfter();var C=(m-g)*t.getBoxDir();if("snap-block"===u){if(null===o)u="block-start";else{var S=this.container.getPaddingRect();u=this.container.getBoxDir()*(o-(this.container.vertical?S.x2:S.y1))<=this.container.getBoxDir()*((this.container.vertical?S.x1:S.y2)-o-f)?"block-start":"block-end"}if(!l[u]){if(!l["block-end"])return null;u="block-end"}}if(!s&&C<f)return null;if(d=(p="inline-start"===u||"inline-end"===u?h.b(t.clientLayout,t.element,[h.a.FIT_CONTENT_INLINE_SIZE])[h.a.FIT_CONTENT_INLINE_SIZE]:t.adjustContentRelativeSize?t.getContentInlineSize():t.vertical?t.height:t.width)+t.getInsetStart()+t.getInsetEnd(),!s&&v-y<d)return null}switch(g-=E,m-=E,y-=b,v-=b,u){case"inline-start":case"block-start":case"snap-block":t.setInlinePosition(y,p),t.setBlockPosition(g,c);break;case"inline-end":case"block-end":t.setInlinePosition(v-d,p),t.setBlockPosition(m-f*t.getBoxDir(),c);break;default:throw new Error("unknown float direction: "+n)}return u},t.prototype.getFloatFragmentExclusions=function(){var t=this.floatFragments.map(function(t){return t.getOuterShape()});return this.parent?this.parent.getFloatFragmentExclusions().concat(t):t},t.prototype.reattachFloatFragments=function(){var t=this.container.element&&this.container.element.parentNode;t&&this.floatFragments.forEach(function(e){t.appendChild(e.area.element)})},t.prototype.getMaxReachedAfterEdge=function(){var t=this.getContainer().vertical;return this.floatFragments.reduce(function(e,n){var i=n.getOuterRect();return t?Math.min(e,i.x1):Math.max(e,i.y2)},t?1/0:0)},t.prototype.getBlockStartEdgeOfBlockEndFloats=function(){var t=this.getContainer().vertical;return this.floatFragments.filter(function(t){return"block-end"===t.floatSide}).reduce(function(e,n){var i=n.getOuterRect();return t?Math.max(e,i.x2):Math.min(e,i.y1)},t?0:1/0)},t.prototype.getPageFloatClearEdge=function(t,e){function n(t){return function(e){return t.isAnchorAlreadyAppeared(e.float.getId())}}function o(t,e){return t.continuations.some(n(e))}for(var r=e.getPaddingRect(),a=e.vertical?r.x1:r.y2,s=this;s;){if(s.floatsDeferredToNext.some(n(s)))return a;s=s.parent}i.a(e.clientLayout);var l=this.getLimitValue("block-start",e.layoutContext,e.clientLayout,o);return this.getLimitValue("block-end",e.layoutContext,e.clientLayout,o)*e.getBoxDir()<a*e.getBoxDir()?a:l},t.prototype.getPageFloatPlacementCondition=function(t,e,n){var i=this;if(t.floatReference!==this.floatReference)return this.getParent(t.floatReference).getPageFloatPlacementCondition(t,e,n);var o={"block-start":!0,"block-end":!0,"inline-start":!0,"inline-end":!0};if(!n)return o;var r,a=this.toLogical(e),s=this.toLogical(n);r="all"===s?["block-start","block-end","inline-start","inline-end"]:"both"===s?["inline-start","inline-end"]:"same"===s?"snap-block"===a?["block-start","block-end"]:[a]:[s];var l=t.getOrder();function u(t){return function(e){return e.floatSide===t&&e.getOrder()<l}}return r.forEach(function(t){switch(t){case"block-start":case"inline-start":o[t]=!function t(e,n){return e.children.some(function(e){return e.floatFragments.some(u(n))||t(e,n)})}(i,t);break;case"block-end":case"inline-end":o[t]=!function t(e,n){var i=e.parent;return!!i&&(i.floatFragments.some(u(n))||t(i,n))}(i,t);break;default:throw new Error("Unexpected side: "+t)}}),o},t.prototype.getLayoutConstraints=function(){return(this.parent?this.parent.getLayoutConstraints():[]).concat(this.layoutConstraints)},t.prototype.addLayoutConstraint=function(t,e){e===this.floatReference?this.layoutConstraints.push(t):this.getParent(e).addLayoutConstraint(t,e)},t.prototype.isColumnFullWithPageFloats=function(t){var e=t.layoutContext,n=t.clientLayout;i.a(n);for(var o=this,r=null;o&&o.container;){var a=o.getLimitValuesInner(e,n);r?t.vertical?(a.right<r.right&&(r.right=a.right,r.floatMinWrapBlockStart=a.floatMinWrapBlockStart),a.left>r.left&&(r.left=a.left,r.floatMinWrapBlockEnd=a.floatMinWrapBlockEnd)):(a.top>r.top&&(r.top=a.top,r.floatMinWrapBlockStart=a.floatMinWrapBlockStart),a.bottom<r.bottom&&(r.bottom=a.bottom,r.floatMinWrapBlockEnd=a.floatMinWrapBlockEnd)):r=a,o=o.parent}var s=Math.max(r.floatMinWrapBlockStart,r.floatMinWrapBlockEnd);return(t.vertical?r.right-r.left:r.bottom-r.top)<=s},t.prototype.getMaxBlockSizeOfPageFloats=function(){var t=this.getContainer().vertical;return this.floatFragments.length?Math.max.apply(null,this.floatFragments.map(function(e){var n=e.area;return t?n.width:n.height})):0},t.prototype.lock=function(){this.locked=!0},t.prototype.unlock=function(){this.locked=!1},t.prototype.isLocked=function(){return this.locked},t}(),C=[],S=function(){function t(){}return t.register=function(t){C.push(t)},t.prototype.findByNodeContext=function(t){for(var e=C.length-1;e>=0;e--){var n=C[e];if(n.appliesToNodeContext(t))return n}throw new Error("No PageFloatLayoutStrategy found for "+t)},t.prototype.findByFloat=function(t){for(var e=C.length-1;e>=0;e--){var n=C[e];if(n.appliesToFloat(t))return n}throw new Error("No PageFloatLayoutStrategy found for "+t)},t}(),T=function(){function t(){}return t.prototype.appliesToNodeContext=function(t){return y(t.floatReference)},t.prototype.appliesToFloat=function(t){return!0},t.prototype.createPageFloat=function(t,e,n){var o=t.floatReference;i.a(t.floatSide);var r=t.floatSide,a=t.toNodePosition();return n.resolveFloatReferenceFromColumnSpan(o,t.columnSpan,t).thenAsync(function(n){o=n,i.a(e.flowName);var s=new v(a,o,r,t.clearSide,e.flowName,t.floatMinWrapBlock);return e.addPageFloat(s),p.d(s)})},t.prototype.createPageFloatFragment=function(t,e,n,i){var o=t[0].float;return new b(o.floatReference,e,t,n,i)},t.prototype.findPageFloatFragment=function(t,e){return e.findPageFloatFragment(t)},t.prototype.adjustPageFloatArea=function(t,e,n){},t.prototype.forbid=function(t,e){},t}();S.register(new T)},function(t,e,n){n.d(e,"c",function(){return a}),n.d(e,"b",function(){return l}),n.d(e,"d",function(){return u}),n.d(e,"a",function(){return c}),n.d(e,"e",function(){return h});var i=n(0),o=n(9),r={page:!0,left:!0,right:!0,recto:!0,verso:!0,column:!0,region:!0};function a(t){return!!r[t]}var s={avoid:!0,"avoid-page":!0,"avoid-column":!0,"avoid-region":!0};function l(t){return!!s[t]}function u(t,e){if(!t)return e;if(!e)return t;var n=a(t),i=a(e);if(!n||!i)return i?e:n?t:l(e)?e:l(t)?t:e;switch(e){case"column":return t;case"region":return"column"===t?e:t;default:return e}}function c(t){switch(t){case"left":case"right":case"recto":case"verso":return t;default:return"any"}}function h(t){switch(t){case"left":case"right":case"recto":case"verso":return t;default:return null}}o.c.registerHook("SIMPLE_PROPERTY",function(t){var e=t.name,n=t.value;switch(e){case"page-break-before":case"page-break-after":case"page-break-inside":return{name:e.replace(/^page-/,""),value:n===i.t.always?i.t.page:n,important:t.important};default:return t}})},function(t,e,n){n.d(e,"a",function(){return a}),n.d(e,"b",function(){return s}),n.d(e,"c",function(){return l}),n.d(e,"f",function(){return u}),n.d(e,"d",function(){return c}),n.d(e,"e",function(){return h});var i=n(1),o=n(6),r=n(8);function a(t,e,n,r){var a=t.viewNode;if(!a)return NaN;if(1==a.nodeType){if(t.after||!t.inline){var s=e.getElementClientRect(a);if(s.right>=s.left&&s.bottom>=s.top)return t.after?r?s.left:s.bottom:r?s.right:s.top}return NaN}var l=NaN,u=a.ownerDocument.createRange(),c=a.textContent.length;if(!c)return NaN;t.after&&(n+=c),n>=c&&(n=c-1),u.setStart(a,n),u.setEnd(a,n+1);var h=e.getRangeClientRects(u);r&&i.m(document.body)&&(h=function(t,e,n){var i=n.ownerDocument.createRange();i.setStart(n,0),i.setEnd(n,n.textContent.length);for(var r=t.getRangeClientRects(i),a=[],s=0,l=e;s<l.length;s++){var u=l[s],c=void 0;for(c=0;c<r.length;c++){var h=r[c];if(u.top>=h.top&&u.bottom<=h.bottom&&Math.abs(u.left-h.left)<1){a.push({top:u.top,left:h.left,bottom:u.bottom,right:h.right});break}}c==r.length&&(o.b.warn("Could not fix character box"),a.push(u))}return a}(e,h,a));for(var p=0,f=0,d=h;f<d.length;f++){var g=d[f],m=r?g.bottom-g.top:g.right-g.left;g.right>g.left&&g.bottom>g.top&&(isNaN(l)||m>p)&&(l=r?g.left:g.bottom,p=m)}return l}function s(t,e,n){var i=e.clientLayout.getElementClientRect(t),o=e.getComputedMargin(t);return n?i.width+o.left+o.right:i.height+o.top+o.bottom}function l(t){for(;t;){if(t.parentNode===t.ownerDocument)return!1;t=t.parentNode}return!0}function u(t,e){if(t)for(var n;(n=t.lastChild)!=e;)t.removeChild(n)}function c(t){return!!t.getAttribute(r.m)}function h(t){if(!t)return!1;var e=t.viewNode;return!(!e||1!==e.nodeType)&&c(e)}},function(t,e,n){var i,o,r,a,s,l;n.d(e,"a",function(){return i}),n.d(e,"b",function(){return o}),n.d(e,"d",function(){return r}),n.d(e,"c",function(){return a}),n.d(e,"e",function(){return s}),n.d(e,"f",function(){return l}),(i||(i={})).isInstanceOfBlockFormattingContext=function(t){return t&&"Block"===t.formattingContextType},function(t){!function(t){t.INLINE="inline",t.COLUMN="column",t.REGION="region",t.PAGE="page"}(t.FloatReference||(t.FloatReference={}))}(o||(o={})),(r||(r={})).isInstanceOfAfterIfContinuesLayoutConstraint=function(t){return t&&"AfterIfContinue"==t.flagmentLayoutConstraintType},function(t){t.isInstanceOfRepetitiveElementsOwnerFormattingContext=function(t){return!!t&&("RepetitiveElementsOwner"===t.formattingContextType||s.isInstanceOfTableFormattingContext(t))},t.isInstanceOfRepetitiveElementsOwnerLayoutConstraint=function(t){return!!t&&("RepetitiveElementsOwner"===t.flagmentLayoutConstraintType||s.isInstanceOfTableRowLayoutConstraint(t))}}(a||(a={})),function(t){t.isInstanceOfTableFormattingContext=function(t){return t&&"Table"===t.formattingContextType},t.isInstanceOfTableRowLayoutConstraint=function(t){return t&&"TableRow"===t.flagmentLayoutConstraintType}}(s||(s={})),function(t){!function(t){t[t.IGNORE=0]="IGNORE",t[t.NEWLINE=1]="NEWLINE",t[t.PRESERVE=2]="PRESERVE"}(t.Whitespace||(t.Whitespace={})),function(t){t[t.NONE=0]="NONE",t[t.CONTENT=1]="CONTENT",t[t.ROOTLESS=2]="ROOTLESS",t[t.ROOTED=3]="ROOTED"}(t.ShadowType||(t.ShadowType={}))}(l||(l={}))},function(t,e,n){var i,o=n(1),r=n(6),a=n(3),s=n(17);function l(t,e,n,o,s){var l=a.c("ajax"),c=new XMLHttpRequest,h=l.suspend(c),p={status:0,statusText:"",url:t,contentType:null,responseText:null,responseXML:null,responseBlob:null};c.open(n||"GET",t,!0),e&&(c.responseType=e),c.onreadystatechange=function(){if(4===c.readyState){if(p.status=c.status,p.statusText=c.statusText||404==c.status&&"Not Found"||"",200==p.status||0==p.status)if(e&&e!==i.DOCUMENT||!c.responseXML||"parsererror"==c.responseXML.documentElement.localName)if((!e||e===i.DOCUMENT)&&c.response instanceof HTMLDocument)p.responseXML=c.response,p.contentType=c.response.contentType;else{var n=c.response;e&&e!==i.TEXT||"string"!=typeof n?n?p.responseBlob="string"==typeof n?u([n]):n:r.b.warn("Unexpected empty success response for",t):p.responseText=n;var o=c.getResponseHeader("Content-Type");o&&(p.contentType=o.replace(/(.*);.*$/,"$1"))}else p.responseXML=c.responseXML,p.contentType=c.responseXML.contentType;h.schedule(p)}};try{o?(c.setRequestHeader("Content-Type",s||"text/plain; charset=UTF-8"),c.send(o)):(/^file:|^https?:\/\/[^\/]+\.githubusercontent\.com|\.opf$/.test(t)?/\/aozorabunko\/[^\/]+\/cards\/[^\/]+\/files\/[^\/.]+\.html$/.test(t)?c.overrideMimeType("text/html; charset=Shift_JIS"):/\.(html|htm)$/.test(t)?c.overrideMimeType("text/html; charset=UTF-8"):/\.(xhtml|xht|xml|opf)$/.test(t)?c.overrideMimeType("application/xml; charset=UTF-8"):/\.(txt|css)$/.test(t)?c.overrideMimeType("text/plain; charset=UTF-8"):c.overrideMimeType("text/html; charset=UTF-8"):/^data:,(<|%3C|%3c)/.test(t)?c.overrideMimeType("text/html; charset=UTF-8"):/^data:,/.test(t)&&c.overrideMimeType("text/plain; charset=UTF-8"),c.send(null))}catch(e){r.b.warn(e,"Error fetching "+t),h.schedule(p)}return l.result()}function u(t,e){var n=e||"application/octet-stream",i=window.WebKitBlobBuilder||window.MSBlobBuilder;if(i){for(var o=new i,r=0;r<t.length;r++)o.append(t[r]);return o.getBlob(n)}return new Blob(t,{type:n})}function c(t){var e=a.c("readBlob"),n=new FileReader,i=e.suspend(n);return n.addEventListener("load",function(){i.schedule(n.result)},!1),n.readAsArrayBuffer(t),e.result()}function h(t){return(window.URL||window.webkitURL).createObjectURL(t)}n.d(e,"b",function(){return i}),n.d(e,"c",function(){return l}),n.d(e,"e",function(){return u}),n.d(e,"g",function(){return c}),n.d(e,"d",function(){return h}),n.d(e,"a",function(){return p}),n.d(e,"f",function(){return d}),function(t){t.DEFAULT="",t.ARRAYBUFFER="arraybuffer",t.BLOB="blob",t.DOCUMENT="document",t.JSON="json",t.TEXT="text"}(i||(i={}));var p=function(){function t(t,e){this.parser=t,this.type=e,this.resources={},this.fetchers={}}return t.prototype.load=function(t,e,n){t=o.I(t);var i=this.resources[t];return void 0!==i?a.d(i):this.fetch(t,e,n).get()},t.prototype.fetchInner=function(t,e,n){var i=this,r=a.c("fetch"),s=t.endsWith("?viv-toc-box");s&&(t=t.replace("?viv-toc-box",""));var u=o.C("user-agent.xml",o.D),c=!s&&t===u;return c&&(t="data:application/xml,"+encodeURIComponent('<!DOCTYPE html>\n<html xmlns="http://www.w3.org/1999/xhtml" xmlns:s="http://www.pyroxy.com/ns/shadow">\n<head>\n<style><![CDATA[\n\n.footnote-content {\n  float: footnote;\n}\n\n.table-cell-container {\n  display: block;\n}\n\n]]></style>\n</head>\n<body>\n\n<s:template id="footnote"><s:content/><s:include class="footnote-content"/></s:template>\n\n<s:template id="table-cell"><div data-vivliostyle-flow-root="true" class="table-cell-container"><s:content/></div></s:template>\n\n</body>\n</html>\n')),l(t,i.type).then(function(o){if(o.status>=400&&e)throw new Error((n||"Failed to fetch required resource: "+t)+" ("+o.status+(o.statusText?" "+o.statusText:"")+")");s?(t+="?viv-toc-box",o.url+="?viv-toc-box"):c&&(o.url=t=u),i.parser(o,i).then(function(e){delete i.fetchers[t],i.resources[t]=e,r.finish(e)})}),r.result()},t.prototype.fetch=function(t,e,n){if(t=o.I(t),this.resources[t])return null;var i=this.fetchers[t];if(!i){var r=this;i=new s.a(function(){return r.fetchInner(t,e,n)},"Fetch "+t),r.fetchers[t]=i,i.start()}return i},t.prototype.get=function(t){return this.resources[o.I(t)]},t.prototype.delete=function(t){delete this.resources[o.I(t)]},t}();function f(t,e){var n=t.responseText;return a.d(n?o.H(n):null)}function d(){return new p(f,i.TEXT)}},function(t,e,n){n.d(e,"a",function(){return a}),n.d(e,"c",function(){return s}),n.d(e,"b",function(){return l});var i=n(1),o=n(6),r=n(3),a=function(){function t(t,e){this.fetch=t,this.arrived=!1,this.resource=null,this.task=null,this.piggybacks=[],this.name=e}return t.prototype.start=function(){if(!this.task){var t=this;this.task=r.a().getScheduler().run(function(){var e=r.c("Fetcher.run");return t.fetch().then(function(n){var i=t.piggybacks;if(t.arrived=!0,t.resource=n,t.task=null,t.piggybacks=[],i)for(var r=0;r<i.length;r++)try{i[r](n)}catch(t){o.b.error(t,"Error:")}e.finish(n)}),e.result()},this.name)}},t.prototype.piggyback=function(t){this.arrived?t(this.resource):this.piggybacks.push(t)},t.prototype.get=function(){return this.arrived?r.d(this.resource):(this.start(),this.task.join())},t.prototype.hasArrived=function(){return this.arrived},t}(),s=function(t){if(0==t.length)return r.d(!0);if(1==t.length)return t[0].get().thenReturn(!0);var e=r.c("waitForFetches"),n=0;return e.loop(function(){for(;n<t.length;){var e=t[n++];if(!e.hasArrived())return e.get().thenReturn(!0)}return r.d(!1)}).then(function(){e.finish(!0)}),e.result()};function l(t,e){var n=null,o=null;"img"==t.localName&&(n=t.getAttribute("width"),o=t.getAttribute("height"));var s=new a(function(){var a=r.c("loadImage"),s=a.suspend(t),l=!1,u=function(e){l||(l=!0,"img"==t.localName&&(n||t.removeAttribute("width"),o||t.removeAttribute("height")),s.schedule(e?e.type:"timeout"))};return t.addEventListener("load",u,!1),t.addEventListener("error",u,!1),t.addEventListener("abort",u,!1),t.namespaceURI==i.a.SVG?(t.setAttributeNS(i.a.XLINK,"xlink:href",e),setTimeout(u,300)):t.src=e,a.result()},"loadElement "+e);return s.start(),s}},function(t,e,n){n.d(e,"c",function(){return u}),n.d(e,"b",function(){return c}),n.d(e,"a",function(){return h}),n.d(e,"d",function(){return p}),n.d(e,"e",function(){return f});var i=n(22),o=n(24),r=n(14),a=n(9),s=n(3),l=n(15),u=function(){function t(){}return t.prototype.find=function(t){for(var e=a.b(a.a.RESOLVE_LAYOUT_PROCESSOR),n=0;n<e.length;n++){var i=e[n](t);if(i)return i}throw new Error("No processor found for a formatting context: "+t.getName())},t}(),c=function(){function t(){}return t.prototype.layout=function(t,e,n){return e.isFloatNodeContext(t)?e.layoutFloatOrFootnote(t):e.isBreakable(t)?e.layoutBreakableBlock(t):e.layoutUnbreakable(t)},t.prototype.createEdgeBreakPosition=function(t,e,n,o){return new i.b(t.copy(),e,n,o)},t.prototype.startNonInlineElementNode=function(t){return!1},t.prototype.afterNonInlineElementNode=function(t,e){return!1},t.prototype.clearOverflownViewNodes=function(t,e,n,i){if(n.viewNode&&n.viewNode.parentNode){var o=n.viewNode.parentNode;r.f(o,n.viewNode),i&&o.removeChild(n.viewNode)}},t.prototype.finishBreak=function(t,e,n,i){var o=n||null!=e.viewNode&&1==e.viewNode.nodeType&&!e.after;return t.clearOverflownViewNodes(e,o),i&&(t.fixJustificationIfNeeded(e,!0),t.layoutContext.processFragmentedBlockEdge(o?e:e.parent)),s.d(!0)},t}(),h=function(){function t(t){this.parent=t,this.formattingContextType="Block"}return t.prototype.getName=function(){return"Block formatting context (BlockFormattingContext)"},t.prototype.isFirstTime=function(t,e){return e},t.prototype.getParent=function(){return this.parent},t.prototype.saveState=function(){},t.prototype.restoreState=function(t){},t}(),p=new c,f=l.a.isInstanceOfBlockFormattingContext;a.d(a.a.RESOLVE_FORMATTING_CONTEXT,function(t,e,n,i,r,a){var s=t.parent;return!s&&t.formattingContext?null:s&&t.formattingContext!==s.formattingContext?null:t.establishesBFC||!t.formattingContext&&o.d(n,i,r,a)?new h(s?s.formattingContext:null):null}),a.d(a.a.RESOLVE_LAYOUT_PROCESSOR,function(t){return t instanceof h?p:null})},function(t,e,n){n.d(e,"a",function(){return i}),n.d(e,"b",function(){return r});var i,o=n(1);function r(t,e,n){var r={display:e.style.display,position:e.style.position,width:e.style.width,maxWidth:e.style.maxWidth,minWidth:e.style.minWidth,height:e.style.height,maxHeight:e.style.maxHeight,minHeight:e.style.minHeight},a=e.ownerDocument,s=e.parentNode,l=a.createElement("div");function u(n){return t.getElementComputedStyle(e).getPropertyValue(n)}o.F(l,"position",r.position),s.insertBefore(l,e),l.appendChild(e),o.F(e,"width","auto"),o.F(e,"max-width","none"),o.F(e,"min-width","0"),o.F(e,"height","auto"),o.F(e,"max-height","none"),o.F(e,"min-height","0");var c=o.v("writing-mode"),h=(c?u(c[0]):null)||u("writing-mode"),p="vertical-rl"===h||"tb-rl"===h||"vertical-lr"===h||"tb-lr"===h,f=p?"height":"width",d=p?"width":"height";function g(){return o.F(e,"display","block"),o.F(e,"position","static"),u(f)}function m(){o.F(e,"display","inline-block"),o.F(l,f,"99999999px");var t=u(f);return o.F(l,f,""),t}function y(){o.F(e,"display","inline-block"),o.F(l,f,"0");var t=u(f);return o.F(l,f,""),t}function v(){var t=g(),e=y(),n=parseFloat(t);if(n<=parseFloat(e))return e;var i=m();return n<=parseFloat(i)?t:i}function E(){return u(d)}function b(){throw new Error("Getting fill-available block size is not implemented")}var w={};return n.forEach(function(t){var n;switch(t){case i.FILL_AVAILABLE_INLINE_SIZE:n=g();break;case i.MAX_CONTENT_INLINE_SIZE:n=m();break;case i.MIN_CONTENT_INLINE_SIZE:n=y();break;case i.FIT_CONTENT_INLINE_SIZE:n=v();break;case i.FILL_AVAILABLE_BLOCK_SIZE:n=b();break;case i.MAX_CONTENT_BLOCK_SIZE:case i.MIN_CONTENT_BLOCK_SIZE:case i.FIT_CONTENT_BLOCK_SIZE:n=E();break;case i.FILL_AVAILABLE_WIDTH:n=p?b():g();break;case i.FILL_AVAILABLE_HEIGHT:n=p?g():b();break;case i.MAX_CONTENT_WIDTH:n=p?E():m();break;case i.MAX_CONTENT_HEIGHT:n=p?m():E();break;case i.MIN_CONTENT_WIDTH:n=p?E():y();break;case i.MIN_CONTENT_HEIGHT:n=p?y():E();break;case i.FIT_CONTENT_WIDTH:n=p?E():v();break;case i.FIT_CONTENT_HEIGHT:n=p?v():E()}w[t]=parseFloat(n),o.F(e,"position",r.position),o.F(e,"display",r.display)}),o.F(e,"width",r.width),o.F(e,"max-width",r.maxWidth),o.F(e,"min-width",r.minWidth),o.F(e,"height",r.height),o.F(e,"max-height",r.maxHeight),o.F(e,"min-height",r.minHeight),s.insertBefore(e,l),s.removeChild(l),w}!function(t){t.FILL_AVAILABLE_INLINE_SIZE="fill-available inline size",t.FILL_AVAILABLE_BLOCK_SIZE="fill-available block size",t.FILL_AVAILABLE_WIDTH="fill-available width",t.FILL_AVAILABLE_HEIGHT="fill-available height",t.MAX_CONTENT_INLINE_SIZE="max-content inline size",t.MAX_CONTENT_BLOCK_SIZE="max-content block size",t.MAX_CONTENT_WIDTH="max-content width",t.MAX_CONTENT_HEIGHT="max-content height",t.MIN_CONTENT_INLINE_SIZE="min-content inline size",t.MIN_CONTENT_BLOCK_SIZE="min-content block size",t.MIN_CONTENT_WIDTH="min-content width",t.MIN_CONTENT_HEIGHT="min-content height",t.FIT_CONTENT_INLINE_SIZE="fit-content inline size",t.FIT_CONTENT_BLOCK_SIZE="fit-content block size",t.FIT_CONTENT_WIDTH="fit-content width",t.FIT_CONTENT_HEIGHT="fit-content height"}(i||(i={}))},function(t,e,n){n.d(e,"d",function(){return u}),n.d(e,"c",function(){return h}),n.d(e,"e",function(){return f}),n.d(e,"b",function(){return g}),n.d(e,"a",function(){return m});var i,o=n(0),r=n(11),a=n(6),s=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),l=function(t){function e(){var e=t.call(this)||this;return e.propSet={},e}return s(e,t),e.prototype.visitIdent=function(t){return this.propSet[t.name]=!0,t},e.prototype.visitSpaceList=function(t){return this.visitValues(t.values),t},e}(o.m);function u(t){if(t){var e=new l;try{return t.visit(e),e.propSet}catch(t){a.b.warn(t,"toSet:")}}return{}}var c=function(t){function e(e){var n=t.call(this)||this;return n.value=e,n}return s(e,t),e.prototype.visitInt=function(t){return this.value=t.num,t},e}(o.m);function h(t,e){if(t){var n=new c(e);try{return t.visit(n),n.value}catch(t){a.b.warn(t,"toInt: ")}}return e}var p=function(t){function e(){var e=t.call(this)||this;return e.collect=!1,e.coords=[],e.name=null,e}return s(e,t),e.prototype.visitNumeric=function(t){return this.collect&&this.coords.push(t),null},e.prototype.visitNum=function(t){return this.collect&&0==t.num&&this.coords.push(new o.i(0,"px")),null},e.prototype.visitSpaceList=function(t){return this.visitValues(t.values),null},e.prototype.visitFunc=function(t){return this.collect||(this.collect=!0,this.visitValues(t.values),this.collect=!1,this.name=t.name.toLowerCase()),null},e.prototype.getShape=function(t,e,n,i,o){var a=this;if(this.coords.length>0){var s=[];switch(this.coords.forEach(function(t,e){if("%"==t.unit){var r=e%2==0?n:i;3==e&&"circle"==a.name&&(r=Math.sqrt((n*n+i*i)/2)),s.push(t.num*r/100)}else s.push(t.num*o.queryUnitSize(t.unit,!1))}),this.name){case"polygon":if(s.length%2==0){for(var l=[],u=0;u<s.length;u+=2)l.push(new r.b(t+s[u],e+s[u+1]));return new r.d(l)}break;case"rectangle":if(4==s.length)return r.k(t+s[0],e+s[1],t+s[0]+s[2],e+s[1]+s[3]);break;case"ellipse":if(4==s.length)return r.j(t+s[0],e+s[1],s[2],s[3]);break;case"circle":if(3==s.length)return r.j(t+s[0],e+s[1],s[2],s[2])}}return null},e}(o.m);function f(t,e,n,i,o,s){if(t){var l=new p;try{return t.visit(l),l.getShape(e,n,i,o,s)}catch(t){a.b.warn(t,"toShape:")}}return r.k(e,n,e+i,n+o)}var d=function(t){function e(e){var n=t.call(this)||this;return n.reset=e,n.counters={},n.name=null,n}return s(e,t),e.prototype.visitIdent=function(t){return this.name=t.toString(),this.reset?this.counters[this.name]=0:this.counters[this.name]=(this.counters[this.name]||0)+1,t},e.prototype.visitInt=function(t){return this.name&&(this.counters[this.name]+=t.num-(this.reset?0:1)),t},e.prototype.visitSpaceList=function(t){return this.visitValues(t.values),t},e}(o.m);function g(t,e){var n=new d(e);try{t.visit(n)}catch(t){a.b.warn(t,"toCounters:")}return n.counters}var m=function(t){function e(e,n){var i=t.call(this)||this;return i.baseUrl=e,i.transformer=n,i}return s(e,t),e.prototype.visitURL=function(t){return new o.l(this.transformer.transformURL(t.url,this.baseUrl))},e}(o.d)},function(t,e,n){n.d(e,"c",function(){return s}),n.d(e,"e",function(){return l}),n.d(e,"a",function(){return u}),n.d(e,"d",function(){return c}),n.d(e,"f",function(){return h}),n.d(e,"b",function(){return p});var i=n(1),o=n(0),r=n(5),a=n(8),s=(new DOMParser).parseFromString('<root xmlns="'+i.a.SHADOW+'"/>',"text/xml"),l=["footnote-marker","first-5-lines","first-4-lines","first-3-lines","first-2-lines","first-line","first-letter","before","","after"],u="data-adapt-pseudo";function c(t){return t.getAttribute(u)||""}function h(t,e){t.setAttribute(u,e)}var p=function(){function t(t,e,n,i,o){this.element=t,this.style=e,this.styler=n,this.context=i,this.exprContentListener=o,this.contentProcessed={}}return t.prototype.getStyle=function(t,e){var n=c(t);this.styler&&n&&n.match(/after$/)&&(this.style=this.styler.getStyle(this.element,!0),this.styler=null);var i=r.u(this.style,"_pseudos")[n]||{};if(n.match(/^first-/)&&!i["x-first-pseudo"]){var a=1,s=void 0;"first-letter"==n?a=0:null!=(s=n.match(/^first-([0-9]+)-lines$/))&&(a=s[1]-0),i["x-first-pseudo"]=new r.c(new o.g(a),0)}return i},t.prototype.processContent=function(t,e){var n=c(t);if(!this.contentProcessed[n]){this.contentProcessed[n]=!0;var i=e.content;i&&a.y(i)&&i.visit(new a.c(t,this.context,i,this.exprContentListener))}},t}()},function(t,e,n){n.d(e,"a",function(){return l}),n.d(e,"c",function(){return u}),n.d(e,"b",function(){return c});var i,o=n(13),r=n(14),a=n(15),s=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),l=function(){function t(){}return t.prototype.calculateOffset=function(t){return u(this.getNodeContext(),t.collectElementsOffset())},t.prototype.breakPositionChosen=function(t){},t.prototype.getNodeContext=function(){return null},t}();function u(t,e){return{current:e.reduce(function(e,n){return e+n.calculateOffset(t)},0),minimum:e.reduce(function(e,n){return e+n.calculateMinimumOffset(t)},0)}}var c=function(t){function e(e,n,i,o){var r=t.call(this)||this;return r.position=e,r.breakOnEdge=n,r.overflows=i,r.computedBlockSize=o,r.isEdgeUpdated=!1,r.edge=0,r.overflowIfRepetitiveElementsDropped=i,r}return s(e,t),e.prototype.findAcceptableBreak=function(t,e){return this.updateOverflows(t),e<this.getMinBreakPenalty()?null:t.findEdgeBreakPosition(this)},e.prototype.getMinBreakPenalty=function(){if(!this.isEdgeUpdated)throw new Error("EdgeBreakPosition.prototype.updateEdge not called");var t=this.isFirstContentOfRepetitiveElementsOwner()&&!this.overflowIfRepetitiveElementsDropped;return(o.b(this.breakOnEdge)?1:0)+(this.overflows&&!t?3:0)+(this.position.parent?this.position.parent.breakPenalty:0)},e.prototype.updateEdge=function(t){var e=t.calculateClonedPaddingBorder(this.position);this.edge=r.a(this.position,t.clientLayout,0,t.vertical)+e,this.isEdgeUpdated=!0},e.prototype.updateOverflows=function(t){this.isEdgeUpdated||this.updateEdge(t);var e=this.edge,n=this.calculateOffset(t);this.overflowIfRepetitiveElementsDropped=t.isOverflown(e+(t.vertical?-1:1)*n.minimum),this.overflows=this.position.overflow=t.isOverflown(e+(t.vertical?-1:1)*n.current)},e.prototype.getNodeContext=function(){return this.position},e.prototype.isFirstContentOfRepetitiveElementsOwner=function(){var t=this.getNodeContext();if(!t||!t.parent)return!1;var e=t.parent.formattingContext;if(!a.c.isInstanceOfRepetitiveElementsOwnerFormattingContext(e))return!1;var n=e.getRepetitiveElements();return!!n&&n.isFirstContentNode(t)},e}(l)},function(t,e,n){n.r(e),n.d(e,"LayoutIteratorStrategy",function(){return c}),n.d(e,"LayoutIterator",function(){return h}),n.d(e,"EdgeSkipper",function(){return p}),n.d(e,"PseudoColumn",function(){return f});var i,o=n(13),r=n(22),a=n(30),s=n(3),l=n(8),u=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),c=function(){function t(){}return t.prototype.initialState=function(t){return{nodeContext:t,atUnforcedBreak:!1,break:!1}},t.prototype.startNonDisplayableNode=function(t){},t.prototype.afterNonDisplayableNode=function(t){},t.prototype.startIgnoredTextNode=function(t){},t.prototype.afterIgnoredTextNode=function(t){},t.prototype.startNonElementNode=function(t){},t.prototype.afterNonElementNode=function(t){},t.prototype.startInlineElementNode=function(t){},t.prototype.afterInlineElementNode=function(t){},t.prototype.startNonInlineElementNode=function(t){},t.prototype.afterNonInlineElementNode=function(t){},t.prototype.finish=function(t){},t}(),h=function(){function t(t,e){this.strategy=t,this.layoutContext=e}return t.prototype.iterate=function(t){var e=this,n=this.strategy,i=n.initialState(t),o=s.c("LayoutIterator");return o.loopWithFrame(function(t){for(var o;i.nodeContext;){var r=((o=i.nodeContext.viewNode?1!==i.nodeContext.viewNode.nodeType?l.p(i.nodeContext.viewNode,i.nodeContext.whitespace)?i.nodeContext.after?n.afterIgnoredTextNode(i):n.startIgnoredTextNode(i):i.nodeContext.after?n.afterNonElementNode(i):n.startNonElementNode(i):i.nodeContext.inline?i.nodeContext.after?n.afterInlineElementNode(i):n.startInlineElementNode(i):i.nodeContext.after?n.afterNonInlineElementNode(i):n.startNonInlineElementNode(i):i.nodeContext.after?n.afterNonDisplayableNode(i):n.startNonDisplayableNode(i))&&o.isPending()?o:s.d(!0)).thenAsync(function(){return i.break?s.d(null):e.layoutContext.nextInTree(i.nodeContext,i.atUnforcedBreak)});if(r.isPending())return void r.then(function(e){i.break?t.breakLoop():(i.nodeContext=e,t.continueLoop())});if(i.break)return void t.breakLoop();i.nodeContext=r.get()}n.finish(i),t.breakLoop()}).then(function(){o.finish(i.nodeContext)}),o.result()},t}(),p=function(t){function e(e){var n=t.call(this)||this;return n.leadingEdge=e,n}return u(e,t),e.prototype.startNonInlineBox=function(t){},e.prototype.endEmptyNonInlineBox=function(t){},e.prototype.endNonInlineBox=function(t){},e.prototype.initialState=function(t){return{nodeContext:t,atUnforcedBreak:!!this.leadingEdge&&t.after,break:!1,leadingEdge:this.leadingEdge,breakAtTheEdge:null,onStartEdges:!1,leadingEdgeContexts:[],lastAfterNodeContext:null}},e.prototype.processForcedBreak=function(t,e){var n=!t.leadingEdge&&o.c(t.breakAtTheEdge);if(n){var i=t.nodeContext=t.leadingEdgeContexts[0]||t.nodeContext;i.viewNode.parentNode.removeChild(i.viewNode),e.pageBreakType=t.breakAtTheEdge}return n},e.prototype.saveEdgeAndProcessOverflow=function(t,e){var n=e.checkOverflowAndSaveEdgeAndBreakPosition(t.lastAfterNodeContext,null,!0,t.breakAtTheEdge);return n&&(t.nodeContext=(t.lastAfterNodeContext||t.nodeContext).modify(),t.nodeContext.overflow=!0),n},e.prototype.processLayoutConstraint=function(t,e,n){var i=t.nodeContext,o=!e.allowLayout(i);return o&&(n.checkOverflowAndSaveEdgeAndBreakPosition(t.lastAfterNodeContext,null,!1,t.breakAtTheEdge),(i=t.nodeContext=i.modify()).overflow=!0),o},e.prototype.startNonElementNode=function(t){t.onStartEdges=!1},e.prototype.startNonInlineElementNode=function(t){return t.leadingEdgeContexts.push(t.nodeContext.copy()),t.breakAtTheEdge=o.d(t.breakAtTheEdge,t.nodeContext.breakBefore),t.onStartEdges=!0,this.startNonInlineBox(t)},e.prototype.afterNonInlineElementNode=function(t){var e;return(t.onStartEdges?((e=this.endEmptyNonInlineBox(t))&&e.isPending()?e:s.d(!0)).thenAsync(function(){return t.break||(t.leadingEdgeContexts=[],t.leadingEdge=!1,t.atUnforcedBreak=!1,t.breakAtTheEdge=null),s.d(!0)}):(e=this.endNonInlineBox(t))&&e.isPending()?e:s.d(!0)).thenAsync(function(){return t.break||(t.onStartEdges=!1,t.lastAfterNodeContext=t.nodeContext.copy(),t.breakAtTheEdge=o.d(t.breakAtTheEdge,t.nodeContext.breakAfter)),s.d(!0)})},e}(c),f=function(){function t(t,e,n){this.startNodeContexts=[],this.column=Object.create(t),this.column.element=e,this.column.layoutContext=t.layoutContext.clone(),this.column.stopAtOverflow=!1,this.column.flowRootFormattingContext=n.formattingContext,this.column.pseudoParent=t;var i=this.column.calculateClonedPaddingBorder(n);this.column.footnoteEdge=this.column.footnoteEdge-i;var o=this;this.column.openAllViews=function(t){return a.b.prototype.openAllViews.call(this,t).thenAsync(function(t){return o.startNodeContexts.push(t.copy()),s.d(t)})}}return t.prototype.layout=function(t,e){return this.column.layout(t,e)},t.prototype.findAcceptableBreakPosition=function(t){var e=this.column.findAcceptableBreakPosition();if(t){var n=this.startNodeContexts[0].copy(),i=new r.b(n,null,n.overflow,0);if(i.findAcceptableBreak(this.column,0),!e.nodeContext)return{breakPosition:i,nodeContext:n}}return e},t.prototype.finishBreak=function(t,e,n){return this.column.finishBreak(t,e,n)},t.prototype.doFinishBreakOfFragmentLayoutConstraints=function(t){this.column.doFinishBreakOfFragmentLayoutConstraints(t)},t.prototype.isStartNodeContext=function(t){var e=this.startNodeContexts[0];return e.viewNode===t.viewNode&&e.after===t.after&&e.offsetInNode===t.offsetInNode},t.prototype.isLastAfterNodeContext=function(t){return l.u(t.toNodePosition(),this.column.lastAfterPosition)},t.prototype.getColumnElement=function(){return this.column.element},t.prototype.getColumn=function(){return this.column},t}()},function(t,e,n){n.d(e,"e",function(){return r}),n.d(e,"c",function(){return l}),n.d(e,"d",function(){return u}),n.d(e,"f",function(){return c}),n.d(e,"g",function(){return h}),n.d(e,"a",function(){return p}),n.d(e,"b",function(){return f});var i=n(0),o="data-vivliostyle-flow-root";function r(t){return"true"===t.getAttribute(o)}function a(t){var e,n=t.toString();switch(n){case"inline-flex":e="flex";break;case"inline-grid":e="grid";break;case"inline-table":e="table";break;case"inline":case"table-row-group":case"table-column":case"table-column-group":case"table-header-group":case"table-footer-group":case"table-row":case"table-cell":case"table-caption":case"inline-block":e="block";break;default:e=n}return i.r(e)}function s(t){return t===i.t.absolute||t===i.t.fixed}function l(t,e,n,o){return t===i.t.none||(s(e)?(n=i.t.none,t=a(t)):(n&&n!==i.t.none||o)&&(t=a(t))),{display:t,position:e,float:n}}function u(t,e,n,o){return l(t,e,n,o).display===i.t.block}function c(t){switch(t.toString()){case"inline":case"inline-block":case"inline-list-item":case"inline-flex":case"inline-grid":case"ruby":case"inline-table":return!0;default:return!1}}function h(t){switch(t.toString()){case"ruby-base":case"ruby-text":case"ruby-base-container":case"ruby-text-container":return!0;default:return!1}}function p(t,e,n,o,r,a,l){return r=r||a||i.t.horizontal_tb,!!l||!!n&&n!==i.t.none||s(e)||t===i.t.inline_block||t===i.t.table_cell||t===i.t.table_caption||t==i.t.flex||(t===i.t.block||t===i.t.list_item)&&!!o&&o!==i.t.visible||!!a&&r!==a}function f(t){return t===i.t.relative||t===i.t.absolute||t===i.t.fixed}},function(t,e,n){n.d(e,"c",function(){return o}),n.d(e,"b",function(){return s}),n.d(e,"a",function(){return l});var i=n(7);function o(t,e,n){return t-=n,0===e?0===t:t%e==0&&t/e>=0}var r=function(){function t(t){this.matchers=t}return t.prototype.matches=function(){return this.matchers.some(function(t){return t.matches()})},t}(),a=function(){function t(t){this.matchers=t}return t.prototype.matches=function(){return this.matchers.every(function(t){return t.matches()})},t}(),s=function(){function t(t,e,n){this.elementOffset=t,this.a=e,this.b=n}return t.registerFragmentIndex=function(e,n,i){var o=t.fragmentIndices;(!o[e]||o[e].priority<=i)&&(o[e]={fragmentIndex:n,priority:i})},t.clearFragmentIndices=function(){t.fragmentIndices={}},t.prototype.matches=function(){var e=t.fragmentIndices[this.elementOffset];return null!=e&&null!=e.fragmentIndex&&o(e.fragmentIndex,this.a,this.b)},t.fragmentIndices={},t}(),l=function(){function t(){}return t.buildViewConditionMatcher=function(t,e){var n=e.split("_");return"NFS"==n[0]?new s(t,parseInt(n[1],10),parseInt(n[2],10)):(i.b("unknown view condition. condition="+e),null)},t.buildAllMatcher=function(t){return new a(t)},t.buildAnyMatcher=function(t){return new r(t)},t}()},function(t,e,n){n.d(e,"b",function(){return p}),n.d(e,"e",function(){return f}),n.d(e,"a",function(){return d}),n.d(e,"c",function(){return v}),n.d(e,"d",function(){return E});var i,o=n(7),r=n(1),a=n(14),s=n(25),l=n(21),u=n(3),c=n(8),h=n(15),p=h.d.isInstanceOfAfterIfContinuesLayoutConstraint,f=s.b.registerFragmentIndex;s.b.clearFragmentIndices,Promise.resolve().then(n.bind(null,23)).then(function(t){i=t});var d=function(){function t(t,e){this.sourceNode=t,this.styler=e}return t.prototype.createElement=function(t,e){var n=this;if(!i)throw new Error("layoututil module is required but not be imported.");var o=e.viewNode.ownerDocument.createElement("div"),a=new i.PseudoColumn(t,o,e),s=a.getColumn().pageBreakType;return a.getColumn().pageBreakType=null,a.layout(this.createNodePositionForPseudoElement(),!0).thenAsync(function(){n.styler.contentProcessed["after-if-continues"]=!1,a.getColumn().pageBreakType=s;var t=o.firstChild;return r.F(t,"display","block"),u.d(t)})},t.prototype.createNodePositionForPseudoElement=function(){var t=l.c.createElementNS(r.a.XHTML,"div");l.f(t,"after-if-continues");var e=this.createShadowContext(t),n={steps:[{node:t,shadowType:e.type,shadowContext:e,nodeShadow:null,shadowSibling:null}],offsetInNode:0,after:!1,preprocessedTextContent:null};return new c.a(n)},t.prototype.createShadowContext=function(t){return new c.n(this.sourceNode,t,null,null,null,h.f.ShadowType.ROOTED,this.styler)},t}(),g=function(){function t(t,e,n){this.nodeContext=t,this.afterIfContinues=e,this.pseudoElementHeight=n,this.flagmentLayoutConstraintType="AfterIfContinue"}return t.prototype.allowLayout=function(t,e,n){return!(e&&!t||t&&t.overflow)},t.prototype.nextCandidate=function(t){return!1},t.prototype.postLayout=function(t,e,n,i){},t.prototype.finishBreak=function(t,e){var n=this;return this.getRepetitiveElements().affectTo(t)?this.afterIfContinues.createElement(e,this.nodeContext).thenAsync(function(t){return n.nodeContext.viewNode.appendChild(t),u.d(!0)}):u.d(!0)},t.prototype.getRepetitiveElements=function(){return new m(this.nodeContext,this.pseudoElementHeight)},t.prototype.equalsTo=function(e){return e instanceof t&&this.afterIfContinues==e.afterIfContinues},t.prototype.getPriorityOfFinishBreak=function(){return 9},t}(),m=function(){function t(t,e){this.nodeContext=t,this.pseudoElementHeight=e}return t.prototype.calculateOffset=function(t){return this.affectTo(t)?this.pseudoElementHeight:0},t.prototype.calculateMinimumOffset=function(t){return this.calculateOffset(t)},t.prototype.affectTo=function(t){if(!t)return!1;var e=t.shadowContext?t.shadowContext.owner:t.sourceNode;if(e===this.nodeContext.sourceNode)return!!t.after;for(var n=e.parentNode;n;n=n.parentNode)if(n===this.nodeContext.sourceNode)return!0;return!1},t}();function y(t,e){if(!t||!t.afterIfContinues||t.after||e.isFloatNodeContext(t))return u.d(t);var n=t.afterIfContinues;return n.createElement(e,t).thenAsync(function(i){o.a(null!==t);var r=function(t,e,n){var i=t.viewNode;i.appendChild(n);var o=a.b(n,e,t.vertical);return i.removeChild(n),o}(t,e,i);return e.fragmentLayoutConstraints.push(new g(t,n,r)),u.d(t)})}function v(t,e){return t.thenAsync(function(t){return y(t,e)})}function E(t,e){var n=u.c("processAfterIfContinuesOfAncestors"),i=t;return n.loop(function(){if(null!==i){var t=y(i,e);return i=i.parent,t.thenReturn(!0)}return u.d(!1)}).then(function(){n.finish(!0)}),n.result()}},function(t,e,n){n.d(e,"a",function(){return r}),n.d(e,"d",function(){return a}),n.d(e,"b",function(){return s}),n.d(e,"c",function(){return l});var i=n(28),o=n.n(i);function r(t,e){return o()(t,e,0)}function a(t){return t.reduce(function(t,e){return e[0]===o.a.DELETE?t:t+e[1]},"")}function s(t,e){return u(t,e,1)}function l(t,e){return u(t,e,-1)}function u(t,e,n){var i=0,r=0;return t.some(function(t){for(var a=0;a<t[1].length;a++){switch(t[0]*n){case o.a.INSERT:i++;break;case o.a.DELETE:i--,r++;break;case o.a.EQUAL:r++}if(r>e)return!0}return!1}),Math.max(Math.min(e,r-1)+i,0)}},function(t,e){var n=-1,i=1,o=0;function r(t,e,u,c){if(t===e)return t?[[o,t]]:[];if(null!=u){var d=function(t,e,n){var i="number"==typeof n?{index:n,length:0}:n.oldRange,o="number"==typeof n?null:n.newRange,r=t.length,a=e.length;if(0===i.length&&(null===o||0===o.length)){var s=i.index,l=t.slice(0,s),u=t.slice(s),c=o?o.index:null,h=s+a-r;if((null===c||c===h)&&!(h<0||h>a)){var p=e.slice(0,h);if((b=e.slice(h))===u){var d=Math.min(s,h),g=l.slice(0,d),m=p.slice(0,d);if(g===m){var y=l.slice(d),v=p.slice(d);return f(g,y,v,u)}}}if(null===c||c===s){var E=s,b=(p=e.slice(0,E),e.slice(E));if(p===l){var w=Math.min(r-E,a-E),N=u.slice(u.length-w),C=b.slice(b.length-w);if(N===C)return f(l,y=u.slice(0,u.length-w),v=b.slice(0,b.length-w),N)}}}return i.length>0&&o&&0===o.length&&(g=t.slice(0,i.index),N=t.slice(i.index+i.length),!(a<(d=g.length)+(w=N.length))&&(m=e.slice(0,d),C=e.slice(a-w),g===m&&N===C))?f(g,y=t.slice(d,r-w),v=e.slice(d,a-w),N):null}(t,e,u);if(d)return d}var g=s(t,e),m=t.substring(0,g);g=l(t=t.substring(g),e=e.substring(g));var y=t.substring(t.length-g),v=function(t,e){var u;if(!t)return[[i,e]];if(!e)return[[n,t]];var c=t.length>e.length?t:e,h=t.length>e.length?e:t,p=c.indexOf(h);if(-1!==p)return u=[[i,c.substring(0,p)],[o,h],[i,c.substring(p+h.length)]],t.length>e.length&&(u[0][0]=u[2][0]=n),u;if(1===h.length)return[[n,t],[i,e]];var f=function(t,e){var n=t.length>e.length?t:e,i=t.length>e.length?e:t;if(n.length<4||2*i.length<n.length)return null;function o(t,e,n){for(var i,o,r,a,u=t.substring(n,n+Math.floor(t.length/4)),c=-1,h="";-1!==(c=e.indexOf(u,c+1));){var p=s(t.substring(n),e.substring(c)),f=l(t.substring(0,n),e.substring(0,c));h.length<f+p&&(h=e.substring(c-f,c)+e.substring(c,c+p),i=t.substring(0,n-f),o=t.substring(n+p),r=e.substring(0,c-f),a=e.substring(c+p))}return 2*h.length>=t.length?[i,o,r,a,h]:null}var r,a,u,c,h,p=o(n,i,Math.ceil(n.length/4)),f=o(n,i,Math.ceil(n.length/2));return p||f?(r=f?p&&p[4].length>f[4].length?p:f:p,t.length>e.length?(a=r[0],u=r[1],c=r[2],h=r[3]):(c=r[0],h=r[1],a=r[2],u=r[3]),[a,u,c,h,r[4]]):null}(t,e);if(f){var d=f[0],g=f[1],m=f[2],y=f[3],v=f[4],E=r(d,m),b=r(g,y);return E.concat([[o,v]],b)}return function(t,e){for(var o=t.length,r=e.length,s=Math.ceil((o+r)/2),l=s,u=2*s,c=new Array(u),h=new Array(u),p=0;p<u;p++)c[p]=-1,h[p]=-1;c[l+1]=0,h[l+1]=0;for(var f=o-r,d=f%2!=0,g=0,m=0,y=0,v=0,E=0;E<s;E++){for(var b=-E+g;b<=E-m;b+=2){for(var w=l+b,N=(I=b===-E||b!==E&&c[w-1]<c[w+1]?c[w+1]:c[w-1]+1)-b;I<o&&N<r&&t.charAt(I)===e.charAt(N);)I++,N++;if(c[w]=I,I>o)m+=2;else if(N>r)g+=2;else if(d&&(T=l+f-b)>=0&&T<u&&-1!==h[T]){var C=o-h[T];if(I>=C)return a(t,e,I,N)}}for(var S=-E+y;S<=E-v;S+=2){for(var T=l+S,x=(C=S===-E||S!==E&&h[T-1]<h[T+1]?h[T+1]:h[T-1]+1)-S;C<o&&x<r&&t.charAt(o-C-1)===e.charAt(r-x-1);)C++,x++;if(h[T]=C,C>o)v+=2;else if(x>r)y+=2;else if(!d&&(w=l+f-S)>=0&&w<u&&-1!==c[w]){var I=c[w];if(N=l+I-w,I>=(C=o-C))return a(t,e,I,N)}}}return[[n,t],[i,e]]}(t,e)}(t=t.substring(0,t.length-g),e=e.substring(0,e.length-g));return m&&v.unshift([o,m]),y&&v.push([o,y]),function t(e,r){e.push([o,""]);for(var a,u=0,c=0,f=0,d="",g="";u<e.length;)if(u<e.length-1&&!e[u][1])e.splice(u,1);else switch(e[u][0]){case i:f++,g+=e[u][1],u++;break;case n:c++,d+=e[u][1],u++;break;case o:var m=u-f-c-1;if(r){if(m>=0&&p(e[m][1])){var y=e[m][1].slice(-1);if(e[m][1]=e[m][1].slice(0,-1),d=y+d,g=y+g,!e[m][1]){e.splice(m,1),u--;var v=m-1;e[v]&&e[v][0]===i&&(f++,g=e[v][1]+g,v--),e[v]&&e[v][0]===n&&(c++,d=e[v][1]+d,v--),m=v}}h(e[u][1])&&(y=e[u][1].charAt(0),e[u][1]=e[u][1].slice(1),d+=y,g+=y)}if(u<e.length-1&&!e[u][1]){e.splice(u,1);break}if(d.length>0||g.length>0){d.length>0&&g.length>0&&(0!==(a=s(g,d))&&(m>=0?e[m][1]+=g.substring(0,a):(e.splice(0,0,[o,g.substring(0,a)]),u++),g=g.substring(a),d=d.substring(a)),0!==(a=l(g,d))&&(e[u][1]=g.substring(g.length-a)+e[u][1],g=g.substring(0,g.length-a),d=d.substring(0,d.length-a)));var E=f+c;0===d.length&&0===g.length?(e.splice(u-E,E),u-=E):0===d.length?(e.splice(u-E,E,[i,g]),u=u-E+1):0===g.length?(e.splice(u-E,E,[n,d]),u=u-E+1):(e.splice(u-E,E,[n,d],[i,g]),u=u-E+2)}0!==u&&e[u-1][0]===o?(e[u-1][1]+=e[u][1],e.splice(u,1)):u++,f=0,c=0,d="",g=""}""===e[e.length-1][1]&&e.pop();var b=!1;for(u=1;u<e.length-1;)e[u-1][0]===o&&e[u+1][0]===o&&(e[u][1].substring(e[u][1].length-e[u-1][1].length)===e[u-1][1]?(e[u][1]=e[u-1][1]+e[u][1].substring(0,e[u][1].length-e[u-1][1].length),e[u+1][1]=e[u-1][1]+e[u+1][1],e.splice(u-1,1),b=!0):e[u][1].substring(0,e[u+1][1].length)==e[u+1][1]&&(e[u-1][1]+=e[u+1][1],e[u][1]=e[u][1].substring(e[u+1][1].length)+e[u+1][1],e.splice(u+1,1),b=!0)),u++;b&&t(e,r)}(v,c),v}function a(t,e,n,i){var o=t.substring(0,n),a=e.substring(0,i),s=t.substring(n),l=e.substring(i),u=r(o,a),c=r(s,l);return u.concat(c)}function s(t,e){if(!t||!e||t.charAt(0)!==e.charAt(0))return 0;for(var n=0,i=Math.min(t.length,e.length),o=i,r=0;n<o;)t.substring(r,o)==e.substring(r,o)?r=n=o:i=o,o=Math.floor((i-n)/2+n);return u(t.charCodeAt(o-1))&&o--,o}function l(t,e){if(!t||!e||t.slice(-1)!==e.slice(-1))return 0;for(var n=0,i=Math.min(t.length,e.length),o=i,r=0;n<o;)t.substring(t.length-o,t.length-r)==e.substring(e.length-o,e.length-r)?r=n=o:i=o,o=Math.floor((i-n)/2+n);return c(t.charCodeAt(t.length-o))&&o--,o}function u(t){return t>=55296&&t<=56319}function c(t){return t>=56320&&t<=57343}function h(t){return c(t.charCodeAt(0))}function p(t){return u(t.charCodeAt(t.length-1))}function f(t,e,r,a){return p(t)||h(a)?null:function(t){for(var e=[],n=0;n<t.length;n++)t[n][1].length>0&&e.push(t[n]);return e}([[o,t],[n,e],[i,r],[o,a]])}function d(t,e,n){return r(t,e,n,!0)}d.INSERT=i,d.DELETE=n,d.EQUAL=o,t.exports=d},function(t,e,n){n.d(e,"a",function(){return r});var i=n(7),o=n(3),r=function(){function t(){this.initialBreakPositions=null,this.initialStateOfFormattingContext=null}return t.prototype.layout=function(t,e){return this.prepareLayout(t,e),this.tryLayout(t,e)},t.prototype.tryLayout=function(t,e){var n=this,r=o.c("AbstractLayoutRetryer.tryLayout");this.saveState(t,e);var a=this.resolveLayoutMode(t);return a.doLayout(t,e).then(function(o){var s=a.accept(o,e);(s=a.postLayout(o,n.initialPosition,e,s))?r.finish(o):(i.a(n.initialPosition),n.clearNodes(n.initialPosition),n.restoreState(t,e),n.tryLayout(n.initialPosition,e).thenFinish(r))}),r.result()},t.prototype.prepareLayout=function(t,e){},t.prototype.clearNodes=function(t){for(var e,n,i=t.viewNode||t.parent.viewNode;e=i.lastChild;)i.removeChild(e);for(;n=i.nextSibling;)n.parentNode.removeChild(n)},t.prototype.saveState=function(t,e){this.initialPosition=t.copy(),this.initialBreakPositions=[].concat(e.breakPositions),this.initialFragmentLayoutConstraints=[].concat(e.fragmentLayoutConstraints),t.formattingContext&&(this.initialStateOfFormattingContext=t.formattingContext.saveState())},t.prototype.restoreState=function(t,e){e.breakPositions=this.initialBreakPositions,e.fragmentLayoutConstraints=this.initialFragmentLayoutConstraints,t.formattingContext&&t.formattingContext.restoreState(this.initialStateOfFormattingContext)},t}()},function(t,e,n){n.d(e,"a",function(){return T}),n.d(e,"b",function(){return P});var i,o=n(7),r=n(1),a=n(13),s=n(22),l=n(0),u=n(27),c=n(11),h=n(14),p=n(18),f=n(29),d=n(6),g=n(12),m=n(9),y=n(26),v=n(31),E=n(19),b=n(3),w=n(8),N=n(15),C=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),S={img:!0,svg:!0,audio:!0,video:!0},T=function(){function t(t){this.constraints=t}return t.prototype.allowLayout=function(t){return this.constraints.every(function(e){return e.allowLayout(t)})},t}(),x=function(t){function e(e,n){var i=t.call(this)||this;return i.checkPoints=e,i.penalty=n,i.alreadyEvaluated=!1,i.breakNodeContext=null,i}return C(e,t),e.prototype.findAcceptableBreak=function(t,e){return e<this.getMinBreakPenalty()?null:(this.alreadyEvaluated||(this.breakNodeContext=t.findBoxBreakPosition(this,e>0),this.alreadyEvaluated=!0),this.breakNodeContext)},e.prototype.getMinBreakPenalty=function(){return this.penalty},e.prototype.getNodeContext=function(){return this.alreadyEvaluated?this.breakNodeContext:this.checkPoints[this.checkPoints.length-1]},e}(s.a);function I(t){switch(t){case"ruby":case"inline-block":case"inline-flex":case"inline-grid":case"inline-list-item":case"inline-table":return!0}return!1}var P=function(t){function e(e,n,i,o,r){var a=t.call(this,e)||this;return a.layoutContext=n,a.clientLayout=i,a.layoutConstraint=o,a.pageFloatLayoutContext=r,a.flowRootFormattingContext=null,a.isFloat=!1,a.isFootnote=!1,a.startEdge=0,a.endEdge=0,a.beforeEdge=0,a.afterEdge=0,a.footnoteEdge=0,a.box=null,a.chunkPositions=null,a.bands=null,a.overflown=!1,a.breakPositions=null,a.pageBreakType=null,a.forceNonfitting=!0,a.leftFloatEdge=0,a.rightFloatEdge=0,a.bottommostFloatTop=0,a.stopAtOverflow=!0,a.lastAfterPosition=null,a.fragmentLayoutConstraints=[],a.pseudoParent=null,a.nodeContextOverflowingDueToRepetitiveElements=null,a.blockDistanceToBlockEndFloats=NaN,a.last=e.lastChild,a.viewDocument=e.ownerDocument,r.setContainer(a),a}return C(e,t),e.prototype.getTopEdge=function(){return this.vertical?this.startEdge:this.beforeEdge},e.prototype.getBottomEdge=function(){return this.vertical?this.endEdge:this.afterEdge},e.prototype.getLeftEdge=function(){return this.vertical?this.afterEdge:this.startEdge},e.prototype.getRightEdge=function(){return this.vertical?this.beforeEdge:this.endEdge},e.prototype.isFloatNodeContext=function(t){return!(!t.floatSide||this.isFloat&&!t.parent)},e.prototype.stopByOverflow=function(t){return this.stopAtOverflow&&!!t&&t.overflow},e.prototype.isOverflown=function(t){return this.vertical?t<this.footnoteEdge:t>this.footnoteEdge},e.prototype.getExclusions=function(){var t=this.pageFloatLayoutContext.getFloatFragmentExclusions();return this.exclusions.concat(t)},e.prototype.openAllViews=function(t){var e=this,n=b.c("openAllViews"),i=t.steps;e.layoutContext.setViewRoot(e.element,e.isFootnote);var r=i.length-1,a=null;return n.loop(function(){for(;r>=0;){var n=a,o=i[r];if(a=w.v(o,n),r!==i.length-1||a.formattingContext||(a.formattingContext=e.flowRootFormattingContext),0==r&&(a.offsetInNode=e.calculateOffsetInNodeForNodeContext(t),a.after=t.after,a.preprocessedTextContent=t.preprocessedTextContent,a.after))break;var s=e.layoutContext.setCurrent(a,0==r&&0==a.offsetInNode);if(r--,s.isPending())return s}return b.d(!1)}).then(function(){o.a(a),n.finish(a)}),n.result()},e.prototype.calculateOffsetInNodeForNodeContext=function(t){return t.preprocessedTextContent?u.b(t.preprocessedTextContent,t.offsetInNode):t.offsetInNode},e.prototype.maybePeelOff=function(t,e){if(t.firstPseudo&&t.inline&&!t.after&&0==t.firstPseudo.count&&1!=t.viewNode.nodeType){var n=t.viewNode.textContent.match(A);return this.layoutContext.peelOff(t,n[0].length)}return b.d(t)},e.prototype.buildViewToNextBlockEdge=function(t,e){var n=this,i=!1,o=b.c("buildViewToNextBlockEdge");return o.loopWithFrame(function(o){t.viewNode&&!h.e(t)&&e.push(t.copy()),n.maybePeelOff(t,0).then(function(r){r!==t&&(t=r,h.e(t)||e.push(t.copy())),n.nextInTree(t).then(function(e){(t=e)?(!i&&n.layoutConstraint.allowLayout(t)||(i=!0,(t=t.modify()).overflow=!0),n.isFloatNodeContext(t)&&!n.vertical?n.layoutFloatOrFootnote(t).then(function(e){t=e,n.pageFloatLayoutContext.isInvalidated()&&(t=null),t?o.continueLoop():o.breakLoop()}):t.inline?o.continueLoop():o.breakLoop()):o.breakLoop()})})}).then(function(){o.finish(t)}),o.result()},e.prototype.nextInTree=function(t,e){var n=this.layoutContext.nextInTree(t,e);return y.c(n,this)},e.prototype.buildDeepElementView=function(t){if(!t.viewNode)return b.d(t);var e=[],n=t.sourceNode,i=this,o=b.c("buildDeepElementView");return o.loopWithFrame(function(o){t.viewNode&&t.inline&&!h.e(t)?e.push(t.copy()):(e.length>0&&i.postLayoutBlock(t,e),e=[]),i.maybePeelOff(t,0).then(function(r){var a=r;if(a!==t){for(var s=a;s&&s.sourceNode!=n;)s=s.parent;if(null==s)return t=a,void o.breakLoop();h.e(a)||e.push(a.copy())}i.nextInTree(a).then(function(e){(t=e)&&t.sourceNode!=n?i.layoutConstraint.allowLayout(t)?o.continueLoop():((t=t.modify()).overflow=!0,i.stopAtOverflow?o.breakLoop():o.continueLoop()):o.breakLoop()})})}).then(function(){e.length>0&&i.postLayoutBlock(t,e),o.finish(t)}),o.result()},e.prototype.createFloat=function(t,e,n,i){var o=this.viewDocument.createElement("div");return this.vertical?(i>=this.height&&(i-=.1),r.F(o,"height",n+"px"),r.F(o,"width",i+"px")):(n>=this.width&&(n-=.1),r.F(o,"width",n+"px"),r.F(o,"height",i+"px")),r.F(o,"float",e),r.F(o,"clear",e),this.element.insertBefore(o,t),o},e.prototype.killFloats=function(){for(var t=this.element.firstChild;t;){var e=t.nextSibling;if(1==t.nodeType){var n=t,i=n.style.cssFloat;if("left"!=i&&"right"!=i)break;this.element.removeChild(n)}t=e}},e.prototype.createFloats=function(){for(var t=this.element.firstChild,e=this.bands,n=this.vertical?this.getTopEdge():this.getLeftEdge(),i=this.vertical?this.getBottomEdge():this.getRightEdge(),o=0,r=e;o<r.length;o++){var a=r[o],s=a.y2-a.y1;a.left=this.createFloat(t,"left",a.x1-n,s),a.right=this.createFloat(t,"right",i-a.x2,s)}},e.prototype.calculateEdge=function(t,e,n,i){var o;if(t&&h.c(t.viewNode))return NaN;if(t&&t.after&&!t.inline&&(o=h.a(t,this.clientLayout,0,this.vertical),!isNaN(o)))return o;for(var r=i-(t=e[n]).boxOffset;;){if(o=h.a(t,this.clientLayout,r,this.vertical),!isNaN(o))return o;if(r>0)r--;else{if(--n<0)return this.beforeEdge;1!=(t=e[n]).viewNode.nodeType&&(r=t.viewNode.textContent.length)}}},e.prototype.parseComputedLength=function(t){if("number"==typeof t)return t;var e=t.match(/^(-?[0-9]*(\.[0-9]*)?)px$/);return e?parseFloat(e[0]):0},e.prototype.getComputedMargin=function(t){var e=this.clientLayout.getElementComputedStyle(t),n=new c.a(0,0,0,0);return e&&(n.left=this.parseComputedLength(e.marginLeft),n.top=this.parseComputedLength(e.marginTop),n.right=this.parseComputedLength(e.marginRight),n.bottom=this.parseComputedLength(e.marginBottom)),n},e.prototype.getComputedPaddingBorder=function(t){var e=this.clientLayout.getElementComputedStyle(t),n=new c.a(0,0,0,0);return e&&(n.left=this.parseComputedLength(e.borderLeftWidth)+this.parseComputedLength(e.paddingLeft),n.top=this.parseComputedLength(e.borderTopWidth)+this.parseComputedLength(e.paddingTop),n.right=this.parseComputedLength(e.borderRightWidth)+this.parseComputedLength(e.paddingRight),n.bottom=this.parseComputedLength(e.borderBottomWidth)+this.parseComputedLength(e.paddingBottom)),n},e.prototype.getComputedInsets=function(t){var e=this.clientLayout.getElementComputedStyle(t),n=new c.a(0,0,0,0);if(e){if("border-box"==e.boxSizing)return this.getComputedMargin(t);n.left=this.parseComputedLength(e.marginLeft)+this.parseComputedLength(e.borderLeftWidth)+this.parseComputedLength(e.paddingLeft),n.top=this.parseComputedLength(e.marginTop)+this.parseComputedLength(e.borderTopWidth)+this.parseComputedLength(e.paddingTop),n.right=this.parseComputedLength(e.marginRight)+this.parseComputedLength(e.borderRightWidth)+this.parseComputedLength(e.paddingRight),n.bottom=this.parseComputedLength(e.marginBottom)+this.parseComputedLength(e.borderBottomWidth)+this.parseComputedLength(e.paddingBottom)}return n},e.prototype.setComputedInsets=function(t,e){var n=this.clientLayout.getElementComputedStyle(t);n&&(e.marginLeft=this.parseComputedLength(n.marginLeft),e.borderLeft=this.parseComputedLength(n.borderLeftWidth),e.paddingLeft=this.parseComputedLength(n.paddingLeft),e.marginTop=this.parseComputedLength(n.marginTop),e.borderTop=this.parseComputedLength(n.borderTopWidth),e.paddingTop=this.parseComputedLength(n.paddingTop),e.marginRight=this.parseComputedLength(n.marginRight),e.borderRight=this.parseComputedLength(n.borderRightWidth),e.paddingRight=this.parseComputedLength(n.paddingRight),e.marginBottom=this.parseComputedLength(n.marginBottom),e.borderBottom=this.parseComputedLength(n.borderBottomWidth),e.paddingBottom=this.parseComputedLength(n.paddingBottom))},e.prototype.setComputedWidthAndHeight=function(t,e){var n=this.clientLayout.getElementComputedStyle(t);n&&(e.width=this.parseComputedLength(n.width),e.height=this.parseComputedLength(n.height))},e.prototype.layoutUnbreakable=function(t){return this.buildDeepElementView(t)},e.prototype.layoutFloat=function(t){var e=this,n=b.c("layoutFloat"),i=t.viewNode,a=t.floatSide;return r.F(i,"float","none"),r.F(i,"display","inline-block"),r.F(i,"vertical-align","top"),e.buildDeepElementView(t).then(function(s){for(var l=e.clientLayout.getElementClientRect(i),u=e.getComputedMargin(i),h=new c.c(l.left-u.left,l.top-u.top,l.right+u.right,l.bottom+u.bottom),p=e.startEdge,f=e.endEdge,d=t.parent;d&&d.inline;)d=d.parent;if(d){(C=d.viewNode.ownerDocument.createElement("div")).style.left="0px",C.style.top="0px",e.vertical?(C.style.bottom="0px",C.style.width="1px"):(C.style.right="0px",C.style.height="1px"),d.viewNode.appendChild(C);var g=e.clientLayout.getElementClientRect(C);p=Math.max(e.getStartEdge(g),p),f=Math.min(e.getEndEdge(g),f),d.viewNode.removeChild(C);var m=e.vertical?h.y2-h.y1:h.x2-h.x1;"left"==a?f=Math.max(f,p+m):p=Math.min(p,f-m),d.viewNode.appendChild(t.viewNode)}var y=new c.c(p,e.getBoxDir()*e.beforeEdge,f,e.getBoxDir()*e.afterEdge),v=h;e.vertical&&(v=c.i(h));var E=e.getBoxDir();if(v.y1<e.bottommostFloatTop*E){var b=v.y2-v.y1;v.y1=e.bottommostFloatTop*E,v.y2=v.y1+b}c.h(y,e.bands,v,a),e.vertical&&(h=c.m(v));var w,N=e.getComputedInsets(i);r.F(i,"width",h.x2-h.x1-N.left-N.right+"px"),r.F(i,"height",h.y2-h.y1-N.top-N.bottom+"px"),r.F(i,"position","absolute"),o.a(t.display),r.F(i,"display",t.display);var C,S=null;d&&(S=d.containingBlockForAbsolute?d:d.getContainingBlockForAbsolute()),S?((C=S.viewNode.ownerDocument.createElement("div")).style.position="absolute",S.vertical?C.style.right="0":C.style.left="0",C.style.top="0",S.viewNode.appendChild(C),w=e.clientLayout.getElementClientRect(C),S.viewNode.removeChild(C)):w={left:e.getLeftEdge()-e.paddingLeft,right:e.getRightEdge()+e.paddingRight,top:e.getTopEdge()-e.paddingTop},(S?S.vertical:e.vertical)?r.F(i,"right",w.right-h.x2+"px"):r.F(i,"left",h.x1-w.left+"px"),r.F(i,"top",h.y1-w.top+"px"),t.clearSpacer&&(t.clearSpacer.parentNode.removeChild(t.clearSpacer),t.clearSpacer=null);var T=e.vertical?h.x1:h.y2,x=e.vertical?h.x2:h.y1;e.isOverflown(T)&&0!=e.breakPositions.length?((t=t.modify()).overflow=!0,n.finish(t)):(e.killFloats(),y=new c.c(e.getLeftEdge(),e.getTopEdge(),e.getRightEdge(),e.getBottomEdge()),e.vertical&&(y=c.i(y)),c.e(y,e.bands,v,null,a),e.createFloats(),"left"==a?e.leftFloatEdge=T:e.rightFloatEdge=T,e.bottommostFloatTop=x,e.updateMaxReachedAfterEdge(T),n.finish(s))}),n.result()},e.prototype.setupFloatArea=function(t,e,n,i,o,r){var a=this.pageFloatLayoutContext,s=a.getContainer(e),l=t.element;s.element.parentNode.appendChild(l),t.isFloat=!0,t.originX=s.originX,t.originY=s.originY,t.vertical=s.vertical,t.marginLeft=t.marginRight=t.marginTop=t.marginBottom=0,t.borderLeft=t.borderRight=t.borderTop=t.borderBottom=0,t.paddingLeft=t.paddingRight=t.paddingTop=t.paddingBottom=0,t.exclusions=(s.exclusions||[]).concat(),t.forceNonfitting=!a.hasFloatFragments(),t.innerShape=null;var u=s.getPaddingRect();t.setHorizontalPosition(u.x1-s.originX,u.x2-u.x1),t.setVerticalPosition(u.y1-s.originY,u.y2-u.y1),o.adjustPageFloatArea(t,s,this),t.init();var c=!!a.setFloatAreaDimensions(t,e,n,i,!0,!a.hasFloatFragments(),r);return c?(t.killFloats(),t.init()):s.element.parentNode.removeChild(l),c},e.prototype.createPageFloatArea=function(t,e,n,i,o){var a=this.element.ownerDocument.createElement("div");r.F(a,"position","absolute");var s=this.pageFloatLayoutContext.getPageFloatLayoutContext(t.floatReference),l=new g.e(null,g.a.COLUMN,null,this.pageFloatLayoutContext.flowName,t.nodePosition,null,null),u=s.getContainer(),c=new F(e,a,this.layoutContext.clone(),this.clientLayout,this.layoutConstraint,l,u);return l.setContainer(c),this.setupFloatArea(c,t.floatReference,e,n,i,o)?c:null},e.prototype.layoutSinglePageFloatFragment=function(t,e,n,i,r,a,s){var l=this.pageFloatLayoutContext,u=s?s.continuations:[],c=(t=u.concat(t))[0].float,h=l.getPageFloatPlacementCondition(c,e,n),p=this.createPageFloatArea(c,e,a,r,h),f={floatArea:p,pageFloatFragment:null,newPosition:null};if(!p)return b.d(f);var d=b.c("layoutSinglePageFloatFragment"),g=!1,m=0;return d.loopWithFrame(function(e){if(m>=t.length)e.breakLoop();else{var n=t[m],o=new w.a(n.nodePosition);p.layout(o,!0).then(function(t){f.newPosition=t,!t||i?(m++,e.continueLoop()):(g=!0,e.breakLoop())})}}).then(function(){if(!g){o.a(p);var n=l.setFloatAreaDimensions(p,c.floatReference,e,a,!1,i,h);if(n){var s=r.createPageFloatFragment(t,n,p,!!f.newPosition);l.addPageFloatFragment(s,!0),f.pageFloatFragment=s}else g=!0}d.finish(f)}),d.result()},e.prototype.layoutPageFloatInner=function(t,e,n,i){var r=this.pageFloatLayoutContext,a=t.float;function s(e,n){n?r.removePageFloatFragment(n,!0):e&&e.element.parentNode.removeChild(e.element),r.restoreStashedFragments(a.floatReference),r.deferPageFloat(t)}r.stashEndFloatFragments(a);var l=b.c("layoutPageFloatInner"),u=this;return this.layoutSinglePageFloatFragment([t],a.floatSide,a.clearSide,!r.hasFloatFragments(),e,n,i).then(function(t){var e=t.floatArea,n=t.pageFloatFragment,c=t.newPosition;n?u.layoutStashedPageFloats(a.floatReference,[i]).then(function(t){if(t){if(o.a(n),r.addPageFloatFragment(n),r.discardStashedFragments(a.floatReference),c){var i=new g.c(a,c.primary);r.deferPageFloat(i)}l.finish(!0)}else s(e,n),l.finish(!1)}):(s(e,n),l.finish(!1))}),l.result()},e.prototype.layoutStashedPageFloats=function(t,e){var n=this.pageFloatLayoutContext,i=n.getStashedFloatFragments(t),o=[],r=[],a=!1,s=b.c("layoutStashedPageFloats"),l=this,u=0;return s.loopWithFrame(function(t){if(u>=i.length)t.breakLoop();else{var n=i[u];if(e.includes(n))return u++,void t.continueLoop();var s=(new g.f).findByFloat(n.continuations[0].float);l.layoutSinglePageFloatFragment(n.continuations,n.floatSide,null,!1,s,null).then(function(e){var n=e.floatArea;n&&o.push(n);var i=e.pageFloatFragment;i?(r.push(i),u++,t.continueLoop()):(a=!0,t.breakLoop())})}}).then(function(){a?(r.forEach(function(t){n.removePageFloatFragment(t,!0)}),o.forEach(function(t){var e=t.element;e&&e.parentNode&&e.parentNode.removeChild(e)})):i.forEach(function(t){var e=t.area.element;e&&e.parentNode&&e.parentNode.removeChild(e)}),s.finish(!a)}),s.result()},e.prototype.setFloatAnchorViewNode=function(t){var e=t.viewNode.parentNode,n=e.ownerDocument.createElement("span");n.setAttribute(w.m,"1"),"footnote"===t.floatSide&&this.layoutContext.applyPseudoelementStyle(t,"footnote-call",n),e.appendChild(n),e.removeChild(t.viewNode);var i=t.modify();return i.after=!0,i.viewNode=n,i},e.prototype.resolveFloatReferenceFromColumnSpan=function(t,e,n){var i=this,o=b.c("resolveFloatReferenceFromColumnSpan"),r=this.pageFloatLayoutContext,a=r.getPageFloatLayoutContext(g.a.REGION);return r.getContainer().width<a.getContainer().width&&t===g.a.COLUMN?e===l.t.auto?this.buildDeepElementView(n.copy()).then(function(e){var n=e.viewNode,r=E.b(i.clientLayout,n,[E.a.MIN_CONTENT_INLINE_SIZE])[E.a.MIN_CONTENT_INLINE_SIZE],a=i.getComputedMargin(n);i.vertical?r+=a.top+a.bottom:r+=a.left+a.right,r>i.width?o.finish(g.a.REGION):o.finish(t)}):e===l.t.all?o.finish(g.a.REGION):o.finish(t):o.finish(t),o.result()},e.prototype.layoutPageFloat=function(t){var e=this,n=this.pageFloatLayoutContext,i=(new g.f).findByNodeContext(t),r=n.findPageFloatByNodePosition(t.toNodePosition());return(r?b.d(r):i.createPageFloat(t,n,this)).thenAsync(function(r){var a=w.x(t,0),s=e.setFloatAnchorViewNode(t),l=i.findPageFloatFragment(r,n),u=new g.c(r,a);if(l&&l.hasFloat(r))return n.registerPageFloatAnchor(r,s.viewNode),b.d(s);if(n.isForbidden(r)||n.hasPrecedingFloatsDeferredToNext(r))return n.deferPageFloat(u),n.registerPageFloatAnchor(r,s.viewNode),b.d(s);if(e.nodeContextOverflowingDueToRepetitiveElements)return b.d(null);var c=h.a(s,e.clientLayout,0,e.vertical);return e.isOverflown(c)?b.d(s):e.layoutPageFloatInner(u,i,c,l).thenAsync(function(t){return o.a(r),t?b.d(null):(n.registerPageFloatAnchor(r,s.viewNode),b.d(s))})})},e.prototype.createJustificationAdjustmentElement=function(t,e,n,i){var o=e.createElement("span");o.style.visibility="hidden",o.style.verticalAlign="top",o.setAttribute(w.m,"1");var a=e.createElement("span");a.style.fontSize="0",a.style.lineHeight="0",a.textContent=" #",o.appendChild(a),o.style.display="block",o.style.textIndent="0",o.style.textAlign="left",n.insertBefore(o,t);var s=this.clientLayout.getElementClientRect(a);o.style.textAlign="right";var l=this.clientLayout.getElementClientRect(a);o.style.textAlign="",r.j(document.body)?o.style.display="inline":o.style.display="inline-block";var u=i?l.top-s.top:l.left-s.left,c=u>=1?u-1+"px":"100%";return i?o.style.paddingTop=c:o.style.paddingLeft=c,o},e.prototype.addAndAdjustJustificationElement=function(t,e,n,i,o,a){return function(t,e,n,i){if(r.k(document.body)){var o=O(t),a=e?n:n.previousSibling,s=a?a.textContent:"";if(s.charAt(s.length-1)===o){var l=n.ownerDocument,u=n.parentNode;r.l(document.body)?u.insertBefore(l.createTextNode(" "),i):u.insertBefore(l.createElement("wbr"),i)}}}(t,e,n,i),this.createJustificationAdjustmentElement(i,o,a,t.vertical)},e.prototype.compensateJustificationLineHeight=function(t,e,n){var i=this.clientLayout.getElementClientRect(t),o=this.clientLayout.getElementClientRect(e);n.vertical?(e.style.marginRight=o.right-i.right+"px",e.style.width="0px"):(e.style.marginTop=i.top-o.top+"px",e.style.height="0px"),e.setAttribute(w.m,"1")},e.prototype.fixJustificationIfNeeded=function(t,e){if(!t.after||t.inline){if(e){for(var n="",i=t.parent;i&&!n;i=i.parent)!i.inline&&i.viewNode&&(n=i.viewNode.style.textAlign);if("justify"!==n)return}var o=t.viewNode,r=o.ownerDocument,a=e&&(t.after||1!=o.nodeType),s=a?o.nextSibling:o;s&&!s.parentNode&&(s=null);var l=o.parentNode||t.parent&&t.parent.viewNode;if(l){var u=this.addAndAdjustJustificationElement(t,a,o,s,r,l);if(!e){var c=r.createElement("div");l.insertBefore(c,s),this.compensateJustificationLineHeight(u,c,t)}}}},e.prototype.processLineStyling=function(t,e,n){var i=this,o=b.c("processLineStyling"),r=n.concat([]);n.splice(0,n.length);var a=0,s=t.firstPseudo;return 0==s.count&&(s=s.outer),o.loopWithFrame(function(n){if(s){var o=i.findLinePositions(r),l=s.count-a;if(o.length<=l)n.breakLoop();else{var u=i.findAcceptableBreakInside(r,o[l-1],!0);null!=u?i.finishBreak(u,!1,!1).then(function(){a+=l,i.layoutContext.peelOff(u,0).then(function(o){t=o,i.fixJustificationIfNeeded(t,!1),s=t.firstPseudo,r=[],i.buildViewToNextBlockEdge(t,r).then(function(t){e=t,n.continueLoop()})})}):n.breakLoop()}}else n.breakLoop()}).then(function(){Array.prototype.push.apply(n,r),o.finish(e)}),o.result()},e.prototype.isLoneImage=function(t){return!(2!=t.length&&this.breakPositions.length>0)&&t[0].sourceNode==t[1].sourceNode&&S[t[0].sourceNode.localName]},e.prototype.getTrailingMarginEdgeAdjustment=function(t){for(var e=0,n=0,i=t.length-1;i>=0;i--){var o=t[i];if(!o.after||!o.viewNode||1!=o.viewNode.nodeType)break;var r=this.getComputedMargin(o.viewNode),a=this.vertical?-r.left:r.bottom;a>0?e=Math.max(e,a):n=Math.min(n,a)}return e-n},e.prototype.layoutBreakableBlock=function(t){var e=this,n=b.c("layoutBreakableBlock"),i=[];return e.buildViewToNextBlockEdge(t,i).then(function(o){var r=i.length-1;if(r<0)n.finish(o);else{var a=e.calculateEdge(o,i,r,i[r].boxOffset),l=!1;if(!o||!h.c(o.viewNode)){var u=s.c(o,e.collectElementsOffset());l=e.isOverflown(a+(e.vertical?-1:1)*u.minimum),e.isOverflown(a+(e.vertical?-1:1)*u.current)&&!e.nodeContextOverflowingDueToRepetitiveElements&&(e.nodeContextOverflowingDueToRepetitiveElements=o)}null==o&&(a+=e.getTrailingMarginEdgeAdjustment(i)),e.updateMaxReachedAfterEdge(a),(t.firstPseudo?e.processLineStyling(t,o,i):b.d(o)).then(function(t){e.postLayoutBlock(t,i),i.length>0&&(e.saveBoxBreakPosition(i),l&&!e.isLoneImage(i)&&t&&((t=t.modify()).overflow=!0)),n.finish(t)})}}),n.result()},e.prototype.postLayoutBlock=function(t,e){var n=this;m.b(m.a.POST_LAYOUT_BLOCK).forEach(function(i){i(t,e,n)})},e.prototype.findEndOfLine=function(t,e,n){for(var i,o=this.vertical?t-1:t+1,r=0,a=e[0].boxOffset,s=r,l=e.length-1,u=e[l].boxOffset;a<u;){i=a+Math.ceil((u-a)/2),s=r;for(var c=l;s<c;){var h=s+Math.ceil((c-s)/2);e[h].boxOffset>i?c=h-1:s=h}var p=this.calculateEdge(null,e,s,i);if(this.vertical?p<=o:p>=o){for(u=i-1;e[s].boxOffset==i;)s--;l=s}else n&&this.updateMaxReachedAfterEdge(p),a=i,r=s}return{nodeContext:e[s],index:a,checkPointIndex:s}},e.prototype.findAcceptableBreakInside=function(t,e,n){var i=this.findEndOfLine(e,t,!0),o=i.nodeContext,r=o.viewNode;if(1!=r.nodeType){var a=r;o=this.resolveTextNodeBreaker(o).breakTextNode(a,o,i.index,t,i.checkPointIndex,n)}return this.clearOverflownViewNodes(o,!1),o},e.prototype.resolveTextNodeBreaker=function(t){return m.b(m.a.RESOLVE_TEXT_NODE_BREAKER).reduce(function(e,n){return n(t)||e},R.instance)},e.prototype.getRangeBoxes=function(t,e){for(var n=[],i=t.ownerDocument.createRange(),o=!1,r=t,a=null,s=!1,l=!0;l;){var u=!0;do{var c=null;r==e&&(l=1===e.nodeType&&!(!e.firstChild||o)),1!=r.nodeType?(s||(i.setStartBefore(r),s=!0),a=r):o?o=!1:h.d(r)?u=!s:"ruby"==r.localName||I(this.clientLayout.getElementComputedStyle(r).display)?((u=!s)&&(i.setStartBefore(r),s=!0,a=r),r.contains(e)&&(l=!1)):c=r.firstChild,c||(c=r.nextSibling)||(o=!0,c=r.parentNode),r=c}while(u&&l);if(s){i.setEndAfter(a);for(var p=this.clientLayout.getRangeClientRects(i),f=0;f<p.length;f++)n.push(p[f]);s=!1}}return n},e.prototype.findLinePositions=function(t){var e=[],n=this.getRangeBoxes(t[0].viewNode,t[t.length-1].viewNode);n.sort(this.vertical?w.q:w.r);for(var i=0,o=0,a=0,s=0,l=0,u=this.getBoxDir();;){if(l<n.length){var c=n[l],h=1;if(s>0){var p=Math.max(this.getBoxSize(c),1);h=u*this.getBeforeEdge(c)<u*i?u*(this.getAfterEdge(c)-i)/p:u*this.getAfterEdge(c)>u*o?u*(o-this.getBeforeEdge(c))/p:1}if(0==s||h>=.6||h>=.2&&this.getStartEdge(c)>=a-1){a=this.getEndEdge(c),this.vertical?(i=0==s?c.right:Math.max(i,c.right),o=0==s?c.left:Math.min(o,c.left)):(i=0==s?c.top:Math.min(i,c.top),o=0==s?c.bottom:Math.max(o,c.bottom)),s++,l++;continue}}if(s>0&&(e.push(o),s=0),l>=n.length)break}return e.sort(r.B),this.vertical&&e.reverse(),e},e.prototype.calculateClonedPaddingBorder=function(t){var e=this,n=0;return t.walkUpBlocks(function(t){if("clone"===t.inheritedProps["box-decoration-break"]){o.a(t.viewNode instanceof Element);var i=e.getComputedPaddingBorder(t.viewNode);n+=t.vertical?-i.left:i.bottom,"table"===t.display&&(n+=t.blockBorderSpacing)}}),n},e.prototype.getOffsetByRepetitiveElements=function(t){return(t?t.calculateOffset(this):s.c(null,this.collectElementsOffset())).current},e.prototype.findBoxBreakPosition=function(t,e){for(var n,i,o=this,a=t.checkPoints,s=a[0];s.parent&&s.inline;)s=s.parent;e?(n=1,i=1):(n=Math.max((s.inheritedProps.widows||2)-0,1),i=Math.max((s.inheritedProps.orphans||2)-0,1));var l=o.calculateClonedPaddingBorder(s),u=this.findLinePositions(a),c=this.footnoteEdge-l,h=this.getBoxDir(),p=this.getOffsetByRepetitiveElements(t);c-=h*p;var f=this.findFirstOverflowingEdgeAndCheckPoint(a);isNaN(f.edge)&&(f.edge=h*(1/0));var d,g=r.i(u.length,function(t){var e=u[t];return o.vertical?e<c||e<=f.edge:e>c||e>=f.edge}),m=g<=0;if(m&&(g=r.i(u.length,function(t){return o.vertical?u[t]<c:u[t]>c})),(g=Math.min(u.length-n,g))<i)return null;if(c=u[g-1],d=m?f.checkPoint:this.findAcceptableBreakInside(t.checkPoints,c,e)){var y=this.getAfterEdgeOfBlockContainer(d);!isNaN(y)&&y<c&&(c=y),this.computedBlockSize=h*(c-this.beforeEdge)+p}return d},e.prototype.getAfterEdgeOfBlockContainer=function(t){var e=t;do{e=e.parent}while(e&&e.inline);return e?((e=e.copy().modify()).after=!0,h.a(e,this.clientLayout,0,this.vertical)):NaN},e.prototype.findFirstOverflowingEdgeAndCheckPoint=function(t){var e=t.findIndex(function(t){return t.overflow});if(e<0)return{edge:NaN,checkPoint:null};var n=t[e];return{edge:this.calculateEdge(null,t,e,n.boxOffset),checkPoint:n}},e.prototype.findEdgeBreakPosition=function(t){return this.computedBlockSize=t.computedBlockSize+this.getOffsetByRepetitiveElements(t),t.position},e.prototype.finishBreak=function(t,e,n){o.a(t.formattingContext);var i=(new p.c).find(t.formattingContext).finishBreak(this,t,e,n);return i||(i=p.d.finishBreak(this,t,e,n)),i},e.prototype.findAcceptableBreakPosition=function(){var t=null,e=null,n=0,i=0;do{n=i,i=Number.MAX_VALUE;for(var o=this.breakPositions.length-1;o>=0&&!e;--o){e=(t=this.breakPositions[o]).findAcceptableBreak(this,n);var r=t.getMinBreakPenalty();r>n&&(i=Math.min(i,r))}}while(i>n&&!e&&this.forceNonfitting);return{breakPosition:e?t:null,nodeContext:e}},e.prototype.doFinishBreak=function(t,e,n,i){if(this.pageFloatLayoutContext.isInvalidated()||this.pageBreakType||!e)return b.d(t);var o=this,r=b.c("doFinishBreak"),a=!1;if(!t){if(this.forceNonfitting)return d.b.warn("Could not find any page breaks?!!"),o.skipTailEdges(e).then(function(t){t?((t=t.modify()).overflow=!1,o.finishBreak(t,a,!0).then(function(){r.finish(t)})):r.finish(t)}),r.result();t=n,a=!0,o.computedBlockSize=i}return this.finishBreak(t,a,!0).then(function(){r.finish(t)}),r.result()},e.prototype.isBreakable=function(t){if(t.after)return!0;switch(t.sourceNode.namespaceURI){case r.a.SVG:return!1}return!t.flexContainer},e.prototype.zeroIndent=function(t){var e=t.toString();return""==e||"auto"==e||!!e.match(/^0+(.0*)?[^0-9]/)},e.prototype.checkOverflowAndSaveEdge=function(t,e){if(!t)return!1;if(h.c(t.viewNode))return!1;var n=h.a(t,this.clientLayout,0,this.vertical),i=s.c(t,this.collectElementsOffset()),o=this.isOverflown(n+(this.vertical?-1:1)*i.minimum);if(this.isOverflown(n+(this.vertical?-1:1)*i.current)&&!this.nodeContextOverflowingDueToRepetitiveElements)this.nodeContextOverflowingDueToRepetitiveElements=t;else if(e){var r=n+this.getTrailingMarginEdgeAdjustment(e),a=this.footnoteEdge-this.getBoxDir()*i.current;n=this.vertical?Math.min(n,Math.max(r,a)):Math.max(n,Math.min(r,a))}return this.updateMaxReachedAfterEdge(n),o},e.prototype.checkOverflowAndSaveEdgeAndBreakPosition=function(t,e,n,i){if(!t)return!1;if(h.c(t.viewNode))return!1;var o=this.checkOverflowAndSaveEdge(t,e);return!n&&o||this.saveEdgeBreakPosition(t,i,o),o},e.prototype.applyClearance=function(t){if(!t.viewNode.parentNode)return!1;var e=this.getComputedMargin(t.viewNode),n=t.viewNode.ownerDocument.createElement("div");this.vertical?(n.style.bottom="0px",n.style.width="1px",n.style.marginRight=e.right+"px"):(n.style.right="0px",n.style.height="1px",n.style.marginTop=e.top+"px"),t.viewNode.parentNode.insertBefore(n,t.viewNode);var i=this.clientLayout.getElementClientRect(n),o=this.getBeforeEdge(i),r=this.getBoxDir(),a=t.clearSide,s=-this.getBoxDir()*(1/0);switch("all"===a&&(s=this.pageFloatLayoutContext.getPageFloatClearEdge(a,this)),a){case"left":s=r*Math.max(s*r,this.leftFloatEdge*r);break;case"right":s=r*Math.max(s*r,this.rightFloatEdge*r);break;default:s=r*Math.max(s*r,Math.max(this.rightFloatEdge*r,this.leftFloatEdge*r))}if(o*r>=s*r)return t.viewNode.parentNode.removeChild(n),!1;var l=Math.max(1,(s-o)*r);this.vertical?n.style.width=l+"px":n.style.height=l+"px",i=this.clientLayout.getElementClientRect(n);var u=this.getAfterEdge(i);if(this.vertical){var c=u+e.right-s;c>0==e.right>=0&&(c+=e.right),n.style.marginLeft=c+"px"}else{var h=s-(u+e.top);h>0==e.top>=0&&(h+=e.top),n.style.marginBottom=h+"px"}return t.clearSpacer=n,!0},e.prototype.isBFC=function(t){return!!p.e(t)||!!N.c.isInstanceOfRepetitiveElementsOwnerFormattingContext(t)},e.prototype.skipEdges=function(t,e,n){var i=t.after?t.parent&&t.parent.formattingContext:t.formattingContext;if(i&&!this.isBFC(i))return b.d(t);var r=this,s=b.c("skipEdges"),l=!n&&e&&t&&t.after,u=n,c=null,h=[],f=[],d=!1;function g(){return!!n||!e&&a.c(u)}function m(){(t=h[0]||t).viewNode.parentNode.removeChild(t.viewNode),r.pageBreakType=u}return s.loopWithFrame(function(n){for(;t;){o.a(t.formattingContext);var i=(new p.c).find(t.formattingContext);do{if(!t.viewNode)break;if(t.inline&&1!=t.viewNode.nodeType){if(w.p(t.viewNode,t.whitespace))break;if(!t.after)return g()?m():r.checkOverflowAndSaveEdgeAndBreakPosition(c,null,!0,u)?(t=(r.stopAtOverflow&&c||t).modify()).overflow=!0:(t=t.modify()).breakBefore=u,void n.breakLoop()}if(!t.after){if(i&&i.startNonInlineElementNode(t))break;if(t.clearSide&&r.applyClearance(t)&&e&&0===r.breakPositions.length&&r.saveEdgeBreakPosition(t.copy(),u,!1),!r.isBFC(t.formattingContext)||N.c.isInstanceOfRepetitiveElementsOwnerFormattingContext(t.formattingContext)||r.isFloatNodeContext(t)||t.flexContainer)return h.push(t.copy()),u=a.d(u,t.breakBefore),g()?m():!r.checkOverflowAndSaveEdgeAndBreakPosition(c,null,!0,u)&&r.layoutConstraint.allowLayout(t)||((t=(r.stopAtOverflow&&c||t).modify()).overflow=!0),void n.breakLoop()}if(1!=t.viewNode.nodeType)break;var s=t.viewNode.style;if(t.after){if(t.inline)break;if(i&&i.afterNonInlineElementNode(t,r.stopAtOverflow))break;if(d){if(g())return m(),void n.breakLoop();h=[],e=!1,l=!1,u=null}d=!1,c=t.copy(),f.push(c),u=a.d(u,t.breakAfter),!s||r.zeroIndent(s.paddingBottom)&&r.zeroIndent(s.borderBottomWidth)||(f=[c])}else{if(h.push(t.copy()),u=a.d(u,t.breakBefore),!r.layoutConstraint.allowLayout(t)&&(r.checkOverflowAndSaveEdgeAndBreakPosition(c,null,!r.stopAtOverflow,u),(t=t.modify()).overflow=!0,r.stopAtOverflow))return void n.breakLoop();var y=t.viewNode.localName;if(S[y])return g()?m():r.checkOverflowAndSaveEdgeAndBreakPosition(c,null,!0,u)&&((t=(r.stopAtOverflow&&c||t).modify()).overflow=!0),void n.breakLoop();!s||r.zeroIndent(s.paddingTop)&&r.zeroIndent(s.borderTopWidth)||(l=!1,f=[]),d=!0}}while(0);var v=r.nextInTree(t,l);if(v.isPending())return void v.then(function(e){t=e,n.continueLoop()});t=v.get()}r.checkOverflowAndSaveEdgeAndBreakPosition(c,f,!r.stopAtOverflow,u)?c&&r.stopAtOverflow&&((t=c.modify()).overflow=!0):a.c(u)&&(r.pageBreakType=u),n.breakLoop()}).then(function(){c&&(r.lastAfterPosition=c.toNodePosition()),s.finish(t)}),s.result()},e.prototype.skipTailEdges=function(t){var e=t.copy(),n=this,i=b.c("skipEdges"),o=null,r=!1;return i.loopWithFrame(function(i){for(;t;){do{if(!t.viewNode)break;if(t.inline&&1!=t.viewNode.nodeType){if(w.p(t.viewNode,t.whitespace))break;if(!t.after)return a.c(o)&&(n.pageBreakType=o),void i.breakLoop()}if(!t.after&&(n.isFloatNodeContext(t)||t.flexContainer))return o=a.d(o,t.breakBefore),a.c(o)&&(n.pageBreakType=o),void i.breakLoop();if(1!=t.viewNode.nodeType)break;var s=t.viewNode.style;if(t.after){if(r){if(a.c(o))return n.pageBreakType=o,void i.breakLoop();o=null}r=!1,o=a.d(o,t.breakAfter)}else{o=a.d(o,t.breakBefore);var l=t.viewNode.localName;if(S[l])return a.c(o)&&(n.pageBreakType=o),void i.breakLoop();if(s&&(!n.zeroIndent(s.paddingTop)||!n.zeroIndent(s.borderTopWidth)))return void i.breakLoop()}r=!0}while(0);var u=n.layoutContext.nextInTree(t);if(u.isPending())return void u.then(function(e){t=e,i.continueLoop()});t=u.get()}e=null,i.breakLoop()}).then(function(){i.finish(e)}),i.result()},e.prototype.layoutFloatOrFootnote=function(t){return g.h(t.floatReference)||"footnote"===t.floatSide?this.layoutPageFloat(t):this.layoutFloat(t)},e.prototype.layoutNext=function(t,e,n){var i=this,r=b.c("layoutNext");return this.skipEdges(t,e,n||null).then(function(n){if(!(t=n)||i.pageBreakType||i.stopByOverflow(t))r.finish(t);else{var a=t.formattingContext;o.a(a),(new p.c).find(a).layout(t,i,e).thenFinish(r)}}),r.result()},e.prototype.clearOverflownViewNodes=function(t,e){if(t)for(var n=t.parent;t;t=n,n=n?n.parent:null){var i=(n||t).formattingContext;o.a(i),(new p.c).find(i).clearOverflownViewNodes(this,n,t,e),e=!1}},e.prototype.initGeom=function(){var t=this.element.ownerDocument.createElement("div");t.style.position="absolute",t.style.top=this.paddingTop+"px",t.style.right=this.paddingRight+"px",t.style.bottom=this.paddingBottom+"px",t.style.left=this.paddingLeft+"px",this.element.appendChild(t);var e=this.clientLayout.getElementClientRect(t);this.element.removeChild(t);var n=this.originX+this.left+this.getInsetLeft(),i=this.originY+this.top+this.getInsetTop();this.box=new c.c(n,i,n+this.width,i+this.height),this.startEdge=e?this.vertical?e.top:e.left:0,this.endEdge=e?this.vertical?e.bottom:e.right:0,this.beforeEdge=e?this.vertical?e.right:e.top:0,this.afterEdge=e?this.vertical?e.left:e.bottom:0,this.leftFloatEdge=this.beforeEdge,this.rightFloatEdge=this.beforeEdge,this.bottommostFloatTop=this.beforeEdge,this.footnoteEdge=this.afterEdge,this.bands=c.l(this.box,[this.getInnerShape()],this.getExclusions(),8,this.snapHeight,this.vertical),this.createFloats()},e.prototype.init=function(){this.chunkPositions=[],r.F(this.element,"width",this.width+"px"),r.F(this.element,"height",this.height+"px"),this.initGeom(),this.computedBlockSize=0,this.overflown=!1,this.pageBreakType=null,this.lastAfterPosition=null},e.prototype.saveEdgeBreakPosition=function(t,e,n){o.a(t.formattingContext);var i=t.copy(),r=(new p.c).find(t.formattingContext),a=this.calculateClonedPaddingBorder(i),s=r.createEdgeBreakPosition(i,e,n,this.computedBlockSize+a);this.breakPositions.push(s)},e.prototype.saveBoxBreakPosition=function(t){var e=t[0].breakPenalty,n=new x(t,e);this.breakPositions.push(n)},e.prototype.updateMaxReachedAfterEdge=function(t){if(!isNaN(t)){var e=this.getBoxDir()*(t-this.beforeEdge);this.computedBlockSize=Math.max(e,this.computedBlockSize)}},e.prototype.layout=function(t,e,n){if(this.chunkPositions.push(t),t.primary.after&&(this.lastAfterPosition=t.primary),this.stopAtOverflow&&this.overflown)return b.d(t);if(this.isFullWithPageFloats())return t.primary.after&&1===t.primary.steps.length?b.d(null):b.d(t);var i=this,o=b.c("layout");return i.openAllViews(t.primary).then(function(t){var r=null;if(t.viewNode)r=t.copy();else{var a=function(t){t.nodeContext.viewNode&&(r=t.nodeContext,i.layoutContext.removeEventListener("nextInTree",a))};i.layoutContext.addEventListener("nextInTree",a)}var s=new L(e,n);s.layout(t,i).then(function(t){i.doFinishBreak(t,s.context.overflownNodeContext,r,s.initialComputedBlockSize).then(function(t){(i.pseudoParent?b.d(null):i.doFinishBreakOfFragmentLayoutConstraints(t)).then(function(){if(i.pageFloatLayoutContext.isInvalidated())o.finish(null);else if(t){i.overflown=!0;var e=new w.a(t.toNodePosition());o.finish(e)}else o.finish(null)})})})}),o.result()},e.prototype.isFullWithPageFloats=function(){return this.pageFloatLayoutContext.isColumnFullWithPageFloats(this)},e.prototype.getMaxBlockSizeOfPageFloats=function(){return this.pageFloatLayoutContext.getMaxBlockSizeOfPageFloats()},e.prototype.doFinishBreakOfFragmentLayoutConstraints=function(t){var e=this,n=b.c("doFinishBreakOfFragmentLayoutConstraints"),i=[].concat(this.fragmentLayoutConstraints);i.sort(function(t,e){return t.getPriorityOfFinishBreak()-e.getPriorityOfFinishBreak()});var o=0;return n.loop(function(){return o<i.length?i[o++].finishBreak(t,e).thenReturn(!0):b.d(!1)}).then(function(){n.finish(!0)}),n.result()},e.prototype.doLayout=function(t,e,n){var i=this,o=b.c("doLayout"),r=null;return i.breakPositions=[],i.nodeContextOverflowingDueToRepetitiveElements=null,o.loopWithFrame(function(o){for(var a=function(){var a=!0;if(i.layoutNext(t,e,n||null).then(function(s){if(e=!1,n=null,i.nodeContextOverflowingDueToRepetitiveElements&&i.stopAtOverflow?(i.pageBreakType=null,(t=i.nodeContextOverflowingDueToRepetitiveElements).overflow=!0):t=s,i.pageFloatLayoutContext.isInvalidated())o.breakLoop();else if(i.pageBreakType)o.breakLoop();else if(t&&i.stopByOverflow(t)){r=t;var l=i.findAcceptableBreakPosition();t=l.nodeContext,l.breakPosition&&l.breakPosition.breakPositionChosen(i),o.breakLoop()}else a?a=!1:o.continueLoop()}),a)return a=!1,{value:void 0}};t;){var s=a();if("object"==typeof s)return s.value}i.computedBlockSize+=i.getOffsetByRepetitiveElements(),o.breakLoop()}).then(function(){o.finish({nodeContext:t,overflownNodeContext:r})}),o.result()},e.prototype.redoLayout=function(){for(var t=this.chunkPositions,e=this.element.lastChild;e!=this.last;){var n=e.previousSibling;this.element===e.parentNode&&this.layoutContext.isPseudoelement(e)||this.element.removeChild(e),e=n}this.killFloats(),this.init();var i=this,o=b.c("redoLayout"),r=0,a=null,s=!0;return o.loopWithFrame(function(e){if(r<t.length){var n=t[r++];i.layout(n,s).then(function(t){s=!1,t?(a=t,e.breakLoop()):e.continueLoop()})}else e.breakLoop()}).then(function(){o.finish(a)}),o.result()},e.prototype.saveDistanceToBlockEndFloats=function(){var t=this.pageFloatLayoutContext.getBlockStartEdgeOfBlockEndFloats();t>0&&isFinite(t)&&(this.blockDistanceToBlockEndFloats=this.getBoxDir()*(t-this.beforeEdge-this.computedBlockSize))},e.prototype.collectElementsOffset=function(){for(var t=this,e=[],n=this;n;n=n.pseudoParent)n.fragmentLayoutConstraints.forEach(function(n){if(N.c.isInstanceOfRepetitiveElementsOwnerLayoutConstraint(n)){var i=n.getRepetitiveElements();e.push(i)}y.b(n)&&(i=n.getRepetitiveElements(),e.push(i)),N.e.isInstanceOfTableRowLayoutConstraint(n)&&n.getElementsOffsetsForTableCell(t).forEach(function(t){e.push(t)})});return e},e}(w.b),A=/^[^A-Za-z0-9_\u009E\u009F\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02AF\u037B-\u037D\u0386\u0388-\u0482\u048A-\u0527]*([A-Za-z0-9_\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02AF\u037B-\u037D\u0386\u0388-\u0482\u048A-\u0527][^A-Za-z0-9_\u009E\u009F\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02AF\u037B-\u037D\u0386\u0388-\u0482\u048A-\u0527]*)?/,R=function(){function t(){}return t.prototype.breakTextNode=function(t,e,n,i,o,r){if(e.after)e.offsetInNode=t.length;else{var a=n-e.boxOffset,s=t.data;(a=173==s.charCodeAt(a)?this.breakAfterSoftHyphen(t,s,a,e):this.breakAfterOtherCharacter(t,s,a,e))>0&&(e=this.updateNodeContext(e,a,t))}return e},t.prototype.breakAfterSoftHyphen=function(t,e,n,i){return t.replaceData(n,e.length-n,i.breakWord?"":O(i)),n+1},t.prototype.breakAfterOtherCharacter=function(t,e,n,i){var o=e.charAt(n);n++;var a=e.charAt(n);return t.replaceData(n,e.length-n,!i.breakWord&&r.x(o)&&r.x(a)?O(i):""),n},t.prototype.updateNodeContext=function(t,e,n){return(t=t.modify()).offsetInNode+=e,t.breakBefore=null,t},t}();function O(t){return t.hyphenateCharacter||t.parent&&t.parent.hyphenateCharacter||"-"}R.instance=new R;var L=function(t){function e(e,n){var i=t.call(this)||this;return i.leadingEdge=e,i.initialPageBreakType=null,i.initialComputedBlockSize=0,i.initialOverflown=!1,i.context={overflownNodeContext:null},i.breakAfter=n||null,i}return C(e,t),e.prototype.resolveLayoutMode=function(t){return new k(this.leadingEdge,this.breakAfter,this.context)},e.prototype.prepareLayout=function(t,e){e.fragmentLayoutConstraints=[],e.pseudoParent||v.a()},e.prototype.clearNodes=function(e){t.prototype.clearNodes.call(this,e);for(var n=e;n;){var i=n.viewNode;i&&h.f(i.parentNode,i),n=n.parent}},e.prototype.saveState=function(e,n){t.prototype.saveState.call(this,e,n),this.initialPageBreakType=n.pageBreakType,this.initialComputedBlockSize=n.computedBlockSize,this.initialOverflown=n.overflown},e.prototype.restoreState=function(e,n){t.prototype.restoreState.call(this,e,n),n.pageBreakType=this.initialPageBreakType,n.computedBlockSize=this.initialComputedBlockSize,n.overflown=this.initialOverflown},e}(f.a),k=function(){function t(t,e,n){this.leadingEdge=t,this.breakAfter=e,this.context=n}return t.prototype.doLayout=function(t,e){var n=this,i=b.c("DefaultLayoutMode.doLayout");return y.d(t,e).then(function(){e.doLayout(t,n.leadingEdge,n.breakAfter).then(function(t){n.context.overflownNodeContext=t.overflownNodeContext,i.finish(t.nodeContext)})}),i.result()},t.prototype.accept=function(t,e){var n=this;return!(!e.pageFloatLayoutContext.isInvalidated()&&!e.pageBreakType)||e.fragmentLayoutConstraints.length<=0||e.fragmentLayoutConstraints.every(function(i){return i.allowLayout(t,n.context.overflownNodeContext,e)})},t.prototype.postLayout=function(t,e,n,i){if(!i){var o=n.fragmentLayoutConstraints.some(function(e){return e.nextCandidate(t)});i=!o}return n.fragmentLayoutConstraints.forEach(function(o){o.postLayout(i,t,e,n)}),i},t}(),F=function(t){function e(e,n,i,o,r,a,s){var l=t.call(this,n,i,o,r,a)||this;return l.floatSide=e,l.parentContainer=s,l.rootViewNodes=[],l.floatMargins=[],l.adjustContentRelativeSize=!0,l}return C(e,t),e.prototype.openAllViews=function(e){var n=this;return t.prototype.openAllViews.call(this,e).thenAsync(function(t){return t&&n.fixFloatSizeAndPosition(t),b.d(t)})},e.prototype.convertPercentageSizesToPx=function(t){var e=this.parentContainer.getPaddingRect(),n=e.x2-e.x1,i=e.y2-e.y1;function o(e,n){e.forEach(function(e){var i=r.t(t,e);if(i&&"%"===i.charAt(i.length-1)){var o=parseFloat(i),a=n*o/100;r.F(t,e,a+"px")}})}o(["width","max-width","min-width"],n),o(["height","max-height","min-height"],i),o(["margin-top","margin-right","margin-bottom","margin-left","padding-top","padding-right","padding-bottom","padding-left"],this.vertical?i:n),["margin-top","margin-right","margin-bottom","margin-left"].forEach(function(e){"auto"===r.t(t,e)&&r.F(t,e,"0")})},e.prototype.fixFloatSizeAndPosition=function(t){for(;t.parent;)t=t.parent;o.a(1===t.viewNode.nodeType);var e=t.viewNode;if(this.rootViewNodes.push(e),this.adjustContentRelativeSize&&this.convertPercentageSizesToPx(e),this.floatMargins.push(this.getComputedMargin(e)),this.adjustContentRelativeSize){var n=this.floatSide;if(this.parentContainer.vertical){if("block-end"===n||"left"===n){var i=r.t(e,"height");""!==i&&"auto"!==i&&r.F(e,"margin-top","auto")}}else if("block-end"===n||"bottom"===n){var a=r.t(e,"width");""!==a&&"auto"!==a&&r.F(e,"margin-left","auto")}}},e.prototype.getContentInlineSize=function(){var t=this;return Math.max.apply(null,this.rootViewNodes.map(function(e,n){var i=t.clientLayout.getElementClientRect(e),o=t.floatMargins[n];return t.vertical?o.top+i.height+o.bottom:o.left+i.width+o.right}))},e}(P)},function(t,e,n){n.d(e,"b",function(){return i}),n.d(e,"a",function(){return o});var i=[];function o(){i=[]}},function(t,e,n){n.r(e);var i,o,r,a=!1;!function(t){t.LTR="ltr",t.RTL="rtl"}(i||(i={})),function(t){t.LEFT="left",t.RIGHT="right"}(o||(o={})),function(t){t.LOADING="loading",t.INTERACTIVE="interactive",t.COMPLETE="complete"}(r||(r={}));var s={PageProgression:i,PageSide:o,ReadyState:r},l=n(9),u=n(6),c=function(){function t(t){this.performanceInstance=t,this.timestamps={},this.registerTiming=h,this.registerStartTiming=this.registerStartTiming=h,this.registerEndTiming=this.registerEndTiming=h}return t.prototype.forceRegisterStartTiming=function(t,e){p.call(this,t,"start",e)},t.prototype.forceRegisterEndTiming=function(t,e){p.call(this,t,"end",e)},t.prototype.printTimings=function(){var t=this.timestamps,e="";Object.keys(t).forEach(function(n){for(var i=t[n],o=i.length,r=0;r<o;r++){var a=i[r];e+=n,o>1&&(e+="("+r+")"),e+=" => start: "+a.start+", end: "+a.end+", duration: "+(a.end-a.start)+"\n"}}),u.b.info(e)},t.prototype.disable=function(){this.registerTiming=h,this.registerStartTiming=this.registerStartTiming=h,this.registerEndTiming=this.registerEndTiming=h},t.prototype.enable=function(){this.registerTiming=p,this.registerStartTiming=this.registerStartTiming=f,this.registerEndTiming=this.registerEndTiming=d},t.prototype.isEnabled=function(){return this.registerStartTiming===f},t}();function h(){}function p(t,e,n){n||(n=this.performanceInstance.now());var i,o=this.timestamps[t];o||(o=this.timestamps[t]=[]);for(var r=o.length-1;r>=0&&(!(i=o[r])||i[e]);r--)i=null;i||(i={},o.push(i)),i[e]=n}function f(t,e){this.registerTiming(t,"start",e)}function d(t,e){this.registerTiming(t,"end",e)}var g={now:Date.now},m=new c(window&&window.performance||g);m.forceRegisterStartTiming("load_vivliostyle");var y={profiler:{registerStartTiming:m.registerStartTiming,registerEndTiming:m.registerEndTiming,printTimings:m.printTimings,disable:m.disable,enable:m.enable}},v=n(7),E=n(1);function b(t){if(1==t.nodeType){var e=t.getAttribute("id");if(e&&e.match(/^[-a-zA-Z_0-9.\u007F-\uFFFF]+$/))return e}return null}function w(t){return"^"+t}function N(t){return t.replace(/[\[\]\(\),=;^]/g,w)}function C(t){return t.substr(1)}function S(t){return t?t.replace(/\^[\[\]\(\),=;^]/g,C):t}function T(t){var e=[];do{var n=t.match(/^(\^,|[^,])*/),i=S(n[0]);if(!(t=t.substr(n[0].length+1))&&!e.length)return i;e.push(i)}while(t);return e}function x(t){for(var e={};t;){var n=t.match(/^;([^;=]+)=(([^;]|\^;)*)/);if(!n)return e;e[n[1]]=T(n[2]),t=t.substr(n[0].length)}return e}var I=function(){function t(){}return t.prototype.appendTo=function(t){t.append("!")},t.prototype.applyTo=function(t){return!1},t}(),P=function(){function t(t,e,n){this.index=t,this.id=e,this.sideBias=n}return t.prototype.appendTo=function(t){t.append("/"),t.append(this.index.toString()),(this.id||this.sideBias)&&(t.append("["),this.id&&t.append(this.id),this.sideBias&&(t.append(";s="),t.append(this.sideBias)),t.append("]"))},t.prototype.applyTo=function(t){if(1!=t.node.nodeType)throw new Error("E_CFI_NOT_ELEMENT");var e,n=t.node,i=n.children,o=i.length,r=Math.floor(this.index/2)-1;if(r<0||0==o)e=n.firstChild,t.node=e||n;else{if(e=i[Math.min(r,o-1)],1&this.index){var a=e.nextSibling;a&&1!=a.nodeType?e=a:t.after=!0}t.node=e}if(this.id&&(t.after||this.id!=b(t.node)))throw new Error("E_CFI_ID_MISMATCH");return t.sideBias=this.sideBias,!0},t}(),A=function(){function t(t,e,n,i){this.offset=t,this.textBefore=e,this.textAfter=n,this.sideBias=i}return t.prototype.applyTo=function(t){if(this.offset>0&&!t.after){for(var e=this.offset,n=t.node;;){var i=n.nodeType;if(1==i)break;var o=n.nextSibling;if(3<=i&&i<=5){var r=n.textContent.length;if(e<=r)break;if(!o){e=r;break}e-=r}if(!o){e=0;break}n=o}t.node=n,t.offset=e}return t.sideBias=this.sideBias,!0},t.prototype.appendTo=function(t){t.append(":"),t.append(this.offset.toString()),(this.textBefore||this.textAfter||this.sideBias)&&(t.append("["),(this.textBefore||this.textAfter)&&(this.textBefore&&t.append(N(this.textBefore)),t.append(","),this.textAfter&&t.append(N(this.textAfter))),this.sideBias&&(t.append(";s="),t.append(this.sideBias)),t.append("]"))},t}(),R=function(){function t(){this.steps=null}return t.prototype.fromString=function(t){var e=t.match(/^#?epubcfi\((.*)\)$/);if(!e)throw new Error("E_CFI_NOT_CFI");for(var n=e[1],i=0,o=[];;){var r=void 0;switch(n.charAt(i)){case"/":if(i++,!(e=n.substr(i).match(/^(0|[1-9][0-9]*)(\[([-a-zA-Z_0-9.\u007F-\uFFFF]+)(;([^\]]|\^\])*)?\])?/)))throw new Error("E_CFI_NUMBER_EXPECTED");i+=e[0].length;var a=parseInt(e[1],10),s=e[3];r=x(e[4]),o.push(new P(a,s,E.g(r.s)));break;case":":if(i++,!(e=n.substr(i).match(/^(0|[1-9][0-9]*)(\[((([^\];,]|\^[\];,])*)(,(([^\];,]|\^[\];,])*))?)(;([^]]|\^\])*)?\])?/)))throw new Error("E_CFI_NUMBER_EXPECTED");i+=e[0].length;var l=parseInt(e[1],10),u=e[4];u&&(u=S(u));var c=e[7];c&&(c=S(c)),r=x(e[10]),o.push(new A(l,u,c,E.g(r.s)));break;case"!":i++,o.push(new I);break;case"~":case"@":case"":return void(this.steps=o);default:throw new Error("E_CFI_PARSE_ERROR")}}},t.prototype.navigate=function(e){for(var n={node:e.documentElement,offset:0,after:!1,sideBias:null,ref:null},i=0;i<this.steps.length;i++)if(!this.steps[i].applyTo(n)){n.ref=new t,n.ref.steps=this.steps.slice(i+1);break}return n},t.prototype.trim=function(t,e){return t.replace(/\s+/g," ").match(e?/^[ -\uD7FF\uE000-\uFFFF]{0,8}/:/[ -\uD7FF\uE000-\uFFFF]{0,8}$/)[0].replace(/^\s/,"").replace(/\s$/,"")},t.prototype.prependPathFromNode=function(t,e,n,i){for(var o=[],r=t.parentNode,a="",s="";t;){switch(t.nodeType){case 3:case 4:case 5:var l=t.textContent,u=l.length;n?(e+=u,a||(a=l)):(e>u&&(e=u),n=!0,a=l.substr(0,e),s=l.substr(e)),t=t.previousSibling;continue;case 8:t=t.previousSibling;continue}break}for((e>0||a||s)&&(a=this.trim(a,!1),s=this.trim(s,!0),o.push(new A(e,a,s,i)),i=null);r&&r&&9!=r.nodeType;){for(var c=n?null:b(t),h=n?1:0;t;)1==t.nodeType&&(h+=2),t=t.previousSibling;o.push(new P(h,c,i)),i=null,t=r,r=r.parentNode,n=!1}o.reverse(),this.steps?(o.push(new I),this.steps=o.concat(this.steps)):this.steps=o},t.prototype.toString=function(){if(!this.steps)return"";var t=new E.d;t.append("epubcfi(");for(var e=0;e<this.steps.length;e++)this.steps[e].appendTo(t);return t.append(")"),t.toString()},t}(),O=n(20),L=n(4);function k(t){var e={};return Object.keys(t).forEach(function(n){e[n]=Array.from(t[n])}),e}var F,_=function(){function t(t,e){this.targetId=t,this.resolved=e,this.pageCounters=null,this.spineIndex=-1,this.pageIndex=-1}return t.prototype.equals=function(t){return this===t||!!t&&this.targetId===t.targetId&&this.resolved===t.resolved&&this.spineIndex===t.spineIndex&&this.pageIndex===t.pageIndex},t.prototype.isResolved=function(){return this.resolved},t.prototype.resolve=function(){this.resolved=!0},t.prototype.unresolve=function(){this.resolved=!1},t}(),D=function(){function t(t,e){this.counterStore=t,this.baseURL=e}return t.prototype.countersOfId=function(t,e){t=this.counterStore.documentURLTransformer.transformFragment(t,this.baseURL),this.counterStore.countersById[t]=e},t.prototype.getExprContentListener=function(){return this.counterStore.getExprContentListener()},t}(),B=function(){function t(t,e,n,i){this.counterStore=t,this.baseURL=e,this.rootScope=n,this.pageScope=i,this.styler=null}return t.prototype.setStyler=function(t){this.styler=t},t.prototype.getFragment=function(t){var e=t.match(/^[^#]*#(.*)$/);return e?e[1]:null},t.prototype.getTransformedId=function(t){var e=this.counterStore.documentURLTransformer.transformURL(E.C(t,this.baseURL),this.baseURL);return"#"===e.charAt(0)&&(e=e.substring(1)),e},t.prototype.getPageCounterVal=function(t,e){var n=this,i=new L.t(this.pageScope,function(){return e((i=n.counterStore.currentPageCounters[t])&&i.length?i[i.length-1]:null);var i},"page-counter-"+t);return this.counterStore.registerPageCounterExpr(t,function(t){return e(t[0])},i),i},t.prototype.getPageCountersVal=function(t,e){var n=this,i=new L.t(this.pageScope,function(){return e(n.counterStore.currentPageCounters[t]||[])},"page-counters-"+t);return this.counterStore.registerPageCounterExpr(t,e,i),i},t.prototype.getTargetCounters=function(t,e,n){var i=this.counterStore.countersById[e];return!i&&n&&t&&(this.styler.styleUntilIdIsReached(t),i=this.counterStore.countersById[e]),i||null},t.prototype.getTargetPageCounters=function(t){return this.counterStore.currentPage.elementsById[t]?this.counterStore.currentPageCounters:this.counterStore.pageCountersById[t]||null},t.prototype.getTargetCounterVal=function(t,e,n){var i=this.getFragment(t),o=this.getTransformedId(t),r=this.getTargetCounters(i,o,!1);if(r&&r[e]){var a=r[e];return new L.f(this.rootScope,n(a[a.length-1]||null))}var s=this;return new L.t(this.pageScope,function(){if(r=s.getTargetCounters(i,o,!0)){if(r[e]){var t=r[e];return n(t[t.length-1]||null)}var a=s.getTargetPageCounters(o);if(a){if(s.counterStore.resolveReference(o),a[e]){var l=a[e];return n(l[l.length-1]||null)}return n(0)}return s.counterStore.saveReferenceOfCurrentPage(o,!1),"??"}return s.counterStore.saveReferenceOfCurrentPage(o,!1),"??"},"target-counter-"+e+"-of-"+t)},t.prototype.getTargetCountersVal=function(t,e,n){var i=this.getFragment(t),o=this.getTransformedId(t),r=this;return new L.t(this.pageScope,function(){var t=r.getTargetPageCounters(o);if(t){r.counterStore.resolveReference(o);var a=t[e]||[],s=r.getTargetCounters(i,o,!0)[e]||[];return n(a.concat(s))}return r.counterStore.saveReferenceOfCurrentPage(o,!1),"??"},"target-counters-"+e+"-of-"+t)},t}(),M=function(){function t(t){this.documentURLTransformer=t,this.countersById={},this.pageCountersById={},this.currentPageCounters={},this.previousPageCounters={},this.currentPageCountersStack=[],this.pageIndicesById={},this.currentPage=null,this.newReferencesOfCurrentPage=[],this.referencesToSolve=[],this.referencesToSolveStack=[],this.unresolvedReferences={},this.resolvedReferences={},this.pagesCounterExprs=[],this.currentPageCounters.page=[0]}return t.prototype.createCounterListener=function(t){return new D(this,t)},t.prototype.createCounterResolver=function(t,e,n){return new B(this,t,e,n)},t.prototype.setCurrentPage=function(t){this.currentPage=t},t.prototype.definePageCounter=function(t,e){this.currentPageCounters[t]?this.currentPageCounters[t].push(e):this.currentPageCounters[t]=[e]},t.prototype.forceSetPageCounter=function(t){var e=this.currentPageCounters.page;e&&e.length?e[e.length-1]=t:this.currentPageCounters.page=[t]},t.prototype.updatePageCounters=function(t,e){var n;this.previousPageCounters=k(this.currentPageCounters);var i,o=t["counter-reset"];if(o){var r=o.evaluate(e);r&&(n=O.b(r,!0))}if(n)for(var a in n)this.definePageCounter(a,n[a]);var s=t["counter-increment"];if(s){var l=s.evaluate(e);l&&(i=O.b(l,!1))}for(var u in i?"page"in i||(i.page=1):(i={}).page=1,i){this.currentPageCounters[u]||this.definePageCounter(u,0);var c=this.currentPageCounters[u];c[c.length-1]+=i[u]}},t.prototype.pushPageCounters=function(t){this.currentPageCountersStack.push(this.currentPageCounters),this.currentPageCounters=k(t)},t.prototype.popPageCounters=function(){this.currentPageCounters=this.currentPageCountersStack.pop()},t.prototype.resolveReference=function(t){var e=this.unresolvedReferences[t],n=this.resolvedReferences[t];n||(n=this.resolvedReferences[t]=[]);for(var i=!1,o=0;o<this.referencesToSolve.length;){var r=this.referencesToSolve[o];if(r.targetId===t){if(r.resolve(),this.referencesToSolve.splice(o,1),e){var a=e.indexOf(r);a>=0&&e.splice(a,1)}n.push(r),i=!0}else o++}i||this.saveReferenceOfCurrentPage(t,!0)},t.prototype.saveReferenceOfCurrentPage=function(t,e){if(!this.newReferencesOfCurrentPage.some(function(e){return e.targetId===t})){var n=new _(t,e);this.newReferencesOfCurrentPage.push(n)}},t.prototype.finishPage=function(t,e){var n=this,i=Object.keys(this.currentPage.elementsById);if(i.length>0){var o=k(this.currentPageCounters);i.forEach(function(i){n.pageCountersById[i]=o;var r=n.pageIndicesById[i];if(r&&r.pageIndex<e){var a=n.resolvedReferences[i];if(a){var s,l=n.unresolvedReferences[i];for(l||(l=n.unresolvedReferences[i]=[]);s=a.shift();)s.unresolve(),l.push(s)}}n.pageIndicesById[i]={spineIndex:t,pageIndex:e}})}for(var r,a=this.previousPageCounters;r=this.newReferencesOfCurrentPage.shift();){r.pageCounters=a,r.spineIndex=t,r.pageIndex=e;var s=void 0;r.isResolved()?(s=this.resolvedReferences[r.targetId])||(s=this.resolvedReferences[r.targetId]=[]):(s=this.unresolvedReferences[r.targetId])||(s=this.unresolvedReferences[r.targetId]=[]),s.every(function(t){return!r.equals(t)})&&s.push(r)}this.currentPage=null},t.prototype.getUnresolvedRefsToPage=function(t){var e=this,n=[];Object.keys(t.elementsById).forEach(function(t){var i=e.unresolvedReferences[t];i&&(n=n.concat(i))}),n.sort(function(t,e){return t.spineIndex-e.spineIndex||t.pageIndex-e.pageIndex});var i=[],o=null;return n.forEach(function(t){o&&o.spineIndex===t.spineIndex&&o.pageIndex===t.pageIndex?o.refs.push(t):(o={spineIndex:t.spineIndex,pageIndex:t.pageIndex,pageCounters:t.pageCounters,refs:[t]},i.push(o))}),i},t.prototype.pushReferencesToSolve=function(t){this.referencesToSolveStack.push(this.referencesToSolve),this.referencesToSolve=t},t.prototype.popReferencesToSolve=function(){this.referencesToSolve=this.referencesToSolveStack.pop()},t.prototype.registerPageCounterExpr=function(t,e,n){"pages"===t&&this.pagesCounterExprs.push({expr:n,format:e})},t.prototype.getExprContentListener=function(){return this.exprContentListener.bind(this)},t.prototype.exprContentListener=function(t,e,n){if(this.pagesCounterExprs.findIndex(function(e){return e.expr===t})>=0){var i=n.createElement("span");return i.textContent=e,i.setAttribute(U,t.key),i}return null},t.prototype.finishLastPage=function(t){var e=this,n=t.root.querySelectorAll("["+U+"]"),i=this.currentPageCounters.page[0];Array.from(n).forEach(function(t){var n=t.getAttribute(U),o=e.pagesCounterExprs.findIndex(function(t){return t.expr.key===n});v.a(o>=0),t.textContent=e.pagesCounterExprs[o].format([i])})},t.prototype.createLayoutConstraint=function(t){return new V(this,t)},t}(),U="data-vivliostyle-pages-counter",V=function(){function t(t,e){this.counterStore=t,this.pageIndex=e}return t.prototype.allowLayout=function(t){if(!t||t.after)return!0;var e=t.viewNode;if(!e||1!==e.nodeType)return!0;var n=e.getAttribute("id")||e.getAttribute("name");if(!n)return!0;if(!this.counterStore.resolvedReferences[n]&&!this.counterStore.unresolvedReferences[n])return!0;var i=this.counterStore.pageIndicesById[n];return!i||this.pageIndex>=i.pageIndex},t}(),H=n(5),z=n(10),G=n(2),W=n(16),X=n(0),j=n(12),Y=n(3),q=n(8),K=(F=function(t,e){return(F=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}F(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),Q=j.d,Z=function(t){function e(e,n,i,o,r){var a=t.call(this,e,n,"block-end",null,i,r)||this;return a.footnotePolicy=o,a}return K(e,t),e.prototype.isAllowedToPrecede=function(t){return!(t instanceof e)},e}(j.b),$=function(t){function e(e,n,i,o){return t.call(this,e,"block-end",n,i,o)||this}return K(e,t),e.prototype.getOrder=function(){return 1/0},e.prototype.shouldBeStashedBefore=function(t){return t instanceof Z||this.getOrder()<t.getOrder()},e}(Q),J=function(){function t(t){this.footnote=t}return t.prototype.allowLayout=function(t){var e=t.toNodePosition();return!q.u(e,this.footnote.nodePosition)},t}(),tt=function(){function t(){}return t.prototype.appliesToNodeContext=function(t){return"footnote"===t.floatSide},t.prototype.appliesToFloat=function(t){return t instanceof Z},t.prototype.createPageFloat=function(t,e,n){var i=j.a.REGION,o=e.getPageFloatLayoutContext(i);e.getPageFloatLayoutContext(j.a.PAGE).hasSameContainerAs(o)&&(i=j.a.PAGE);var r=t.toNodePosition();v.a(e.flowName);var a=new Z(r,i,e.flowName,t.footnotePolicy,t.floatMinWrapBlock);return e.addPageFloat(a),Y.d(a)},t.prototype.createPageFloatFragment=function(t,e,n,i){var o=t[0].float;return new $(o.floatReference,t,n,i)},t.prototype.findPageFloatFragment=function(t,e){var n=e.getPageFloatLayoutContext(t.floatReference).floatFragments.filter(function(t){return t instanceof $});return v.a(n.length<=1),n[0]||null},t.prototype.adjustPageFloatArea=function(t,e,n){t.isFootnote=!0,t.adjustContentRelativeSize=!1;var i=t.element;v.a(i),t.vertical=n.layoutContext.applyFootnoteStyle(e.vertical,n.layoutContext.nodeContext&&"rtl"===n.layoutContext.nodeContext.direction,i),t.convertPercentageSizesToPx(i),n.setComputedInsets(i,t),n.setComputedWidthAndHeight(i,t)},t.prototype.forbid=function(t,e){var n=t;switch(n.footnotePolicy){case X.t.line:var i=new J(n);e.addLayoutConstraint(i,n.floatReference)}},t}();j.f.register(new tt);var et=n(22),nt=n(14),it=n(18),ot=n(29),rt=n(23),at=n(26),st=n(31),lt=n(15),ut=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),ct=function(){function t(t,e){this.parent=t,this.rootSourceNode=e,this.formattingContextType="RepetitiveElementsOwner",this.isRoot=!1,this.repetitiveElements=null}return t.prototype.getName=function(){return"Repetitive elements owner formatting context (RepetitiveElementsOwnerFormattingContext)"},t.prototype.isFirstTime=function(t,e){return e},t.prototype.getParent=function(){return this.parent},t.prototype.getRepetitiveElements=function(){return this.repetitiveElements},t.prototype.getRootViewNode=function(t){var e=this.getRootNodeContext(t);return e?e.viewNode:null},t.prototype.getRootNodeContext=function(t){do{if(!t.belongsTo(this)&&t.sourceNode===this.rootSourceNode)return t}while(t=t.parent);return null},t.prototype.initializeRepetitiveElements=function(t){var e=this;this.repetitiveElements||st.b.some(function(t){return t.root===e.rootSourceNode&&(e.repetitiveElements=t.elements,!0)})||(this.repetitiveElements=new ht(t,this.rootSourceNode),st.b.push({root:this.rootSourceNode,elements:this.repetitiveElements}))},t.prototype.saveState=function(){},t.prototype.restoreState=function(t){},t}(),ht=function(){function t(t,e){this.vertical=t,this.ownerSourceNode=e,this.headerSourceNode=null,this.footerSourceNode=null,this.headerViewNode=null,this.footerViewNode=null,this.headerNodePosition=null,this.footerNodePosition=null,this.headerHeight=0,this.footerHeight=0,this.isSkipHeader=!1,this.isSkipFooter=!1,this.enableSkippingFooter=!0,this.enableSkippingHeader=!0,this.doneInitialLayout=!1,this.firstContentSourceNode=null,this.lastContentSourceNode=null,this.affectedNodeCache=[],this.afterLastContentNodeCache=[],this.allowInsert=!1}return t.prototype.setHeaderNodeContext=function(t){this.headerNodePosition||(this.headerNodePosition=q.x(t,0),this.headerSourceNode=t.sourceNode,this.headerViewNode=t.viewNode)},t.prototype.setFooterNodeContext=function(t){this.footerNodePosition||(this.footerNodePosition=q.x(t,0),this.footerSourceNode=t.sourceNode,this.footerViewNode=t.viewNode)},t.prototype.updateHeight=function(t){this.headerViewNode&&(this.headerHeight=nt.b(this.headerViewNode,t,this.vertical),this.headerViewNode=null),this.footerViewNode&&(this.footerHeight=nt.b(this.footerViewNode,t,this.vertical),this.footerViewNode=null)},t.prototype.prepareLayoutFragment=function(){this.isSkipHeader=this.isSkipFooter=!1,this.enableSkippingFooter=!0,this.enableSkippingHeader=!0},t.prototype.appendHeaderToFragment=function(t,e,n){return!this.headerNodePosition||this.isSkipHeader?Y.d(!0):this.appendElementToFragment(this.headerNodePosition,t,e,n)},t.prototype.appendFooterToFragment=function(t,e,n){return!this.footerNodePosition||this.isSkipFooter?Y.d(!0):this.appendElementToFragment(this.footerNodePosition,t,e,n)},t.prototype.appendElementToFragment=function(t,e,n,i){var o=this,r=e.viewNode.ownerDocument,a=e.viewNode,s=r.createElement("div");a.appendChild(s);var l=new rt.PseudoColumn(i,s,e),u=l.getColumn().pageBreakType;return l.getColumn().pageBreakType=null,this.allowInsertRepeatitiveElements=!0,l.layout(new q.a(t),!0).thenAsync(function(){return o.allowInsertRepeatitiveElements=!1,a.removeChild(s),o.moveChildren(s,a,n),l.getColumn().pageBreakType=u,Y.d(!0)})},t.prototype.moveChildren=function(t,e,n){if(e)for(;t.firstChild;){var i=t.firstChild;t.removeChild(i),i.setAttribute(q.m,"1"),n?e.insertBefore(i,n):e.appendChild(i)}},t.prototype.calculateOffset=function(t){var e=0;return t&&!this.affectTo(t)?e:((!this.isSkipFooter||t&&this.isAfterLastContent(t))&&(e+=this.footerHeight),this.isSkipHeader||(e+=this.headerHeight),e)},t.prototype.calculateMinimumOffset=function(t){var e=0;return t&&!this.affectTo(t)?e:(t&&this.isAfterLastContent(t)&&(e+=this.footerHeight),this.enableSkippingHeader||(e+=this.headerHeight),e)},t.prototype.isAfterLastContent=function(t){var e=this;return this.findResultFromCache(t,this.afterLastContentNodeCache,function(n){return e.isAfterNodeContextOf(e.lastContentSourceNode,t,!1)})},t.prototype.affectTo=function(t){var e=this;return this.findResultFromCache(t,this.affectedNodeCache,function(n){return e.isAfterNodeContextOf(e.ownerSourceNode,t,!0)})},t.prototype.findResultFromCache=function(t,e,n){var i=e.filter(function(e){return e.nodeContext.sourceNode===t.sourceNode&&e.nodeContext.after===t.after});if(i.length>0)return i[0].result;var o=n(t);return e.push({nodeContext:t,result:o}),o},t.prototype.isAfterNodeContextOf=function(t,e,n){for(var i=[],o=t;o;o=o.parentNode){if(e.sourceNode===o)return e.after;i.push(o)}for(var r=e.sourceNode;r;r=r.parentNode){var a=i.indexOf(r);if(a>=0)return!!n&&0===a;for(var s=r;s;s=s.previousElementSibling)if(i.includes(s))return!0}return e.after},t.prototype.isFirstContentNode=function(t){return t&&this.firstContentSourceNode===t.sourceNode},t.prototype.isEnableToUpdateState=function(){return!!(!this.isSkipFooter&&this.enableSkippingFooter&&this.footerNodePosition||!this.isSkipHeader&&this.enableSkippingHeader&&this.headerNodePosition)},t.prototype.updateState=function(){!this.isSkipFooter&&this.enableSkippingFooter&&this.footerNodePosition?this.isSkipFooter=!0:!this.isSkipHeader&&this.enableSkippingHeader&&this.headerNodePosition&&(this.isSkipHeader=!0)},t.prototype.preventSkippingHeader=function(){this.isSkipHeader=!1,this.enableSkippingHeader=!1},t.prototype.preventSkippingFooter=function(){this.isSkipFooter=!1,this.enableSkippingFooter=!1},t.prototype.isHeaderRegistered=function(){return!!this.headerNodePosition},t.prototype.isFooterRegistered=function(){return!!this.footerNodePosition},t.prototype.isHeaderSourceNode=function(t){return this.headerSourceNode===t},t.prototype.isFooterSourceNode=function(t){return this.footerSourceNode===t},t}(),pt=function(){function t(t){this.formattingContext=t}return t.prototype.accept=function(t,e){return!!t},t.prototype.postLayout=function(t,e,n,i){var o=this.formattingContext.getRepetitiveElements();return o&&(v.a(n.clientLayout),o.doneInitialLayout||(o.updateHeight(n),o.doneInitialLayout=!0)),i},t}(),ft=function(){function t(t){this.formattingContext=t}return t.prototype.accept=function(t,e){return!0},t.prototype.postLayout=function(t,e,n,i){return i},t}(),dt=function(t){function e(e,n){var i=t.call(this,e)||this;return i.processor=n,i}return ut(e,t),e.prototype.doLayout=function(t,e){return this.processor.doInitialLayout(t,e)},e.prototype.accept=function(t,e){return!1},e}(pt),gt=function(t){function e(e,n){var i=t.call(this,e)||this;return i.processor=n,i}return ut(e,t),e.prototype.doLayout=function(t,e){return t.belongsTo(this.formattingContext)||t.after||e.fragmentLayoutConstraints.unshift(new mt(t)),this.processor.doLayout(t,e)},e}(ft),mt=function(){function t(t){this.flagmentLayoutConstraintType="RepetitiveElementsOwner";var e=bt(t.formattingContext);this.nodeContext=e.getRootNodeContext(t)}return t.prototype.allowLayout=function(t,e,n){var i=this.getRepetitiveElements();return!(i&&!nt.c(this.nodeContext.viewNode)&&i.isEnableToUpdateState()&&(e&&!t||t&&t.overflow))},t.prototype.nextCandidate=function(t){var e=this.getRepetitiveElements();return!!e&&!!e.isEnableToUpdateState()&&(e.updateState(),!0)},t.prototype.postLayout=function(t,e,n,i){var o=this.getRepetitiveElements();o&&t&&i.stopAtOverflow&&(null==e||o.isAfterLastContent(e))&&o.preventSkippingFooter()},t.prototype.finishBreak=function(t,e){var n=bt(this.nodeContext.formattingContext),i=this.getRepetitiveElements();if(!i)return Y.d(!0);var o=this.nodeContext;return function(t,e,n){var i=t.getRepetitiveElements();if(i){var o=t.getRootNodeContext(e);if(o.viewNode){var r=o.viewNode.firstChild;return i.appendHeaderToFragment(o,r,n)}}return Y.d(!0)}(n,o,e).thenAsync(function(){return function(t,e,n){var i=t.getRepetitiveElements();if(i&&!i.isSkipFooter){var o=t.getRootNodeContext(e);if(o.viewNode)return i.appendFooterToFragment(o,null,n)}return Y.d(!0)}(n,o,e).thenAsync(function(){return i.prepareLayoutFragment(),Y.d(!0)})})},t.prototype.getRepetitiveElements=function(){return bt(this.nodeContext.formattingContext).getRepetitiveElements()},t.prototype.equalsTo=function(e){return e instanceof t&&bt(this.nodeContext.formattingContext)===bt(e.nodeContext.formattingContext)},t.prototype.getPriorityOfFinishBreak=function(){return 10},t}(),yt=function(t){function e(e,n){var i=t.call(this)||this;return i.formattingContext=e,i.processor=n,i}return ut(e,t),e.prototype.resolveLayoutMode=function(t){var e=this.formattingContext.getRepetitiveElements();return t.belongsTo(this.formattingContext)||e.doneInitialLayout?(t.belongsTo(this.formattingContext)||t.after||e&&e.preventSkippingHeader(),new gt(this.formattingContext,this.processor)):new dt(this.formattingContext,this.processor)},e}(ot.a),vt=function(t){function e(e,n){var i=t.call(this)||this;return i.formattingContext=e,i.column=n,i}return ut(e,t),e.prototype.startNonInlineElementNode=function(t){var e=this.formattingContext,n=t.nodeContext,i=e.getRepetitiveElements();if(n.parent&&e.rootSourceNode===n.parent.sourceNode){switch(n.repeatOnBreak){case"header":if(!i.isHeaderRegistered())return i.setHeaderNodeContext(n),Y.d(!0);n.repeatOnBreak="none";break;case"footer":if(!i.isFooterRegistered())return i.setFooterNodeContext(n),Y.d(!0);n.repeatOnBreak="none"}i.firstContentSourceNode||(i.firstContentSourceNode=n.sourceNode)}return rt.EdgeSkipper.prototype.startNonInlineElementNode.call(this,t)},e.prototype.afterNonInlineElementNode=function(t){var e=this.formattingContext,n=t.nodeContext;return n.sourceNode===e.rootSourceNode&&(e.getRepetitiveElements().lastContentSourceNode=t.lastAfterNodeContext&&t.lastAfterNodeContext.sourceNode,t.break=!0),"header"===n.repeatOnBreak||"footer"===n.repeatOnBreak?Y.d(!0):rt.EdgeSkipper.prototype.afterNonInlineElementNode.call(this,t)},e}(rt.EdgeSkipper);function Et(t,e){t&&function(t,e){for(var n=t;n;n=n.parent){var i=n.formattingContext;i&&i instanceof ct&&!n.belongsTo(i)&&e(i,n)}}(t.after?t.parent:t,function(t,n){lt.e.isInstanceOfTableFormattingContext(t)||e.fragmentLayoutConstraints.push(new mt(n))})}function bt(t){return v.a(t instanceof ct),t}!function(t){ut(function(e,n){var i=t.call(this)||this;return i.formattingContext=e,i.column=n,i},t)}(rt.EdgeSkipper);var wt=new(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return ut(e,t),e.prototype.layout=function(t,e,n){if(e.isFloatNodeContext(t))return e.layoutFloatOrFootnote(t);var i=bt(t.formattingContext);return i.getRootViewNode(t)?(n&&Et(t.parent,e),t.belongsTo(i)?it.b.prototype.layout.call(this,t,e,n):new yt(i,this).layout(t,e)):e.buildDeepElementView(t)},e.prototype.startNonInlineElementNode=function(t){var e=function(t){var e=t.formattingContext;return e&&e instanceof ct?e:null}(t).getRepetitiveElements();return!!e&&(e.allowInsertRepeatitiveElements||!e.isHeaderSourceNode(t.sourceNode)&&!e.isFooterSourceNode(t.sourceNode)||t.viewNode.parentNode.removeChild(t.viewNode),!1)},e.prototype.doInitialLayout=function(t,e){bt(t.formattingContext);var n=Y.c("BlockLayoutProcessor.doInitialLayout");return this.layoutEntireBlock(t,e).thenFinish(n),n.result()},e.prototype.layoutEntireBlock=function(t,e){var n=bt(t.formattingContext),i=new vt(n,e);return new rt.LayoutIterator(i,e.layoutContext).iterate(t)},e.prototype.doLayout=function(t,e){var n=bt(t.formattingContext),i=Y.c("doLayout"),o=e.layoutContext.nextInTree(t,!1);return at.c(o,e).then(function(t){var o=t;i.loopWithFrame(function(t){for(var i=function(){var i=!0;if(e.layoutNext(o,!1).then(function(r){o=r,e.pageFloatLayoutContext.isInvalidated()?t.breakLoop():e.pageBreakType?t.breakLoop():o&&e.stopByOverflow(o)?t.breakLoop():o&&o.after&&o.sourceNode==n.rootSourceNode?t.breakLoop():i?i=!1:t.continueLoop()}),i)return i=!1,{value:void 0}};o;){var r=i();if("object"==typeof r)return r.value}t.breakLoop()}).then(function(){i.finish(o)})}),i.result()},e.prototype.finishBreak=function(t,e,n,i){return it.b.prototype.finishBreak.call(this,t,e,n,i)},e.prototype.clearOverflownViewNodes=function(t,e,n,i){it.b.prototype.clearOverflownViewNodes(t,e,n,i)},e}(it.b));l.d(l.a.RESOLVE_LAYOUT_PROCESSOR,function(t){return t instanceof ct&&!lt.e.isInstanceOfTableFormattingContext(t)?wt:null});var Nt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),Ct=function(){function t(t,e){this.rowIndex=t,this.sourceNode=e,this.cells=[]}return t.prototype.addCell=function(t){this.cells.push(t)},t.prototype.getMinimumHeight=function(){return Math.min.apply(null,this.cells.map(function(t){return t.height}))},t}(),St=function(){function t(t,e,n){this.rowIndex=t,this.columnIndex=e,this.height=0,this.anchorSlot=null,this.viewElement=n,this.colSpan=n.colSpan||1,this.rowSpan=n.rowSpan||1}return t.prototype.setHeight=function(t){this.height=t},t.prototype.setAnchorSlot=function(t){this.anchorSlot=t},t}(),Tt=function(t,e,n){this.rowIndex=t,this.columnIndex=e,this.cell=n},xt=function(){function t(t,e,n){this.column=t,this.cellNodeContext=n,this.empty=!1,this.pseudoColumn=new rt.PseudoColumn(t,e,n)}return t.prototype.findAcceptableBreakPosition=function(){var t=this.cellNodeContext.viewNode,e=this.cellNodeContext.verticalAlign;"middle"!==e&&"bottom"!==e||E.F(t,"vertical-align","top");var n=this.pseudoColumn.findAcceptableBreakPosition(!0);return E.F(t,"vertical-align",e),n},t}(),It=function(t,e){this.viewNode=t,this.side=e},Pt=function(t){function e(e,n,i,o){var r=t.call(this,e,n,i,o)||this;return r.acceptableCellBreakPositions=null,r.rowIndex=null,r.formattingContext=e.formattingContext,r}return Nt(e,t),e.prototype.findAcceptableBreak=function(e,n){var i=t.prototype.findAcceptableBreak.call(this,e,n);return n<this.getMinBreakPenalty()?null:this.getAcceptableCellBreakPositions().every(function(t){return!!t.nodeContext})?i:null},e.prototype.getMinBreakPenalty=function(){var e=t.prototype.getMinBreakPenalty.call(this);return this.getAcceptableCellBreakPositions().forEach(function(t){e+=t.breakPosition.getMinBreakPenalty()}),e},e.prototype.getAcceptableCellBreakPositions=function(){if(!this.acceptableCellBreakPositions){this.formattingContext;var t=this.getCellFragments();this.acceptableCellBreakPositions=t.map(function(t){return t.findAcceptableBreakPosition()})}return this.acceptableCellBreakPositions},e.prototype.getRowIndex=function(){return null!=this.rowIndex?this.rowIndex:this.rowIndex=this.formattingContext.findRowIndexBySourceNode(this.position.sourceNode)},e.prototype.getCellFragments=function(){return this.formattingContext.getRowSpanningCellsOverflowingTheRow(this.getRowIndex()).map(this.formattingContext.getCellFragmentOfCell,this.formattingContext)},e}(et.b),At=function(t){function e(e,n,i){var o=t.call(this)||this;return o.rowIndex=e,o.beforeNodeContext=n,o.formattingContext=i,o.acceptableCellBreakPositions=null,o}return Nt(e,t),e.prototype.findAcceptableBreak=function(t,e){if(e<this.getMinBreakPenalty())return null;var n=this.getCellFragments(),i=this.getAcceptableCellBreakPositions(),o=i.every(function(t){return!!t.nodeContext})&&i.some(function(t,e){var i=n[e].pseudoColumn,o=t.nodeContext;return!i.isStartNodeContext(o)&&!i.isLastAfterNodeContext(o)});return this.beforeNodeContext.overflow=i.some(function(t){return t.nodeContext&&t.nodeContext.overflow}),o?this.beforeNodeContext:null},e.prototype.getMinBreakPenalty=function(){var t=this.formattingContext,e=t.getRowByIndex(this.rowIndex),n=0;return t.isFreelyFragmentableRow(e)||(n+=10),this.getAcceptableCellBreakPositions().forEach(function(t){n+=t.breakPosition.getMinBreakPenalty()}),n},e.prototype.getAcceptableCellBreakPositions=function(){if(!this.acceptableCellBreakPositions){var t=this.getCellFragments();this.acceptableCellBreakPositions=t.map(function(t){return t.findAcceptableBreakPosition()})}return this.acceptableCellBreakPositions},e.prototype.getCellFragments=function(){return this.formattingContext.getCellsFallingOnRow(this.rowIndex).map(this.formattingContext.getCellFragmentOfCell,this.formattingContext)},e}(et.a),Rt=function(t){function e(e,n){var i=t.call(this,e,n)||this;return i.tableSourceNode=n,i.formattingContextType="Table",i.vertical=!1,i.columnCount=-1,i.tableWidth=0,i.captions=[],i.colGroups=null,i.colWidths=null,i.inlineBorderSpacing=0,i.rows=[],i.slots=[],i.cellFragments=[],i.lastRowViewNode=null,i.cellBreakPositions=[],i.repetitiveElements=null,i}return Nt(e,t),e.prototype.getName=function(){return"Table formatting context (Table.TableFormattingContext)"},e.prototype.isFirstTime=function(t,e){if(!e)return e;switch(t.display){case"table-row":return 0===this.cellBreakPositions.length;case"table-cell":return!this.cellBreakPositions.some(function(e){return e.cellNodePosition.steps[0].node===t.sourceNode});default:return e}},e.prototype.getParent=function(){return this.parent},e.prototype.finishFragment=function(){this.cellFragments=[]},e.prototype.addRow=function(t,e){this.rows[t]=e},e.prototype.getRowSlots=function(t){var e=this.slots[t];return e||(e=this.slots[t]=[]),e},e.prototype.addCell=function(t,e){var n=this.rows[t];n||(this.addRow(t,new Ct(t,null)),n=this.rows[t]),v.a(n),n.addCell(e);for(var i=t+e.rowSpan,o=this.getRowSlots(t),r=0;o[r];)r++;for(;t<i;t++){o=this.getRowSlots(t);for(var a=r;a<r+e.colSpan;a++){var s=o[a]=new Tt(t,a,e);e.anchorSlot||e.setAnchorSlot(s)}}},e.prototype.getRowByIndex=function(t){var e=this.rows[t];return v.a(e),e},e.prototype.findRowIndexBySourceNode=function(t){return this.rows.findIndex(function(e){return t===e.sourceNode})},e.prototype.addCellFragment=function(t,e,n){var i=this.cellFragments[t];i||(i=this.cellFragments[t]=[]),i[e]=n},e.prototype.getCellsFallingOnRow=function(t){return this.getRowSlots(t).reduce(function(t,e){return e.cell!==t[t.length-1]?t.concat(e.cell):t},[])},e.prototype.getRowSpanningCellsOverflowingTheRow=function(t){return this.getCellsFallingOnRow(t).filter(function(e){return e.rowIndex+e.rowSpan-1>t})},e.prototype.getCellFragmentOfCell=function(t){return this.cellFragments[t.rowIndex]&&this.cellFragments[t.rowIndex][t.columnIndex]},e.prototype.isFreelyFragmentableRow=function(t){return t.getMinimumHeight()>this.tableWidth/2},e.prototype.getColumnCount=function(){return this.columnCount<0&&(this.columnCount=Math.max.apply(null,this.rows.map(function(t){return t.cells.reduce(function(t,e){return t+e.colSpan},0)}))),this.columnCount},e.prototype.updateCellSizes=function(t){var e=this;this.rows.forEach(function(n){n.cells.forEach(function(n){var i=t.getElementClientRect(n.viewElement);n.viewElement=null,n.setHeight(e.vertical?i.width:i.height)})})},e.prototype.findCellFromColumn=function(t){if(!t)return null;var e=null,n=0,i=0;t:for(n=0;n<this.cellFragments.length;n++)if(this.cellFragments[n])for(i=0;i<this.cellFragments[n].length;i++)if(this.cellFragments[n][i]&&t===this.cellFragments[n][i].pseudoColumn.getColumn()){e=this.rows[n].cells[i];break t}if(!e)return null;for(;n<this.slots.length;n++)for(;i<this.slots[n].length;i++){var o=this.slots[n][i];if(o.cell===e)return{rowIndex:o.rowIndex,columnIndex:o.columnIndex}}return null},e.prototype.collectElementsOffsetOfUpperCells=function(t){var e=this,n=[];return this.slots.reduce(function(i,o,r){if(r>=t.rowIndex)return i;var a=e.getCellFragmentOfCell(o[t.columnIndex].cell);return!a||n.includes(a)?i:(e.collectElementsOffsetFromColumn(a.pseudoColumn.getColumn(),i),n.push(a),i)},[])},e.prototype.collectElementsOffsetOfHighestColumn=function(){var t=this,e=[];return this.rows.forEach(function(n){n.cells.forEach(function(n,i){e[i]||(e[i]={collected:[],elements:[]});var o=e[i],r=t.getCellFragmentOfCell(n);r&&!o.collected.includes(r)&&(t.collectElementsOffsetFromColumn(r.pseudoColumn.getColumn(),o.elements),o.collected.push(r))})}),[new Ot(e.map(function(t){return t.elements}))]},e.prototype.collectElementsOffsetFromColumn=function(t,e){t.fragmentLayoutConstraints.forEach(function(t){if(lt.c.isInstanceOfRepetitiveElementsOwnerLayoutConstraint(t)){var n=t.getRepetitiveElements();e.push(n)}lt.e.isInstanceOfTableRowLayoutConstraint(t)&&t.getElementsOffsetsForTableCell(null).forEach(function(t){e.push(t)})})},e.prototype.saveState=function(){return[].concat(this.cellBreakPositions)},e.prototype.restoreState=function(t){this.cellBreakPositions=t},e}(ct),Ot=function(){function t(t){this.repeatitiveElementsInColumns=t}return t.prototype.calculateOffset=function(t){return this.calculateMaxOffsetOfColumn(t,function(t){return t.current})},t.prototype.calculateMinimumOffset=function(t){return this.calculateMaxOffsetOfColumn(t,function(t){return t.minimum})},t.prototype.calculateMaxOffsetOfColumn=function(t,e){var n=0;return this.repeatitiveElementsInColumns.forEach(function(i){var o=et.c(t,i);n=Math.max(n,e(o))}),n},t}();function Lt(t){return v.a(t instanceof Rt),t}function kt(t){return function(t){return"table-row-group"===t||"table-header-group"===t||"table-footer-group"===t}(t)||function(t){return"table"===t||"inline-table"===t}(t)}function Ft(t,e,n){var i=t.nodeContext,o=i.display,r=i.parent?i.parent.display:null,a=!1;if("inline-table"===r&&!(i.formattingContext instanceof Rt))for(var s=i.parent;s;s=s.parent)if(s.formattingContext instanceof Rt){a=s.formattingContext===e;break}return a||"table-row"===o&&!kt(r)||"table-cell"===o&&"table-row"!==r&&!kt(r)||i.formattingContext instanceof Rt&&i.formattingContext!==e?n.buildDeepElementView(i).thenAsync(function(e){return t.nodeContext=e,Y.d(!0)}):null}var _t=function(t){function e(e,n){var i=t.call(this)||this;return i.formattingContext=e,i.column=n,i.rowIndex=-1,i.columnIndex=0,i.inRow=!1,i.checkPoints=[],i.inHeaderOrFooter=!1,i}return Nt(e,t),e.prototype.startNonInlineElementNode=function(e){var n=this.formattingContext,i=Ft(e,n,this.column);if(i)return i;this.postLayoutBlockContents(e);var o=e.nodeContext,r=o.display,a=n.getRepetitiveElements();switch(r){case"table":n.inlineBorderSpacing=o.inlineBorderSpacing;break;case"table-caption":var s=new It(o.viewNode,o.captionSide);n.captions.push(s);break;case"table-header-group":return a.isHeaderRegistered()||(this.inHeaderOrFooter=!0,a.setHeaderNodeContext(o)),Y.d(!0);case"table-footer-group":return a.isFooterRegistered()||(this.inHeaderOrFooter=!0,a.setFooterNodeContext(o)),Y.d(!0);case"table-row":this.inHeaderOrFooter||(this.inRow=!0,this.rowIndex++,v.a(o.sourceNode),this.columnIndex=0,n.addRow(this.rowIndex,new Ct(this.rowIndex,o.sourceNode)),a.firstContentSourceNode||(a.firstContentSourceNode=o.sourceNode))}return t.prototype.startNonInlineElementNode.call(this,e)},e.prototype.afterNonInlineElementNode=function(e){var n=this.formattingContext,i=e.nodeContext,o=i.display,r=this.column.clientLayout;if(this.postLayoutBlockContents(e),i.sourceNode===n.tableSourceNode){var a=r.getElementComputedStyle(n.getRootViewNode(i));n.tableWidth=parseFloat(a[n.vertical?"height":"width"]),n.getRepetitiveElements().lastContentSourceNode=e.lastAfterNodeContext&&e.lastAfterNodeContext.sourceNode,e.break=!0}else switch(o){case"table-header-group":case"table-footer-group":if(this.inHeaderOrFooter)return this.inHeaderOrFooter=!1,Y.d(!0);break;case"table-row":this.inHeaderOrFooter||(n.lastRowViewNode=i.viewNode,this.inRow=!1);break;case"table-cell":if(!this.inHeaderOrFooter){this.inRow||(this.rowIndex++,this.columnIndex=0,this.inRow=!0);var s=i.viewNode;n.addCell(this.rowIndex,new St(this.rowIndex,this.columnIndex,s)),this.columnIndex++}}return t.prototype.afterNonInlineElementNode.call(this,e)},e.prototype.startNonElementNode=function(t){this.registerCheckPoint(t)},e.prototype.afterNonElementNode=function(t){this.registerCheckPoint(t)},e.prototype.startInlineElementNode=function(t){this.registerCheckPoint(t)},e.prototype.afterInlineElementNode=function(t){this.registerCheckPoint(t)},e.prototype.registerCheckPoint=function(t){var e=t.nodeContext;e&&e.viewNode&&!nt.e(e)&&this.checkPoints.push(e.clone())},e.prototype.postLayoutBlockContents=function(t){this.checkPoints.length>0&&this.column.postLayoutBlock(t.nodeContext,this.checkPoints),this.checkPoints=[]},e}(rt.EdgeSkipper),Dt=function(t){function e(e,n){var i=t.call(this,!0)||this;return i.formattingContext=e,i.column=n,i.inRow=!1,i.currentRowIndex=-1,i.currentColumnIndex=0,i.originalStopAtOverflow=n.stopAtOverflow,n.stopAtOverflow=!1,i}return Nt(e,t),e.prototype.resetColumn=function(){this.column.stopAtOverflow=this.originalStopAtOverflow},e.prototype.getColSpanningCellWidth=function(t){var e=this.formattingContext.colWidths;v.a(e);for(var n=0,i=0;i<t.colSpan;i++)n+=e[t.anchorSlot.columnIndex+i];return n+this.formattingContext.inlineBorderSpacing*(t.colSpan-1)},e.prototype.layoutCell=function(t,e,n){var i=t.rowIndex,o=t.columnIndex,r=t.colSpan,a=e.viewNode;e.verticalAlign,r>1&&(E.F(a,"box-sizing","border-box"),E.F(a,this.formattingContext.vertical?"height":"width",this.getColSpanningCellWidth(t)+"px"));var s=a.ownerDocument.createElement("div");a.appendChild(s);var l=new xt(this.column,s,e);return this.formattingContext.addCellFragment(i,o,l),1===n.primary.steps.length&&n.primary.after&&(l.empty=!0),l.pseudoColumn.layout(n,!0).thenReturn(!0)},e.prototype.hasBrokenCellAtSlot=function(t){var e=this.formattingContext.cellBreakPositions[0];return!!e&&e.cell.anchorSlot.columnIndex===t},e.prototype.extractRowSpanningCellBreakPositions=function(){var t=this.formattingContext.cellBreakPositions;if(0===t.length)return[];var e=[],n=0;do{var i=t[n],o=i.cell.rowIndex;if(o<this.currentRowIndex){var r=e[o];r||(r=e[o]=[]),r.push(i),t.splice(n,1)}else n++}while(n<t.length);return e},e.prototype.layoutRowSpanningCellsFromPreviousFragment=function(t){var e=this,n=this.formattingContext,i=this.extractRowSpanningCellBreakPositions(),o=i.reduce(function(t){return t+1},0);if(0===o)return Y.d(!0);var r=this.column.layoutContext,a=t.nodeContext;a.viewNode.parentNode.removeChild(a.viewNode);var s=Y.c("layoutRowSpanningCellsFromPreviousFragment"),l=Y.d(!0),u=0,c=[];return i.forEach(function(t){l=l.thenAsync(function(){var i=q.v(t[0].cellNodePosition.steps[1],a.parent);return r.setCurrent(i,!1).thenAsync(function(){var a=Y.d(!0),s=0;function l(t){for(;s<t;){if(!c.includes(s)){var e=i.viewNode.ownerDocument.createElement("td");E.F(e,"padding","0"),i.viewNode.appendChild(e)}s++}}return t.forEach(function(t){a=a.thenAsync(function(){var n=t.cell;l(n.anchorSlot.columnIndex);var a=t.cellNodePosition,h=q.v(a.steps[0],i);return h.offsetInNode=a.offsetInNode,h.after=a.after,h.fragmentIndex=a.steps[0].fragmentIndex+1,r.setCurrent(h,!1).thenAsync(function(){for(var i=t.breakChunkPosition,r=0;r<n.colSpan;r++)c.push(s+r);return s+=n.colSpan,e.layoutCell(n,h,i).thenAsync(function(){return h.viewNode.rowSpan=n.rowIndex+n.rowSpan-e.currentRowIndex+o-u,Y.d(!0)})})})}),a.thenAsync(function(){return l(n.getColumnCount()),u++,Y.d(!0)})})})}),l.then(function(){r.setCurrent(a,!0,t.atUnforcedBreak).then(function(){s.finish(!0)})}),s.result()},e.prototype.startTableRow=function(t){var e=this;if(this.inHeader||this.inFooter)return Y.d(!0);var n=t.nodeContext,i=this.formattingContext;return this.currentRowIndex<0?(v.a(n.sourceNode),this.currentRowIndex=i.findRowIndexBySourceNode(n.sourceNode)):this.currentRowIndex++,this.currentColumnIndex=0,this.inRow=!0,this.layoutRowSpanningCellsFromPreviousFragment(t).thenAsync(function(){return e.registerCellFragmentIndex(),e.column.checkOverflowAndSaveEdgeAndBreakPosition(t.lastAfterNodeContext,null,!0,t.breakAtTheEdge)&&0===i.getRowSpanningCellsOverflowingTheRow(e.currentRowIndex-1).length&&(e.resetColumn(),n.overflow=!0,t.break=!0),Y.d(!0)})},e.prototype.registerCellFragmentIndex=function(){var t=this;this.formattingContext.getRowByIndex(this.currentRowIndex).cells.forEach(function(e){var n=t.formattingContext.cellBreakPositions[e.columnIndex];if(n&&n.cell.anchorSlot.columnIndex==e.anchorSlot.columnIndex){var i=n.cellNodePosition.steps[0],o=t.column.layoutContext.xmldoc.getElementOffset(i.node);at.e(o,i.fragmentIndex+1,1)}})},e.prototype.startTableCell=function(t){var e=this;if(this.inHeader||this.inFooter)return Y.d(!0);var n=t.nodeContext;this.inRow||(this.currentRowIndex<0?this.currentRowIndex=0:this.currentRowIndex++,this.currentColumnIndex=0,this.inRow=!0);var i=this.formattingContext.getRowByIndex(this.currentRowIndex).cells[this.currentColumnIndex],o=n.copy().modify();o.after=!0,t.nodeContext=o;var r,a=Y.c("startTableCell");if(this.hasBrokenCellAtSlot(i.anchorSlot.columnIndex)){var s=this.formattingContext.cellBreakPositions.shift();n.fragmentIndex=s.cellNodePosition.steps[0].fragmentIndex+1,r=Y.d(s.breakChunkPosition)}else r=this.column.nextInTree(n,t.atUnforcedBreak).thenAsync(function(t){t.viewNode&&n.viewNode.removeChild(t.viewNode);var e=q.x(t,0);return Y.d(new q.a(e))});return r.then(function(o){v.a(n),e.layoutCell(i,n,o).then(function(){e.afterNonInlineElementNode(t),e.currentColumnIndex++,a.finish(!0)})}),a.result()},e.prototype.startNonInlineBox=function(t){var e=Ft(t,Lt(this.formattingContext),this.column);if(e)return e;var n=t.nodeContext,i=this.formattingContext.getRepetitiveElements(),o=n.display;return"table-header-group"===o&&i&&i.isHeaderSourceNode(n.sourceNode)?(this.inHeader=!0,Y.d(!0)):"table-footer-group"===o&&i&&i.isFooterSourceNode(n.sourceNode)?(this.inFooter=!0,Y.d(!0)):"table-row"===o?this.startTableRow(t):"table-cell"===o?this.startTableCell(t):Y.d(!0)},e.prototype.endNonInlineBox=function(t){var e=t.nodeContext;if("table-row"===e.display&&(this.inRow=!1,!this.inHeader&&!this.inFooter)){var n=e.copy().modify();n.after=!1;var i=new At(this.currentRowIndex,n,this.formattingContext);this.column.breakPositions.push(i)}return Y.d(!0)},e.prototype.afterNonInlineElementNode=function(n){var i=n.nodeContext,o=this.formattingContext.getRepetitiveElements(),r=i.display;if("table-header-group"===r?o&&!o.allowInsertRepeatitiveElements&&o.isHeaderSourceNode(i.sourceNode)?(this.inHeader=!1,i.viewNode.parentNode.removeChild(i.viewNode)):E.F(i.viewNode,"display","table-row-group"):"table-footer-group"===r&&(o&&!o.allowInsertRepeatitiveElements&&o.isFooterSourceNode(i.sourceNode)?(this.inFooter=!1,i.viewNode.parentNode.removeChild(i.viewNode)):E.F(i.viewNode,"display","table-row-group")),r&&e.ignoreList[r])i.viewNode.parentNode.removeChild(i.viewNode);else{if(i.sourceNode!==this.formattingContext.tableSourceNode)return t.prototype.afterNonInlineElementNode.call(this,n);i.overflow=this.column.checkOverflowAndSaveEdge(i,null),this.resetColumn(),n.break=!0}return Y.d(!0)},e.ignoreList={"table-caption":!0,"table-column-group":!0,"table-column":!0},e}(rt.EdgeSkipper),Bt=[],Mt=function(){function t(){}return t.prototype.layoutEntireTable=function(t,e){var n=Lt(t.formattingContext),i=new _t(n,e);return new rt.LayoutIterator(i,e.layoutContext).iterate(t)},t.prototype.getColumnWidths=function(t,e,n,i){for(var o=t.ownerDocument,r=o.createElement("tr"),a=[],s=0;s<e;s++){var l=o.createElement("td");r.appendChild(l),a.push(l)}t.parentNode.insertBefore(r,t.nextSibling);var u=a.map(function(t){var e=i.getElementClientRect(t);return n?e.height:e.width});return t.parentNode.removeChild(r),u},t.prototype.getColGroupElements=function(t){for(var e=[],n=t.firstElementChild;n;)"colgroup"===n.localName&&e.push(n),n=n.nextElementSibling;return e},t.prototype.normalizeAndGetColElements=function(t){var e=[];return t.forEach(function(t){var n=t.span;t.removeAttribute("span");for(var i=t.firstElementChild;i;){if("col"===i.localName){var o=i.span;for(i.removeAttribute("span"),n-=o;o-- >1;){var r=i.cloneNode(!0);t.insertBefore(r,i),e.push(r)}e.push(i)}i=i.nextElementSibling}for(;n-- >0;)i=t.ownerDocument.createElement("col"),t.appendChild(i),e.push(i)}),e},t.prototype.addMissingColElements=function(t,e,n,i){if(t.length<n){var o=i.ownerDocument.createElement("colgroup");e.push(o);for(var r=t.length;r<n;r++){var a=i.ownerDocument.createElement("col");o.appendChild(a),t.push(a)}}},t.prototype.normalizeColGroups=function(t,e,n){var i=t.vertical,o=t.lastRowViewNode;if(o){v.a(o),t.lastRowViewNode=null;var r=o.ownerDocument.createDocumentFragment(),a=t.getColumnCount();if(a>0){var s=t.colWidths=this.getColumnWidths(o,a,i,n.clientLayout),l=this.getColGroupElements(e),u=this.normalizeAndGetColElements(l);this.addMissingColElements(u,l,a,e),u.forEach(function(t,e){E.F(t,i?"height":"width",s[e]+"px")}),l.forEach(function(t){r.appendChild(t.cloneNode(!0))}),t.colGroups=r}else t.colGroups=r}},t.prototype.doInitialLayout=function(t,e){var n=this,i=Lt(t.formattingContext);i.vertical=t.vertical,i.initializeRepetitiveElements(t.vertical),v.a(t.sourceNode);var o,r,a,s=(o=t.sourceNode,r=Bt.findIndex(function(t){return t.root===o}),(a=Bt[r])?a.tableLayoutOption:null);!function(t){var e=Bt.findIndex(function(e){return e.root===t});e>=0&&Bt.splice(e,1)}(t.sourceNode);var l=Y.c("TableLayoutProcessor.doInitialLayout"),u=t.copy();return this.layoutEntireTable(t,e).then(function(o){var r=o.viewNode,a=e.clientLayout.getElementClientRect(r),c=e.vertical?a.left:a.bottom;if(c+=(e.vertical?-1:1)*et.c(t,e.collectElementsOffset()).current,!(e.isOverflown(c)||s&&s.calculateBreakPositionsInside))return e.breakPositions.push(new Ht(u)),void l.finish(o);n.normalizeColGroups(i,r,e),i.updateCellSizes(e.clientLayout),l.finish(null)}),l.result()},t.prototype.addCaptions=function(t,e,n){var i=t.captions;i.forEach(function(t,o){t&&(e.insertBefore(t.viewNode,n),"top"===t.side&&(i[o]=null))})},t.prototype.addColGroups=function(t,e,n){t.colGroups&&0===this.getColGroupElements(e).length&&e.insertBefore(t.colGroups.cloneNode(!0),n)},t.prototype.removeColGroups=function(t,e){if(t.colGroups&&e){var n=this.getColGroupElements(e);n&&n.forEach(function(t){e.removeChild(t)})}},t.prototype.doLayout=function(t,e){var n=Lt(t.formattingContext),i=n.getRootViewNode(t),o=i.firstChild;this.addCaptions(n,i,o),this.addColGroups(n,i,o);var r=new Dt(n,e),a=new rt.LayoutIterator(r,e.layoutContext),s=Y.c("TableFormattingContext.doLayout");return a.iterate(t).thenFinish(s),s.result()},t.prototype.layout=function(t,e,n){var i=Lt(t.formattingContext);return i.getRootViewNode(t)?(n&&Et(t.parent,e),new Ut(i,this).layout(t,e)):e.buildDeepElementView(t)},t.prototype.createEdgeBreakPosition=function(t,e,n,i){return new Pt(t,e,n,i)},t.prototype.startNonInlineElementNode=function(t){return!1},t.prototype.afterNonInlineElementNode=function(t,e){return!1},t.prototype.finishBreak=function(t,e,n,i){var o=Lt(e.formattingContext);if("table-row"===e.display){v.a(e.sourceNode);var r,a=o.findRowIndexBySourceNode(e.sourceNode);if(o.cellBreakPositions=[],(r=e.after?o.getRowSpanningCellsOverflowingTheRow(a):o.getCellsFallingOnRow(a)).length){var s=Y.c("TableLayoutProcessor.finishBreak"),l=0;return s.loopWithFrame(function(t){if(l!==r.length){var e=r[l++],n=o.getCellFragmentOfCell(e),i=n.findAcceptableBreakPosition().nodeContext;v.a(i);var s=n.cellNodeContext,u=s.toNodePosition(),c=new q.a(i.toNodePosition());o.cellBreakPositions.push({cellNodePosition:u,breakChunkPosition:c,cell:e});var h=s.viewNode;n.column.layoutContext.processFragmentedBlockEdge(n.cellNodeContext),a<e.rowIndex+e.rowSpan-1&&(h.rowSpan=a-e.rowIndex+1),n.empty?t.continueLoop():n.pseudoColumn.finishBreak(i,!1,!0).then(function(){v.a(n),function(t,e,n){var i=e.getRepetitiveElements();if(i){var o=e.vertical,r=t.column,a=t.pseudoColumn.getColumnElement(),s=t.cellNodeContext.viewNode,l=r.clientLayout.getElementClientRect(s),u=r.getComputedPaddingBorder(s);if(o){var c=l.right-r.footnoteEdge-i.calculateOffset(n)-u.right;E.F(a,"max-width",c+"px")}else{var h=r.footnoteEdge-i.calculateOffset(n)-l.top-u.top;E.F(a,"max-height",h+"px")}E.F(a,"overflow","hidden")}}(n,o,i),t.continueLoop()})}else t.breakLoop()}).then(function(){t.clearOverflownViewNodes(e,!1),t.layoutContext.processFragmentedBlockEdge(e),o.finishFragment(),s.finish(!0)}),s.result()}}return o.finishFragment(),it.d.finishBreak(t,e,n,i)},t.prototype.clearOverflownViewNodes=function(t,e,n,i){it.b.prototype.clearOverflownViewNodes(t,e,n,i)},t}(),Ut=function(t){function e(e,n){var i=t.call(this)||this;return i.tableFormattingContext=e,i.processor=n,i}return Nt(e,t),e.prototype.resolveLayoutMode=function(t){var e=this.tableFormattingContext.getRepetitiveElements();return e&&e.doneInitialLayout?(t.sourceNode!==this.tableFormattingContext.tableSourceNode||t.after||e&&e.preventSkippingHeader(),new Gt(this.tableFormattingContext,this.processor)):new Vt(this.tableFormattingContext,this.processor)},e.prototype.clearNodes=function(e){t.prototype.clearNodes.call(this,e);var n=this.tableFormattingContext.getRootViewNode(e);this.processor.removeColGroups(this.tableFormattingContext,n)},e.prototype.restoreState=function(e,n){t.prototype.restoreState.call(this,e,n),this.tableFormattingContext.finishFragment()},e}(ot.a),Vt=function(t){function e(e,n){var i=t.call(this,e)||this;return i.processor=n,i}return Nt(e,t),e.prototype.doLayout=function(t,e){return this.processor.doInitialLayout(t,e)},e}(pt),Ht=function(t){function e(e){return t.call(this,e,null,e.overflow,0)||this}return Nt(e,t),e.prototype.getMinBreakPenalty=function(){if(!this.isEdgeUpdated)throw new Error("EdgeBreakPosition.prototype.updateEdge not called");return(this.overflows?3:0)+(this.position.parent?this.position.parent.breakPenalty:0)},e.prototype.breakPositionChosen=function(t){t.fragmentLayoutConstraints.push(new zt(this.position.sourceNode))},e}(et.b),zt=function(){function t(t){this.tableRootNode=t,this.flagmentLayoutConstraintType="EntireTable"}return t.prototype.allowLayout=function(t,e,n){return v.a(!t.overflow),!1},t.prototype.nextCandidate=function(t){return!0},t.prototype.postLayout=function(t,e,n,i){v.a(e.sourceNode),Bt.push({root:e.sourceNode,tableLayoutOption:{calculateBreakPositionsInside:!0}})},t.prototype.finishBreak=function(t,e){return Y.d(!0)},t.prototype.equalsTo=function(e){return e instanceof t&&e.tableRootNode===this.tableRootNode},t.prototype.getPriorityOfFinishBreak=function(){return 0},t}(),Gt=function(t){function e(e,n){var i=t.call(this,e)||this;return i.processor=n,i}return Nt(e,t),e.prototype.doLayout=function(t,e){var n=this.formattingContext.getRepetitiveElements();if(n&&!n.isAfterLastContent(t)){var i=new Wt(t);e.fragmentLayoutConstraints.some(function(t){return i.equalsTo(t)})||e.fragmentLayoutConstraints.unshift(i)}return this.processor.doLayout(t,e)},e}(ft),Wt=function(t){function e(e){var n=t.call(this,e)||this;return n.flagmentLayoutConstraintType="TableRow",n.cellFragmentLayoutConstraints=[],n}return Nt(e,t),e.prototype.allowLayout=function(t,e,n){var i=this.getRepetitiveElements();return!(i&&!n.pseudoParent&&!nt.c(this.nodeContext.viewNode)&&i.isEnableToUpdateState()&&(e&&!t||t&&t.overflow))},e.prototype.nextCandidate=function(e){var n=Lt(this.nodeContext.formattingContext);return!!this.collectCellFragmentLayoutConstraints(e,n).some(function(t){return t.constraints.some(function(t){return t.nextCandidate(e)})})||t.prototype.nextCandidate.call(this,e)},e.prototype.postLayout=function(e,n,i,o){var r=Lt(this.nodeContext.formattingContext);if(this.cellFragmentLayoutConstraints=this.collectCellFragmentLayoutConstraints(n,r),this.cellFragmentLayoutConstraints.forEach(function(t){t.constraints.forEach(function(n){n.postLayout(e,t.breakPosition,i,o)})}),!e){var a=r.getRootViewNode(this.nodeContext);(new Mt).removeColGroups(r,a),this.removeDummyRowNodes(i)}t.prototype.postLayout.call(this,e,n,i,o)},e.prototype.finishBreak=function(e,n){var i=this,o=(Lt(this.nodeContext.formattingContext),Y.c("finishBreak")),r=this.cellFragmentLayoutConstraints.reduce(function(t,e){return t.concat(e.constraints.map(function(t){return{constraint:t,breakPosition:e.breakPosition}}))},[]),a=0;return o.loop(function(){if(a<r.length){var t=r[a++];return t.constraint.finishBreak(t.breakPosition,n).thenReturn(!0)}return Y.d(!1)}).then(function(){o.finish(!0)}),o.result().thenAsync(function(){return t.prototype.finishBreak.call(i,e,n)})},e.prototype.removeDummyRowNodes=function(t){if(t&&"table-row"===t.display&&t.viewNode)for(;t.viewNode.previousElementSibling;){var e=t.viewNode.previousElementSibling;e.parentNode&&e.parentNode.removeChild(e)}},e.prototype.collectCellFragmentLayoutConstraints=function(t,e){return this.getCellFragemnts(t,e).map(function(t){return{constraints:t.fragment.pseudoColumn.getColumn().fragmentLayoutConstraints,breakPosition:t.breakPosition}})},e.prototype.getCellFragemnts=function(t,e){var n=Number.MAX_VALUE;t&&"table-row"===t.display&&(v.a(t.sourceNode),n=e.findRowIndexBySourceNode(t.sourceNode)+1),n=Math.min(e.cellFragments.length,n);for(var i=[],o=0;o<n;o++)e.cellFragments[o]&&e.cellFragments[o].forEach(function(t){t&&i.push({fragment:t,breakPosition:t.findAcceptableBreakPosition().nodeContext})});return i},e.prototype.getElementsOffsetsForTableCell=function(t){var e=Lt(this.nodeContext.formattingContext),n=e.findCellFromColumn(t);return n?e.collectElementsOffsetOfUpperCells(n):e.collectElementsOffsetOfHighestColumn()},e.prototype.equalsTo=function(t){return t instanceof e&&Lt(this.nodeContext.formattingContext)===Lt(t.nodeContext.formattingContext)},e}(mt),Xt=new Mt;l.d(l.a.RESOLVE_FORMATTING_CONTEXT,function(t,e,n,i,o,r){if(!e)return null;if(n===X.t.table){var a=t.parent;return new Rt(a?a.formattingContext:null,t.sourceNode)}return null}),l.d(l.a.RESOLVE_LAYOUT_PROCESSOR,function(t){return t instanceof Rt?Xt:null});var jt=n(13);function Yt(t){return t.reduce(function(t,e){return t+e},0)/t.length}var qt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),Kt=function(t,e){this.layoutResult=t,this.penalty=e};function Qt(t){return t.vertical?t.width:t.height}function Zt(t,e){t.vertical?t.width=e:t.height=e}var $t=function(){function t(t,e,n){this.layoutContainer=t,this.columnGenerator=e,this.regionPageFloatLayoutContext=n,this.originalContainerBlockSize=Qt(t)}return t.prototype.balanceColumns=function(t){var e=this,n=Y.c("ColumnBalancer#balanceColumns");e.preBalance(t),e.savePageFloatLayoutContexts(t),e.layoutContainer.clear();var i=[e.createTrialResult(t)];return n.loopWithFrame(function(t){e.hasNextCandidate(i)?(e.updateCondition(i),e.columnGenerator().then(function(n){e.savePageFloatLayoutContexts(n),e.layoutContainer.clear(),n?(i.push(e.createTrialResult(n)),t.continueLoop()):t.breakLoop()})):t.breakLoop()}).then(function(){var t=i.reduce(function(t,e){return e.penalty<t.penalty?e:t},i[0]);e.restoreContents(t.layoutResult),e.postBalance(),n.finish(t.layoutResult)}),n.result()},t.prototype.createTrialResult=function(t){var e=this.calculatePenalty(t);return new Kt(t,e)},t.prototype.preBalance=function(t){},t.prototype.postBalance=function(){Zt(this.layoutContainer,this.originalContainerBlockSize)},t.prototype.savePageFloatLayoutContexts=function(t){var e=this.regionPageFloatLayoutContext.detachChildren();t&&(t.columnPageFloatLayoutContexts=e)},t.prototype.restoreContents=function(t){var e=this.layoutContainer.element;t.columns.forEach(function(t){e.appendChild(t.element)}),v.a(t.columnPageFloatLayoutContexts),this.regionPageFloatLayoutContext.attachChildren(t.columnPageFloatLayoutContexts)},t}(),Jt=1;function te(t){var e=t[t.length-1];if(0===e.penalty)return!1;var n=t[t.length-2];if(n&&e.penalty>=n.penalty)return!1;var i=e.layoutResult.columns;return Math.max.apply(null,i.map(function(t){return t.computedBlockSize}))>Math.max.apply(null,i.map(function(t){return t.getMaxBlockSizeOfPageFloats()}))+Jt}function ee(t,e){var n=t[t.length-1].layoutResult.columns,i=Math.max.apply(null,n.map(function(t){return isNaN(t.blockDistanceToBlockEndFloats)?t.computedBlockSize:t.computedBlockSize-t.blockDistanceToBlockEndFloats+Jt}))-Jt;i<Qt(e)?Zt(e,i):Zt(e,Qt(e)-1)}var ne=function(t){function e(e,n,i,o){var r=t.call(this,i,e,n)||this;return r.columnCount=o,r.originalPosition=null,r.foundUpperBound=!1,r}return qt(e,t),e.prototype.preBalance=function(t){var e=t.columns.reduce(function(t,e){return t+e.computedBlockSize},0);Zt(this.layoutContainer,e/this.columnCount),this.originalPosition=t.position},e.prototype.checkPosition=function(t){return this.originalPosition?this.originalPosition.isSamePosition(t):null===t},e.prototype.calculatePenalty=function(t){if(!this.checkPosition(t.position))return 1/0;var e=t.columns;return ie(e)?1/0:Math.max.apply(null,e.map(function(t){return t.computedBlockSize}))},e.prototype.hasNextCandidate=function(t){if(1===t.length)return!0;if(this.foundUpperBound)return te(t);var e=t[t.length-1];return this.checkPosition(e.layoutResult.position)&&!ie(e.layoutResult.columns)?(this.foundUpperBound=!0,!0):Qt(this.layoutContainer)<this.originalContainerBlockSize},e.prototype.updateCondition=function(t){if(this.foundUpperBound)ee(t,this.layoutContainer);else{var e=Math.min(this.originalContainerBlockSize,Qt(this.layoutContainer)+.1*this.originalContainerBlockSize);Zt(this.layoutContainer,e)}},e}($t);function ie(t){if(t.length<=1)return!1;var e=t[t.length-1].computedBlockSize;return t.slice(0,t.length-1).every(function(t){return e>t.computedBlockSize})}var oe,re=function(t){function e(e,n,i){return t.call(this,i,e,n)||this}return qt(e,t),e.prototype.calculatePenalty=function(t){if(t.columns.every(function(t){return 0===t.computedBlockSize}))return 1/0;var e,n,i=t.columns.filter(function(t){return!t.pageBreakType}).map(function(t){return t.computedBlockSize});return n=Yt(e=i),Yt(e.map(function(t){var e=t-n;return e*e}))},e.prototype.hasNextCandidate=function(t){return te(t)},e.prototype.updateCondition=function(t){ee(t,this.layoutContainer)},e}($t),ae=n(24),se=function(t,e,n){this.endStuckFixed=t,this.endFixed=e,this.endSlipped=n},le=function(){function t(){this.map=[]}return t.prototype.getMaxFixed=function(){return 0==this.map.length?0:this.map[this.map.length-1].endFixed},t.prototype.getMaxSlipped=function(){return 0==this.map.length?0:this.map[this.map.length-1].endSlipped},t.prototype.addStuckRange=function(t){if(0==this.map.length)this.map.push(new se(t,t,t));else{var e=this.map[this.map.length-1],n=e.endSlipped+t-e.endFixed;e.endFixed==e.endStuckFixed?(e.endFixed=t,e.endStuckFixed=t,e.endSlipped=n):this.map.push(new se(t,t,n))}},t.prototype.addSlippedRange=function(t){0==this.map.length?this.map.push(new se(t,0,0)):this.map[this.map.length-1].endFixed=t},t.prototype.slippedByFixed=function(t){var e=this,n=E.i(this.map.length,function(n){return t<=e.map[n].endFixed}),i=this.map[n];return i.endSlipped-Math.max(0,i.endStuckFixed-t)},t.prototype.fixedBySlipped=function(t){var e=this,n=E.i(this.map.length,function(n){return t<=e.map[n].endSlipped}),i=this.map[n];return i.endStuckFixed-(i.endSlipped-t)},t}(),ue=function(){function t(e,n,i,o,r,a,s,l){if(this.context=e,this.style=n,this.offset=i,this.isRoot=o,this.flowChunk=r,this.atBlockStart=a,this.atFlowStart=s,this.isParentBoxDisplayed=l,this.isBlockValue=null,this.hasBoxValue=null,this.styleValues={},this.beforeBox=null,this.afterBox=null,this.breakBefore=null,this.flowName=r.flowName,this.hasBox()){var u=n._pseudos;if(u&&u.before){var c=new t(e,u.before,i,!1,r,this.isBlock(),s,!0),h=c.styleValue("content");q.y(h)&&(this.beforeBox=c,this.breakBefore=c.breakBefore)}}this.breakBefore=jt.d(this.getBreakValue("before"),this.breakBefore),this.atFlowStart&&jt.c(this.breakBefore)&&(r.breakBefore=jt.d(r.breakBefore,this.breakBefore))}return t.prototype.buildAfterPseudoElementBox=function(e,n,i){if(this.hasBox()){var o=this.style._pseudos;if(o&&o.after){var r=new t(this.context,o.after,e,!1,this.flowChunk,n,i,!0),a=r.styleValue("content");q.y(a)&&(this.afterBox=r)}}},t.prototype.styleValue=function(t,e){if(!(t in this.styleValues)){var n=this.style[t];this.styleValues[t]=n?n.evaluate(this.context,t):e||null}return this.styleValues[t]},t.prototype.displayValue=function(){return this.styleValue("display",X.t.inline)},t.prototype.isBlock=function(){if(null===this.isBlockValue){var t=this.displayValue(),e=this.styleValue("position"),n=this.styleValue("float");this.isBlockValue=ae.d(t,e,n,this.isRoot)}return this.isBlockValue},t.prototype.hasBox=function(){return null===this.hasBoxValue&&(this.hasBoxValue=this.isParentBoxDisplayed&&this.displayValue()!==X.t.none),this.hasBoxValue},t.prototype.getBreakValue=function(t){var e=null;if(this.isBlock()){var n=this.styleValue("break-"+t);n&&(e=n.toString())}return e},t}(),ce=function(){function t(t){this.context=t,this.stack=[],this.atBlockStart=!0,this.atFlowStart=!0,this.atStartStack=[]}return t.prototype.empty=function(){return 0===this.stack.length},t.prototype.lastBox=function(){return this.stack[this.stack.length-1]},t.prototype.lastFlowName=function(){var t=this.lastBox();return t?t.flowChunk.flowName:null},t.prototype.isCurrentBoxDisplayed=function(){return this.stack.every(function(t){return t.displayValue()!==X.t.none})},t.prototype.push=function(t,e,n,i){var o=this.lastBox();i&&o&&i.flowName!==o.flowName&&this.atStartStack.push({atBlockStart:this.atBlockStart,atFlowStart:this.atFlowStart});var r=i||o.flowChunk,a=this.atFlowStart||!!i,s=this.isCurrentBoxDisplayed(),l=new ue(this.context,t,e,n,r,a||this.atBlockStart,a,s);return this.stack.push(l),this.atBlockStart=l.hasBox()?!l.beforeBox&&l.isBlock():this.atBlockStart,this.atFlowStart=l.hasBox()?!l.beforeBox&&a:this.atFlowStart,l},t.prototype.encounteredTextNode=function(t){var e=this.lastBox();if((this.atBlockStart||this.atFlowStart)&&e.hasBox()){var n=e.styleValue("white-space",X.t.normal).toString(),i=q.z(n);v.a(null!==i),q.p(t,i)||(this.atBlockStart=!1,this.atFlowStart=!1)}},t.prototype.pop=function(t){var e=this.stack.pop();if(e.buildAfterPseudoElementBox(t,this.atBlockStart,this.atFlowStart),this.atFlowStart&&e.afterBox){var n=e.afterBox.getBreakValue("before");e.flowChunk.breakBefore=jt.d(e.flowChunk.breakBefore,n)}var i=this.lastBox();if(i)if(i.flowName===e.flowName)e.hasBox()&&(this.atBlockStart=this.atFlowStart=!1);else{var o=this.atStartStack.pop();this.atBlockStart=o.atBlockStart,this.atFlowStart=o.atFlowStart}return e},t.prototype.nearestBlockStartOffset=function(t){if(!t.atBlockStart)return t.offset;var e=this.stack.length-1,n=this.stack[e];for(n===t&&(e--,n=this.stack[e]);e>=0;){if(n.flowName!==t.flowName)return t.offset;if(!n.atBlockStart)return n.offset;if(n.isRoot)return n.offset;t=n,n=this.stack[--e]}throw new Error("No block start offset found!")},t}(),he=function(){function t(t,e,n,i,o,r,a,s){this.xmldoc=t,this.scope=n,this.context=i,this.primaryFlows=o,this.validatorSet=r,this.counterListener=a,this.rootStyle={},this.styleMap={},this.flows={},this.flowChunks=[],this.flowListener=null,this.flowToReach=null,this.idToReach=null,this.primary=!0,this.primaryStack=[],this.rootBackgroundAssigned=!1,this.rootLayoutAssigned=!1,this.breakBeforeValues={},this.bodyReached=!0,this.root=t.root,this.cascadeHolder=e,this.last=this.root,this.cascade=e.createInstance(i,a,s,t.lang),this.offsetMap=new le;var l=t.getElementOffset(this.root);this.lastOffset=l,this.boxStack=new ce(i),this.offsetMap.addStuckRange(l);var u=this.getAttrStyle(this.root);switch(this.cascade.pushElement(this.root,u,l),this.postprocessTopStyle(u,!1),this.root.namespaceURI){case E.a.XHTML:case E.a.FB2:this.bodyReached=!1}this.primaryStack.push(!0),this.styleMap={},this.styleMap["e"+l]=u,this.lastOffset++,this.replayFlowElementsFromOffset(-1)}return t.prototype.hasProp=function(t,e,n){var i=t[n];return i&&i.evaluate(this.context)!==e[n]},t.prototype.transferPropsToRoot=function(t,e){for(var n in e){var i=t[n];if(i)this.rootStyle[n]=i,delete t[n];else{var o=e[n];o&&(this.rootStyle[n]=new H.c(o,z.c))}}},t.prototype.postprocessTopStyle=function(t,e){var n=this;if(["writing-mode","direction"].forEach(function(i){!t[i]||e&&n.rootStyle[i]||(n.rootStyle[i]=t[i])}),!this.rootBackgroundAssigned){var i=this.hasProp(t,this.validatorSet.backgroundProps,"background-color")?t["background-color"].evaluate(this.context):null,o=this.hasProp(t,this.validatorSet.backgroundProps,"background-image")?t["background-image"].evaluate(this.context):null;(i&&i!==X.t.inherit||o&&o!==X.t.inherit)&&(this.transferPropsToRoot(t,this.validatorSet.backgroundProps),this.rootBackgroundAssigned=!0)}if(!this.rootLayoutAssigned)for(var r=0;r<pe.length;r++)if(this.hasProp(t,this.validatorSet.layoutProps,pe[r])){this.transferPropsToRoot(t,this.validatorSet.layoutProps),this.rootLayoutAssigned=!0;break}if(!e){var a=t["font-size"];if(a){var s=a.evaluate(this.context),l=s.num;switch(s.unit){case"em":case"rem":l*=this.context.initialFontSize;break;case"ex":l*=this.context.initialFontSize*L.G.ex/L.G.em;break;case"%":l*=this.context.initialFontSize/100;break;default:var u=L.G[s.unit];u&&(l*=u)}this.context.rootFontSize=l}}},t.prototype.getTopContainerStyle=function(){for(var t=0;!this.bodyReached&&(t+=5e3,this.styleUntil(t,0)!=Number.POSITIVE_INFINITY););return this.rootStyle},t.prototype.getAttrStyle=function(t){if(t.style instanceof CSSStyleDeclaration){var e=t.getAttribute("style");if(e)return H.E(this.scope,this.validatorSet,this.xmldoc.url,e)}return{}},t.prototype.getReachedOffset=function(){return this.lastOffset},t.prototype.replayFlowElementsFromOffset=function(t){if(!(t>=this.lastOffset)){var e=this.context,n=this.xmldoc.getElementOffset(this.root);if(t<n){var i=this.getStyle(this.root,!1);v.a(i);var o=(l=H.s(i,"flow-into"))?l.evaluate(e,"flow-into").toString():"body",r=this.encounteredFlowElement(o,i,this.root,n);this.boxStack.empty()&&this.boxStack.push(i,n,!0,r)}var a=this.xmldoc.getNodeByOffset(t),s=this.xmldoc.getNodeOffset(a,0,!1);if(!(s>=this.lastOffset))for(;;){if(1!=a.nodeType)s+=a.textContent.length;else{var l,u=a,c=this.getStyle(u,!1);(l=c["flow-into"])&&(o=l.evaluate(e,"flow-into").toString(),this.encounteredFlowElement(o,c,u,s)),s++}if(s>=this.lastOffset)break;var h=a.firstChild;if(null==h)for(;!(h=a.nextSibling);)if((a=a.parentNode)===this.root)return;a=h}}},t.prototype.resetFlowChunkStream=function(t){this.flowListener=t;for(var e=0;e<this.flowChunks.length;e++)this.flowListener.encounteredFlowChunk(this.flowChunks[e],this.flows[this.flowChunks[e].flowName])},t.prototype.styleUntilFlowIsReached=function(t){this.flowToReach=t;for(var e=0;null!=this.flowToReach&&(e+=5e3,this.styleUntil(e,0)!=Number.POSITIVE_INFINITY););},t.prototype.styleUntilIdIsReached=function(t){if(t){this.idToReach=t;for(var e=0;this.idToReach&&(e+=5e3,this.styleUntil(e,0)!==Number.POSITIVE_INFINITY););this.idToReach=null}},t.prototype.encounteredFlowElement=function(t,e,n,i){var o=0,r=Number.POSITIVE_INFINITY,a=!1,s=!1,l=!1,u=e["flow-options"];if(u){var c=O.d(u.evaluate(this.context,"flow-options"));a=!!c.exclusive,s=!!c.static,l=!!c.last}var h=e["flow-linger"];h&&(r=O.c(h.evaluate(this.context,"flow-linger"),Number.POSITIVE_INFINITY));var p=e["flow-priority"];p&&(o=O.c(p.evaluate(this.context,"flow-priority"),0));var f=this.breakBeforeValues[i]||null,d=this.flows[t];if(!d){var g=this.boxStack.lastFlowName();d=this.flows[t]=new q.f(t,g)}var m=new q.g(t,n,i,o,r,a,s,l,f);return this.flowChunks.push(m),this.flowToReach==t&&(this.flowToReach=null),this.flowListener&&this.flowListener.encounteredFlowChunk(m,d),m},t.prototype.registerForcedBreakOffset=function(t,e,n){if(jt.c(t)){var i=this.flows[n].forcedBreakOffsets;(0===i.length||i[i.length-1]<e)&&i.push(e)}var o=this.breakBeforeValues[e];this.breakBeforeValues[e]=jt.d(o,t)},t.prototype.styleUntil=function(t,e){var n=-1;if(t<=this.lastOffset&&(n=this.offsetMap.slippedByFixed(t)+e)<this.offsetMap.getMaxSlipped())return this.offsetMap.fixedBySlipped(n);if(null==this.last)return Number.POSITIVE_INFINITY;for(var i=this.context;;){var o=this.last.firstChild;if(null==o)for(;;){if(1==this.last.nodeType){this.cascade.popElement(this.last),this.primary=this.primaryStack.pop();var r=null;if((c=this.boxStack.pop(this.lastOffset)).afterBox){var a=c.afterBox.getBreakValue("before");this.registerForcedBreakOffset(a,c.afterBox.atBlockStart?this.boxStack.nearestBlockStartOffset(c):c.afterBox.offset,c.flowName),r=c.afterBox.getBreakValue("after")}r=jt.d(r,c.getBreakValue("after")),this.registerForcedBreakOffset(r,this.lastOffset,c.flowName)}if(o=this.last.nextSibling)break;if(this.last=this.last.parentNode,this.last===this.root)return this.last=null,t<this.lastOffset&&(n<0&&(n=this.offsetMap.slippedByFixed(t)+e),n<=this.offsetMap.getMaxSlipped())?this.offsetMap.fixedBySlipped(n):Number.POSITIVE_INFINITY}if(this.last=o,1!=this.last.nodeType)this.lastOffset+=this.last.textContent.length,this.boxStack.encounteredTextNode(this.last),this.primary?this.offsetMap.addStuckRange(this.lastOffset):this.offsetMap.addSlippedRange(this.lastOffset);else{var s=this.last,l=this.getAttrStyle(s);this.primaryStack.push(this.primary),this.cascade.pushElement(s,l,this.lastOffset);var u=s.getAttribute("id")||s.getAttributeNS(E.a.XML,"id");u&&u===this.idToReach&&(this.idToReach=null),this.bodyReached||"body"!=s.localName||s.parentNode!=this.root||(this.postprocessTopStyle(l,!0),this.bodyReached=!0);var c=void 0,h=l["flow-into"];if(h){var p=h.evaluate(i,"flow-into").toString(),f=this.encounteredFlowElement(p,l,s,this.lastOffset);this.primary=!!this.primaryFlows[p],c=this.boxStack.push(l,this.lastOffset,s===this.root,f)}else c=this.boxStack.push(l,this.lastOffset,s===this.root);var d=this.boxStack.nearestBlockStartOffset(c);if(this.registerForcedBreakOffset(c.breakBefore,d,c.flowName),c.beforeBox){var g=c.beforeBox.getBreakValue("after");this.registerForcedBreakOffset(g,c.beforeBox.atBlockStart?d:c.offset,c.flowName)}if(this.primary&&c.displayValue()===X.t.none&&(this.primary=!1),this.styleMap["e"+this.lastOffset]=l,this.lastOffset++,this.primary?this.offsetMap.addStuckRange(this.lastOffset):this.offsetMap.addSlippedRange(this.lastOffset),t<this.lastOffset&&(n<0&&(n=this.offsetMap.slippedByFixed(t)+e),n<=this.offsetMap.getMaxSlipped()))return this.offsetMap.fixedBySlipped(n)}}},t.prototype.getStyle=function(t,e){var n=this.xmldoc.getElementOffset(t),i="e"+n;return e&&(n=this.xmldoc.getNodeOffset(t,0,!0)),this.lastOffset<=n&&this.styleUntil(n,0),this.styleMap[i]},t.prototype.processContent=function(t,e){},t}(),pe=["column-count","column-width","column-fill"],fe="/*\n * Copyright 2013 Google, Inc.\n * Copyright 2015 Trim-marks Inc.\n * Copyright 2019 Vivliostyle Foundation\n *\n * CSS property validation.\n */\nNUM = POS_NUM | ZERO | NEGATIVE;\nNNEG_NUM = POS_NUM | ZERO;\nINT = POS_INT | ZERO | NEGATIVE;\nNNEG_INT = POS_INT | ZERO;\nPERCENTAGE = POS_PERCENTAGE | ZERO | NEGATIVE;\nSTRICT_PERCENTAGE = POS_PERCENTAGE | ZERO_PERCENTAGE | NEGATIVE;\nNNEG_PERCENTAGE = POS_PERCENTAGE | ZERO;\nLENGTH = POS_LENGTH | ZERO | NEGATIVE;\nNNEG_LENGTH = POS_LENGTH | ZERO | NEGATIVE;\nPLENGTH = LENGTH | PERCENTAGE;\nPPLENGTH = POS_LENGTH | ZERO | POS_PERCENTAGE;\nALENGTH = LENGTH | auto;\nAPLENGTH = PLENGTH | auto;\nPAPLENGTH = PPLENGTH | auto;\nANGLE = POS_ANGLE | ZERO | NEGATIVE;\nLENGTH_OR_NUM = LENGTH | NUM;\nANGLE_OR_NUM = ANGLE | NUM;\nSCOLOR = HASHCOLOR | aliceblue: #F0F8FF | antiquewhite: #FAEBD7 | aqua: #00FFFF | aquamarine: #7FFFD4 | azure: #F0FFFF |\n    beige: #F5F5DC | bisque: #FFE4C4 | black: #000000 | blanchedalmond: #FFEBCD | blue: #0000FF | blueviolet: #8A2BE2 | brown: #A52A2A |\n    burlywood: #DEB887 | cadetblue: #5F9EA0 | chartreuse: #7FFF00 | chocolate: #D2691E | coral: #FF7F50 | cornflowerblue: #6495ED |\n    cornsilk: #FFF8DC | crimson: #DC143C | cyan: #00FFFF | darkblue: #00008B | darkcyan: #008B8B | darkgoldenrod: #B8860B |\n    darkgray: #A9A9A9 | darkgreen: #006400 | darkgrey: #A9A9A9 | darkkhaki: #BDB76B | darkmagenta: #8B008B | darkolivegreen: #556B2F |\n    darkorange: #FF8C00 | darkorchid: #9932CC | darkred: #8B0000 | darksalmon: #E9967A | darkseagreen: #8FBC8F | darkslateblue: #483D8B |\n    darkslategray: #2F4F4F | darkslategrey: #2F4F4F | darkturquoise: #00CED1 | darkviolet: #9400D3 | deeppink: #FF1493 |\n    deepskyblue: #00BFFF | dimgray: #696969 | dimgrey: #696969 | dodgerblue: #1E90FF | firebrick: #B22222 | floralwhite: #FFFAF0 |\n    forestgreen: #228B22 | fuchsia: #FF00FF | gainsboro: #DCDCDC | ghostwhite: #F8F8FF | gold: #FFD700 | goldenrod: #DAA520 |\n    gray: #808080 | green: #008000 | greenyellow: #ADFF2F | grey: #808080 | honeydew: #F0FFF0 | hotpink: #FF69B4 | indianred: #CD5C5C |\n    indigo: #4B0082 | ivory: #FFFFF0 | khaki: #F0E68C | lavender: #E6E6FA | lavenderblush: #FFF0F5 | lawngreen: #7CFC00 |\n    lemonchiffon: #FFFACD | lightblue: #ADD8E6 | lightcoral: #F08080 | lightcyan: #E0FFFF | lightgoldenrodyellow: #FAFAD2 |\n    lightgray: #D3D3D3 | lightgreen: #90EE90 | lightgrey: #D3D3D3 | lightpink: #FFB6C1 | lightsalmon: #FFA07A | lightseagreen: #20B2AA |\n    lightskyblue: #87CEFA | lightslategray: #778899 | lightslategrey: #778899 | lightsteelblue: #B0C4DE | lightyellow: #FFFFE0 |\n    lime: #00FF00 | limegreen: #32CD32 | linen: #FAF0E6 | magenta: #FF00FF | maroon: #800000 | mediumaquamarine: #66CDAA |\n    mediumblue: #0000CD | mediumorchid: #BA55D3 | mediumpurple: #9370DB | mediumseagreen: #3CB371 | mediumslateblue: #7B68EE |\n    mediumspringgreen: #00FA9A | mediumturquoise: #48D1CC | mediumvioletred: #C71585 | midnightblue: #191970 | mintcream: #F5FFFA |\n    mistyrose: #FFE4E1 | moccasin: #FFE4B5 | navajowhite: #FFDEAD | navy: #000080 | oldlace: #FDF5E6 | olive: #808000 |\n    olivedrab: #6B8E23 | orange: #FFA500 | orangered: #FF4500 | orchid: #DA70D6 | palegoldenrod: #EEE8AA | palegreen: #98FB98 |\n    paleturquoise: #AFEEEE | palevioletred: #DB7093 | papayawhip: #FFEFD5 | peachpuff: #FFDAB9 | peru: #CD853F | pink: #FFC0CB |\n    plum: #DDA0DD | powderblue: #B0E0E6 | purple: #800080 | rebeccapurple: #663399 | red: #FF0000 | rosybrown: #BC8F8F | royalblue: #4169E1 |\n    saddlebrown: #8B4513 | salmon: #FA8072 | sandybrown: #F4A460 | seagreen: #2E8B57 | seashell: #FFF5EE | sienna: #A0522D |\n    silver: #C0C0C0 | skyblue: #87CEEB | slateblue: #6A5ACD | slategray: #708090 | slategrey: #708090 | snow: #FFFAFA |\n    springgreen: #00FF7F | steelblue: #4682B4 | tan: #D2B48C | teal: #008080 | thistle: #D8BFD8 | tomato: #FF6347 |\n    turquoise: #40E0D0 | violet: #EE82EE | wheat: #F5DEB3 | white: #FFFFFF | whitesmoke: #F5F5F5 | yellow: #FFFF00 |\n    yellowgreen: #9ACD32 | transparent | currentcolor;\nRGBCOLOR = rgb(INT{3}) | rgb(STRICT_PERCENTAGE{3});\nRGBACOLOR = rgba(NUM{4}) | rgba(STRICT_PERCENTAGE{3} NUM);\nHSLCOLOR = hsl(NUM PERCENTAGE{2});\nHSLACOLOR = hsl(NUM PERCENTAGE{2} NUM);\nCOLOR = SCOLOR | RGBCOLOR | RGBACOLOR | HSLCOLOR | HSLACOLOR;\nBG_POSITION_TERM = PLENGTH | left | center | right | top | bottom;\nSIDE_OR_CORNER =  [left | right] || [top | bottom];\nCOLOR_STOP = SPACE(COLOR [PERCENTAGE | LENGTH]?);\nLINEAR_GRADIENT = linear-gradient([ANGLE | SPACE(to SIDE_OR_CORNER)]? COLOR_STOP+) |\n                  repeating-linear-gradient([ANGLE | SPACE(to SIDE_OR_CORNER)]? COLOR_STOP+) |;\nGRADIENT_EXTENT = closest-corner | closest-side | farthest-corner | farthest-side;\nGRADIENT_POSITION = at BG_POSITION_TERM{1,4};\nGRADIENT_SHAPE = SPACE(circle LENGTH? GRADIENT_POSITION?) | SPACE(ellipse PLENGTH{2}? GRADIENT_POSITION?)| SPACE([circle | ellipse] GRADIENT_EXTENT? GRADIENT_POSITION?);\nRADIAL_GRADIENT = radial-gradient([GRADIENT_SHAPE | SPACE(GRADIENT_POSITION)]? COLOR_STOP+) |\n                  repeating-radial-gradient([GRADIENT_SHAPE | SPACE(GRADIENT_POSITION)]? COLOR_STOP+);\nURI_OR_NONE = URI | none;\nIMAGE =  URI | LINEAR_GRADIENT | RADIAL_GRADIENT | none;\nazimuth = ANGLE | [[ left-side | far-left | left | center-left | center | center-right | right | far-right | right-side ] || behind ] | leftwards | rightwards;\nbackground-attachment = COMMA( [scroll | fixed | local]+ );\nbackground-color = COLOR;\nbackground-image = COMMA( IMAGE+ );\nbackground-position = COMMA( SPACE(BG_POSITION_TERM{1,4})+ ); /* relaxed */\nbackground-repeat = COMMA( [repeat | repeat-x | repeat-y | no-repeat]+ );\nborder-collapse = collapse | separate;\nBORDER_SIDE_COLOR = COLOR;\nBORDER_SIDE_STYLE = none | hidden | dotted | dashed | solid | double | groove | ridge | inset | outset;\nBORDER_SIDE_WIDTH = thin: 1px | medium: 3px | thick: 5px | NNEG_LENGTH;\nborder-spacing = LENGTH LENGTH?;\nborder-top-color = BORDER_SIDE_COLOR;\nborder-right-color = BORDER_SIDE_COLOR;\nborder-bottom-color = BORDER_SIDE_COLOR;\nborder-left-color = BORDER_SIDE_COLOR;\nborder-top-style = BORDER_SIDE_STYLE;\nborder-right-style = BORDER_SIDE_STYLE;\nborder-bottom-style = BORDER_SIDE_STYLE;\nborder-left-style = BORDER_SIDE_STYLE;\nborder-top-width = BORDER_SIDE_WIDTH;\nborder-right-width = BORDER_SIDE_WIDTH;\nborder-bottom-width = BORDER_SIDE_WIDTH;\nborder-left-width = BORDER_SIDE_WIDTH;\nBORDER_RADIUS = PLENGTH{1,2};\nborder-top-left-radius = BORDER_RADIUS;\nborder-top-right-radius = BORDER_RADIUS;\nborder-bottom-right-radius = BORDER_RADIUS;\nborder-bottom-left-radius = BORDER_RADIUS;\nborder-image-source = IMAGE;\nborder-image-slice = [NUM | PERCENTAGE]{1,4} || fill; /* relaxed */\nborder-image-width = [NUM | PLENGTH | auto]{1,4};\nborder-image-outset = [NUM | LENGTH]{1,4};\nborder-image-repeat = [ stretch | repeat | round | space ]{1,2};\nbottom = APLENGTH;\ncaption-side = top | bottom;\nclear = none | left | right | top | bottom | both | all | same;\nclip = rect(ALENGTH{4}) | rect(SPACE(ALENGTH{4})) | auto;\ncolor = COLOR;\nLIST_STYLE_TYPE = disc | circle | square | decimal | decimal-leading-zero | lower-roman |\n    upper-roman | lower-greek | lower-latin | upper-latin | armenian | georgian | lower-alpha |\n    upper-alpha | russian | upper-russian | lower-russian | cjk-ideographic | trad-chinese-informal |\n    hebrew | none;\nTYPE_OR_UNIT_IN_ATTR = string | color | url | integer | number | length | angle | time | frequency;\nATTR = attr(SPACE(IDENT TYPE_OR_UNIT_IN_ATTR?) [ STRING | IDENT | COLOR | INT | NUM | PLENGTH | ANGLE | POS_TIME | FREQUENCY]?);\nCONTENT = normal | none |\n    [ STRING | URI | counter(IDENT LIST_STYLE_TYPE?) |\n    counters(IDENT STRING LIST_STYLE_TYPE?) | ATTR |\n    target-counter([ STRING | URI ] IDENT LIST_STYLE_TYPE?) |\n    target-counter(ATTR IDENT LIST_STYLE_TYPE?) |\n    target-counters([ STRING | URI ] IDENT STRING LIST_STYLE_TYPE?) |\n    target-counters(ATTR IDENT STRING LIST_STYLE_TYPE?) |\n    open-quote | close-quote | no-open-quote | no-close-quote ]+;\ncontent = CONTENT;\nCOUNTER = [ IDENT INT? ]+ | none;\ncounter-increment = COUNTER;\ncounter-reset = COUNTER;\ncounter-set = COUNTER;\ncue-after = URI_OR_NONE;\ncue-before = URI_OR_NONE;\ncursor = COMMA(URI* [ auto | crosshair | default | pointer | move | e-resize | ne-resize | nw-resize |\n    n-resize | se-resize | sw-resize | s-resize | w-resize | text | wait | help | progress ]);\ndirection = ltr | rtl;\ndisplay = inline | block | list-item | inline-block | table | inline-table | table-row-group |\n    table-header-group | table-footer-group | table-row | table-column-group | table-column |\n    table-cell | table-caption | none | oeb-page-head | oeb-page-foot | flex | inline-flex |\n    ruby | ruby-base | ruby-text | ruby-base-container | ruby-text-container | run-in | compact | marker;\nelevation = ANGLE | below | level | above | higher | lower;\nempty-cells = show | hide;\nFAMILY = SPACE(IDENT+) | STRING;\nFAMILY_LIST = COMMA( FAMILY+ );\nfont-family = FAMILY_LIST;\nfont-size = xx-small | x-small | small | medium | large | x-large | xx-large | larger | smaller | PPLENGTH | POS_NUM;\nfont-style = normal | italic | oblique;\nfont-variant = normal | small-caps;\nfont-weight = normal | bold | bolder | lighter | 100 | 200 | 300 | 400 | 500 | 600 | 700 | 800 | 900;\nheight = PAPLENGTH | POS_NUM ;\nleft = APLENGTH;\nletter-spacing = normal | LENGTH_OR_NUM;\nline-height = normal | POS_NUM | PPLENGTH;\nlist-style-image = IMAGE;\nlist-style-position = inside | outside;\nlist-style-type = LIST_STYLE_TYPE;\nmargin-right = APLENGTH;\nmargin-left = APLENGTH;\nmargin-top = APLENGTH;\nmargin-bottom = APLENGTH;\nNPLENGTH = none | PLENGTH;\nmax-height = NPLENGTH;\nmax-width = NPLENGTH;\nmin-height = auto | PLENGTH;\nmin-width = auto | PLENGTH;\norphans = POS_INT;\noutline-offset = LENGTH;\noutline-color = COLOR | invert;\noutline-style = BORDER_SIDE_STYLE;\noutline-width = BORDER_SIDE_WIDTH;\noverflow = visible | hidden | scroll | auto;\npadding-right = PPLENGTH;\npadding-left = PPLENGTH;\npadding-top = PPLENGTH;\npadding-bottom = PPLENGTH;\nPAGE_BREAK = auto | always | avoid | left | right | recto | verso;\npage-break-after = PAGE_BREAK;\npage-break-before = PAGE_BREAK;\npage-break-inside = avoid | auto;\nPAUSE = POS_TIME | ZERO | POS_PERCENTAGE;\npause-after = PAUSE;\npause-before = PAUSE;\npitch-range = NUM;\npitch = FREQUENCY | x-low | low | medium | high | x-high;\nplay-during = [URI [ mix || repeat ]?] | auto | none;\nposition = static | relative | absolute | fixed;\nquotes = [STRING STRING]+ | none;\nrichness = NUM;\nright = APLENGTH;\nspeak-header = once | always;\nspeak-numeral = digits | continuous;\nspeak-punctuation = code | none;\nspeech-rate = NUM | x-slow | slow | medium | fast | x-fast | faster | slower;\nstress = NUM;\ntable-layout = auto | fixed;\ntext-align = left | right | center | justify | start | end;\ntext-decoration = none | [ underline || overline || line-through || blink ];\ntext-indent = PLENGTH;\ntext-transform = capitalize | uppercase | lowercase | none;\ntop = APLENGTH;\nvertical-align = baseline | sub | super | top | text-top | middle | bottom | text-bottom | PLENGTH;\nvisibility = visible | hidden | collapse;\nvoice-family = FAMILY_LIST;\nvolume = NUM | PERCENTAGE | silent | x-soft | soft | medium | loud | x-loud;\nwhite-space = normal | pre | nowrap | pre-wrap | pre-line;\nwidows = POS_INT;\nwidth = PAPLENGTH | POS_NUM ;\nword-spacing = normal | LENGTH_OR_NUM;\nz-index = auto | INT;\n\n[epub,moz,ms,webkit]hyphens = auto | manual | none;\n[webkit]hyphenate-character = auto | STRING;\n\n/* css-logical */\nmargin-block-start = APLENGTH;\nmargin-block-end = APLENGTH;\nmargin-inline-start = APLENGTH;\nmargin-inline-end = APLENGTH;\npadding-block-start = APLENGTH;\npadding-block-end = APLENGTH;\npadding-inline-start = APLENGTH;\npadding-inline-end = APLENGTH;\nborder-block-start-color = BORDER_SIDE_COLOR;\nborder-block-end-color = BORDER_SIDE_COLOR;\nborder-inline-start-color = BORDER_SIDE_COLOR;\nborder-inline-end-color = BORDER_SIDE_COLOR;\nborder-block-start-style = BORDER_SIDE_STYLE;\nborder-block-end-style = BORDER_SIDE_STYLE;\nborder-inline-start-style = BORDER_SIDE_STYLE;\nborder-inline-end-style = BORDER_SIDE_STYLE;\nborder-block-start-width = BORDER_SIDE_WIDTH;\nborder-block-end-width = BORDER_SIDE_WIDTH;\nborder-inline-start-width = BORDER_SIDE_WIDTH;\nborder-inline-end-width = BORDER_SIDE_WIDTH;\nblock-start = APLENGTH;\nblock-end = APLENGTH;\ninline-start = APLENGTH;\ninline-end = APLENGTH;\nblock-size = PAPLENGTH | POS_NUM;\ninline-size = PAPLENGTH | POS_NUM;\nmax-block-size = NPLENGTH;\nmax-inline-size = NPLENGTH;\nmin-block-size = auto | PLENGTH;\nmin-inline-size = auto | PLENGTH;\n\nSHAPE = auto | rectangle( PLENGTH{4} ) |  ellipse( PLENGTH{4} ) |  circle( PLENGTH{3} ) |\n    polygon( SPACE(PLENGTH+)+ );\n[epubx]shape-inside = SHAPE;\n[epubx,webkit]shape-outside = SHAPE;\n[epubx,ms]wrap-flow = auto | both | start | end | maximum | clear | around /* epub al */;\n\nTRANSFORM_FUNCTION = matrix(NUM{6}) | translate(PLENGTH{1,2}) | translateX(PLENGTH) | translateY(PLENGTH) |\n scale(NUM{1,2}) | scaleX(NUM) | scaleY(NUM) | rotate(ANGLE) | skewX(ANGLE) | skewY(ANGLE);\n[epub,ms]transform = none | TRANSFORM_FUNCTION+;\n[epub,ms]transform-origin = [[[ top | bottom | left | right] PLENGTH?] | center | PLENGTH]{1,2}; /* relaxed */\n\nBOX = border-box | padding-box | content-box;\nSHADOW = SPACE(inset || LENGTH{2,4} || COLOR); /* relaxed */\n[webkit]background-size = COMMA( SPACE( [PLENGTH | auto ]{1,2} | cover | contain)+ );\n[webkit]background-origin = COMMA( BOX+ );\n[webkit]background-clip = COMMA( BOX+ );\n[webkit]box-shadow = none | COMMA( SHADOW+ );\ntext-shadow = none |  COMMA( SHADOW+ );\n[webkit]box-decoration-break = slice | clone;\nFILTER_FUNCTION = blur(LENGTH) | brightness(NUM | PERCENTAGE) | contrast(NUM | PERCENTAGE) | drop-shadow(SPACE(LENGTH{2,3} COLOR?))\n                | grayscale(NUM | PERCENTAGE) | hue-rotate(ANGLE) | invert(NUM | PERCENTAGE) | opacity(NUM | PERCENTAGE)\n                | saturate(NUM | PERCENTAGE) | sepia(NUM | PERCENTAGE);\nFILTER_FUNCTION_LIST = FILTER_FUNCTION+;\n[webkit]filter = none | FILTER_FUNCTION_LIST;\n\nopacity = NUM;\n\n[moz,webkit]column-width = LENGTH | auto;\n[moz,webkit]column-count = INT | auto;\n[moz,webkit]column-gap = LENGTH | normal;\n[moz,webkit]column-rule-color = COLOR;\n[moz,webkit]column-rule-style = BORDER_SIDE_STYLE;\n[moz,webkit]column-rule-width = BORDER_SIDE_WIDTH;\nBREAK = auto | avoid | avoid-page | page | left | right | recto | verso | avoid-column | column | avoid-region | region;\nbreak-before = BREAK;\nbreak-after = BREAK;\nbreak-inside = auto | avoid | avoid-page | avoid-column | avoid-region;\n[webkit]column-span = none | auto | all;\n[moz]column-fill = auto | balance | balance-all;\n\nsrc = COMMA([SPACE(URI format(STRING+)?) | local(FAMILY)]+); /* for font-face */\n\n[epubx,webkit]flow-from = IDENT;\n[epubx,webkit]flow-into = IDENT;\n[epubx]flow-linger = INT | none;\n[epubx]flow-priority = INT;\n[epubx]flow-options = none | [ exclusive || last || static ];\n[epubx]page = INT | auto;\n[epubx]min-page-width = LENGTH;\n[epubx]min-page-height = LENGTH;\n[epubx]required = true | false;\n[epubx]enabled = true | false;\n[epubx]conflicting-partitions = COMMA(IDENT+);\n[epubx]required-partitions = COMMA(IDENT+);\n[epubx]snap-height = LENGTH | none;\n[epubx]snap-width = LENGTH | none;\n[epubx]flow-consume = all | some;\n[epubx]utilization = NUM;\n[epubx]text-zoom = font-size | scale;\n\n[adapt]template = URI_OR_NONE;\n[adapt]behavior = IDENT;\n\n/* CSS Fonts */\nfont-size-adjust = none | NNEG_NUM;\n[webkit]font-kerning = auto | normal | none;\nfont-variant-east-asian = normal | [[ jis78 | jis83 | jis90 | jis04 | simplified | traditional ] || [ full-width | proportional-width ] || ruby];\nfont-feature-settings = COMMA( SPACE( STRING [ on | off | INT ]? )+ );\nfont-stretch = normal | wider | narrower | ultra-condensed | extra-condensed | condensed | semi-condensed | semi-expanded | expanded | extra-expanded | ultra-expanded;\n\n/* CSS Images */\nimage-resolution = RESOLUTION;\nobject-fit = fill | contain | cover | none | scale-down;\nobject-position = COMMA( SPACE(BG_POSITION_TERM{1,4})+ ); /* relaxed */\n\n/* CSS Paged Media */\nPAGE_SIZE = a5 | a4 | a3 | b5 | b4 | jis-b5 | jis-b4 | letter | legal | ledger;\nbleed = auto | LENGTH;\nmarks = none | [ crop || cross ];\nsize = POS_LENGTH{1,2} | auto | [ PAGE_SIZE || [ portrait | landscape ] ];\n\n/* CSS Page Floats */\nfloat-reference = inline | column | region | page;\nfloat = block-start | block-end | inline-start | inline-end | snap-block | snap-inline | left | right | top | bottom | none | footnote;\nfloat-min-wrap-block = PPLENGTH;\n\n/* CSS Ruby */\nruby-align = start | center | space-between | space-around;\nruby-position = over | under | inter-character;\n\n/* CSS Size Adjust */\n[moz,ms]text-size-adjust = auto | none | POS_PERCENTAGE;\n\n/* CSS Text */\n[ms,webkit]line-break = auto | loose | normal | strict;\noverflow-wrap = normal | break-word;\n[moz]tab-size = NNEG_INT | NNEG_LENGTH;\n[moz,ms]text-align-last = auto | start | end | left | right | center | justify;\n[ms]text-justify = auto | none | inter-word | inter-character | inter-ideograph /* specified in UA stylesheet for IE */;\n[ms]word-break = normal | keep-all | break-all | break-word;\n[ms]word-wrap = normal | break-word;\n\n/* CSS Text Decoration */\n[webkit]text-decoration-color = COLOR;\n[webkit]text-decoration-line = none | [ underline || overline || line-through || blink ];\n[webkit]text-decoration-skip = none | [ objects || spaces || ink || edges || box-decoration ];\n[webkit]text-decoration-style = solid | double | dotted | dashed | wavy;\n[epub,webkit]text-emphasis-color = COLOR;\n[webkit]text-emphasis-position = [ over | under ] [ right | left ];\n[epub,webkit]text-emphasis-style = none | [[ filled | open ] || [ dot | circle | double-circle | triangle | sesame ]] | STRING;\n[ms,webkit]text-underline-position = auto | [ under || [ left | right ]];\n\n/* CSS Transforms */\n[ms,webkit]backface-visibility = visible | hidden;\n\n/* CSS UI */\nbox-sizing = content-box | padding-box | border-box;\n[ms]text-overflow = [clip | ellipsis | STRING]{1,2};\n\n/* CSS Writing Modes */\n[webkit]text-combine = none | horizontal;\n[epub,ms]text-combine-horizontal = none | all | [ digits POS_INT? ]; /* relaxed */\ntext-combine-upright = none | all | [ digits POS_INT? ]; /* relaxed */\n[epub,webkit]text-orientation = mixed | upright | sideways-right | sideways-left | sideways | use-glyph-orientation /* the following values are kept for backward-compatibility */ | vertical-right | rotate-right | rotate-left | rotate-normal | auto;\nunicode-bidi = normal | embed | isolate | bidi-override | isolate-override | plaintext;\n[epub,webkit]writing-mode = horizontal-tb | vertical-rl | lr-tb | rl-tb | tb-rl | lr | rl | tb;\n\n/* CSS Flex box */\nFLEX_BASIS = content | PAPLENGTH;\nflex-direction = row | row-reverse | column | column-reverse;\nflex-wrap = nowrap | wrap | wrap-reverse;\norder = INT;\nflex-grow = NNEG_NUM;\nflex-shrink = NNEG_NUM;\nflex-basis = FLEX_BASIS;\nflex = none | [ [ NNEG_NUM NNEG_NUM? ] || FLEX_BASIS ];\njustify-content = flex-start | flex-end | center | space-between | space-around;\nalign-items = flex-start | flex-end | center | baseline | stretch;\nalign-self = auto | flex-start | flex-end | center | baseline | stretch;\nalign-content = flex-start | flex-end | center | space-between | space-around | stretch;\n\n/* Pointer Events */\n[ms]touch-action = auto | none | [ pan-x || pan-y ] | manipulation;\n\n/* SVG 2 */\nOPACITY_VALUE = NUM | PERCENTAGE;\nDASH_ARRAY = COMMA( SPACE( [ LENGTH | PERCENTAGE | NUM ]+ )+ );\nPAINT = none | child | child(INT) | COLOR | SPACE( URI [none | COLOR]? ) | context-fill | context-stroke;\ncolor-interpolation = auto | sRGB | linearRGB;\ncolor-rendering = auto | optimizeSpeed | optimizeQuality;\nfill = PAINT;\nfill-opacity = OPACITY_VALUE;\nfill-rule = nonzero | evenodd;\nglyph-orientation-vertical = auto | NUM | ANGLE;\nimage-rendering = auto | optimizeSpeed | optimizeQuality | crisp-edges | pixelated;\nmarker-start = none | URI;\nmarker-mid = none | URI;\nmarker-end = none | URI;\npointer-events = bounding-box | visiblePainted | visibleFill | visibleStroke | visible | painted | fill | stroke | all | none;\npaint-order = normal | [ fill || stroke || markers ];\nshape-rendering = auto | optimizeSpeed | crispEdges | geometricPrecision;\nstop-color = COLOR;\nstop-opacity = OPACITY_VALUE;\nstroke = PAINT;\nstroke-dasharray = none | DASH_ARRAY;\nstroke-dashoffset = PERCENTAGE | LENGTH_OR_NUM;\nstroke-linecap = butt | round | square;\nstroke-linejoin = miter | round | bevel;\nstroke-miterlimit = NUM;\nstroke-opacity = OPACITY_VALUE;\nstroke-width = PERCENTAGE | LENGTH_OR_NUM;\ntext-anchor = start | middle | end;\ntext-rendering = auto | optimizeSpeed | optimizeLegibility | geometricPrecision;\nvector-effect = none | SPACE( [ non-scaling-stroke | non-scaling-size | non-rotation | fixed-position ]+ [ viewport | screen ]? );\n\n/* SVG 1.1 */\nalignment-baseline = auto | baseline | before-edge | text-before-edge | middle | central | after-edge | text-after-edge | ideographic | alphabetic | hanging | mathematical;\nbaseline-shift = baseline | sub | super | PERCENTAGE | LENGTH_OR_NUM;\ndominant-baseline = auto | use-script | no-change | reset-size | ideographic | alphabetic | hanging | mathematical | central | middle | text-after-edge | text-before-edge;\nmask = none | URI;\n\n/* css-masking-1 */\nSHAPE_RADIUS = PLENGTH | closest-side | farthest-side;\nFILL_RULE = nonzero | evenodd;\nSHAPE_BOX = BOX | margin-box;\nGEOMETRY_BOX = SHAPE_BOX | fill-box | stroke-box | view-box;\nBASIC_SHAPE =\n    inset( SPACE( PLENGTH{1,4} [ round PLENGTH{1,4} [ SLASH PLENGTH{1,4} ]? ]? ) )\n  | circle(  SPACE( [SHAPE_RADIUS]?    [at BG_POSITION_TERM{1,4}]? ) )\n  | ellipse( SPACE( SHAPE_RADIUS{2}? [at BG_POSITION_TERM{1,4}]? ) )\n  | polygon( FILL_RULE? COMMA( SPACE( PLENGTH{2} )+ )+ );\n[webkit]clip-path = none | URI | [ BASIC_SHAPE || GEOMETRY_BOX ];\nclip-rule = nonzero | evenodd;\n\n/* filters */\nflood-color = COLOR;\nflood-opacity = OPACITY_VALUE;\nlighting-color = COLOR;\n\n/* compositing-1 */\nBLEND_MODE = normal | multiply | screen | overlay | darken | lighten | color-dodge | color-burn | hard-light | soft-light | difference | exclusion | hue | saturation | color | luminosity;\nmix-blend-mode = BLEND_MODE;\nisolation = auto | isolate;\nbackground-blend-mode = COMMA( BLEND_MODE+ );\n\n/* CSS GCPM */\nfootnote-policy = auto | line;\n\n[viv]repeat-on-break = auto | none | header | footer;\n\nDEFAULTS\n\nbackground-attachment: scroll;\nbackground-color: transparent;\nbackground-image: none;\nbackground-repeat: repeat;\nbackground-position: 0% 0%;\nbackground-clip: border-box;\nbackground-origin: padding-box;\nbackground-size: auto;\nborder-top-color: currentColor;\nborder-right-color: currentColor;\nborder-bottom-color: currentColor;\nborder-left-color: currentColor;\nborder-top-style: none;\nborder-right-style: none;\nborder-bottom-style: none;\nborder-left-style: none;\nborder-top-width: 3px;\nborder-right-width: 3px;\nborder-bottom-width: 3px;\nborder-left-width: 3px;\nborder-top-left-radius: 0;\nborder-top-right-radius: 0;\nborder-bottom-right-radius: 0;\nborder-bottom-left-radius: 0;\nborder-image-source: none;\nborder-image-slice: 100%;\nborder-image-width: 1;\nborder-image-outset: 0;\nborder-image-repeat: stretch;\ncolumn-count: auto;\ncolumn-gap: normal;\ncolumn-width: auto;\ncolumn-rule-color: currentColor;\ncolumn-rule-style: none;\ncolumn-rule-width: 3px;\ncolumn-fill: balance;\noutline-color: currentColor;\noutline-style: none;\noutline-width: 3px;\nflex-direction: row;\nflex-wrap: nowrap;\nfont-family: serif;\nfont-style: normal;\nfont-size: medium;\nfont-variant: normal;\nfont-weight: normal;\nfont-stretch: normal;\nline-height: normal;\nlist-style-image: none;\nlist-style-position: outside;\nlist-style-type: disc;\nmargin-bottom: auto;\nmargin-left: auto;\nmargin-right: auto;\nmargin-top: auto;\npadding-bottom: auto;\npadding-left: auto;\npadding-right: auto;\npadding-top: auto;\ntext-emphasis-color: currentColor;\ntext-emphasis-style: none;\nmarker-start: none;\nmarker-mid: none;\nmarker-end: none;\n\n\nSHORTHANDS\n\nbackground = COMMA background-image [background-position [ / background-size ]] background-repeat\n     background-attachment [background-origin background-clip] background-color; /* background-color is a special case, see the code */\nborder-top = border-top-width border-top-style border-top-color;\nborder-right = border-right-width border-right-style border-right-color;\nborder-bottom = border-bottom-width border-bottom-style border-bottom-color;\nborder-left = border-left-width border-left-style border-left-color;\nborder-width = INSETS border-top-width border-right-width border-bottom-width border-left-width;\nborder-style = INSETS border-top-style border-right-style border-bottom-style border-left-style;\nborder-color = INSETS border-top-color border-right-color border-bottom-color border-left-color;\nborder = border-width border-style border-color;\nborder-image = border-image-source border-image-slice [ / border-image-width [ / border-image-outset ] ]\n     border-image-repeat;\nborder-radius = INSETS_SLASH border-top-left-radius border-top-right-radius\n     border-bottom-right-radius border-bottom-left-radius;\n[moz,webkit]columns = column-width column-count;\n[moz,webkit]column-rule = column-rule-width column-rule-style column-rule-color;\nflex-flow = flex-direction flex-wrap;\noeb-column-number = column-count;\noutline = outline-width outline-style outline-color;\nlist-style = list-style-type list-style-position list-style-image;\nmargin = INSETS margin-top margin-right margin-bottom margin-left;\npadding = INSETS padding-top padding-right padding-bottom padding-left;\npause = INSETS pause-before pause-after;\nfont = FONT font-style font-variant font-weight font-stretch /* font-size line-height font-family are special-cased */;\n[epub,webkit]text-emphasis = text-emphasis-style text-emphasis-color;\nmarker = INSETS marker-start marker-mid marker-end;\n\n/* css-logical */\nmargin-block = INSETS margin-block-start margin-block-end;\nmargin-inline = INSETS margin-inline-start margin-inline-end;\npadding-block = INSETS padding-block-start padding-block-end;\npadding-inline = INSETS padding-inline-start padding-inline-end;\nborder-block-width = INSETS border-block-start-width border-block-end-width;\nborder-block-style = INSETS border-block-start-style border-block-end-style;\nborder-block-color = INSETS border-block-start-color border-block-end-color;\nborder-inline-width = INSETS border-inline-start-width border-inline-end-width;\nborder-inline-style = INSETS border-inline-start-style border-inline-end-style;\nborder-inline-color = INSETS border-inline-start-color border-inline-end-color;\nborder-block = border-block-width border-block-style border-block-color;\nborder-inline = border-inline-width border-inline-style border-inline-color;\nborder-block-start = border-block-start-width border-block-start-style border-block-start-color;\nborder-block-end = border-block-end-width border-block-end-style border-block-end-color;\nborder-inline-start = border-inline-start-width border-inline-start-style border-inline-start-color;\nborder-inline-end = border-inline-end-width border-inline-end-style border-inline-end-color;\ninset-block-start = block-start;\ninset-block-end = block-end;\ninset-inline-start = inline-start;\ninset-inline-end = inline-end;\ninset-block = INSETS block-start block-end;\ninset-inline = INSETS inline-start inline-end;\n\n/* old names  */\n[adapt,webkit]margin-before = margin-block-start;\n[adapt,webkit]margin-after = margin-block-end;\n[adapt,webkit]margin-start = margin-inline-start;\n[adapt,webkit]margin-end = margin-inline-end;\n[adapt,webkit]padding-before = padding-block-start;\n[adapt,webkit]padding-after = padding-block-end;\n[adapt,webkit]padding-start = padding-inline-start;\n[adapt,webkit]padding-end = padding-inline-end;\n[adapt,webkit]border-before-color = border-block-start-color;\n[adapt,webkit]border-after-color = border-block-end-color;\n[adapt,webkit]border-start-color = border-inline-start-color;\n[adapt,webkit]border-end-color = border-inline-end-color;\n[adapt,webkit]border-before-style = border-block-start-style;\n[adapt,webkit]border-after-style = border-block-end-style;\n[adapt,webkit]border-start-style = border-inline-start-style;\n[adapt,webkit]border-end-style = border-inline-end-style;\n[adapt,webkit]border-before-width = border-block-start-width;\n[adapt,webkit]border-after-width = border-block-end-width;\n[adapt,webkit]border-start-width = border-inline-start-width;\n[adapt,webkit]border-end-width = border-inline-end-width;\n[adapt,webkit]before = block-start;\n[adapt,webkit]after = block-end;\n[adapt,webkit]start = inline-start;\n[adapt,webkit]end = inline-end;\n",de=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),ge=function(){function t(t){this.validator=t,this.success=null,this.failure=null,this.code=0}return t.prototype.isSpecial=function(){return 0!=this.code},t.prototype.markAsStartGroup=function(){this.code=-1},t.prototype.isStartGroup=function(){return-1==this.code},t.prototype.markAsEndGroup=function(){this.code=-2},t.prototype.isEndGroup=function(){return-2==this.code},t.prototype.markAsStartAlternate=function(t){this.code=2*t+1},t.prototype.isStartAlternate=function(){return this.code>0&&this.code%2!=0},t.prototype.markAsEndAlternate=function(t){this.code=2*t+2},t.prototype.isEndAlternate=function(){return this.code>0&&this.code%2==0},t.prototype.getAlternate=function(){return Math.floor((this.code-1)/2)},t}(),me=function(t,e){this.where=t,this.success=e,this.what=-1};!function(t){t[t.FOLLOW=1]="FOLLOW",t[t.OPTIONAL=2]="OPTIONAL",t[t.REPEATED=3]="REPEATED",t[t.ALTERNATE=4]="ALTERNATE"}(oe||(oe={}));var ye=function(){function t(){this.nodes=[],this.connections=[],this.match=[],this.nomatch=[],this.error=[],this.emptyHead=!0}return t.prototype.connect=function(t,e){for(var n=0;n<t.length;n++)this.connections[t[n]].what=e;t.splice(0,t.length)},t.prototype.clone=function(){for(var e,n,i,o=new t,r=0;r<this.nodes.length;r++){var a=this.nodes[r],s=new ge(a.validator);s.code=a.code,o.nodes.push(s)}for(r=0;r<this.connections.length;r++){var l=this.connections[r],u=new me(l.where,l.success);u.what=l.what,o.connections.push(u)}return(e=o.match).push.apply(e,this.match),(n=o.nomatch).push.apply(n,this.nomatch),(i=o.error).push.apply(i,this.error),o},t.prototype.addSpecialToArr=function(t,e,n){var i=this.nodes.length,o=new ge(we);n>=0?e?o.markAsStartAlternate(n):o.markAsEndAlternate(n):e?o.markAsStartGroup():o.markAsEndGroup(),this.nodes.push(o),this.connect(t,i);var r=new me(i,!0),a=new me(i,!1);t.push(this.connections.length),this.connections.push(a),t.push(this.connections.length),this.connections.push(r)},t.prototype.endSpecialGroup=function(){for(var t=[this.match,this.nomatch,this.error],e=0;e<t.length;e++)this.addSpecialToArr(t[e],!1,-1)},t.prototype.startSpecialGroup=function(){if(this.nodes.length)throw new Error("invalid call");this.addSpecialToArr(this.match,!0,-1)},t.prototype.endClause=function(t){this.addSpecialToArr(this.match,!1,t)},t.prototype.startClause=function(t){if(this.nodes.length)throw new Error("invalid call");var e=new ge(we);e.markAsStartAlternate(t),this.nodes.push(e);var n=new me(0,!0),i=new me(0,!1);this.nomatch.push(this.connections.length),this.connections.push(i),this.match.push(this.connections.length),this.connections.push(n)},t.prototype.addPrimitive=function(t){var e=this.nodes.length;this.nodes.push(new ge(t));var n=new me(e,!0),i=new me(e,!1);this.connect(this.match,e),this.emptyHead?(this.nomatch.push(this.connections.length),this.emptyHead=!1):this.error.push(this.connections.length),this.connections.push(i),this.match.push(this.connections.length),this.connections.push(n)},t.prototype.isSimple=function(){return 1==this.nodes.length&&!this.nodes[0].isSpecial()},t.prototype.isPrimitive=function(){return this.isSimple()&&this.nodes[0].validator instanceof Ee},t.prototype.addGroup=function(t,e){if(0!=t.nodes.length){var n=this.nodes.length;if(e==oe.ALTERNATE&&1==n&&t.isPrimitive()&&this.isPrimitive())this.nodes[0].validator=this.nodes[0].validator.combine(t.nodes[0].validator);else{for(var i=0;i<t.nodes.length;i++)this.nodes.push(t.nodes[i]);e==oe.ALTERNATE?(this.emptyHead=!0,this.connect(this.nomatch,n)):this.connect(this.match,n);var o=this.connections.length;for(i=0;i<t.connections.length;i++){var r=t.connections[i];r.where+=n,r.what>=0&&(r.what+=n),this.connections.push(r)}for(i=0;i<t.match.length;i++)this.match.push(t.match[i]+o);if(e==oe.REPEATED&&this.connect(this.match,n),e==oe.OPTIONAL||e==oe.REPEATED)for(i=0;i<t.nomatch.length;i++)this.match.push(t.nomatch[i]+o);else if(this.emptyHead){for(i=0;i<t.nomatch.length;i++)this.nomatch.push(t.nomatch[i]+o);this.emptyHead=t.emptyHead}else for(i=0;i<t.nomatch.length;i++)this.error.push(t.nomatch[i]+o);for(i=0;i<t.error.length;i++)this.error.push(t.error[i]+o);t.nodes=null,t.connections=null}}},t.prototype.finish=function(t,e){var n=this.nodes.length;this.nodes.push(t),this.nodes.push(e),this.connect(this.match,n),this.connect(this.nomatch,n+1),this.connect(this.error,n+1);for(var i=0,o=this.connections;i<o.length;i++){var r=o[i];r.success?this.nodes[r.where].success=this.nodes[r.what]:this.nodes[r.where].failure=this.nodes[r.what]}for(var a=0;a<n;a++)if(null==this.nodes[a].failure||null==this.nodes[a].success)throw new Error("Invalid validator state");return this.nodes[0]},t}(),ve=function(t){function e(){return t.call(this)||this}return de(e,t),e.prototype.validateForShorthand=function(t,e){var n=t[e].visit(this);return n?[n]:null},e}(X.m),Ee=function(t){function e(e,n,i){var o=t.call(this)||this;return o.allowed=e,o.idents=n,o.units=i,o}return de(e,t),e.prototype.visitEmpty=function(t){return 1&this.allowed?t:null},e.prototype.visitSlash=function(t){return 2048&this.allowed?t:null},e.prototype.visitStr=function(t){return 2&this.allowed?t:null},e.prototype.visitIdent=function(t){return this.idents[t.name.toLowerCase()]||(4&this.allowed?t:null)},e.prototype.visitNumeric=function(t){return 0!=t.num||512&this.allowed?t.num<0&&!(256&this.allowed)?null:this.units[t.unit]?t:null:"%"==t.unit&&1024&this.allowed?t:null},e.prototype.visitNum=function(t){return 0==t.num?512&this.allowed?t:null:t.num<=0&&!(256&this.allowed)?null:16&this.allowed?t:null},e.prototype.visitInt=function(t){return 0==t.num?512&this.allowed?t:null:t.num<=0&&!(256&this.allowed)?null:48&this.allowed?t:this.idents[""+t.num]||null},e.prototype.visitColor=function(t){return 64&this.allowed?t:null},e.prototype.visitURL=function(t){return 128&this.allowed?t:null},e.prototype.visitSpaceList=function(t){return null},e.prototype.visitCommaList=function(t){return null},e.prototype.visitFunc=function(t){return null},e.prototype.visitExpr=function(t){return 2046&this.allowed?t:null},e.prototype.combine=function(t){var n={},i={};for(var o in this.idents)n[o]=this.idents[o];for(var o in t.idents)n[o]=t.idents[o];for(var r in this.units)i[r]=this.units[r];for(var r in t.units)i[r]=t.units[r];return new e(this.allowed|t.allowed,n,i)},e}(ve),be={},we=new Ee(0,be,be),Ne=function(t){function e(e){var n=t.call(this)||this;return n.successTerminal=new ge(null),n.failureTerminal=new ge(null),n.first=e.finish(n.successTerminal,n.failureTerminal),n}return de(e,t),e.prototype.validateList=function(t,e,n){for(var i=e?[]:t,o=this.first,r=n,a=null,s=null;o!==this.successTerminal&&o!==this.failureTerminal;)if(r>=t.length)o=o.failure;else{var l=t[r],u=l;if(o.isSpecial()){var c=!0;o.isStartGroup()?(a?a.push(s):a=[s],s=[]):o.isEndGroup()?s=a.length>0?a.pop():null:o.isEndAlternate()?s[o.getAlternate()]="taken":c=null==s[o.getAlternate()],o=c?o.success:o.failure}else{if(0==r&&!e&&o.validator instanceof Ce&&this instanceof Ce){if(u=new X.j(t).visit(o.validator)){r=t.length,o=o.success;continue}}else if(0==r&&!e&&o.validator instanceof Se&&this instanceof Ce){if(u=new X.b(t).visit(o.validator)){r=t.length,o=o.success;continue}}else u=l.visit(o.validator);if(!u){o=o.failure;continue}if(u!==l&&t===i){i=[];for(var h=0;h<r;h++)i[h]=t[h]}t!==i&&(i[r-n]=u),r++,o=o.success}}return o===this.successTerminal&&(e?i.length>0:r==t.length)?i:null},e.prototype.validateSingle=function(t){for(var e=null,n=this.first;n!==this.successTerminal&&n!==this.failureTerminal;)t?n.isSpecial()?n=n.success:(e=t.visit(n.validator))?(t=null,n=n.success):n=n.failure:n=n.failure;return n===this.successTerminal?e:null},e.prototype.visitEmpty=function(t){return this.validateSingle(t)},e.prototype.visitSlash=function(t){return this.validateSingle(t)},e.prototype.visitStr=function(t){return this.validateSingle(t)},e.prototype.visitIdent=function(t){return this.validateSingle(t)},e.prototype.visitNumeric=function(t){return this.validateSingle(t)},e.prototype.visitNum=function(t){return this.validateSingle(t)},e.prototype.visitInt=function(t){return this.validateSingle(t)},e.prototype.visitColor=function(t){return this.validateSingle(t)},e.prototype.visitURL=function(t){return this.validateSingle(t)},e.prototype.visitSpaceList=function(t){return null},e.prototype.visitCommaList=function(t){return null},e.prototype.visitFunc=function(t){return this.validateSingle(t)},e.prototype.visitExpr=function(t){return null},e}(ve),Ce=function(t){function e(e){return t.call(this,e)||this}return de(e,t),e.prototype.visitSpaceList=function(t){var e=this.validateList(t.values,!1,0);return e===t.values?t:e?new X.j(e):null},e.prototype.visitCommaList=function(t){for(var e=this.first,n=!1;e;){if(e.validator instanceof Se){n=!0;break}e=e.failure}if(n){var i=this.validateList(t.values,!1,0);return i===t.values?t:i?new X.b(i):null}return null},e.prototype.validateForShorthand=function(t,e){return this.validateList(t,!0,e)},e}(Ne),Se=function(t){function e(e){return t.call(this,e)||this}return de(e,t),e.prototype.visitSpaceList=function(t){return this.validateSingle(t)},e.prototype.visitCommaList=function(t){var e=this.validateList(t.values,!1,0);return e===t.values?t:e?new X.b(e):null},e.prototype.validateForShorthand=function(t,e){for(var n,i=this.first;i!==this.failureTerminal;){if(n=i.validator.validateForShorthand(t,e))return n;i=i.failure}return null},e}(Ne),Te=function(t){function e(e,n){var i=t.call(this,n)||this;return i.name=e,i}return de(e,t),e.prototype.validateSingle=function(t){return null},e.prototype.visitFunc=function(t){if(t.name.toLowerCase()!=this.name)return null;var e=this.validateList(t.values,!1,0);return e===t.values?t:e?new X.e(t.name,e):null},e}(Ne),xe=function(){function t(){}return t.prototype.tryParse=function(t,e,n){return e},t.prototype.success=function(t,e){},t}(),Ie=function(t){function e(e,n){var i=t.call(this)||this;return i.name=n,i.validator=e.validators[i.name],i}return de(e,t),e.prototype.tryParse=function(t,e,n){if(n.values[this.name])return e;var i=this.validator.validateForShorthand(t,e);if(i){var o=i.length,r=o>1?new X.j(i):i[0];return this.success(r,n),e+o}return e},e.prototype.success=function(t,e){e.values[this.name]=t},e}(xe),Pe=function(t){function e(e,n){var i=t.call(this,e,n[0])||this;return i.names=n,i}return de(e,t),e.prototype.success=function(t,e){for(var n=0;n<this.names.length;n++)e.values[this.names[n]]=t},e}(Ie),Ae=function(t){function e(e,n){var i=t.call(this)||this;return i.nodes=e,i.slash=n,i}return de(e,t),e.prototype.tryParse=function(t,e,n){var i=e;if(this.slash){if(t[e]!=X.w)return i;if(++e==t.length)return i}var o=this.nodes[0].tryParse(t,e,n);if(o==e)return i;e=o;for(var r=1;r<this.nodes.length&&e<t.length&&(o=this.nodes[r].tryParse(t,e,n))!=e;r++)e=o;return e},e}(xe),Re=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.syntax=null,e.propList=null,e.error=!1,e.values={},e.validatorSet=null,e}return de(e,t),e.prototype.setOwner=function(t){this.validatorSet=t},e.prototype.syntaxNodeForProperty=function(t){return new Ie(this.validatorSet,t)},e.prototype.clone=function(){var t=new this.constructor;return t.syntax=this.syntax,t.propList=this.propList,t.validatorSet=this.validatorSet,t},e.prototype.init=function(t,e){this.syntax=t,this.propList=e},e.prototype.finish=function(t,e){if(!this.error){for(var n=0,i=this.propList;n<i.length;n++){var o=i[n];e.simpleProperty(o,this.values[o]||this.validatorSet.defaultValues[o],t)}return!0}return!1},e.prototype.propagateInherit=function(t,e){for(var n=0,i=this.propList;n<i.length;n++){var o=i[n];e.simpleProperty(o,X.t.inherit,t)}},e.prototype.validateList=function(t){return this.error=!0,0},e.prototype.validateSingle=function(t){return this.validateList([t]),null},e.prototype.visitEmpty=function(t){return this.validateSingle(t)},e.prototype.visitStr=function(t){return this.validateSingle(t)},e.prototype.visitIdent=function(t){return this.validateSingle(t)},e.prototype.visitNumeric=function(t){return this.validateSingle(t)},e.prototype.visitNum=function(t){return this.validateSingle(t)},e.prototype.visitInt=function(t){return this.validateSingle(t)},e.prototype.visitColor=function(t){return this.validateSingle(t)},e.prototype.visitURL=function(t){return this.validateSingle(t)},e.prototype.visitSpaceList=function(t){return this.validateList(t.values),null},e.prototype.visitCommaList=function(t){return this.error=!0,null},e.prototype.visitFunc=function(t){return this.validateSingle(t)},e.prototype.visitExpr=function(t){return this.error=!0,null},e}(X.m),Oe=function(t){function e(){return t.call(this)||this}return de(e,t),e.prototype.validateList=function(t){for(var e=0,n=0;e<t.length;){var i=this.syntax[n].tryParse(t,e,this);if(i>e)e=i,n=0;else if(++n==this.syntax.length){this.error=!0;break}}return e},e}(Re),Le=function(t){function e(){return t.call(this)||this}return de(e,t),e.prototype.validateList=function(t){if(t.length>this.syntax.length||0==t.length)return this.error=!0,0;for(var e=0;e<this.syntax.length;e++){for(var n=e;n>=t.length;)n=1==n?0:n-2;if(this.syntax[e].tryParse(t,n,this)!=n+1)return this.error=!0,0}return t.length},e.prototype.createSyntaxNode=function(){return new Pe(this.validatorSet,this.propList)},e}(Re),ke=function(t){function e(){return t.call(this)||this}return de(e,t),e.prototype.validateList=function(t){for(var e=t.length,n=0;n<t.length;n++)if(t[n]===X.w){e=n;break}if(e>this.syntax.length||0==t.length)return this.error=!0,0;for(n=0;n<this.syntax.length;n++){for(var i=n;i>=e;)i=1==i?0:i-2;var o=void 0;if(e+1<t.length)for(o=e+n+1;o>=t.length;)o-=o==e+2?1:2;else o=i;var r=[t[i],t[o]];if(2!=this.syntax[n].tryParse(r,0,this))return this.error=!0,0}return t.length},e}(Re),Fe=function(t){function e(){return t.call(this)||this}return de(e,t),e.prototype.mergeIn=function(t,e){for(var n=0,i=this.propList;n<i.length;n++){var o=i[n],r=e[o]||this.validatorSet.defaultValues[o],a=t[o];a||(a=[],t[o]=a),a.push(r)}},e.prototype.visitCommaList=function(t){for(var e={},n=0;n<t.values.length;n++)if(this.values={},t.values[n]instanceof X.b?this.error=!0:(t.values[n].visit(this),this.mergeIn(e,this.values),this.values["background-color"]&&n!=t.values.length-1&&(this.error=!0)),this.error)return null;for(var i in this.values={},e)this.values[i]="background-color"==i?e[i].pop():new X.b(e[i]);return null},e}(Oe),_e=function(t){function e(){return t.call(this)||this}return de(e,t),e.prototype.init=function(e,n){t.prototype.init.call(this,e,n),this.propList.push("font-family","line-height","font-size")},e.prototype.validateList=function(e){var n=t.prototype.validateList.call(this,e);if(n+2>e.length)return this.error=!0,n;this.error=!1;var i=this.validatorSet.validators;if(!e[n].visit(i["font-size"]))return this.error=!0,n;if(this.values["font-size"]=e[n++],e[n]===X.w){if(++n+2>e.length)return this.error=!0,n;if(!e[n].visit(i["line-height"]))return this.error=!0,n;this.values["line-height"]=e[n++]}var o=n==e.length-1?e[n]:new X.j(e.slice(n,e.length));return o.visit(i["font-family"])?(this.values["font-family"]=o,e.length):(this.error=!0,n)},e.prototype.visitCommaList=function(t){if(t.values[0].visit(this),this.error)return null;for(var e=[this.values["font-family"]],n=1;n<t.values.length;n++)e.push(t.values[n]);var i=new X.b(e);return i.visit(this.validatorSet.validators["font-family"])?this.values["font-family"]=i:this.error=!0,null},e.prototype.visitIdent=function(t){var e=this.validatorSet.systemFonts[t.name];if(e)for(var n in e)this.values[n]=e[n];else this.error=!0;return null},e}(Oe),De={SIMPLE:Oe,INSETS:Le,INSETS_SLASH:ke,COMMA:Fe,FONT:_e},Be=function(){function t(){this.validators={},this.prefixes={},this.defaultValues={},this.namedValidators={},this.systemFonts={},this.shorthands={},this.layoutProps={},this.backgroundProps={}}return t.prototype.addReplacement=function(t,e){var n;if(e.type==G.a.NUMERIC)n=new X.i(e.num,e.text);else if(e.type==G.a.HASH)n=z.h(e.text);else{if(e.type!=G.a.IDENT)throw new Error("unexpected replacement");n=X.r(e.text)}if(t.isPrimitive()){var i=t.nodes[0].validator.idents;for(var o in i)i[o]=n;return t}throw new Error("unexpected replacement")},t.prototype.newGroup=function(t,e){var n=new ye;if("||"==t){for(var i=0;i<e.length;i++){var o=new ye;o.startClause(i),o.addGroup(e[i],oe.FOLLOW),o.endClause(i),n.addGroup(o,0==i?oe.FOLLOW:oe.ALTERNATE)}var r=new ye;return r.startSpecialGroup(),r.addGroup(n,oe.REPEATED),r.endSpecialGroup(),r}var a=void 0;switch(t){case" ":a=oe.FOLLOW;break;case"|":case"||":a=oe.ALTERNATE;break;default:throw new Error("unexpected op")}for(i=0;i<e.length;i++)n.addGroup(e[i],0==i?oe.FOLLOW:a);return n},t.prototype.addCounts=function(t,e,n){for(var i=new ye,o=0;o<e;o++)i.addGroup(t.clone(),oe.FOLLOW);if(n==Number.POSITIVE_INFINITY)i.addGroup(t,oe.REPEATED);else for(o=e;o<n;o++)i.addGroup(t.clone(),oe.OPTIONAL);return i},t.prototype.primitive=function(t){var e=new ye;return e.addPrimitive(t),e},t.prototype.newFunc=function(t,e){var n;switch(t){case"COMMA":n=new Se(e);break;case"SPACE":n=new Ce(e);break;default:n=new Te(t.toLowerCase(),e)}return this.primitive(n)},t.prototype.initBuiltInValidators=function(){this.namedValidators.HASHCOLOR=this.primitive(new Ee(64,be,be)),this.namedValidators.POS_INT=this.primitive(new Ee(32,be,be)),this.namedValidators.POS_NUM=this.primitive(new Ee(16,be,be)),this.namedValidators.POS_PERCENTAGE=this.primitive(new Ee(8,be,{"%":X.o})),this.namedValidators.NEGATIVE=this.primitive(new Ee(256,be,be)),this.namedValidators.ZERO=this.primitive(new Ee(512,be,be)),this.namedValidators.ZERO_PERCENTAGE=this.primitive(new Ee(1024,be,be)),this.namedValidators.POS_LENGTH=this.primitive(new Ee(8,be,{em:X.o,ex:X.o,ch:X.o,rem:X.o,vw:X.o,vh:X.o,vi:X.o,vb:X.o,vmin:X.o,vmax:X.o,pvw:X.o,pvh:X.o,pvi:X.o,pvb:X.o,pvmin:X.o,pvmax:X.o,cm:X.o,mm:X.o,in:X.o,px:X.o,pt:X.o,pc:X.o,q:X.o})),this.namedValidators.POS_ANGLE=this.primitive(new Ee(8,be,{deg:X.o,grad:X.o,rad:X.o,turn:X.o})),this.namedValidators.POS_TIME=this.primitive(new Ee(8,be,{s:X.o,ms:X.o})),this.namedValidators.FREQUENCY=this.primitive(new Ee(8,be,{Hz:X.o,kHz:X.o})),this.namedValidators.RESOLUTION=this.primitive(new Ee(8,be,{dpi:X.o,dpcm:X.o,dppx:X.o})),this.namedValidators.URI=this.primitive(new Ee(128,be,be)),this.namedValidators.IDENT=this.primitive(new Ee(4,be,be)),this.namedValidators.STRING=this.primitive(new Ee(2,be,be)),this.namedValidators.SLASH=this.primitive(new Ee(2048,be,be));var t={"font-family":X.r("sans-serif")};this.systemFonts.caption=t,this.systemFonts.icon=t,this.systemFonts.menu=t,this.systemFonts["message-box"]=t,this.systemFonts["small-caption"]=t,this.systemFonts["status-bar"]=t},t.prototype.isBuiltIn=function(t){return!!t.match(/^[A-Z_0-9]+$/)},t.prototype.readNameAndPrefixes=function(t,e){var n=t.token();if(n.type==G.a.EOF)return null;var i={"":!0};if(n.type==G.a.O_BRK){do{if(t.consume(),(n=t.token()).type!=G.a.IDENT)throw new Error("Prefix name expected");i[n.text]=!0,t.consume(),n=t.token()}while(n.type==G.a.COMMA);if(n.type!=G.a.C_BRK)throw new Error("']' expected");t.consume(),n=t.token()}if(n.type!=G.a.IDENT)throw new Error("Property name expected");if(2==e?"SHORTHANDS"==n.text:"DEFAULTS"==n.text)return t.consume(),null;var o=n.text;if(t.consume(),2!=e){if(t.token().type!=G.a.EQ)throw new Error("'=' expected");this.isBuiltIn(o)||(this.prefixes[o]=i)}else if(t.token().type!=G.a.COLON)throw new Error("':' expected");return o},t.prototype.parseValidators=function(t){for(var e=function(){var e=n.readNameAndPrefixes(t,1);if(!e)return{value:void 0};for(var i=[],o=[],r="",a=void 0,s=!0,l=n,u=function(){if(0==i.length)throw new Error("No values");return 1==i.length?i[0]:l.newGroup(r,i)},c=function(t){if(s)throw new Error("'"+t+"': unexpected");if(r&&r!=t)throw new Error("mixed operators: '"+t+"' and '"+r+"'");r=t,s=!0},h=null;!h;){t.consume();var p=t.token();switch(p.type){case G.a.IDENT:if(s||c(" "),n.isBuiltIn(p.text)){var f=n.namedValidators[p.text];if(!f)throw new Error("'"+p.text+"' unexpected");i.push(f.clone())}else(d={})[p.text.toLowerCase()]=X.r(p.text),i.push(n.primitive(new Ee(0,d,be)));s=!1;break;case G.a.INT:var d;(d={})[""+p.num]=new X.g(p.num),i.push(n.primitive(new Ee(0,d,be))),s=!1;break;case G.a.BAR:c("|");break;case G.a.BAR_BAR:c("||");break;case G.a.O_BRK:s||c(" "),o.push({vals:i,op:r,b:"["}),r="",i=[],s=!0;break;case G.a.FUNC:s||c(" "),o.push({vals:i,op:r,b:"(",fn:p.text}),r="",i=[],s=!0;break;case G.a.C_BRK:a=u();var g=o.pop();if("["!=g.b)throw new Error("']' unexpected");(i=g.vals).push(a),r=g.op,s=!1;break;case G.a.C_PAR:a=u();var m=o.pop();if("("!=m.b)throw new Error("')' unexpected");(i=m.vals).push(n.newFunc(m.fn,a)),r=m.op,s=!1;break;case G.a.COLON:if(s)throw new Error("':' unexpected");t.consume(),i.push(n.addReplacement(i.pop(),t.token()));break;case G.a.QMARK:if(s)throw new Error("'?' unexpected");i.push(n.addCounts(i.pop(),0,1));break;case G.a.STAR:if(s)throw new Error("'*' unexpected");i.push(n.addCounts(i.pop(),0,Number.POSITIVE_INFINITY));break;case G.a.PLUS:if(s)throw new Error("'+' unexpected");i.push(n.addCounts(i.pop(),1,Number.POSITIVE_INFINITY));break;case G.a.O_BRC:if(t.consume(),(p=t.token()).type!=G.a.INT)throw new Error("<int> expected");var y=p.num,v=y;if(t.consume(),(p=t.token()).type==G.a.COMMA){if(t.consume(),(p=t.token()).type!=G.a.INT)throw new Error("<int> expected");v=p.num,t.consume(),p=t.token()}if(p.type!=G.a.C_BRC)throw new Error("'}' expected");i.push(n.addCounts(i.pop(),y,v));break;case G.a.SEMICOL:if(h=u(),o.length>0)throw new Error("unclosed '"+o.pop().b+"'");break;default:throw new Error("unexpected token")}}t.consume(),n.isBuiltIn(e)?n.namedValidators[e]=h:h.isSimple()?n.validators[e]=h.nodes[0].validator:n.validators[e]=new Ce(h)},n=this;;){var i=e();if("object"==typeof i)return i.value}},t.prototype.parseDefaults=function(t){for(;;){var e=this.readNameAndPrefixes(t,2);if(!e)return;for(var n=[];;){t.consume();var i=t.token();if(i.type==G.a.SEMICOL){t.consume();break}switch(i.type){case G.a.IDENT:n.push(X.r(i.text));break;case G.a.NUM:n.push(new X.h(i.num));break;case G.a.INT:n.push(new X.g(i.num));break;case G.a.NUMERIC:n.push(new X.i(i.num,i.text));break;default:throw new Error("unexpected token")}}this.defaultValues[e]=n.length>1?new X.j(n):n[0]}},t.prototype.parseShorthands=function(t){for(;;){var e=this.readNameAndPrefixes(t,3);if(!e)return;var n=t.nthToken(1),i=void 0;n.type==G.a.IDENT&&De[n.text]?(i=new De[n.text],t.consume()):i=new Oe,i.setOwner(this);for(var o=!1,r=[],a=!1,s=[],l=[];!o;)switch(t.consume(),(n=t.token()).type){case G.a.IDENT:if(this.validators[n.text])r.push(i.syntaxNodeForProperty(n.text)),l.push(n.text);else{if(!(this.shorthands[n.text]instanceof Le))throw new Error("'"+n.text+"' is neither a simple property nor an inset shorthand");var u=this.shorthands[n.text];r.push(u.createSyntaxNode()),l.push.apply(l,u.propList)}break;case G.a.SLASH:if(r.length>0||a)throw new Error("unexpected slash");a=!0;break;case G.a.O_BRK:s.push({slash:a,syntax:r}),r=[],a=!1;break;case G.a.C_BRK:var c=new Ae(r,a),h=s.pop();r=h.syntax,a=h.slash,r.push(c);break;case G.a.SEMICOL:o=!0,t.consume();break;default:throw new Error("unexpected token")}i.init(r,l),this.shorthands[e]=i}},t.prototype.parse=function(t){var e=new G.b(t,null);this.parseValidators(e),this.parseDefaults(e),this.parseShorthands(e),this.backgroundProps=this.makePropSet(["background"]),this.layoutProps=this.makePropSet(["margin","border","padding","columns","column-gap","column-rule","column-fill"])},t.prototype.makePropSet=function(t){for(var e={},n=0,i=t;n<i.length;n++)for(var o=i[n],r=this.shorthands[o],a=0,s=r?r.propList:[o];a<s.length;a++){var l=s[a],c=this.defaultValues[l];c?e[l]=c:u.b.warn("Unknown property in makePropSet:",l)}return e},t.prototype.validatePropertyAndHandleShorthand=function(t,e,n,i){var o="",r=t,a=(t=t.toLowerCase()).match(/^-([a-z]+)-([-a-z0-9]+)$/);a&&(o=a[1],t=a[2]);var s=this.prefixes[t];if(s&&s[o]){var l=this.validators[t];if(l){var u=e===X.t.inherit||e.isExpr()?e:e.visit(l);u?i.simpleProperty(t,u,n):i.invalidPropertyValue(r,e)}else{var c=this.shorthands[t].clone();e===X.t.inherit?c.propagateInherit(n,i):(e.visit(c),c.finish(n,i)||i.invalidPropertyValue(r,e))}}else i.unknownProperty(r,e)},t}();function Me(){var t=new Be;return t.initBuiltInValidators(),t.parse(fe),t}var Ue=n(17),Ve={"font-style":X.t.normal,"font-variant":X.t.normal,"font-weight":X.t.normal},He="OTTO"+(new Date).valueOf(),ze=1;function Ge(t,e){var n={};for(var i in t)n[i]=H.s(t,i).evaluate(e,i);return function(t){for(var e in Ve)t[e]||(t[e]=Ve[e])}(n),n}var We=function(){function t(t){this.properties=t,this.blobURLs=[],this.blobs=[],this.fontTraitKey=function(t){var e=new E.d;for(var n in Ve)e.append(" "),e.append(t[n].toString());return e.toString()}(this.properties),this.src=this.properties.src?this.properties.src.toString():null;var e=this.properties["font-family"];this.family=e?e.stringValue():null}return t.prototype.traitsEqual=function(t){return this.fontTraitKey==t.fontTraitKey},t.prototype.makeAtRule=function(t,e){var n=new E.d;for(var i in n.append("@font-face {\n  font-family: "),n.append(this.family),n.append(";\n  "),Ve)n.append(i),n.append(": "),this.properties[i].appendTo(n,!0),n.append(";\n  ");if(e){n.append('src: url("');var o=W.d(e);n.append(o),this.blobURLs.push(o),this.blobs.push(e),n.append('")')}else n.append("src: "),n.append(t);return n.append(";\n}\n"),n.toString()},t}(),Xe=function(){function t(t){this.deobfuscator=t,this.familyMap={}}return t.prototype.registerFamily=function(t,e){var n=t.family,i=this.familyMap[n],o=e.family;if(i){if(i!=o)throw new Error("E_FONT_FAMILY_INCONSISTENT "+t.family)}else this.familyMap[n]=o},t.prototype.filterFontFamily=function(t){if(t instanceof X.b){for(var e=[],n=0,i=t.values;n<i.length;n++){var o=i[n],r=this.familyMap[o.stringValue()];r&&e.push(X.r(r)),e.push(o)}return new X.b(e)}var a=this.familyMap[t.stringValue()];return a?new X.b([X.r(a),t]):t},t}(),je=function(){function t(t,e,n){this.head=t,this.body=e,this.srcURLMap={},this.familyCounter=0,this.familyPrefix=n||"Fnt_"}return t.prototype.getViewFontFamily=function(t,e){var n=t.family,i=e.familyMap[n];return i||(i=this.familyPrefix+ ++this.familyCounter,e.familyMap[n]=i,i)},t.prototype.initFont=function(t,e,n){var i=Y.c("initFont"),o=this,r=t.src,a={};for(var s in Ve)a[s]=t.properties[s];var l=o.getViewFontFamily(t,n);a["font-family"]=X.r(l);var c=new We(a),h=o.body.ownerDocument.createElement("span");h.textContent="M";var p=(new Date).valueOf()+1e3,f=o.head.ownerDocument.createElement("style"),d=He+ze++;for(var g in f.textContent=c.makeAtRule("",W.e([d])),o.head.appendChild(f),o.body.appendChild(h),h.style.visibility="hidden",h.style.fontFamily=l,Ve)E.F(h,g,a[g].toString());var m=h.getBoundingClientRect(),y=m.right-m.left,v=m.bottom-m.top;f.textContent=c.makeAtRule(r,e),u.b.info("Starting to load font:",r);var b=!1;return i.loop(function(){var t=h.getBoundingClientRect(),e=t.right-t.left,n=t.bottom-t.top;return y!=e||v!=n?(b=!0,Y.d(!1)):(new Date).valueOf()>p?Y.d(!1):i.sleep(10)}).then(function(){b?u.b.info("Loaded font:",r):u.b.warn("Failed to load font:",r),o.body.removeChild(h),i.finish(c)}),i.result()},t.prototype.loadFont=function(t,e){var n=t.src,i=this.srcURLMap[n],o=this;return i?i.piggyback(function(i){var o=i;o.traitsEqual(t)?(e.registerFamily(t,o),u.b.warn("Found already-loaded font:",n)):u.b.warn("E_FONT_FACE_INCOMPATIBLE",t.src)}):(i=new Ue.a(function(){var i=Y.c("loadFont"),r=e.deobfuscator?e.deobfuscator(n):null;return r?W.c(n,W.b.BLOB).then(function(n){n.responseBlob?r(n.responseBlob).then(function(n){o.initFont(t,n,e).thenFinish(i)}):i.finish(null)}):o.initFont(t,null,e).thenFinish(i),i.result()},"loadFont "+n),this.srcURLMap[n]=i,i.start()),i},t.prototype.findOrLoadFonts=function(t,e){for(var n=[],i=0,o=t;i<o.length;i++){var r=o[i];r.src&&r.family?n.push(this.loadFont(r,e)):u.b.warn("E_FONT_FACE_INVALID")}return Ue.c(n)},t}(),Ye=n(30),qe=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),Ke=1,Qe=function(){function t(t,e,n,i,o){this.name=e,this.pseudoName=n,this.classes=i,this.parent=o,this.specified={},this.children=[],this.pageMaster=null,this.index=0,this._scope=t,this.key="p"+Ke++,o&&(this.index=o.children.length,o.children.push(this))}return Object.defineProperty(t.prototype,"scope",{get:function(){return this._scope},enumerable:!0,configurable:!0}),t.prototype.createInstance=function(t){throw new Error("E_UNEXPECTED_CALL")},t.prototype.clone=function(t){throw new Error("E_UNEXPECTED_CALL")},t.prototype.copySpecified=function(t){var e=this.specified,n=t.specified;for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(n[i]=e[i])},t.prototype.cloneChildren=function(t){for(var e=0;e<this.children.length;e++)this.children[e].clone({parent:t})},t}(),Ze=function(t){function e(e){var n=t.call(this,e,null,null,[],null)||this;return n.specified.width=new H.c(X.q,0),n.specified.height=new H.c(X.p,0),n}return qe(e,t),e}(Qe),$e=function(t){function e(e,n){var i=t.call(this,e,function(t,e){var n=t.match(/^([^.]+)\.([^.]+)$/);if(n){var i=o.pageMaster.keyMap[n[1]];if(i){var r=this.lookupInstance(i);if(r)return e?r.resolveFunc(n[2]):r.resolveName(n[2])}}return null})||this;i.pageMaster=n;var o=i;return i}return qe(e,t),e}(L.m),Je=function(t){function e(e,n,i,o,r,a,s){var l=t.call(this,e,n,i,o,r)||this;return l.condition=a,l.specificity=s,l.keyMap={},e instanceof $e||(l._scope=new $e(e,l)),l.pageMaster=l,l.specified.width=new H.c(X.q,0),l.specified.height=new H.c(X.p,0),l.specified["wrap-flow"]=new H.c(X.t.auto,0),l.specified.position=new H.c(X.t.relative,0),l.specified.overflow=new H.c(X.t.visible,0),l}return qe(e,t),e.prototype.createInstance=function(t){return new mn(t,this)},e.prototype.clone=function(t){var n=new e(this.scope,this.name,t.pseudoName||this.pseudoName,this.classes,this.parent,this.condition,this.specificity);return this.copySpecified(n),this.cloneChildren(n),n},e.prototype.resetScope=function(){this.scope.pageMaster=this},e}(Qe),tn=function(t){function e(e,n,i,o,r){var a=t.call(this,e,n,i,o,r)||this;return a.pageMaster=r.pageMaster,n&&(a.pageMaster.keyMap[n]=a.key),a.specified["wrap-flow"]=new H.c(X.t.auto,0),a}return qe(e,t),e.prototype.createInstance=function(t){return new yn(t,this)},e.prototype.clone=function(t){var n=new e(t.parent.scope,this.name,this.pseudoName,this.classes,t.parent);return this.copySpecified(n),this.cloneChildren(n),n},e}(Qe),en=function(t){function e(e,n,i,o,r){var a=t.call(this,e,n,i,o,r)||this;return a.pageMaster=r.pageMaster,n&&(a.pageMaster.keyMap[n]=a.key),a}return qe(e,t),e.prototype.createInstance=function(t){return new vn(t,this)},e.prototype.clone=function(t){var n=new e(t.parent.scope,this.name,this.pseudoName,this.classes,t.parent);return this.copySpecified(n),this.cloneChildren(n),n},e}(Qe);function nn(t,e,n){return e&&e!==X.t.auto?e.toExpr(t,n):null}function on(t,e,n){return e&&e!==X.t.auto?e.toExpr(t,n):t.zero}function rn(t,e,n){return e?e===X.t.auto?null:e.toExpr(t,n):t.zero}function an(t,e,n,i){return e&&n!==X.t.none?e.toExpr(t,i):t.zero}function sn(t,e,n){return e?e===X.t._true?t._true:e===X.t._false?t._false:e.toExpr(t,t.zero):n}var ln=function(){function t(t,e){this.parentInstance=t,this.pageBox=e,this.cascaded={},this.style={},this.autoWidth=null,this.autoHeight=null,this.children=[],this.isAutoWidth=!1,this.isAutoHeight=!1,this.isTopDependentOnAutoHeight=!1,this.isRightDependentOnAutoWidth=!1,this.calculatedWidth=0,this.calculatedHeight=0,this.pageMasterInstance=null,this.namedValues={},this.namedFuncs={},this.vertical=!1,this.rtl=!1,this.suppressEmptyBoxGeneration=!1,t&&t.children.push(this)}return t.prototype.reset=function(){this.calculatedWidth=0,this.calculatedHeight=0},t.prototype.addNamedValues=function(t,e){var n=this.resolveName(t),i=this.resolveName(e);if(!n||!i)throw new Error("E_INTERNAL");return L.C(this.pageBox.scope,n,i)},t.prototype.resolveName=function(t){var e=this.namedValues[t];if(e)return e;var n=this.style[t];switch(n&&(e=n.toExpr(this.pageBox.scope,this.pageBox.scope.zero)),t){case"margin-left-edge":e=this.resolveName("left");break;case"margin-top-edge":e=this.resolveName("top");break;case"margin-right-edge":e=this.addNamedValues("border-right-edge","margin-right");break;case"margin-bottom-edge":e=this.addNamedValues("border-bottom-edge","margin-bottom");break;case"border-left-edge":e=this.addNamedValues("margin-left-edge","margin-left");break;case"border-top-edge":e=this.addNamedValues("margin-top-edge","margin-top");break;case"border-right-edge":e=this.addNamedValues("padding-right-edge","border-right-width");break;case"border-bottom-edge":e=this.addNamedValues("padding-bottom-edge","border-bottom-width");break;case"padding-left-edge":e=this.addNamedValues("border-left-edge","border-left-width");break;case"padding-top-edge":e=this.addNamedValues("border-top-edge","border-top-width");break;case"padding-right-edge":e=this.addNamedValues("right-edge","padding-right");break;case"padding-bottom-edge":e=this.addNamedValues("bottom-edge","padding-bottom");break;case"left-edge":e=this.addNamedValues("padding-left-edge","padding-left");break;case"top-edge":e=this.addNamedValues("padding-top-edge","padding-top");break;case"right-edge":e=this.addNamedValues("left-edge","width");break;case"bottom-edge":e=this.addNamedValues("top-edge","height")}if(!e){var i=void 0;if("extent"==t)i=this.vertical?"width":"height";else if("measure"==t)i=this.vertical?"height":"width";else{var o=this.vertical?H.m:H.l;for(var r in i=t,o)i=i.replace(r,o[r])}i!=t&&(e=this.resolveName(i))}return e&&(this.namedValues[t]=e),e},t.prototype.resolveFunc=function(t){var e=this.namedFuncs[t];if(e)return e;switch(t){case"columns":var n=this.pageBox.scope,i=new L.A(n,0),o=this.resolveName("column-count"),r=this.resolveName("column-width"),a=this.resolveName("column-gap");e=L.P(n,L.N(n,new L.d(n,"min",[i,o]),L.C(n,r,a)),a)}return e&&(this.namedFuncs[t]=e),e},t.prototype.initEnabled=function(){var t=this.pageBox.scope,e=this.style,n=sn(t,e.enabled,t._true),i=nn(t,e.page,t.zero);if(i){var o=new L.s(t,"page-number");n=L.D(t,n,new L.i(t,i,o))}var r=nn(t,e["min-page-width"],t.zero);r&&(n=L.D(t,n,new L.j(t,new L.s(t,"page-width"),r)));var a=nn(t,e["min-page-height"],t.zero);a&&(n=L.D(t,n,new L.j(t,new L.s(t,"page-height"),a))),n=this.boxSpecificEnabled(n),e.enabled=new X.c(n)},t.prototype.boxSpecificEnabled=function(t){return t},t.prototype.initHorizontal=function(){var t=this.pageBox.scope,e=this.style,n=this.parentInstance?this.parentInstance.style.width.toExpr(t,null):null,i=nn(t,e.left,n),o=nn(t,e["margin-left"],n),r=an(t,e["border-left-width"],e["border-left-style"],n),a=on(t,e["padding-left"],n),s=nn(t,e.width,n),l=nn(t,e["max-width"],n),u=on(t,e["padding-right"],n),c=an(t,e["border-right-width"],e["border-right-style"],n),h=nn(t,e["margin-right"],n),p=nn(t,e.right,n),f=L.C(t,r,a),d=L.C(t,r,u);if(i&&p&&s){var g=L.P(t,n,L.C(t,s,L.C(t,L.C(t,i,f),d)));o?h?p=L.P(t,g,h):h=L.P(t,g,L.C(t,p,o)):(g=L.P(t,g,p),h?o=L.P(t,g,h):h=o=L.N(t,g,new L.f(t,.5)))}else{o||(o=t.zero),h||(h=t.zero),i||p||s||(i=t.zero),i||s?i||p?s||p||(s=this.autoWidth,this.isAutoWidth=!0):i=t.zero:(s=this.autoWidth,this.isAutoWidth=!0);var m=L.P(t,n,L.C(t,L.C(t,o,f),L.C(t,h,d)));this.isAutoWidth&&(l||(l=L.P(t,m,i||p)),this.vertical||!nn(t,e["column-width"],null)&&!nn(t,e["column-count"],null)||(s=l,this.isAutoWidth=!1)),i?s?p||(p=L.P(t,m,L.C(t,i,s))):s=L.P(t,m,L.C(t,i,p)):i=L.P(t,m,L.C(t,p,s))}var y=on(t,e["snap-width"]||(this.parentInstance?this.parentInstance.style["snap-width"]:null),n);e.left=new X.c(i),e["margin-left"]=new X.c(o),e["border-left-width"]=new X.c(r),e["padding-left"]=new X.c(a),e.width=new X.c(s),e["max-width"]=new X.c(l||s),e["padding-right"]=new X.c(u),e["border-right-width"]=new X.c(c),e["margin-right"]=new X.c(h),e.right=new X.c(p),e["snap-width"]=new X.c(y)},t.prototype.initVertical=function(){var t=this.pageBox.scope,e=this.style,n=this.parentInstance?this.parentInstance.style.width.toExpr(t,null):null,i=this.parentInstance?this.parentInstance.style.height.toExpr(t,null):null,o=nn(t,e.top,i),r=nn(t,e["margin-top"],n),a=an(t,e["border-top-width"],e["border-top-style"],n),s=on(t,e["padding-top"],n),l=nn(t,e.height,i),u=nn(t,e["max-height"],i),c=on(t,e["padding-bottom"],n),h=an(t,e["border-bottom-width"],e["border-bottom-style"],n),p=nn(t,e["margin-bottom"],n),f=nn(t,e.bottom,i),d=L.C(t,a,s),g=L.C(t,h,c);if(o&&f&&l){var m=L.P(t,i,L.C(t,l,L.C(t,L.C(t,o,d),g)));r?p?f=L.P(t,m,r):p=L.P(t,m,L.C(t,f,r)):(m=L.P(t,m,f),p?r=L.P(t,m,p):p=r=L.N(t,m,new L.f(t,.5)))}else{r||(r=t.zero),p||(p=t.zero),o||f||l||(o=t.zero),o||l?o||f?l||f||(l=this.autoHeight,this.isAutoHeight=!0):o=t.zero:(l=this.autoHeight,this.isAutoHeight=!0);var y=L.P(t,i,L.C(t,L.C(t,r,d),L.C(t,p,g)));this.isAutoHeight&&(u||(u=L.P(t,y,o||f)),this.vertical&&(nn(t,e["column-width"],null)||nn(t,e["column-count"],null))&&(l=u,this.isAutoHeight=!1)),o?l?f||(f=L.P(t,y,L.C(t,o,l))):l=L.P(t,y,L.C(t,f,o)):o=L.P(t,y,L.C(t,f,l))}var v=on(t,e["snap-height"]||(this.parentInstance?this.parentInstance.style["snap-height"]:null),n);e.top=new X.c(o),e["margin-top"]=new X.c(r),e["border-top-width"]=new X.c(a),e["padding-top"]=new X.c(s),e.height=new X.c(l),e["max-height"]=new X.c(u||l),e["padding-bottom"]=new X.c(c),e["border-bottom-width"]=new X.c(h),e["margin-bottom"]=new X.c(p),e.bottom=new X.c(f),e["snap-height"]=new X.c(v)},t.prototype.initColumns=function(){var t=this.pageBox.scope,e=this.style,n=nn(t,e[this.vertical?"height":"width"],null),i=nn(t,e["column-width"],n),o=nn(t,e["column-count"],null),r=function(t,e,n){return e&&e!==X.t.normal?e.toExpr(t,null):null}(t,e["column-gap"]);r||(r=new L.x(t,1,"em")),i&&!o&&(o=new L.d(t,"floor",[L.H(t,L.C(t,n,r),L.C(t,i,r))]),o=new L.d(t,"max",[t.one,o])),o||(o=t.one),i=L.P(t,L.H(t,L.C(t,n,r),o),r),e["column-width"]=new X.c(i),e["column-count"]=new X.c(o),e["column-gap"]=new X.c(r)},t.prototype.depends=function(t,e,n){return this.style[t].toExpr(this.pageBox.scope,null).depend(e,n)},t.prototype.init=function(t){t.registerInstance(this.pageBox.key,this);var e=this.pageBox.scope,n=this.style,i=this,o=this.parentInstance?this.parentInstance.getActiveRegions(t):null,r=H.n(this.cascaded,t,o,!1,null);this.vertical=H.z(r,t,!!this.parentInstance&&this.parentInstance.vertical),this.rtl=H.y(r,t,!!this.parentInstance&&this.parentInstance.rtl),H.k(r,n,this.vertical,this.rtl,function(t,e){return e.value}),this.autoWidth=new L.t(e,function(){return i.calculatedWidth},"autoWidth"),this.autoHeight=new L.t(e,function(){return i.calculatedHeight},"autoHeight"),this.initHorizontal(),this.initVertical(),this.initColumns(),this.initEnabled()},t.prototype.getProp=function(t,e){var n=this.style[e];return n&&(n=z.i(t,n,e)),n},t.prototype.getPropAsNumber=function(t,e){var n=this.style[e];return n&&(n=z.i(t,n,e)),X.x(n,t)},t.prototype.getSpecial=function(t,e){var n=H.t(this.cascaded,e);if(n){for(var i=[],o=0;o<n.length;o++){var r=n[o].evaluate(t,"");r&&r!==X.o&&i.push(r)}if(i.length)return i}return null},t.prototype.getActiveRegions=function(t){var e=this.getSpecial(t,"region-id");if(e){for(var n=[],i=0;i<e.length;i++)n[i]=e[i].toString();return n}return null},t.prototype.propagateProperty=function(t,e,n,i){this.propagatePropertyToElement(t,e.element,n,i)},t.prototype.propagatePropertyToElement=function(t,e,n,i){var o=this.getProp(t,n);o&&(o.isNumeric()&&L.O(o.unit)&&(o=X.n(o,t)),"font-family"===n&&(o=i.filterFontFamily(o)),E.F(e,n,o.toString()))},t.prototype.propagateDelayedProperty=function(t,e,n,i){var o=this.getProp(t,n);o&&i.push(new q.d(e.element,n,o))},t.prototype.assignLeftPosition=function(t,e){var n=this.getPropAsNumber(t,"left"),i=this.getPropAsNumber(t,"margin-left"),o=this.getPropAsNumber(t,"padding-left"),r=this.getPropAsNumber(t,"border-left-width"),a=this.getPropAsNumber(t,"width");e.setHorizontalPosition(n,a),E.F(e.element,"margin-left",i+"px"),E.F(e.element,"padding-left",o+"px"),E.F(e.element,"border-left-width",r+"px"),e.marginLeft=i,e.borderLeft=r,e.paddingLeft=o},t.prototype.assignRightPosition=function(t,e){var n=this.getPropAsNumber(t,"right"),i=this.getPropAsNumber(t,"snap-height"),o=this.getPropAsNumber(t,"margin-right"),r=this.getPropAsNumber(t,"padding-right"),a=this.getPropAsNumber(t,"border-right-width");if(E.F(e.element,"margin-right",o+"px"),E.F(e.element,"padding-right",r+"px"),E.F(e.element,"border-right-width",a+"px"),e.marginRight=o,e.borderRight=a,this.vertical&&i>0){var s=n+e.getInsetRight(),l=s-Math.floor(s/i)*i;l>0&&(e.snapOffsetX=i-l,r+=e.snapOffsetX)}e.paddingRight=r,e.snapWidth=i},t.prototype.assignTopPosition=function(t,e){var n=this.getPropAsNumber(t,"snap-height"),i=this.getPropAsNumber(t,"top"),o=this.getPropAsNumber(t,"margin-top"),r=this.getPropAsNumber(t,"padding-top"),a=this.getPropAsNumber(t,"border-top-width");if(e.top=i,e.marginTop=o,e.borderTop=a,e.snapHeight=n,!this.vertical&&n>0){var s=i+e.getInsetTop(),l=s-Math.floor(s/n)*n;l>0&&(e.snapOffsetY=n-l,r+=e.snapOffsetY)}e.paddingTop=r,E.F(e.element,"top",i+"px"),E.F(e.element,"margin-top",o+"px"),E.F(e.element,"padding-top",r+"px"),E.F(e.element,"border-top-width",a+"px")},t.prototype.assignBottomPosition=function(t,e){var n=this.getPropAsNumber(t,"margin-bottom"),i=this.getPropAsNumber(t,"padding-bottom"),o=this.getPropAsNumber(t,"border-bottom-width"),r=this.getPropAsNumber(t,"height")-e.snapOffsetY;E.F(e.element,"height",r+"px"),E.F(e.element,"margin-bottom",n+"px"),E.F(e.element,"padding-bottom",i+"px"),E.F(e.element,"border-bottom-width",o+"px"),e.height=r-e.snapOffsetY,e.marginBottom=n,e.borderBottom=o,e.paddingBottom=i},t.prototype.assignBeforePosition=function(t,e){this.vertical?this.assignRightPosition(t,e):this.assignTopPosition(t,e)},t.prototype.assignAfterPosition=function(t,e){this.vertical?this.assignLeftPosition(t,e):this.assignBottomPosition(t,e)},t.prototype.assignStartEndPosition=function(t,e){this.vertical?(this.assignTopPosition(t,e),this.assignBottomPosition(t,e)):(this.assignRightPosition(t,e),this.assignLeftPosition(t,e))},t.prototype.sizeWithMaxHeight=function(t,e){E.F(e.element,"border-top-width","0px");var n=this.getPropAsNumber(t,"max-height");this.isTopDependentOnAutoHeight?e.setVerticalPosition(0,n):(this.assignTopPosition(t,e),n-=e.snapOffsetY,e.height=n,E.F(e.element,"height",n+"px"))},t.prototype.sizeWithMaxWidth=function(t,e){E.F(e.element,"border-left-width","0px");var n=this.getPropAsNumber(t,"max-width");if(this.isRightDependentOnAutoWidth)e.setHorizontalPosition(0,n);else{this.assignRightPosition(t,e),n-=e.snapOffsetX,e.width=n;var i=this.getPropAsNumber(t,"right");E.F(e.element,"right",i+"px"),E.F(e.element,"width",n+"px")}},t.prototype.prepareContainer=function(t,e,n,i,o){this.parentInstance&&this.vertical==this.parentInstance.vertical||E.F(e.element,"writing-mode",this.vertical?"vertical-rl":"horizontal-tb"),(this.vertical?this.isAutoWidth:this.isAutoHeight)?this.vertical?this.sizeWithMaxWidth(t,e):this.sizeWithMaxHeight(t,e):(this.assignBeforePosition(t,e),this.assignAfterPosition(t,e)),(this.vertical?this.isAutoHeight:this.isAutoWidth)?this.vertical?this.sizeWithMaxHeight(t,e):this.sizeWithMaxWidth(t,e):this.assignStartEndPosition(t,e);for(var r=0;r<un.length;r++)this.propagateProperty(t,e,un[r],i)},t.prototype.transferContentProps=function(t,e,n,i){for(var o=0;o<hn.length;o++)this.propagateProperty(t,e,hn[o],i)},t.prototype.transferSinglUriContentProps=function(t,e,n){for(var i=0;i<pn.length;i++)this.propagatePropertyToElement(t,e,pn[i],n)},t.prototype.finishContainer=function(t,e,n,i,o,r,a){this.vertical?this.calculatedWidth=e.computedBlockSize+e.snapOffsetX:this.calculatedHeight=e.computedBlockSize+e.snapOffsetY;var s=(this.vertical||!i)&&this.isAutoHeight,l=(!this.vertical||!i)&&this.isAutoWidth,u=null;if((l||s)&&(l&&E.F(e.element,"width","auto"),s&&E.F(e.element,"height","auto"),u=r.getElementClientRect(i?i.element:e.element),l&&(this.calculatedWidth=Math.ceil(u.right-u.left-e.paddingLeft-e.borderLeft-e.paddingRight-e.borderRight),this.vertical&&(this.calculatedWidth+=e.snapOffsetX)),s&&(this.calculatedHeight=u.bottom-u.top-e.paddingTop-e.borderTop-e.paddingBottom-e.borderBottom,this.vertical||(this.calculatedHeight+=e.snapOffsetY))),(this.vertical?this.isAutoHeight:this.isAutoWidth)&&this.assignStartEndPosition(t,e),(this.vertical?this.isAutoWidth:this.isAutoHeight)&&((this.vertical?this.isRightDependentOnAutoWidth:this.isTopDependentOnAutoHeight)&&this.assignBeforePosition(t,e),this.assignAfterPosition(t,e)),o>1){var c=this.getPropAsNumber(t,"column-rule-width"),h=this.getProp(t,"column-rule-style"),p=this.getProp(t,"column-rule-color");if(c>0&&h&&h!=X.t.none&&p!=X.t.transparent)for(var f=this.getPropAsNumber(t,"column-gap"),d=this.vertical?e.height:e.width,g=this.vertical?"border-top":"border-left",m=1;m<o;m++){var y=(d+f)*m/o-f/2+e.paddingLeft-c/2,v=e.height+e.paddingTop+e.paddingBottom,b=e.element.ownerDocument.createElement("div");E.F(b,"position","absolute"),E.F(b,this.vertical?"left":"top","0px"),E.F(b,this.vertical?"top":"left",y+"px"),E.F(b,this.vertical?"height":"width","0px"),E.F(b,this.vertical?"width":"height",v+"px"),E.F(b,g,c+"px "+h.toString()+(p?" "+p.toString():"")),e.element.insertBefore(b,e.element.firstChild)}}for(m=0;m<cn.length;m++)this.propagateProperty(t,e,cn[m],a);for(m=0;m<fn.length;m++)this.propagateDelayedProperty(t,e,fn[m],n.delayedItems)},t.prototype.applyCascadeAndInit=function(t,e){var n=this.cascaded,i=this.pageBox.specified;for(var o in i)H.x(o)&&H.F(n,o,H.s(i,o));if(this.pageBox.pseudoName==dn)for(var r in e)(r.match(/^background-/)||"writing-mode"==r)&&(n[r]=e[r]);if("layout-host"==this.pageBox.pseudoName)for(var a in e)a.match(/^background-/)||"writing-mode"==a||(n[a]=e[a]);t.pushRule(this.pageBox.classes,null,n),n.content&&(n.content=n.content.filterValue(new H.e(t,null,t.counterResolver))),this.init(t.context);for(var s=0,l=this.pageBox.children;s<l.length;s++)l[s].createInstance(this).applyCascadeAndInit(t,e);t.popRule()},t.prototype.resolveAutoSizing=function(t){this.isAutoWidth&&(this.isRightDependentOnAutoWidth=this.depends("right",this.autoWidth,t)||this.depends("margin-right",this.autoWidth,t)||this.depends("border-right-width",this.autoWidth,t)||this.depends("padding-right",this.autoWidth,t)),this.isAutoHeight&&(this.isTopDependentOnAutoHeight=this.depends("top",this.autoHeight,t)||this.depends("margin-top",this.autoHeight,t)||this.depends("border-top-width",this.autoHeight,t)||this.depends("padding-top",this.autoHeight,t));for(var e=0,n=this.children;e<n.length;e++)n[e].resolveAutoSizing(t)},t}(),un=["border-left-style","border-right-style","border-top-style","border-bottom-style","border-left-color","border-right-color","border-top-color","border-bottom-color","outline-style","outline-color","outline-width","overflow","visibility"],cn=["border-top-left-radius","border-top-right-radius","border-bottom-right-radius","border-bottom-left-radius","border-image-source","border-image-slice","border-image-width","border-image-outset","border-image-repeat","background-attachment","background-color","background-image","background-repeat","background-position","background-clip","background-origin","background-size","opacity","z-index","background-blend-mode","isolation","mix-blend-mode","filter"],hn=["color","font-family","font-size","font-style","font-weight","font-variant","line-height","letter-spacing","text-align","text-decoration","text-indent","text-transform","white-space","word-spacing","font-feature-settings","font-kerning","font-size-adjust","font-variant-east-asian","font-stretch","text-decoration-color","text-decoration-line","text-decoration-skip","text-decoration-style","text-emphasis","text-emphasis-color","text-emphasis-position","text-emphasis-style","text-shadow","text-underline-position"],pn=["width","height","image-resolution","object-fit","object-position"],fn=["transform","transform-origin"],dn="background-host",gn=function(t){function e(e){return t.call(this,null,e)||this}return qe(e,t),e.prototype.applyCascadeAndInit=function(e,n){t.prototype.applyCascadeAndInit.call(this,e,n),this.children.sort(function(t,e){return e.pageBox.specificity-t.pageBox.specificity||t.pageBox.index-e.pageBox.index})},e}(ln),mn=function(t){function e(e,n){var i=t.call(this,e,n)||this;return i.pageMasterInstance=i,i}return qe(e,t),e.prototype.boxSpecificEnabled=function(t){var e=this.pageBox.pageMaster;return e.condition&&(t=L.D(e.scope,t,e.condition)),t},e.prototype.adjustPageLayout=function(t,e,n){},e}(ln),yn=function(t){function e(e,n){var i=t.call(this,e,n)||this;return i.pageMasterInstance=e.pageMasterInstance,i}return qe(e,t),e}(ln),vn=function(t){function e(e,n){var i=t.call(this,e,n)||this;return i.pageMasterInstance=e.pageMasterInstance,i}return qe(e,t),e.prototype.processPartitionList=function(t,e,n){var i=null;if(e instanceof X.f&&(i=[e]),e instanceof X.b&&(i=e.values),i)for(var o=this.pageBox.scope,r=0;r<i.length;r++)if(i[r]instanceof X.f){var a=L.M(i[r].name,"enabled"),s=new L.s(o,a);n&&(s=new L.w(o,s)),t=L.D(o,t,s)}return t},e.prototype.boxSpecificEnabled=function(t){var e=this.pageBox.scope,n=this.style,i=sn(e,n.required,e._false)!==e._false;if(i||this.isAutoHeight){var o=function(t,e,n){return e?e.toExpr(t,t.zero):new L.f(t,"body")}(e,n["flow-from"]),r=new L.d(e,"has-content",[o]);t=L.D(e,t,r)}if(t=this.processPartitionList(t,n["required-partitions"],!1),t=this.processPartitionList(t,n["conflicting-partitions"],!0),i){var a=this.pageMasterInstance.style.enabled,s=a?a.toExpr(e,null):e._true;s=L.D(e,s,t),this.pageMasterInstance.style.enabled=new X.c(s)}return t},e.prototype.prepareContainer=function(e,n,i,o,r){E.F(n.element,"overflow","hidden"),t.prototype.prepareContainer.call(this,e,n,i,o,r)},e}(ln),En=function(t){function e(e,n,i,o){var r=t.call(this,e,n,!1)||this;return r.target=i,r.validatorSet=o,r}return qe(e,t),e.prototype.property=function(t,e,n){this.validatorSet.validatePropertyAndHandleShorthand(t,e,n,this)},e.prototype.unknownProperty=function(t,e){this.report("E_INVALID_PROPERTY "+t+": "+e.toString())},e.prototype.invalidPropertyValue=function(t,e){this.report("E_INVALID_PROPERTY_VALUE "+t+": "+e.toString())},e.prototype.simpleProperty=function(t,e,n){this.target.specified[t]=new H.c(e,n?z.d:z.e)},e}(z.f),bn=function(t){function e(e,n,i,o){return t.call(this,e,n,i,o)||this}return qe(e,t),e}(En),wn=function(t){function e(e,n,i,o){var r=t.call(this,e,n,i,o)||this;return i.specified.width=new H.c(X.s,0),i.specified.height=new H.c(X.s,0),r}return qe(e,t),e.prototype.startPartitionRule=function(t,e,n){var i=new en(this.scope,t,e,n,this.target),o=new bn(this.scope,this.owner,i,this.validatorSet);this.owner.pushHandler(o)},e.prototype.startPartitionGroupRule=function(t,n,i){var o=new tn(this.scope,t,n,i,this.target),r=new e(this.scope,this.owner,o,this.validatorSet);this.owner.pushHandler(r)},e}(En),Nn=function(t){function e(e,n,i,o){return t.call(this,e,n,i,o)||this}return qe(e,t),e.prototype.startPartitionRule=function(t,e,n){var i=new en(this.scope,t,e,n,this.target),o=new bn(this.scope,this.owner,i,this.validatorSet);this.owner.pushHandler(o)},e.prototype.startPartitionGroupRule=function(t,e,n){var i=new tn(this.scope,t,e,n,this.target),o=new wn(this.scope,this.owner,i,this.validatorSet);this.owner.pushHandler(o)},e}(En),Cn=n(19),Sn=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();function Tn(t){var e=t["writing-mode"];e=e&&e.value;var n=t.direction;return n=n&&n.value,e===X.t.vertical_lr||e!==X.t.vertical_rl&&n!==X.t.rtl?i.LTR:i.RTL}var xn,In,Pn={a5:{width:new X.i(148,"mm"),height:new X.i(210,"mm")},a4:{width:new X.i(210,"mm"),height:new X.i(297,"mm")},a3:{width:new X.i(297,"mm"),height:new X.i(420,"mm")},b5:{width:new X.i(176,"mm"),height:new X.i(250,"mm")},b4:{width:new X.i(250,"mm"),height:new X.i(353,"mm")},"jis-b5":{width:new X.i(182,"mm"),height:new X.i(257,"mm")},"jis-b4":{width:new X.i(257,"mm"),height:new X.i(364,"mm")},letter:{width:new X.i(8.5,"in"),height:new X.i(11,"in")},legal:{width:new X.i(8.5,"in"),height:new X.i(14,"in")},ledger:{width:new X.i(11,"in"),height:new X.i(17,"in")}},An=new X.i(.24,"pt"),Rn=new X.i(3,"mm"),On=new X.i(10,"mm"),Ln=new X.i(13,"mm");function kn(t){var e={width:X.q,height:X.p,bleed:X.u,bleedOffset:X.u},n=t.size;if(n&&n.value!==X.t.auto){var i=n.value,o=void 0,r=void 0;if(i.isSpaceList()?(o=i.values[0],r=i.values[1]):(o=i,r=null),o.isNumeric())e.width=o,e.height=r||o;else{var a=o.name&&Pn[o.name.toLowerCase()];a&&(r&&r===X.t.landscape?(e.width=a.height,e.height=a.width):(e.width=a.width,e.height=a.height))}}var s=t.marks;s&&s.value!==X.t.none&&(e.bleedOffset=Ln);var l=t.bleed;return l&&l.value!==X.t.auto?l.value&&l.value.isNumeric()&&(e.bleed=l.value):s&&(s.value.isSpaceList()?s.value.values.some(function(t){return t===X.t.crop}):s.value===X.t.crop)&&(e.bleed=new X.i(6,"pt")),e}function Fn(t,e){var n={},i=t.bleed.num*e.queryUnitSize(t.bleed.unit,!1),o=t.bleedOffset.num*e.queryUnitSize(t.bleedOffset.unit,!1),r=i+o,a=t.width;a===X.q?e.pref.defaultPaperSize?n.pageWidth=e.pref.defaultPaperSize.width*e.queryUnitSize("px",!1):n.pageWidth=(e.pref.spreadView?Math.floor(e.viewportWidth/2)-e.pref.pageBorder:e.viewportWidth)-2*r:n.pageWidth=a.num*e.queryUnitSize(a.unit,!1);var s=t.height;return s===X.p?e.pref.defaultPaperSize?n.pageHeight=e.pref.defaultPaperSize.height*e.queryUnitSize("px",!1):n.pageHeight=e.viewportHeight-2*r:n.pageHeight=s.num*e.queryUnitSize(s.unit,!1),n.bleed=i,n.bleedOffset=o,n.cropOffset=r,n}function _n(t,e,n){var i=t.createElementNS(E.a.SVG,"svg");return i.setAttribute("width",e),i.setAttribute("height",n),i.style.position="absolute",i}function Dn(t,e,n){n=n||"polyline";var i=t.createElementNS(E.a.SVG,n);return i.setAttribute("stroke","black"),i.setAttribute("stroke-width",e),i.setAttribute("fill","none"),i}!function(t){t.TOP_LEFT="top left",t.TOP_RIGHT="top right",t.BOTTOM_LEFT="bottom left",t.BOTTOM_RIGHT="bottom right"}(xn||(xn={})),function(t){t.TOP="top",t.BOTTOM="bottom",t.LEFT="left",t.RIGHT="right"}(In||(In={}));var Bn,Mn,Un=(Bn={width:!0,height:!0,"block-size":!0,"inline-size":!0,margin:!0,padding:!0,border:!0,outline:!0,"outline-width":!0,"outline-style":!0,"outline-color":!0},["left","right","top","bottom","before","after","start","end","block-start","block-end","inline-start","inline-end"].forEach(function(t){Bn["margin-"+t]=!0,Bn["padding-"+t]=!0,Bn["border-"+t+"-width"]=!0,Bn["border-"+t+"-style"]=!0,Bn["border-"+t+"-color"]=!0}),Bn);!function(t){t.START="start",t.CENTER="center",t.END="end"}(Mn||(Mn={}));var Vn,Hn,zn={"top-left-corner":{order:1,isInTopRow:!0,isInBottomRow:!1,isInLeftColumn:!0,isInRightColumn:!0,positionAlongVariableDimension:null},"top-left":{order:2,isInTopRow:!0,isInBottomRow:!1,isInLeftColumn:!1,isInRightColumn:!1,positionAlongVariableDimension:Mn.START},"top-center":{order:3,isInTopRow:!0,isInBottomRow:!1,isInLeftColumn:!1,isInRightColumn:!1,positionAlongVariableDimension:Mn.CENTER},"top-right":{order:4,isInTopRow:!0,isInBottomRow:!1,isInLeftColumn:!1,isInRightColumn:!1,positionAlongVariableDimension:Mn.END},"top-right-corner":{order:5,isInTopRow:!0,isInBottomRow:!1,isInLeftColumn:!1,isInRightColumn:!0,positionAlongVariableDimension:null},"right-top":{order:6,isInTopRow:!1,isInBottomRow:!1,isInLeftColumn:!1,isInRightColumn:!0,positionAlongVariableDimension:Mn.START},"right-middle":{order:7,isInTopRow:!1,isInBottomRow:!1,isInLeftColumn:!1,isInRightColumn:!0,positionAlongVariableDimension:Mn.CENTER},"right-bottom":{order:8,isInTopRow:!1,isInBottomRow:!1,isInLeftColumn:!1,isInRightColumn:!0,positionAlongVariableDimension:Mn.END},"bottom-right-corner":{order:9,isInTopRow:!1,isInBottomRow:!0,isInLeftColumn:!1,isInRightColumn:!0,positionAlongVariableDimension:null},"bottom-right":{order:10,isInTopRow:!1,isInBottomRow:!0,isInLeftColumn:!1,isInRightColumn:!1,positionAlongVariableDimension:Mn.END},"bottom-center":{order:11,isInTopRow:!1,isInBottomRow:!0,isInLeftColumn:!1,isInRightColumn:!1,positionAlongVariableDimension:Mn.CENTER},"bottom-left":{order:12,isInTopRow:!1,isInBottomRow:!0,isInLeftColumn:!1,isInRightColumn:!1,positionAlongVariableDimension:Mn.START},"bottom-left-corner":{order:13,isInTopRow:!1,isInBottomRow:!0,isInLeftColumn:!0,isInRightColumn:!1,positionAlongVariableDimension:null},"left-bottom":{order:14,isInTopRow:!1,isInBottomRow:!1,isInLeftColumn:!0,isInRightColumn:!1,positionAlongVariableDimension:Mn.END},"left-middle":{order:15,isInTopRow:!1,isInBottomRow:!1,isInLeftColumn:!0,isInRightColumn:!1,positionAlongVariableDimension:Mn.CENTER},"left-top":{order:16,isInTopRow:!1,isInBottomRow:!1,isInLeftColumn:!0,isInRightColumn:!1,positionAlongVariableDimension:Mn.START}},Gn=(Vn=zn,Object.keys(Vn).sort(function(t,e){return Vn[t].order-Vn[e].order})),Wn="vivliostyle-page-rule-master",Xn="_marginBoxes",jn=function(t){function e(e,n,i){var o=t.call(this,e,null,Wn,[],n,null,0)||this;o.pageMarginBoxes={};var r=kn(i),a=new Yn(o.scope,o,i,r);return o.bodyPartitionKey=a.key,o.createPageMarginBoxes(i),o.applySpecified(i,r),o}return Sn(e,t),e.prototype.createPageMarginBoxes=function(t){var e=t[Xn];if(e){var n=this;Gn.forEach(function(i){e[i]&&(n.pageMarginBoxes[i]=new qn(n.scope,n,i,t))})}},e.prototype.applySpecified=function(t,e){for(var n in this.specified.position=new H.c(X.t.relative,0),this.specified.width=new H.c(e.width,0),this.specified.height=new H.c(e.height,0),t)Un[n]||"background-clip"===n||(this.specified[n]=t[n])},e.prototype.createInstance=function(t){return new Kn(t,this)},e}(Je),Yn=function(t){function e(e,n,i,o){var r=t.call(this,e,null,null,[],n)||this;return r.pageSize=o,r.specified["z-index"]=new H.c(new X.g(0),0),r.applySpecified(i),r}return Sn(e,t),e.prototype.applySpecified=function(t){for(var e in this.specified["flow-from"]=new H.c(X.r("body"),0),this.specified.position=new H.c(X.t.absolute,0),this.specified.overflow=new H.c(X.t.visible,0),Un)Un.hasOwnProperty(e)&&(this.specified[e]=t[e])},e.prototype.createInstance=function(t){return new Jn(t,this)},e}(en),qn=function(t){function e(e,n,i,o){var r=t.call(this,e,null,null,[],n)||this;return r.marginBoxName=i,r.applySpecified(o),r}return Sn(e,t),e.prototype.applySpecified=function(t){var e=t[Xn][this.marginBoxName];for(var n in t){var i=t[n],o=e[n];(H.v[n]||o&&o.value===X.t.inherit)&&(this.specified[n]=i)}for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(i=e[n])&&i.value!==X.t.inherit&&(this.specified[n]=i)},e.prototype.createInstance=function(t){return new ti(t,this)},e}(en),Kn=function(t){function e(e,n){var i=t.call(this,e,n)||this;return i.pageAreaDimension=null,i.pageMarginBoxInstances={},i}return Sn(e,t),e.prototype.applyCascadeAndInit=function(e,n){var i=this.cascaded;for(var o in n)if(Object.prototype.hasOwnProperty.call(n,o))switch(o){case"writing-mode":case"direction":i[o]=n[o]}t.prototype.applyCascadeAndInit.call(this,e,n)},e.prototype.initHorizontal=function(){var t=this.style;t.left=X.u,t["margin-left"]=X.u,t["border-left-width"]=X.u,t["padding-left"]=X.u,t["padding-right"]=X.u,t["border-right-width"]=X.u,t["margin-right"]=X.u,t.right=X.u},e.prototype.initVertical=function(){var t=this.style;t.top=X.u,t["margin-top"]=X.u,t["border-top-width"]=X.u,t["padding-top"]=X.u,t["padding-bottom"]=X.u,t["border-bottom-width"]=X.u,t["margin-bottom"]=X.u,t.bottom=X.u},e.prototype.setPageAreaDimension=function(t){this.pageAreaDimension=t;var e=this.style;e.width=new X.c(t.borderBoxWidth),e.height=new X.c(t.borderBoxHeight),e["padding-left"]=new X.c(t.marginLeft),e["padding-right"]=new X.c(t.marginRight),e["padding-top"]=new X.c(t.marginTop),e["padding-bottom"]=new X.c(t.marginBottom)},e.prototype.adjustPageLayout=function(t,e,n){var i=e.marginBoxes,o={start:this.pageAreaDimension.marginLeft,end:this.pageAreaDimension.marginRight,extent:this.pageAreaDimension.borderBoxWidth},r={start:this.pageAreaDimension.marginTop,end:this.pageAreaDimension.marginBottom,extent:this.pageAreaDimension.borderBoxHeight};this.sizeMarginBoxesAlongVariableDimension(i.top,!0,o,t,n),this.sizeMarginBoxesAlongVariableDimension(i.bottom,!0,o,t,n),this.sizeMarginBoxesAlongVariableDimension(i.left,!1,r,t,n),this.sizeMarginBoxesAlongVariableDimension(i.right,!1,r,t,n)},e.prototype.sizeMarginBoxesAlongVariableDimension=function(t,e,n,i,o){var r=Mn.START,a=Mn.CENTER,s=Mn.END,l=this.pageBox.scope,u={},c={},h={};for(var p in t){var f=zn[p];if(f){var d=t[p],g=this.pageMarginBoxInstances[p],m=new Qn(d,g.style,e,l,o);u[f.positionAlongVariableDimension]=d,c[f.positionAlongVariableDimension]=g,h[f.positionAlongVariableDimension]=m}}var y={start:n.start.evaluate(i),end:n.end.evaluate(i),extent:n.extent.evaluate(i)},v=this.getSizesOfMarginBoxesAlongVariableDimension(h,y.extent),E=!1,b={};Object.keys(u).forEach(function(t){var r=t,a=nn(l,c[r].style[e?"max-width":"max-height"],n.extent);if(a){var s=a.evaluate(i);if(v[r]>s){var p=h[r]=new $n(u[r],c[r].style,e,l,o,s);b[r]=p.getOuterSize(),E=!0}}}),E&&(v=this.getSizesOfMarginBoxesAlongVariableDimension(h,y.extent),E=!1,[r,a,s].forEach(function(t){v[t]=b[t]||v[t]}));var w={};Object.keys(u).forEach(function(t){var r=t,a=nn(l,c[r].style[e?"min-width":"min-height"],n.extent);if(a){var s=a.evaluate(i);if(v[r]<s){var p=h[r]=new $n(u[r],c[r].style,e,l,o,s);w[r]=p.getOuterSize(),E=!0}}}),E&&(v=this.getSizesOfMarginBoxesAlongVariableDimension(h,y.extent),[r,a,s].forEach(function(t){v[t]=w[t]||v[t]}));var N=y.start+y.extent,C=y.start+(y.start+y.extent);[r,a,s].forEach(function(t){var n=v[t];if(n){var i=u[t],o=0;switch(t){case r:o=e?i.left:i.top;break;case a:o=(C-n)/2;break;case s:o=N-n}e?i.setHorizontalPosition(o,n-i.getInsetLeft()-i.getInsetRight()):i.setVerticalPosition(o,n-i.getInsetTop()-i.getInsetBottom())}})},e.prototype.getSizesOfMarginBoxesAlongVariableDimension=function(t,e){var n=t[Mn.START],i=t[Mn.CENTER],o=t[Mn.END],r={};if(i){var a=[n,o].filter(function(t){return t}),s=a.length?new Zn(a):null,l=this.distributeAutoMarginBoxSizes(i,s,e);l.xSize&&(r[Mn.CENTER]=l.xSize);var u=(e-(l.xSize||i.getOuterSize()))/2;n&&n.hasAutoSize()&&(r[Mn.START]=u),o&&o.hasAutoSize()&&(r[Mn.END]=u)}else{var c=this.distributeAutoMarginBoxSizes(n,o,e);c.xSize&&(r[Mn.START]=c.xSize),c.ySize&&(r[Mn.END]=c.ySize)}return r},e.prototype.distributeAutoMarginBoxSizes=function(t,e,n){var i={xSize:null,ySize:null};if(t&&e)if(t.hasAutoSize()&&e.hasAutoSize()){var o=t.getOuterMaxContentSize(),r=e.getOuterMaxContentSize();if(o>0&&r>0){var a=o+r;if(a<n)i.xSize=n*o/a;else{var s=t.getOuterMinContentSize(),l=s+e.getOuterMinContentSize();l<n?i.xSize=s+(n-l)*(o-s)/(a-l):l>0&&(i.xSize=n*s/l)}i.xSize>0&&(i.ySize=n-i.xSize)}else o>0?i.xSize=n:r>0&&(i.ySize=n)}else t.hasAutoSize()?i.xSize=Math.max(n-e.getOuterSize(),0):e.hasAutoSize()&&(i.ySize=Math.max(n-t.getOuterSize(),0));else t?t.hasAutoSize()&&(i.xSize=n):e&&e.hasAutoSize()&&(i.ySize=n);return i},e.prototype.prepareContainer=function(e,n,i,o,r){t.prototype.prepareContainer.call(this,e,n,i,o,r),n.element.setAttribute("data-vivliostyle-page-box",!0)},e}(mn),Qn=function(){function t(t,e,n,i,o){this.container=t,this.isHorizontal=n,this.clientLayout=o,this.size=null,this.hasAutoSize_=!nn(i,e[n?"width":"height"],new L.x(i,0,"px"))}return t.prototype.hasAutoSize=function(){return this.hasAutoSize_},t.prototype.getSize=function(){if(!this.size){var t=this.isHorizontal?[Cn.a.MAX_CONTENT_WIDTH,Cn.a.MIN_CONTENT_WIDTH]:[Cn.a.MAX_CONTENT_HEIGHT,Cn.a.MIN_CONTENT_HEIGHT];this.size=Cn.b(this.clientLayout,this.container.element,t)}return this.size},t.prototype.getOuterMaxContentSize=function(){var t=this.getSize();return this.isHorizontal?this.container.getInsetLeft()+t[Cn.a.MAX_CONTENT_WIDTH]+this.container.getInsetRight():this.container.getInsetTop()+t[Cn.a.MAX_CONTENT_HEIGHT]+this.container.getInsetBottom()},t.prototype.getOuterMinContentSize=function(){var t=this.getSize();return this.isHorizontal?this.container.getInsetLeft()+t[Cn.a.MIN_CONTENT_WIDTH]+this.container.getInsetRight():this.container.getInsetTop()+t[Cn.a.MIN_CONTENT_HEIGHT]+this.container.getInsetBottom()},t.prototype.getOuterSize=function(){return this.isHorizontal?this.container.getInsetLeft()+this.container.width+this.container.getInsetRight():this.container.getInsetTop()+this.container.height+this.container.getInsetBottom()},t}(),Zn=function(){function t(t){this.params=t}return t.prototype.hasAutoSize=function(){return this.params.some(function(t){return t.hasAutoSize()})},t.prototype.getOuterMaxContentSize=function(){var t=this.params.map(function(t){return t.getOuterMaxContentSize()});return Math.max.apply(null,t)*t.length},t.prototype.getOuterMinContentSize=function(){var t=this.params.map(function(t){return t.getOuterMinContentSize()});return Math.max.apply(null,t)*t.length},t.prototype.getOuterSize=function(){var t=this.params.map(function(t){return t.getOuterSize()});return Math.max.apply(null,t)*t.length},t}(),$n=function(t){function e(e,n,i,o,r,a){var s=t.call(this,e,n,i,o,r)||this;return s.fixedSize=a,s}return Sn(e,t),e.prototype.hasAutoSize=function(){return!1},e.prototype.getOuterMaxContentSize=function(){return this.getOuterSize()},e.prototype.getOuterMinContentSize=function(){return this.getOuterSize()},e.prototype.getOuterSize=function(){return this.isHorizontal?this.container.getInsetLeft()+this.fixedSize+this.container.getInsetRight():this.container.getInsetTop()+this.fixedSize+this.container.getInsetBottom()},e}(Qn),Jn=function(t){function e(e,n){var i=t.call(this,e,n)||this;return i.borderBoxWidth=null,i.borderBoxHeight=null,i.marginTop=null,i.marginRight=null,i.marginBottom=null,i.marginLeft=null,i}return Sn(e,t),e.prototype.applyCascadeAndInit=function(e,n){var i=this.cascaded;for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(o.match(/^column.*$/)||o.match(/^background-/))&&(i[o]=n[o]);t.prototype.applyCascadeAndInit.call(this,e,n),this.parentInstance.setPageAreaDimension({borderBoxWidth:this.borderBoxWidth,borderBoxHeight:this.borderBoxHeight,marginTop:this.marginTop,marginRight:this.marginRight,marginBottom:this.marginBottom,marginLeft:this.marginLeft})},e.prototype.initHorizontal=function(){var t=this.resolvePageBoxDimensions({start:"left",end:"right",extent:"width"});this.borderBoxWidth=t.borderBoxExtent,this.marginLeft=t.marginStart,this.marginRight=t.marginEnd},e.prototype.initVertical=function(){var t=this.resolvePageBoxDimensions({start:"top",end:"bottom",extent:"height"});this.borderBoxHeight=t.borderBoxExtent,this.marginTop=t.marginStart,this.marginBottom=t.marginEnd},e.prototype.resolvePageBoxDimensions=function(t){var e=this.style,n=this.pageBox.pageSize,i=this.pageBox.scope,o=t.start,r=t.end,a=t.extent,s=n[a].toExpr(i,null),l=nn(i,e[a],s),u=nn(i,e["margin-"+o],s),c=nn(i,e["margin-"+r],s),h=on(i,e["padding-"+o],s),p=on(i,e["padding-"+r],s),f=an(i,e["border-"+o+"-width"],e["border-"+o+"-style"],s),d=an(i,e["border-"+r+"-width"],e["border-"+r+"-style"],s),g=L.P(i,s,L.C(i,L.C(i,f,h),L.C(i,d,p)));return l?(g=L.P(i,g,l),u||c?u?c=L.P(i,g,u):u=L.P(i,g,c):c=u=L.N(i,g,new L.f(i,.5))):(u||(u=i.zero),c||(c=i.zero),l=L.P(i,g,L.C(i,u,c))),e[o]=new X.c(u),e[r]=new X.c(c),e["margin-"+o]=X.u,e["margin-"+r]=X.u,e["padding-"+o]=new X.c(h),e["padding-"+r]=new X.c(p),e["border-"+o+"-width"]=new X.c(f),e["border-"+r+"-width"]=new X.c(d),e[a]=new X.c(l),e["max-"+a]=new X.c(l),{borderBoxExtent:L.P(i,s,L.C(i,u,c)),marginStart:u,marginEnd:c}},e.prototype.prepareContainer=function(e,n,i,o,r){t.prototype.prepareContainer.call(this,e,n,i,o,r),i.pageAreaElement=n.element,e.pageAreaWidth=parseFloat(i.pageAreaElement.style.width),e.pageAreaHeight=parseFloat(i.pageAreaElement.style.height)},e}(vn),ti=function(t){function e(e,n){var i=t.call(this,e,n)||this;i.suppressEmptyBoxGeneration=!0;var o=n.marginBoxName;return i.boxInfo=zn[o],e.pageMarginBoxInstances[o]=i,i}return Sn(e,t),e.prototype.prepareContainer=function(e,n,i,o,r){this.applyVerticalAlign(e,n.element),t.prototype.prepareContainer.call(this,e,n,i,o,r)},e.prototype.applyVerticalAlign=function(t,e){E.F(e,"display","flex");var n=this.getProp(t,"vertical-align"),i=null;n===X.r("middle")?i="center":n===X.r("top")?i="flex-start":n===X.r("bottom")&&(i="flex-end"),i&&(E.F(e,"flex-flow",this.vertical?"row":"column"),E.F(e,"justify-content",i))},e.prototype.positionAlongVariableDimension=function(t,e){var n=this.style,i=this.pageBox.scope,o=t.start,r=t.end,a=t.extent,s="left"===o,l=s?e.borderBoxWidth:e.borderBoxHeight,u=nn(i,n[a],l),c=s?e.marginLeft:e.marginTop;if(this.boxInfo.positionAlongVariableDimension===Mn.START)n[o]=new X.c(c);else if(u){var h=on(i,n["margin-"+o],l),p=on(i,n["margin-"+r],l),f=on(i,n["padding-"+o],l),d=on(i,n["padding-"+r],l),g=an(i,n["border-"+o+"-width"],n["border-"+o+"-style"],l),m=an(i,n["border-"+r+"-width"],n["border-"+r+"-style"],l),y=L.C(i,u,L.C(i,L.C(i,f,d),L.C(i,L.C(i,g,m),L.C(i,h,p))));switch(this.boxInfo.positionAlongVariableDimension){case Mn.CENTER:n[o]=new X.c(L.C(i,c,L.H(i,L.P(i,l,y),new L.f(i,2))));break;case Mn.END:n[o]=new X.c(L.P(i,L.C(i,c,l),y))}}},e.prototype.positionAndSizeAlongFixedDimension=function(t,e){var n=this.style,i=this.pageBox.scope,o=t.inside,r=t.outside,a=t.extent,s=e["margin"+r.charAt(0).toUpperCase()+r.substring(1)],l=rn(i,n["margin-"+o],s),u=rn(i,n["margin-"+r],s),c=on(i,n["padding-"+o],s),h=on(i,n["padding-"+r],s),p=an(i,n["border-"+o+"-width"],n["border-"+o+"-style"],s),f=an(i,n["border-"+r+"-width"],n["border-"+r+"-style"],s),d=nn(i,n[a],s),g=null;function m(t){if(g)return g;g={extent:d?d.evaluate(t):null,marginInside:l?l.evaluate(t):null,marginOutside:u?u.evaluate(t):null};var e=s.evaluate(t),n=0;return[p,c,h,f].forEach(function(e){e&&(n+=e.evaluate(t))}),(null===g.marginInside||null===g.marginOutside)&&n+g.extent+g.marginInside+g.marginOutside>e&&(null===g.marginInside&&(g.marginInside=0),null===g.marginOutside&&(g.marginOutside=0)),null!==g.extent&&null!==g.marginInside&&null!==g.marginOutside&&(g.marginOutside=null),null===g.extent&&null!==g.marginInside&&null!==g.marginOutside?g.extent=e-n-g.marginInside-g.marginOutside:null!==g.extent&&null===g.marginInside&&null!==g.marginOutside?g.marginInside=e-n-g.extent-g.marginOutside:null!==g.extent&&null!==g.marginInside&&null===g.marginOutside?g.marginOutside=e-n-g.extent-g.marginInside:null===g.extent?(g.marginInside=g.marginOutside=0,g.extent=e-n):g.marginInside=g.marginOutside=(e-n-g.extent)/2,g}n[a]=new X.c(new L.t(i,function(){var t=m(this).extent;return null===t?0:t},a)),n["margin-"+o]=new X.c(new L.t(i,function(){var t=m(this).marginInside;return null===t?0:t},"margin-"+o)),n["margin-"+r]=new X.c(new L.t(i,function(){var t=m(this).marginOutside;return null===t?0:t},"margin-"+r)),"left"===o?n.left=new X.c(L.C(i,e.marginLeft,e.borderBoxWidth)):"top"===o&&(n.top=new X.c(L.C(i,e.marginTop,e.borderBoxHeight)))},e.prototype.initHorizontal=function(){var t=this.parentInstance.pageAreaDimension;this.boxInfo.isInLeftColumn?this.positionAndSizeAlongFixedDimension({inside:"right",outside:"left",extent:"width"},t):this.boxInfo.isInRightColumn?this.positionAndSizeAlongFixedDimension({inside:"left",outside:"right",extent:"width"},t):this.positionAlongVariableDimension({start:"left",end:"right",extent:"width"},t)},e.prototype.initVertical=function(){var t=this.parentInstance.pageAreaDimension;this.boxInfo.isInTopRow?this.positionAndSizeAlongFixedDimension({inside:"bottom",outside:"top",extent:"height"},t):this.boxInfo.isInBottomRow?this.positionAndSizeAlongFixedDimension({inside:"top",outside:"bottom",extent:"height"},t):this.positionAlongVariableDimension({start:"top",end:"bottom",extent:"height"},t)},e.prototype.finishContainer=function(e,n,i,o,r,a,s){t.prototype.finishContainer.call(this,e,n,i,o,r,a,s);var l=i.marginBoxes,u=this.pageBox.marginBoxName,c=this.boxInfo;c.isInLeftColumn||c.isInRightColumn?c.isInTopRow||c.isInBottomRow||(c.isInLeftColumn?l.left[u]=n:c.isInRightColumn&&(l.right[u]=n)):c.isInTopRow?l.top[u]=n:c.isInBottomRow&&(l.bottom[u]=n)},e}(vn),ei=function(){function t(t,e,n,i,o){this.cascadeInstance=t,this.pageScope=e,this.rootPageBoxInstance=n,this.context=i,this.docElementStyle=o,this.pageMasterCache={},this.definePageProgression()}return t.prototype.definePageProgression=function(){var t=this.pageScope,e=new L.s(t,"page-number"),n=new L.i(t,new L.q(t,e,new L.f(t,2)),t.zero);t.defineName("recto-page",new L.w(t,n)),t.defineName("verso-page",n),(this.context.pageProgression||Tn(this.docElementStyle))===i.LTR?(t.defineName("left-page",n),t.defineName("right-page",new L.w(t,n))):(t.defineName("left-page",new L.w(t,n)),t.defineName("right-page",n))},t.prototype.getCascadedPageStyle=function(){var t={};return this.cascadeInstance.pushRule([],"",t),this.cascadeInstance.popRule(),t},t.prototype.getPageRulePageMaster=function(t,e){var n=t.pageBox;if(0===Object.keys(e).length)return n.resetScope(),t;var i=this.makeCacheKey(e,n),o=this.pageMasterCache[i];return o||(o=n.pseudoName===dn?this.generatePageRuleMaster(e):this.generateCascadedPageMaster(e,n),this.pageMasterCache[i]=o),o.pageBox.resetScope(),o},t.prototype.makeCacheKey=function(t,e){var n=this.makeCascadeValueObjectKey(t);return e.key+"^"+n},t.prototype.makeCascadeValueObjectKey=function(t){var e=[];for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){var i,o=t[n];i=o instanceof H.c?""+o.value:this.makeCascadeValueObjectKey(o),e.push(n+i+(o.priority||""))}return e.sort().join("^")},t.prototype.generatePageRuleMaster=function(t){var e=new jn(this.pageScope,this.rootPageBoxInstance.pageBox,t).createInstance(this.rootPageBoxInstance);return e.applyCascadeAndInit(this.cascadeInstance,this.docElementStyle),e.resolveAutoSizing(this.context),e},t.prototype.generateCascadedPageMaster=function(t,e){var n=e.clone({pseudoName:Wn}),i=n.specified,o=t.size;if(o){var r=kn(t),a=o.priority;i.width=H.i(this.context,i.width,new H.c(r.width,a)),i.height=H.i(this.context,i.height,new H.c(r.height,a))}["counter-reset","counter-increment"].forEach(function(e){i[e]&&(t[e]=i[e])});var s=n.createInstance(this.rootPageBoxInstance);return s.applyCascadeAndInit(this.cascadeInstance,this.docElementStyle),s.resolveAutoSizing(this.context),s},t}(),ni=function(t){function e(e){var n=t.call(this)||this;return n.pageType=e,n}return Sn(e,t),e.prototype.apply=function(t){t.currentPageType===this.pageType&&this.chained.apply(t)},e.prototype.getPriority=function(){return 3},e.prototype.makePrimary=function(t){return this.chained&&t.insertInTable(t.pagetypes,this.pageType,this.chained),!0},e}(H.d),ii=function(t){function e(e){var n=t.call(this)||this;return n.scope=e,n}return Sn(e,t),e.prototype.apply=function(t){1===new L.s(this.scope,"page-number").evaluate(t.context)&&this.chained.apply(t)},e.prototype.getPriority=function(){return 2},e}(H.d),oi=function(t){function e(e){var n=t.call(this)||this;return n.scope=e,n}return Sn(e,t),e.prototype.apply=function(t){new L.s(this.scope,"left-page").evaluate(t.context)&&this.chained.apply(t)},e.prototype.getPriority=function(){return 1},e}(H.d),ri=function(t){function e(e){var n=t.call(this)||this;return n.scope=e,n}return Sn(e,t),e.prototype.apply=function(t){new L.s(this.scope,"right-page").evaluate(t.context)&&this.chained.apply(t)},e.prototype.getPriority=function(){return 1},e}(H.d),ai=function(t){function e(e){var n=t.call(this)||this;return n.scope=e,n}return Sn(e,t),e.prototype.apply=function(t){new L.s(this.scope,"recto-page").evaluate(t.context)&&this.chained.apply(t)},e.prototype.getPriority=function(){return 1},e}(H.d),si=function(t){function e(e){var n=t.call(this)||this;return n.scope=e,n}return Sn(e,t),e.prototype.apply=function(t){new L.s(this.scope,"verso-page").evaluate(t.context)&&this.chained.apply(t)},e.prototype.getPriority=function(){return 1},e}(H.d),li=function(t){function e(e,n){return t.call(this,e,n,null,null,null)||this}return Sn(e,t),e.prototype.apply=function(t){!function(t,e,n,i,o){H.B(t,e,n,i,null,null,null);var r=n[Xn];if(r){var a=H.q(e,Xn);for(var s in r)if(r.hasOwnProperty(s)){var l=a[s];l||(l={},a[s]=l),H.B(t,l,r[s],i,null,null,null)}}}(t.context,t.currentStyle,this.style,this.specificity)},e}(H.a),ui=function(t){function e(e,n,i,o,r){var a=t.call(this,e,n,null,i,null,o,!1)||this;return a.pageProps=r,a.currentPageSelectors=[],a.currentNamedPageSelector="",a.currentPseudoPageClassSelectors=[],a}return Sn(e,t),e.prototype.startPageRule=function(){this.startSelectorRule()},e.prototype.tagSelector=function(t,e){v.a(e),this.currentNamedPageSelector=e,e&&(this.chain.push(new ni(e)),this.specificity+=65536)},e.prototype.pseudoclassSelector=function(t,e){switch(e&&this.reportAndSkip("E_INVALID_PAGE_SELECTOR :"+t+"("+e.join("")+")"),this.currentPseudoPageClassSelectors.push(":"+t),t.toLowerCase()){case"first":this.chain.push(new ii(this.scope)),this.specificity+=256;break;case"left":this.chain.push(new oi(this.scope)),this.specificity+=1;break;case"right":this.chain.push(new ri(this.scope)),this.specificity+=1;break;case"recto":this.chain.push(new ai(this.scope)),this.specificity+=1;break;case"verso":this.chain.push(new si(this.scope)),this.specificity+=1;break;default:this.reportAndSkip("E_INVALID_PAGE_SELECTOR :"+t)}},e.prototype.finishSelector=function(){var t;t=this.currentNamedPageSelector||this.currentPseudoPageClassSelectors.length?[this.currentNamedPageSelector].concat(this.currentPseudoPageClassSelectors.sort()):null,this.currentPageSelectors.push({selectors:t,specificity:this.specificity}),this.currentNamedPageSelector="",this.currentPseudoPageClassSelectors=[]},e.prototype.nextSelector=function(){this.finishSelector(),t.prototype.nextSelector.call(this)},e.prototype.startRuleBody=function(){this.finishSelector(),t.prototype.startRuleBody.call(this)},e.prototype.simpleProperty=function(e,n,i){var o=this;if("bleed"!==e&&"marks"!==e||this.currentPageSelectors.some(function(t){return null===t.selectors})){t.prototype.simpleProperty.call(this,e,n,i);var r=H.s(this.elementStyle,e),a=this.pageProps;if("bleed"===e||"marks"===e)a[""]||(a[""]={}),Object.keys(a).forEach(function(t){H.F(a[t],e,r)});else if("size"===e){var s=a[""];this.currentPageSelectors.forEach(function(t){var n=new H.c(r.value,r.priority+t.specificity),i=t.selectors?t.selectors.join(""):"",l=a[i];if(l){var u=H.s(l,e);n=u?H.i(null,n,u):n,H.F(l,e,n)}else l=a[i]={},H.F(l,e,n),s&&["bleed","marks"].forEach(function(t){s[t]&&H.F(l,t,s[t])},o)})}}},e.prototype.insertNonPrimary=function(t){this.cascade.insertInTable(this.cascade.pagetypes,"*",t)},e.prototype.makeApplyRuleAction=function(t){return new li(this.elementStyle,t)},e.prototype.startPageMarginBoxRule=function(t){var e=H.q(this.elementStyle,Xn),n=e[t];n||(n={},e[t]=n);var i=new ci(this.scope,this.owner,this.validatorSet,n);this.owner.pushHandler(i)},e}(H.b),ci=function(t){function e(e,n,i,o){var r=t.call(this,e,n,!1)||this;return r.validatorSet=i,r.boxStyle=o,r}return Sn(e,t),e.prototype.property=function(t,e,n){this.validatorSet.validatePropertyAndHandleShorthand(t,e,n,this)},e.prototype.invalidPropertyValue=function(t,e){this.report("E_INVALID_PROPERTY_VALUE "+t+": "+e.toString())},e.prototype.unknownProperty=function(t,e){this.report("E_INVALID_PROPERTY "+t+": "+e.toString())},e.prototype.simpleProperty=function(t,e,n){var i=n?this.getImportantSpecificity():this.getBaseSpecificity(),o=new H.c(e,i);H.F(this.boxStyle,t,o)},e}(z.f),hi=n(27),pi=n(25),fi=n(21),di=function(t,e,n){return t.replace(/[uU][rR][lL]\(\s*"((\\([^0-9a-fA-F]+|[0-9a-fA-F]+\s*)|[^"\r\n])+)"/gm,function(t,i){return'url("'+n.transformURL(i,e)+'"'}).replace(/[uU][rR][lL]\(\s*'((\\([^0-9a-fA-F]+|[0-9a-fA-F]+\s*)|[^'\r\n])+)'/gm,function(t,i){return"url('"+n.transformURL(i,e)+"'"}).replace(/[uU][rR][lL]\(\s*((\\([^0-9a-fA-F]+|[0-9a-fA-F]+\s*)|[^"'\r\n\)\s])+)/gm,function(t,i){return"url("+n.transformURL(i,e)})},gi=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),mi={},yi={"text-indent":"0px","margin-top":"0px","padding-top":"0px","border-top-width":"0px","border-top-style":"none","border-top-color":"transparent","border-top-left-radius":"0px","border-top-right-radius":"0px"},vi={"text-indent":"0px","margin-right":"0px","padding-right":"0px","border-right-width":"0px","border-right-style":"none","border-right-color":"transparent","border-top-right-radius":"0px","border-bottom-right-radius":"0px"},Ei={"margin-top":"0px"},bi={"margin-right":"0px"},wi=function(t){function e(e,n,i,o,r,a,s,l,u,c,h,p,f){var d=t.call(this)||this;return d.flowName=e,d.context=n,d.viewport=i,d.styler=o,d.regionIds=r,d.xmldoc=a,d.docFaces=s,d.footnoteStyle=l,d.stylerProducer=u,d.page=c,d.customRenderer=h,d.fallbackMap=p,d.documentURLTransformer=f,d.nodeContext=null,d.viewRoot=null,d.isFootnote=!1,d.sourceNode=null,d.offsetInNode=0,d.viewNode=null,d.document=i.document,d.exprContentListener=o.counterListener.getExprContentListener(),d}return gi(e,t),e.prototype.clone=function(){return new e(this.flowName,this.context,this.viewport,this.styler,this.regionIds,this.xmldoc,this.docFaces,this.footnoteStyle,this.stylerProducer,this.page,this.customRenderer,this.fallbackMap,this.documentURLTransformer)},e.prototype.createPseudoelementShadow=function(t,e,n,i,o,r,a,s){var l=this.getPseudoMap(n,this.regionIds,this.isFootnote,this.nodeContext,r);if(!l)return s;for(var u=[],c=fi.c.createElementNS(E.a.SHADOW,"root"),h=c,p=0,f=fi.e;p<f.length;p++){var d=f[p],g=void 0;if(d){if(!l[d])continue;if(!("footnote-marker"!=d||e&&this.isFootnote))continue;if(d.match(/^first-/)){var m=i.display;if(!m||m===X.t.inline)continue}if("before"===d||"after"===d){var y=l[d].content;if(!y||y===X.t.normal||y===X.t.none)continue}u.push(d),g=fi.c.createElementNS(E.a.XHTML,"span"),fi.f(g,d)}else g=fi.c.createElementNS(E.a.SHADOW,"content");h.appendChild(g),d.match(/^first-/)&&(h=g)}if(!u.length)return s;var v=new fi.b(t,n,o,r,this.exprContentListener);return new q.n(t,c,null,a,s,q.o.ROOTLESS,v)},e.prototype.getPseudoMap=function(t,e,n,i,o){var r=H.u(t,"_pseudos");if(!r)return null;var a={},s=function(t){var i=a[t]={};H.C(i,r[t],o),H.D(i,o,r[t]),H.o(r[t],e,n,function(t,e){H.C(i,e,o),H.p(e,function(t){H.C(i,t,o)})})};for(var l in r)s(l);return a},e.prototype.createRefShadow=function(t,e,n,i,o){var r=this,a=Y.c("createRefShadow");return r.xmldoc.store.load(t).then(function(s){var l=s;if(l){var u=l.getElement(t);if(u){var c=r.stylerProducer.getStylerForDoc(l);o=new q.n(n,u,l,i,o,e,c)}}a.finish(o)}),a.result()},e.prototype.createShadows=function(t,e,n,i,o,r,a){var s,l=this,u=Y.c("createShadows"),c=i.template;if(c instanceof X.l){var h=c.url;s=l.createRefShadow(h,q.o.ROOTLESS,t,a,null)}else s=Y.d(null);return s.then(function(s){var c=null;if(t.namespaceURI==E.a.SHADOW&&"include"==t.localName){var h=t.getAttribute("href"),p=null;h?p=a?a.xmldoc:l.xmldoc:a&&(h=a.owner.namespaceURI==E.a.XHTML?a.owner.getAttribute("href"):a.owner.getAttributeNS(E.a.XLINK,"href"),p=a.parentShadow?a.parentShadow.xmldoc:l.xmldoc),h&&(h=E.C(h,p.url),c=l.createRefShadow(h,q.o.ROOTED,t,a,s))}null==c&&(c=Y.d(s));var f=null;c.then(function(e){if(i.display===X.t.table_cell){var n=E.C("user-agent.xml#table-cell",E.D);f=l.createRefShadow(n,q.o.ROOTLESS,t,a,e)}else f=Y.d(e)}),f.then(function(s){s=l.createPseudoelementShadow(t,e,n,i,o,r,a,s),u.finish(s)})}),u.result()},e.prototype.setViewRoot=function(t,e){this.viewRoot=t,this.isFootnote=e},e.prototype.computeStyle=function(t,e,n,i){var o=this.context,r=H.n(n,o,this.regionIds,this.isFootnote,this.nodeContext);t=H.z(r,o,t),e=H.y(r,o,e);var a=this;H.k(r,i,t,e,function(t,e){var n=e.evaluate(o,t);return"font-family"==t&&(n=a.docFaces.filterFontFamily(n)),n});var s=i.position,l=i.float,u=ae.c(i.display||X.t.inline,s,l,this.sourceNode===this.xmldoc.root);return["display","position","float"].forEach(function(t){u[t]&&(i[t]=u[t])}),t},e.prototype.inheritFromSourceParent=function(t){for(var e=this.nodeContext.sourceNode,n=[],i=null,o=this.nodeContext.shadowContext,r=-1;e&&1==e.nodeType;){var a=o&&o.root==e;if(!a||o.type==q.o.ROOTLESS){var s=(o?o.styler:this.styler).getStyle(e,!1);n.push(s),i=i||E.u(e)}a?(e=o.owner,o=o.parentShadow):(e=e.parentNode,r++)}for(var l=0===r,u=this.context.queryUnitSize("em",l),c={"font-size":new H.c(new X.i(u,"px"),0)},h=new H.g(c,this.context),p=n.length-1;p>=0;--p){var f=n[p],d=[];for(var g in f)H.w(g)&&d.push(g);d.sort(X.v);for(var m=0,y=d;m<y.length;m++){var v=y[m];h.setPropName(v);var b=H.s(f,v);b.value!==X.t.inherit&&(c[v]=b.filterValue(h))}}for(var w in t)H.w(w)||(c[w]=t[w]);return{lang:i,elementStyle:c}},e.prototype.resolveURL=function(t){return t=E.C(t,this.xmldoc.url),this.fallbackMap[t]||t},e.prototype.inheritLangAttribute=function(){this.nodeContext.lang=E.u(this.nodeContext.sourceNode)||this.nodeContext.parent&&this.nodeContext.parent.lang||this.nodeContext.lang},e.prototype.transferPolyfilledInheritedProps=function(t){var e=H.r().filter(function(e){return t[e]});if(e.length){var n=this.nodeContext.inheritedProps;if(this.nodeContext.parent)for(var i in n=this.nodeContext.inheritedProps={},this.nodeContext.parent.inheritedProps)n[i]=this.nodeContext.parent.inheritedProps[i];e.forEach(function(e){var i=t[e];if(i){if(i instanceof X.g)n[e]=i.num;else if(i instanceof X.f)n[e]=i.name;else if(i instanceof X.i){var o=i;switch(o.unit){case"dpi":case"dpcm":case"dppx":n[e]=o.num*L.G[o.unit]}}else n[e]=i;delete t[e]}})}},e.prototype.resolveFormattingContext=function(t,e,n,i,o,r){for(var a=l.b(l.a.RESOLVE_FORMATTING_CONTEXT),s=0;s<a.length;s++){var u=a[s](t,e,n,i,o,r);if(u)return void(t.formattingContext=u)}},e.prototype.createElementView=function(t,e){var n=this,i=!0,o=Y.c("createElementView"),r=n.sourceNode,a=n.nodeContext.shadowContext?n.nodeContext.shadowContext.styler:n.styler,s=a.getStyle(r,!1);if(!n.nodeContext.shadowContext){var l=this.xmldoc.getElementOffset(r);pi.b.registerFragmentIndex(l,n.nodeContext.fragmentIndex,0)}var u={};if(!n.nodeContext.parent){var c=n.inheritFromSourceParent(s);s=c.elementStyle,n.nodeContext.lang=c.lang}var h=s["float-reference"]&&j.g(s["float-reference"].value.toString());n.nodeContext.parent&&h&&j.h(h)&&(c=n.inheritFromSourceParent(s),s=c.elementStyle,n.nodeContext.lang=c.lang),n.nodeContext.vertical=n.computeStyle(n.nodeContext.vertical,"rtl"===n.nodeContext.direction,s,u),a.processContent(r,u),this.transferPolyfilledInheritedProps(u),this.inheritLangAttribute(),u.direction&&(n.nodeContext.direction=u.direction.toString());var p=u["flow-into"];if(p&&p.toString()!=n.flowName)return o.finish(!1),o.result();var f=u.display;if(f===X.t.none)return o.finish(!1),o.result();var d=null==n.nodeContext.parent;return n.nodeContext.flexContainer=f===X.t.flex,n.createShadows(r,d,s,u,a,n.context,n.nodeContext.shadowContext).then(function(l){n.nodeContext.nodeShadow=l;var c=u.position,p=u.float,g=u.clear,m=n.nodeContext.vertical?X.t.vertical_rl:X.t.horizontal_tb,y=n.nodeContext.parent?n.nodeContext.parent.vertical?X.t.vertical_rl:X.t.horizontal_tb:m,v=ae.e(r);n.nodeContext.establishesBFC=ae.a(f,c,p,u.overflow,m,y,v),n.nodeContext.containingBlockForAbsolute=ae.b(c),!n.nodeContext.isInsideBFC()||p===X.t.footnote||h&&j.h(h)||(p=null,g=null);var b=p===X.t.left||p===X.t.right||p===X.t.top||p===X.t.bottom||p===X.t.inline_start||p===X.t.inline_end||p===X.t.block_start||p===X.t.block_end||p===X.t.snap_block||p===X.t.footnote;p&&(delete u.float,p===X.t.footnote&&(n.isFootnote?(b=!1,u.display=X.t.block):u.display=X.t.inline)),g&&(g===X.t.inherit&&n.nodeContext.parent&&n.nodeContext.parent.clearSide&&(g=X.r(n.nodeContext.parent.clearSide)),g!==X.t.left&&g!==X.t.right&&g!==X.t.top&&g!==X.t.bottom&&g!==X.t.both&&g!==X.t.all&&g!==X.t.same||(delete u.clear,u.display&&u.display!=X.t.inline&&(n.nodeContext.clearSide=g.toString())));var w=f===X.t.list_item&&u["ua-list-item-count"];if((b||u["break-inside"]&&u["break-inside"]!==X.t.auto)&&n.nodeContext.breakPenalty++,f&&f!==X.t.inline&&ae.f(f)&&n.nodeContext.breakPenalty++,n.nodeContext.inline=!b&&!f||ae.f(f)||ae.g(f),n.nodeContext.display=f?f.toString():"inline",n.nodeContext.floatSide=b?p.toString():null,n.nodeContext.floatReference=h||j.a.INLINE,n.nodeContext.floatMinWrapBlock=u["float-min-wrap-block"]||null,n.nodeContext.columnSpan=u["column-span"],!n.nodeContext.inline){var N=u["break-after"];N&&(n.nodeContext.breakAfter=N.toString());var C=u["break-before"];C&&(n.nodeContext.breakBefore=C.toString())}n.nodeContext.verticalAlign=u["vertical-align"]&&u["vertical-align"].toString()||"baseline",n.nodeContext.captionSide=u["caption-side"]&&u["caption-side"].toString()||"top";var S=u["border-collapse"];if(!S||S===X.r("separate")){var T=u["border-spacing"],x=void 0,I=void 0;T&&(T.isSpaceList()?(x=T.values[0],I=T.values[1]):x=I=T,x.isNumeric()&&(n.nodeContext.inlineBorderSpacing=X.x(x,n.context)),I.isNumeric()&&(n.nodeContext.blockBorderSpacing=X.x(I,n.context)))}n.nodeContext.footnotePolicy=u["footnote-policy"];var P=u["x-first-pseudo"];if(P){var A=n.nodeContext.parent?n.nodeContext.parent.firstPseudo:null;n.nodeContext.firstPseudo=new q.e(A,P.num)}n.nodeContext.inline||n.processAfterIfcontinues(r,s,a,n.context);var R=u["white-space"];if(R){var O=q.z(R.toString());null!==O&&(n.nodeContext.whitespace=O)}var L=u["hyphenate-character"];L&&L!==X.t.auto&&(n.nodeContext.hyphenateCharacter=L.str);var k=u["word-break"],F=u["overflow-wrap"]||["word-wrap"];n.nodeContext.breakWord=k===X.t.break_all||F===X.t.break_word,n.resolveFormattingContext(n.nodeContext,t,f,c,p,d),n.nodeContext.parent&&n.nodeContext.parent.formattingContext&&(t=n.nodeContext.parent.formattingContext.isFirstTime(n.nodeContext,t)),n.nodeContext.inline||(n.nodeContext.repeatOnBreak=n.processRepeatOnBreak(u),n.findAndProcessRepeatingElements(r,a));var _,D=!1,B=null,M=[],U=r.namespaceURI,V=r.localName;if(U==E.a.XHTML)"html"==V||"body"==V||"script"==V||"link"==V||"meta"==V?V="div":"vide_"==V?V="video":"audi_"==V?V="audio":"object"==V&&(D=!!n.customRenderer),r.getAttribute(fi.a)&&s.content&&s.content.value&&s.content.value.url&&(V="img");else if(U==E.a.epub)V="span",U=E.a.XHTML;else if(U==E.a.FB2){if(U=E.a.XHTML,"image"==V){V="div";var H=r.getAttributeNS(E.a.XLINK,"href");if(H&&"#"==H.charAt(0)){var z=n.xmldoc.getElement(H);if(z){B=n.createElement(U,"img");var G="data:"+(z.getAttribute("content-type")||"image/jpeg")+";base64,"+z.textContent.replace(/[ \t\n\t]/g,"");M.push(Ue.b(B,G))}}}else V=Ni[V];V||(V=n.nodeContext.inline?"span":"div")}else if(U==E.a.NCX)if(U=E.a.XHTML,"ncx"==V||"navPoint"==V)V="div";else if("navLabel"==V){V="span";var W=r.parentNode;if(W){for(var K=null,Q=W.firstChild;Q;Q=Q.nextSibling)if(1==Q.nodeType){var Z=Q;if(Z.namespaceURI==E.a.NCX&&"content"==Z.localName){K=Z.getAttribute("src");break}}K&&(V="a",(r=r.ownerDocument.createElementNS(U,"a")).setAttribute("href",K))}}else V="span";else U==E.a.SHADOW?(U=E.a.XHTML,V=n.nodeContext.inline?"span":"div"):D=!!n.customRenderer;if(w)t?V="li":(V="div",f=X.t.block,u.display=f);else if("body"==V||"li"==V)V="div";else if("q"==V)V="span";else if("a"==V){var $=u["hyperlink-processing"];$&&"normal"!=$.toString()&&(V="span")}if(u.behavior&&"none"!=u.behavior.toString()&&n.customRenderer&&(D=!0),r.dataset&&"true"===r.getAttribute("data-math-typeset")&&(D=!0),D){var J=n.nodeContext.parent?n.nodeContext.parent.viewNode:null;_=n.customRenderer(r,J,u)}else _=Y.d(null);_.then(function(a){var s;a?D&&(i="true"==a.getAttribute("data-adapt-process-children")):a=n.createElement(U,V),"a"==V&&a.addEventListener("click",n.page.hrefHandler,!1),B&&(n.applyPseudoelementStyle(n.nodeContext,"inner",B),a.appendChild(B)),"iframe"==a.localName&&a.namespaceURI==E.a.XHTML&&(s=a).addEventListener("load",function(){s.contentWindow.navigator.epubReadingSystem={name:"adapt",version:"0.1",layoutStyle:"paginated",hasFeature:function(t,e){switch(t){case"mouse-events":return!0}return!1}}},!1);var l=n.nodeContext.inheritedProps["image-resolution"],c=[],h=u.width,p=u.height,f=r.getAttribute("width"),d=r.getAttribute("height"),g=h===X.t.auto||!h&&!f,m=p===X.t.auto||!p&&!d;if(r.namespaceURI!=E.a.FB2||"td"==V){for(var y=r.attributes,v=y.length,b=null,N=0;N<v;N++){var C=y[N],S=C.namespaceURI,T=C.localName,x=C.nodeValue;if(S){if("http://www.w3.org/2000/xmlns/"==S)continue;S==E.a.XLINK&&"href"==T&&(x=n.resolveURL(x))}else{if(T.match(/^on/))continue;if("style"==T)continue;if(("id"==T||"name"==T)&&t){x=n.documentURLTransformer.transformFragment(x,n.xmldoc.url),a.setAttribute(T,x),n.page.registerElementWithId(a,x);continue}if("src"==T||"href"==T||"poster"==T?(x=n.resolveURL(x),"href"===T&&(x=n.documentURLTransformer.transformURL(x,n.xmldoc.url))):"srcset"==T&&(x=x.split(",").map(function(t){return n.resolveURL(t.trim())}).join(",")),"poster"===T&&"video"===V&&U===E.a.XHTML&&g&&m){var I=new Image,P=Ue.b(I,x);M.push(P),c.push({image:I,element:a,fetcher:P})}}if(U==E.a.SVG&&/^[A-Z\-]+$/.test(T)&&(T=T.toLowerCase()),n.isSVGUrlAttribute(T)&&(x=di(x,n.xmldoc.url,n.documentURLTransformer)),S){var A=mi[S];A&&(T=A+":"+T)}"src"!=T||S||"img"!=V&&"input"!=V||U!=E.a.XHTML?"href"==T&&"image"==V&&U==E.a.SVG&&S==E.a.XLINK?n.page.fetchers.push(Ue.b(a,x)):S?a.setAttributeNS(S,T,x):a.setAttribute(T,x):b=x}if(b){I="input"===V?new Image:a;var R=Ue.b(I,b);I!==a&&(a.src=b),g||m?(g&&m&&l&&1!==l&&c.push({image:I,element:a,fetcher:R}),M.push(R)):n.page.fetchers.push(R)}}delete u.content;var O=u["list-style-image"];if(O&&O instanceof X.l){var L=O.url;M.push(Ue.b(new Image,L))}if(n.preprocessElementStyle(u),n.applyComputedStyles(a,u),!n.nodeContext.inline){var k=null;if(t?e&&(k=n.nodeContext.vertical?bi:Ei):k="clone"!==n.nodeContext.inheritedProps["box-decoration-break"]?n.nodeContext.vertical?vi:yi:n.nodeContext.vertical?bi:Ei,k)for(var F in k)E.F(a,F,k[F])}w&&a.setAttribute("value",u["ua-list-item-count"].stringValue()),n.viewNode=a,M.length?Ue.c(M).then(function(){l>0&&n.modifyElemDimensionWithImageResolution(c,l,u,n.nodeContext.vertical),o.finish(i)}):o.timeSlice().then(function(){o.finish(i)})})}),o.result()},e.prototype.processAfterIfcontinues=function(t,e,n,i){var o=this.getPseudoMap(e,this.regionIds,this.isFootnote,this.nodeContext,i);if(o&&o["after-if-continues"]&&o["after-if-continues"].content){var r=new fi.b(t,e,n,i,this.exprContentListener);this.nodeContext.afterIfContinues=new at.a(t,r)}},e.prototype.isSVGUrlAttribute=function(t){return e.SVG_URL_ATTRIBUTES.includes(t.toLowerCase())},e.prototype.modifyElemDimensionWithImageResolution=function(t,e,n,i){var o=this;t.forEach(function(t){if("load"===t.fetcher.get().get()){var r=t.image,a=r.width/e,s=r.height/e,l=t.element;if(a>0&&s>0)if(n["box-sizing"]===X.t.border_box&&(n["border-left-style"]!==X.t.none&&(a+=X.x(n["border-left-width"],o.context)),n["border-right-style"]!==X.t.none&&(a+=X.x(n["border-right-width"],o.context)),n["border-top-style"]!==X.t.none&&(s+=X.x(n["border-top-width"],o.context)),n["border-bottom-style"]!==X.t.none&&(s+=X.x(n["border-bottom-width"],o.context))),e>1){var u=n["max-width"]||X.t.none,c=n["max-height"]||X.t.none;if(u===X.t.none&&c===X.t.none)E.F(l,"max-width",a+"px");else if(u!==X.t.none&&c===X.t.none)E.F(l,"width",a+"px");else if(u===X.t.none&&c!==X.t.none)E.F(l,"height",s+"px");else{v.a(u.isNumeric()),v.a(c.isNumeric());var h=u,p=c;"%"!==h.unit?E.F(l,"max-width",Math.min(a,X.x(h,o.context))+"px"):"%"!==p.unit?E.F(l,"max-height",Math.min(s,X.x(p,o.context))+"px"):i?E.F(l,"height",s+"px"):E.F(l,"width",a+"px")}}else if(e<1){var f=n["min-width"]||X.u,d=n["min-height"]||X.u;v.a(f.isNumeric()),v.a(f.isNumeric());var g=f,m=d;0===g.num&&0===m.num?E.F(l,"min-width",a+"px"):0!==g.num&&0===m.num?E.F(l,"width",a+"px"):0===g.num&&0!==m.num?E.F(l,"height",s+"px"):"%"!==g.unit?E.F(l,"min-width",Math.max(a,X.x(g,o.context))+"px"):"%"!==m.unit?E.F(l,"min-height",Math.max(s,X.x(m,o.context))+"px"):i?E.F(l,"height",s+"px"):E.F(l,"width",a+"px")}}})},e.prototype.preprocessElementStyle=function(t){var e=this;l.b(l.a.PREPROCESS_ELEMENT_STYLE).forEach(function(n){n(e.nodeContext,t)})},e.prototype.findAndProcessRepeatingElements=function(t,e){for(var n=t.firstChild;n;n=n.nextSibling)if(1===n.nodeType){var i={},o=e.getStyle(n,!1);if(this.computeStyle(this.nodeContext.vertical,"rtl"===this.nodeContext.direction,o,i),this.processRepeatOnBreak(i)){if(this.nodeContext.formattingContext instanceof ct&&!this.nodeContext.belongsTo(this.nodeContext.formattingContext))return;var r=this.nodeContext.parent,a=r&&r.formattingContext;return this.nodeContext.formattingContext=new ct(a,this.nodeContext.sourceNode),void this.nodeContext.formattingContext.initializeRepetitiveElements(this.nodeContext.vertical)}}},e.prototype.processRepeatOnBreak=function(t){var e=t["repeat-on-break"];return e!==X.t.none&&(e===X.t.auto&&(e=t.display===X.t.table_header_group?X.t.header:t.display===X.t.table_footer_group?X.t.footer:X.t.none),e&&e!==X.t.none)?e.toString():null},e.prototype.createTextNodeView=function(){var t=this,e=Y.c("createTextNodeView");return this.preprocessTextContent().then(function(){var n=t.offsetInNode||0,i=hi.d(t.nodeContext.preprocessedTextContent).substr(n);t.viewNode=document.createTextNode(i),e.finish(!0)}),e.result()},e.prototype.preprocessTextContent=function(){if(null!=this.nodeContext.preprocessedTextContent)return Y.d(!0);var t,e=this,n=t=e.sourceNode.textContent,i=Y.c("preprocessTextContent"),o=l.b(l.a.PREPROCESS_TEXT_CONTENT),r=0;return i.loop(function(){return r>=o.length?Y.d(!1):o[r++](e.nodeContext,n).thenAsync(function(t){return n=t,Y.d(!0)})}).then(function(){e.nodeContext.preprocessedTextContent=hi.a(t,n),i.finish(!0)}),i.result()},e.prototype.createNodeView=function(t,e){var n,i=this,o=Y.c("createNodeView"),r=!0;return 1==i.sourceNode.nodeType?n=i.createElementView(t,e):8==i.sourceNode.nodeType?(i.viewNode=null,n=Y.d(!0)):n=i.createTextNodeView(),n.then(function(t){if(r=t,i.nodeContext.viewNode=i.viewNode,i.viewNode){var e=i.nodeContext.parent?i.nodeContext.parent.viewNode:i.viewRoot;e&&e.appendChild(i.viewNode)}o.finish(r)}),o.result()},e.prototype.setCurrent=function(t,e,n){return this.nodeContext=t,t?(this.sourceNode=t.sourceNode,this.offsetInNode=t.offsetInNode):(this.sourceNode=null,this.offsetInNode=-1),this.viewNode=null,this.nodeContext?this.createNodeView(e,!!n):Y.d(!0)},e.prototype.processShadowContent=function(t){if(null==t.shadowContext||"content"!=t.sourceNode.localName||t.sourceNode.namespaceURI!=E.a.SHADOW)return t;var e,n,i,o=t.boxOffset,r=t.shadowContext,a=t.parent;r.subShadow?(i=r.subShadow,e=r.root,(n=r.type)==q.o.ROOTLESS&&(e=e.firstChild)):(i=r.parentShadow,e=r.owner.firstChild,n=q.o.ROOTLESS);var s=t.sourceNode.nextSibling;if(s?(t.sourceNode=s,t.resetView()):t.shadowSibling?t=t.shadowSibling:e?t=null:(t=t.parent.modify()).after=!0,e){var l=new q.k(e,a,o);return l.shadowContext=i,l.shadowType=n,l.shadowSibling=t,l}return t.boxOffset=o,t},e.prototype.nextPositionInTree=function(t){var e=t.boxOffset+1;if(t.after){if(!t.parent)return null;if(t.shadowType!=q.o.ROOTED){var n=t.sourceNode.nextSibling;if(n)return(t=t.modify()).boxOffset=e,t.sourceNode=n,t.resetView(),this.processShadowContent(t)}return t.shadowSibling?((t=t.shadowSibling.modify()).boxOffset=e,t):((t=t.parent.modify()).boxOffset=e,t.after=!0,t)}if(t.nodeShadow){var i=t.nodeShadow.root;if(t.nodeShadow.type==q.o.ROOTLESS&&(i=i.firstChild),i){var o=new q.k(i,t,e);return o.shadowContext=t.nodeShadow,o.shadowType=t.nodeShadow.type,this.processShadowContent(o)}}var r=t.sourceNode.firstChild;return r?this.processShadowContent(new q.k(r,t,e)):(1!=t.sourceNode.nodeType&&(e+=hi.d(t.preprocessedTextContent).length-1-t.offsetInNode),(t=t.modify()).boxOffset=e,t.after=!0,t)},e.prototype.isTransclusion=function(t,e,n){var i=H.s(e,"hyperlink-processing");if(!i)return!1;var o=i.evaluate(this.context,"hyperlink-processing");return!!o&&o.toString()==n},e.prototype.nextInTree=function(t,e){var n=this,i=this.nextPositionInTree(t);if(!i||i.after)return Y.d(i);var o=Y.c("nextInTree");return this.setCurrent(i,!0,e).then(function(t){i.viewNode&&t||((i=i.modify()).after=!0,i.viewNode||(i.inline=!0)),n.dispatchEvent({type:"nextInTree",nodeContext:i}),o.finish(i)}),o.result()},e.prototype.addImageFetchers=function(t){if(t instanceof X.b)for(var e=t.values,n=0;n<e.length;n++)this.addImageFetchers(e[n]);else if(t instanceof X.l){var i=t.url;this.page.fetchers.push(Ue.b(new Image,i))}},e.prototype.applyComputedStyles=function(t,e){var n=e["background-image"];n&&this.addImageFetchers(n);var i=e.position===X.t.relative;for(var o in e)if(!Ci[o]){var r=e[o];(r=r.visit(new O.a(this.xmldoc.url,this.documentURLTransformer))).isNumeric()&&L.O(r.unit)&&(r=X.n(r,this.context)),q.s[o]||i&&q.t[o]?this.page.delayedItems.push(new q.d(t,o,r)):E.F(t,o,r.toString())}},e.prototype.applyPseudoelementStyle=function(t,e,n){if(!t.after){var i=this.sourceNode,o=(t.shadowContext?t.shadowContext.styler:this.styler).getStyle(i,!1),r=H.u(o,"_pseudos");if(r&&(o=r[e])){var a={};t.vertical=this.computeStyle(t.vertical,"rtl"===t.direction,o,a);var s=a.content;q.y(s)&&(s.visit(new q.c(n,this.context,s,this.exprContentListener)),delete a.content),this.applyComputedStyles(n,a)}}},e.prototype.peelOff=function(t,e){var n=Y.c("peelOff"),i=t.firstPseudo,o=t.offsetInNode,r=t.after;if(e>0){var a=t.viewNode.textContent;t.viewNode.textContent=a.substr(0,e),o+=e}else if(!r&&t.viewNode&&0==o){var s=t.viewNode.parentNode;s&&s.removeChild(t.viewNode)}for(var l=t.boxOffset+e,u=[];t.firstPseudo===i;)u.push(t),t=t.parent;var c=u.pop(),h=c.shadowSibling,p=this;return n.loop(function(){for(;u.length>0;){c=u.pop(),t=new q.k(c.sourceNode,t,l),0==u.length&&(t.offsetInNode=o,t.after=r),t.shadowType=c.shadowType,t.shadowContext=c.shadowContext,t.nodeShadow=c.nodeShadow,t.shadowSibling=c.shadowSibling?c.shadowSibling:h,h=null;var e=p.setCurrent(t,!1);if(e.isPending())return e}return Y.d(!1)}).then(function(){n.finish(t)}),n.result()},e.prototype.createElement=function(t,e){return t==E.a.XHTML?this.document.createElement(e):this.document.createElementNS(t,e)},e.prototype.applyFootnoteStyle=function(t,e,n){var i={},o=H.u(this.footnoteStyle,"_pseudos");if(t=this.computeStyle(t,e,this.footnoteStyle,i),o&&o.before){var r={},a=this.createElement(E.a.XHTML,"span");fi.f(a,"before"),n.appendChild(a),this.computeStyle(t,e,o.before,r),delete r.content,this.applyComputedStyles(a,r)}return delete i.content,this.applyComputedStyles(n,i),t},e.prototype.processFragmentedBlockEdge=function(t){t&&t.walkUpBlocks(function(t){var e=t.inheritedProps["box-decoration-break"];if(!e||"slice"===e){var n=t.viewNode;v.a(n instanceof Element),t.vertical?(E.F(n,"padding-left","0"),E.F(n,"border-left","none"),E.F(n,"border-top-left-radius","0"),E.F(n,"border-bottom-left-radius","0")):(E.F(n,"padding-bottom","0"),E.F(n,"border-bottom","none"),E.F(n,"border-bottom-left-radius","0"),E.F(n,"border-bottom-right-radius","0"))}})},e.prototype.convertLengthToPx=function(t,e,n){var i=t.num,o=t.unit;if(L.J(o)){for(var r=e;r&&1!==r.nodeType;)r=r.parentNode;v.a(r);var a=parseFloat(n.getElementComputedStyle(r)["font-size"]);return v.a(this.context),H.j(t,a,this.context).num}var s=this.context.queryUnitSize(o,!1);return s?i*s:t},e.prototype.isSameNodePositionStep=function(t,e){if(t.shadowContext){if(!e.shadowContext)return!1;var n=1===t.node.nodeType?t.node:t.node.parentElement,i=1===e.node.nodeType?e.node:e.node.parentElement;return t.shadowContext.owner===e.shadowContext.owner&&fi.d(n)===fi.d(i)}return t.node===e.node},e.prototype.isSameNodePosition=function(t,e){var n=this;return t.offsetInNode===e.offsetInNode&&t.after==e.after&&t.steps.length===e.steps.length&&t.steps.every(function(t,i){var o=e.steps[i];return n.isSameNodePositionStep(t,o)})},e.prototype.isPseudoelement=function(t){return!!fi.d(t)},e.SVG_URL_ATTRIBUTES=["color-profile","clip-path","cursor","filter","marker","marker-start","marker-end","marker-mid","fill","stroke","mask"],e}(E.c),Ni={a:"a",sub:"sub",sup:"sup",table:"table",tr:"tr",td:"td",th:"th",code:"code",body:"div",p:"p",v:"p",date:"p",emphasis:"em",strong:"strong",style:"span",strikethrough:"del"},Ci={"box-decoration-break":!0,"float-min-wrap-block":!0,"float-reference":!0,"flow-into":!0,"flow-linger":!0,"flow-options":!0,"flow-priority":!0,"footnote-policy":!0,page:!0},Si=function(){function t(t){this.layoutBox=t.layoutBox,this.window=t.window}return t.prototype.subtractOffsets=function(t,e){var n=e.left,i=e.top;return{left:t.left-n,top:t.top-i,right:t.right-n,bottom:t.bottom-i,width:t.width,height:t.height}},t.prototype.getRangeClientRects=function(t){var e=this,n=t.getClientRects(),i=this.layoutBox.getBoundingClientRect();return Array.from(n).map(function(t){return e.subtractOffsets(t,i)})},t.prototype.getElementClientRect=function(t){var e=t.getBoundingClientRect(),n=this.layoutBox.getBoundingClientRect();return this.subtractOffsets(e,n)},t.prototype.getElementComputedStyle=function(t){return this.window.getComputedStyle(t,null)},t}(),Ti=function(){function t(t,e,n,i,o){this.window=t,this.fontSize=e,this.document=t.document,this.root=n||this.document.body;var r=this.root.firstElementChild;r||((r=this.document.createElement("div")).setAttribute("data-vivliostyle-outer-zoom-box","true"),this.root.appendChild(r));var a=r.firstElementChild;a||((a=this.document.createElement("div")).setAttribute("data-vivliostyle-spread-container","true"),r.appendChild(a));var s=r.nextElementSibling;s||((s=this.document.createElement("div")).setAttribute("data-vivliostyle-layout-box","true"),this.root.appendChild(s)),this.outerZoomBox=r,this.contentContainer=a,this.layoutBox=s;var l=new Si(this).getElementComputedStyle(this.root);this.width=i||parseFloat(l.width)||t.innerWidth,this.height=o||parseFloat(l.height)||t.innerHeight}return t.prototype.resetZoom=function(){E.F(this.outerZoomBox,"width",""),E.F(this.outerZoomBox,"height",""),E.F(this.contentContainer,"width",""),E.F(this.contentContainer,"height",""),E.F(this.contentContainer,"transform","")},t.prototype.zoom=function(t,e,n){E.F(this.outerZoomBox,"width",t*n+"px"),E.F(this.outerZoomBox,"height",e*n+"px"),E.F(this.contentContainer,"width",t+"px"),E.F(this.contentContainer,"height",e+"px"),E.F(this.contentContainer,"transform","scale("+n+")")},t.prototype.clear=function(){for(var t=this.root;t.lastChild;)t.removeChild(t.lastChild)},t}(),xi="data-adapt-eloff",Ii=function(){function t(t,e,n){this.store=t,this.url=e,this.document=n,this.lang=null,this.totalOffset=-1,this.lastOffset=1,this.root=n.documentElement;var i=null,o=null;if(this.root.namespaceURI==E.a.XHTML){for(var r=this.root.firstChild;r;r=r.nextSibling)if(1==r.nodeType&&(s=r).namespaceURI==E.a.XHTML)switch(s.localName){case"head":o=s;break;case"body":i=s}this.lang=this.root.getAttribute("lang")}else if(this.root.namespaceURI==E.a.FB2){for(o=this.root,r=this.root.firstChild;r;r=r.nextSibling)1==r.nodeType&&(s=r).namespaceURI==E.a.FB2&&"body"==s.localName&&(i=s);var a=this.doc().child("FictionBook").child("description").child("title-info").child("lang").textContent();a.length>0&&(this.lang=a[0])}else if(this.root.namespaceURI==E.a.SSE)for(var s=this.root.firstElementChild;s;s=s.nextElementSibling){var l=s.localName;"meta"===l?o=s:"body"===l&&(i=s)}this.body=i,this.head=o,this.last=this.root,this.last.setAttribute(xi,"0")}return t.prototype.doc=function(){return new Oi([this.document])},t.prototype.getElementOffset=function(t){var e=t.getAttribute(xi);if(e)return parseInt(e,10);for(var n=this.lastOffset,i=this.last;i!=t;){var o=i.firstChild;if(!o)for(;!(o=i.nextSibling);)if(null==(i=i.parentNode))throw new Error("Internal error");i=o,1==o.nodeType?(o.setAttribute(xi,n.toString()),++n):n+=o.textContent.length}return this.lastOffset=n,this.last=t,n-1},t.prototype.getNodeOffset=function(t,e,n){var i=0,o=t,r=null;if(1==o.nodeType){if(!n)return this.getElementOffset(o)}else{if(i=e,!(r=o.previousSibling))return o=o.parentNode,i+=1,this.getElementOffset(o)+i;o=r}for(;;){for(;o.lastChild;)o=o.lastChild;if(1==o.nodeType)break;if(i+=o.textContent.length,!(r=o.previousSibling)){o=o.parentNode;break}o=r}return i+=1,this.getElementOffset(o)+i},t.prototype.getTotalOffset=function(){return this.totalOffset<0&&(this.totalOffset=this.getNodeOffset(this.root,0,!0)),this.totalOffset},t.prototype.getNodeByOffset=function(t){for(var e,n=this,i=this.root,o=function(){if((e=r.getElementOffset(i))>=t)return{value:i};var o=i.children;if(!o)return"break";var a=E.i(o.length,function(e){var i=o[e];return n.getElementOffset(i)>t});if(0==a)return"break";i=o[a-1]},r=this;;){var a=o();if("object"==typeof a)return a.value;if("break"===a)break}for(var s=e+1,l=i,u=l.firstChild||l.nextSibling,c=null;;){if(u){if(1==u.nodeType)break;if(c=l=u,(s+=u.textContent.length)>t)break}else if(!(l=l.parentNode))break;u=l.nextSibling}return c||i},t.prototype.buildIdMap=function(t){var e=t.getAttribute("id");e&&!this.idMap[e]&&(this.idMap[e]=t);var n=t.getAttributeNS(E.a.XML,"id");n&&!this.idMap[n]&&(this.idMap[n]=t);for(var i=t.firstElementChild;i;i=i.nextElementSibling)this.buildIdMap(i)},t.prototype.getElement=function(t){var e=t.match(/([^#]*)#(.+)$/);if(!e||e[1]&&e[1]!=this.url)return null;var n=e[2],i=this.document.getElementById(n);return!i&&this.document.getElementsByName&&(i=this.document.getElementsByName(n)[0]),i||(this.idMap||(this.idMap={},this.buildIdMap(this.document.documentElement)),i=this.idMap[n]),i},t}();function Pi(t,e,n){var i,o=n||new DOMParser;try{i=o.parseFromString(t,e)}catch(t){}if(!i)return null;var r=i.documentElement;if("parsererror"===r.localName)return null;for(var a=r.firstElementChild;a;a=a.nextElementSibling)if("parsererror"===a.localName)return null;return i}function Ai(t,e){var n=t.responseXML;if(!n){var i=new DOMParser,o=t.responseText;if(o){var r=function(t){var e=t.contentType;if(e){for(var n=Object.keys(Hn),i=0;i<n.length;i++)if(Hn[n[i]]===e)return e;if(e.match(/\+xml$/))return Hn.APPLICATION_XML}var o=t.url.match(/\.([^.\/]+)$/);if(o)switch(o[1]){case"html":case"htm":return Hn.TEXT_HTML;case"xhtml":case"xht":return Hn.APPLICATION_XHTML_XML;case"svg":case"svgz":return Hn.IMAGE_SVG_XML;case"opf":case"xml":return Hn.APPLICATION_XML}return null}(t);if((n=Pi(o,r||Hn.APPLICATION_XML,i))&&!r){var a=n.documentElement;"html"!==a.localName.toLowerCase()||a.namespaceURI?"svg"===a.localName.toLowerCase()&&n.contentType!==Hn.IMAGE_SVG_XML&&(n=Pi(o,Hn.IMAGE_SVG_XML,i)):n=Pi(o,Hn.TEXT_HTML,i)}n||(n=Pi(o,Hn.TEXT_HTML,i))}}var s=n?new Ii(e,t.url,n):null;return Y.d(s)}!function(t){t.TEXT_HTML="text/html",t.TEXT_XML="text/xml",t.APPLICATION_XML="application/xml",t.APPLICATION_XHTML_XML="application/xhtml_xml",t.IMAGE_SVG_XML="image/svg+xml"}(Hn||(Hn={}));var Ri=new(function(){function t(t){this.fn=t}return t.prototype.check=function(t){return this.fn(t)},t.prototype.withAttribute=function(e,n){var i=this;return new t(function(t){return i.check(t)&&1==t.nodeType&&t.getAttribute(e)==n})},t.prototype.withChild=function(e,n){var i=this;return new t(function(t){if(!i.check(t))return!1;var o=new Oi([t]);return o=o.child(e),n&&(o=o.predicate(n)),o.size()>0})},t}())(function(t){return!0}),Oi=function(){function t(t){this.nodes=t}return t.prototype.asArray=function(){return this.nodes},t.prototype.size=function(){return this.nodes.length},t.prototype.predicate=function(e){for(var n=[],i=0,o=this.nodes;i<o.length;i++){var r=o[i];e.check(r)&&n.push(r)}return new t(n)},t.prototype.forEachNode=function(e){for(var n=[],i=function(t){n.push(t)},o=0;o<this.nodes.length;o++)e(this.nodes[o],i);return new t(n)},t.prototype.forEach=function(t){for(var e=[],n=0;n<this.nodes.length;n++)e.push(t(this.nodes[n]));return e},t.prototype.forEachNonNull=function(t){for(var e=[],n=0;n<this.nodes.length;n++){var i=t(this.nodes[n]);null!=i&&e.push(i)}return e},t.prototype.child=function(t){return this.forEachNode(function(e,n){for(var i=e.firstChild;i;i=i.nextSibling)1==i.nodeType&&i.localName==t&&n(i)})},t.prototype.childElements=function(){return this.forEachNode(function(t,e){for(var n=t.firstChild;n;n=n.nextSibling)1==n.nodeType&&e(n)})},t.prototype.attribute=function(t){return this.forEachNonNull(function(e){return 1==e.nodeType?e.getAttribute(t):null})},t.prototype.textContent=function(){return this.forEach(function(t){return t.textContent})},t}(),Li=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),ki=new Ue.a(function(){var t=Y.c("uaStylesheetBase"),e=Me(),n=E.C("user-agent-base.css",E.D),i=new H.b(null,null,null,null,null,e,!0);return i.startStylesheet(z.g.USER_AGENT),H.G(i.cascade),z.k('@namespace html "http://www.w3.org/1999/xhtml";\n\nhtml|html, html|address, html|blockquote, html|body, html|dd, html|div,\nhtml|dl, html|dt, html|fieldset, html|form, html|frame, html|frameset,\nhtml|h1, html|h2, html|h3, html|h4, html|h5, html|h6, html|noframes,\nhtml|ol, html|p, html|ul, html|center, html|dir, html|hr, html|menu, html|pre,\nhtml|article, html|section, html|nav, html|aside, html|hgroup, html|footer, html|header,\nhtml|figure, html|figcaption, html|main {\n   display: block;\n   unicode-bidi: normal;\n}\nhtml|li {\n  display: list-item;\n}\nhtml|head {\n  display: none !important;\n}\nhtml|table {\n  display: table;\n}\nhtml|tr {\n  display: table-row;\n}\nhtml|thead {\n  display: table-header-group;\n  break-after: avoid;\n}\nhtml|tbody {\n  display: table-row-group;\n}\nhtml|tfoot {\n  display: table-footer-group;\n  break-before: avoid;\n}\nhtml|col {\n  display: table-column;\n}\nhtml|colgroup {\n  display: table-column-group;\n}\nhtml|td, html|th {\n  display: table-cell;\n}\nhtml|caption {\n  display: table-caption;\n  text-align: center;\n}\nhtml|th {\n  font-weight: bolder;\n  text-align: center;\n}\nhtml|script {\n  display: none;\n}\nhtml|body {\n  margin: 8px;\n}\nhtml|h1 {\n  font-size: 2em;\n  margin-block-start: 0.67em;\n  margin-block-end: 0.67em;\n  margin-inline-start: 0em;\n  margin-inline-end: 0em;\n}\nhtml|h2 {\n  font-size: 1.5em;\n  margin-block-start: 0.75em;\n  margin-block-end: 0.75em;\n  margin-inline-start: 0em;\n  margin-inline-end: 0em;\n}\nhtml|h3 {\n  font-size: 1.17em;\n  margin-block-start: 0.83em;\n  margin-block-end: 0.83em;\n  margin-inline-start: 0em;\n  margin-inline-end: 0em;\n}\nhtml|h4, html|p, html|blockquote, html|ul, html|fieldset,\nhtml|form, html|ol, html|dl, html|dir, html|menu, html|h5, html|h6 {\n  margin-block-start: 1em;\n  margin-block-end: 1em;\n  margin-inline-start: 0em;\n  margin-inline-end: 0em;\n}\nhtml|h5 {\n  font-size: .83em;\n}\nhtml|h6 {\n  font-size: .75em;\n}\nhtml|h1, html|h2, html|h3, html|h4, html|h5, html|h6, html|b, html|strong {\n  font-weight: bolder;\n}\nhtml|h1, html|h2, html|h3, html|h4, html|h5, html|h6 {\n  break-after: avoid;\n}\nhtml|blockquote {\n  margin-block-start: 0px;\n  margin-block-end: 0px;\n  margin-inline-start: 40px;\n  margin-inline-end: 40px;\n}\nhtml|i, html|cite, html|em, html|var, html|address {\n  font-style: italic;\n}\nhtml|pre, html|tt, html|code, html|kbd, html|samp {\n  font-family: monospace;\n}\nhtml|pre {\n  white-space: pre;\n}\nhtml|button, html|textarea, html|input, html|select {\n  display: inline-block;\n}\nhtml|big {\n  font-size: 1.17em;\n}\nhtml|small, html|sub, html|sup {\n  font-size: .83em;\n}\nhtml|sub {\n  vertical-align: sub;\n}\nhtml|sup {\n  vertical-align: super;\n}\nhtml|table {\n  border-spacing: 2px;\n}\nhtml|thead, html|tbody, html|tfoot {\n  vertical-align: middle;\n}\n/* for XHTML tables without tbody */\nhtml|table > html|tr {\n  vertical-align: middle;\n}\nhtml|td, html|th {\n  vertical-align: inherit;\n}\nhtml|s, html|strike, html|del {\n  text-decoration: line-through;\n}\nhtml|hr {\n  border: 1px inset;\n}\nhtml|ol, html|ul, html|dir, html|menu, html|dd {\n  margin: 0px;\n  margin-inline-start: 40px;\n}\nhtml|ol {\n  list-style-type: decimal;\n}\nhtml|ol html|ul, html|ul html|ol, html|ul html|ul, html|ol html|ol {\n  margin-top: 0;\n  margin-bottom: 0;\n}\nhtml|u, html|ins {\n  text-decoration: underline;\n}\nhtml|center {\n  text-align: center;\n}\nhtml|q:before {\n  content: open-quote;\n}\nhtml|q:after {\n  content: close-quote;\n}\n\nhtml|audio, html|video {\n  break-inside: avoid;\n}\n\nhtml|ruby {\n  display: ruby;\n}\nhtml|rp {\n  display: none;\n}\nhtml|rbc {\n  display: ruby-base-container;\n}\nhtml|rtc {\n  display: ruby-text-container;\n}\nhtml|rb {\n  display: ruby-base;\n  white-space: nowrap;\n}\nhtml|rt {\n  display: ruby-text;\n}\nhtml|ruby, html|rb, html|rt, html|rbc, html|rtc {\n  unicode-bidi: isolate;\n}\n\nhtml|rtc, html|rt {\n  font-variant-east-asian: ruby;\n  text-emphasis: none;\n  white-space: nowrap;\n  line-height: 1;\n}\n\nhtml|rtc:lang(zh), html|rt:lang(zh) {\n  ruby-align: center;\n}\n\nhtml|rtc, html|rt {\n  font-size: 50%;\n}\n\nhtml|rtc:lang(zh-TW), html|rt:lang(zh-TW) {\n  font-size: 30%;\n}\n\nhtml|rtc > html|rt, html|rtc > html|rt:lang(zh-TW) {\n  font-size: 100%;\n}\n\n/* Bidi settings */\nhtml|bdo[dir="ltr"] {\n  direction: ltr;\n  unicode-bidi: bidi-override;\n}\nhtml|bdo[dir="rtl"] {\n  direction: rtl;\n  unicode-bidi: bidi-override;\n}\nhtml|*[dir="ltr"] {\n  direction: ltr;\n  unicode-bidi: embed;\n}\nhtml|*[dir="rtl"] {\n  direction: rtl;\n  unicode-bidi: embed;\n}\n\n/*------------------ epub-specific ---------------------*/\n\n@namespace epub "http://www.idpf.org/2007/ops";\n\nhtml|a[epub|type="noteref"] {\n  font-size: 0.75em;\n  vertical-align: super;\n  line-height: 0.01;\n}\n\nhtml|a[epub|type="noteref"]:href-epub-type(footnote) {\n  -adapt-template: url(user-agent.xml#footnote);\n  text-decoration: none;\n}\n\nhtml|aside[epub|type="footnote"] {\n  display: none;\n}\n\nhtml|aside[epub|type="footnote"]:footnote-content {\n  display: block;\n  margin: 0.25em;\n  font-size: 1.2em;\n  line-height: 1.2;\n}\n\nepub|trigger {\n  display: none;\n}\n\nepub|switch {\n  display: inline;\n}\n\nepub|default {\n  display: inline;\n}\n\nepub|case {\n  display: none;\n}\n\nepub|case[required-namespace::supported] {\n  display: inline;\n}\n\nepub|case[required-namespace::supported] ~ epub|case {\n  display: none;\n}\n\nepub|case[required-namespace::supported] ~ epub|default {\n  display: none;\n}\n\n/*--------------- ncx and toc ----------------------*/\n\n@namespace ncx "http://www.daisy.org/z3986/2005/ncx/";\n\nncx|ncx {\n  display: block;\n  padding-top: 10px;\n  padding-bottom: 10px;\n}\n\nncx|content {\n  display: none;\n}\n\nbody > * {\n  -adapt-behavior: body-child;\n}\n\n[role=doc-toc], [role=directory], nav, .toc, #toc,\n#table-of-contents, #contents {\n  -adapt-behavior: toc-root;\n}\n\n[role=doc-toc] a,\n[role=directory] a,\nnav a,\n.toc a,\n#toc a,\nncx|navLabel {\n  -adapt-behavior: toc-node-anchor;\n}\n\n[role=doc-toc] li,\n[role=directory] li,\nnav li,\n.toc li,\n#toc li,\nncx|navPoint {\n  -adapt-behavior: toc-node;\n}\n\n[role=doc-toc] li > *:first-child,\n[role=directory] li > *:first-child,\nnav li > *:first-child,\n.toc li > *:first-child,\n#toc li > *:first-child {\n  -adapt-behavior: toc-node-first-child;\n}\n\n[role=doc-toc] ol,\n[role=directory] ol,\nnav ol,\n.toc ol,\n#toc ol,\n[role=doc-toc] ul,\n[role=directory] ul,\nnav ul,\n.toc ul,\n#toc ul,\nol[role=doc-toc],\nol[role=directory],\nol.toc,\nol#toc,\nul[role=doc-toc],\nul[role=directory],\nul.toc,\nul#toc {\n  -adapt-behavior: toc-container;\n}\n\n/*---------------- fb2 ---------------------*/\n\n@namespace fb2 "http://www.gribuser.ru/xml/fictionbook/2.0";\n\nfb2|FictionBook {\n  display: block;\n}\n\nfb2|body {\n  font-family: serif;\n  margin: 8px;\n  column-width: 25em;\n}\n\nfb2|a {\n  line-height: 0.1;\n  vertical-align: super;\n  font-size: 0.7em;\n}\n\nfb2|sub {\n  line-height: 0.1;\n  font-size: 0.7em;\n}\n\nfb2|sup {\n  line-height: 0.1;\n  font-size: 0.7em;\n}\n\nfb2|table {\n  display: table;\n  font-size: 0.8em;\n  font-family: sans-serif;\n  margin: 0.5em;\n  border-collapse: collapse;\n  border: 1px solid black;\n}\n\nfb2|td {\n  border: 1px solid black;\n  padding: 0.3em;\n}\n\nfb2|th {\n  font-weight: bold;\n  text-align: center;\n  border: 1px solid black;\n  background-color: #CEE;\n  padding: 0.3em;\n}\n\nfb2|code {\n  font-family: monospace;\n}\n\nfb2|p {\n  display: block;\n  margin: 0px;\n  text-indent: 1.5em;\n  text-align: justify;\n}\n\nfb2|title fb2|p {\n  margin: 0px 0px 0.5em 0px;\n  text-indent: 0px;\n  text-align: inherit;\n}\n\nfb2|title {\n  font-size: 2.2em;\n  font-weight: bold;\n  break-inside: avoid;\n  break-after: avoid;\n  text-align: center;\n  margin: 1em 0px 0.5em 0px;\n  display: block;\n}\n\nfb2|section {\n  display: block;\n}\n\nfb2|section fb2|title {\n  font-size: 1.8em;\n  text-align: center;\n  margin: 1em 0px 0.5em 0px;\n}\n\nfb2|section fb2|section fb2|title {\n  font-size: 1.5em;\n  text-align: left;\n  margin: 1em 0px 0.5em 1.5625em;\n}\n\nfb2|section fb2|section fb2|section fb2|title {\n  font-size: 1.3em;\n  text-align: left;\n  margin: 1em 0px 0.5em 1.923em;\n}\n\nfb2|section fb2|section fb2|section fb2|section fb2|title {\n  font-size: 1.2em;\n  text-align: left;\n  margin: 1em 0px 0.5em 2.083em;\n}\n\nfb2|section fb2|section fb2|section fb2|section fb2|section fb2|title {\n  font-size: 1.1em;\n  text-align: left;\n  margin: 1em 0px 0.5em 2.272em;\n}\n\nfb2|section fb2|section fb2|section fb2|section fb2|section fb2|section fb2|title {\n  text-align: left;\n  margin: 1em 0px 0.5em 2.5em;\n}\n\nfb2|epigraph {\n  text-align: left;\n  font-style: italic;\n  margin: 1em 1em 2em 30%;\n  display: block;\n}\n\nfb2|image {\n  text-align: center;\n  padding: 3px;\n}\n\nfb2|image::inner {\n  max-width: 95%;\n}\n\nfb2|image::after {\n  display: block;\n  content: attr(title);\n}\n\nfb2|v {\n  text-indent: -1em;\n  padding-left: 1em;\n  margin: 0px;\n  display: block;\n}\nfb2|poem {\n  margin: 0.5em 0px 0.5em 2em;\n  display: block;\n}\nfb2|date {\n  margin: 0.5em 0px 0.5em 50%;\n  font-style: italic;\n  display: block;\n}\nfb2|stanza {\n  margin: 0.5em 0px;\n  break-inside: avoid;\n  display: block;\n}\nfb2|empty-line {\n  height: 1em;\n  margin: 0px;\n  display: block;\n}\nfb2|cite {\n  margin: 0.5em 0px 0.5em 1em;\n  font-size: 0.95em;\n  display: block;\n}\nfb2|subtitle {\n  text-indent: 0px;\n  text-align: center;\n  font-style: italic;\n  font-weight: bold;\n  margin: 0.5em 2em;\n  break-inside: avoid;\n  break-after: avoid;\n  display: block;\n}\nfb2|annotation {\n  margin: 1em 0px 1em 2em;\n  text-indent: 0px;\n  font-style: italic;\n  display: block;\n}\nfb2|text-author {\n  text-indent: 0px;\n  margin: 0.2em 0px 0px 3em;\n  display: block;\n}\nfb2|emphasis {\n  font-style: italic;\n}\nfb2|strong {\n  font-weight: bold;\n}\nfb2|strikethrough {\n  text-decoration: line-through;\n}\nfb2|*.italic {\n  font-style: italic;\n}\nfb2|*.bold {\n  font-weight: bold;\n}\n\nfb2|binary, fb2|description, fb2|stylesheet {\n  display: none;\n}\n\nfb2|a[type="note"] {\n  font-size: 0.75em;\n  vertical-align: super;\n  line-height: 0.01;\n  text-decoration: none;\n  -adapt-template: url(user-agent.xml#footnote);\n}\n\nfb2|body[name="notes"] {\n  display: none;\n}\n\nfb2|body[name="notes"] fb2|title {\n  display: inline;\n  vertical-align: super;\n  line-height: 0.01;\n  text-align: left;\n  font-size: 0.75em;\n  font-weight: bold;\n  margin: 0px;\n}\n\nfb2|body[name="notes"] fb2|p {\n  text-indent: 0px;\n  display: inline;  /* for now */\n}\n\nfb2|body[name="notes"] fb2|p + fb2|p {\n  display: block;\n}\n\nfb2|body[name="notes"] fb2|section {\n  text-indent: 0px;\n  line-height: 1.2;\n  font-size: 1.2em;\n}\n',i,n,null,null).thenFinish(t),t.result()},"uaStylesheetBaseFetcher"),Fi=function(){function t(t,e,n,i,o,r,a,s,l,u){this.store=t,this.rootScope=e,this.pageScope=n,this.cascade=i,this.rootBox=o,this.fontFaces=r,this.footnoteProps=a,this.flowProps=s,this.viewportProps=l,this.pageProps=u,this.fontDeobfuscator=t.fontDeobfuscator,this.validatorSet=t.validatorSet,this.pageScope.defineBuiltIn("has-content",function(t){t=t;var e=this.currentLayoutPosition,n=e.firstFlowChunkOfFlow(t);return this.matchPageSide(e.startSideOfFlow(t))&&e.hasContent(t,this.lookupOffset)&&!!n&&!this.flowChunkIsAfterParentFlowForcedBreak(n)}),this.pageScope.defineName("page-number",new L.t(this.pageScope,function(){return this.pageNumberOffset+this.currentLayoutPosition.page},"page-number"))}return t.prototype.sizeViewport=function(t,e,n,i){if(this.viewportProps.length){var o=new L.g(this.rootScope,t,e,n),r=H.A(o,this.viewportProps),a=r.width,s=r.height,l=r["text-zoom"],u=1;if(a&&s||l){var c=L.G.em;if((l?l.evaluate(o,"text-zoom"):null)===X.t.scale&&(u=c/n,n=c,t*=u,e*=u),a&&s){var h=X.x(a.evaluate(o,"width"),o),p=X.x(s.evaluate(o,"height"),o);if(h>0&&p>0)return{width:i&&i.spreadView?2*(h+i.pageBorder):h,height:p,fontSize:n}}}}return{width:t,height:e,fontSize:n}},t}(),_i=function(t){function e(e,n,i,o,r,a,s,l,u,c,h,p){var f=t.call(this,e.rootScope,o.width,o.height,o.fontSize)||this;for(var d in f.style=e,f.xmldoc=n,f.viewport=o,f.clientLayout=r,f.fontMapper=a,f.customRenderer=s,f.fallbackMap=l,f.pageNumberOffset=u,f.documentURLTransformer=c,f.counterStore=h,f.primaryFlows={body:!0},f.rootPageBoxInstance=null,f.styler=null,f.stylerMap=null,f.currentLayoutPosition=null,f.layoutPositionAtPageStart=null,f.lookupOffset=0,f.pageBoxInstances={},f.pageManager=null,f.pageBreaks={},f.pageProgression=null,f.pageSheetSize={},f.pageSheetHeight=0,f.pageSheetWidth=0,f.lang=n.lang||i,f.faces=new Xe(f.style.fontDeobfuscator),f.rootPageFloatLayoutContext=new j.e(null,null,null,null,null,null,null),f.pageProgression=p||null,e.flowProps){var g=e.flowProps[d],m=H.s(g,"flow-consume");m&&(m.evaluate(f,"flow-consume")==X.t.all?f.primaryFlows[d]=!0:delete f.primaryFlows[d])}return f}return Li(e,t),e.prototype.init=function(){var t=this,e=Y.c("StyleInstance.init"),n=this.counterStore.createCounterListener(this.xmldoc.url),i=this.counterStore.createCounterResolver(this.xmldoc.url,this.style.rootScope,this.style.pageScope);this.styler=new he(this.xmldoc,this.style.cascade,this.style.rootScope,this,this.primaryFlows,this.style.validatorSet,n,i),i.setStyler(this.styler),this.styler.resetFlowChunkStream(this),this.stylerMap={},this.stylerMap[this.xmldoc.url]=this.styler;var o=this.styler.getTopContainerStyle();this.pageProgression||(this.pageProgression=Tn(o));var r=this.style.rootBox;this.rootPageBoxInstance=new gn(r);var a=this.style.cascade.createInstance(this,n,i,this.lang);this.rootPageBoxInstance.applyCascadeAndInit(a,o),this.rootPageBoxInstance.resolveAutoSizing(this),this.pageManager=new ei(a,this.style.pageScope,this.rootPageBoxInstance,this,o);for(var s=[],l=0,u=this.style.fontFaces;l<u.length;l++){var c=u[l];if(!c.condition||c.condition.evaluate(this)){var h=Ge(c.properties,this),p=new We(h);s.push(p)}}this.fontMapper.findOrLoadFonts(s,this.faces).thenFinish(e);var f=this.style.pageProps;return Object.keys(f).forEach(function(e){var n=Fn(kn(f[e]),t);t.pageSheetSize[e]={width:n.pageWidth+2*n.cropOffset,height:n.pageHeight+2*n.cropOffset}}),e.result()},e.prototype.getStylerForDoc=function(t){var e=this.stylerMap[t.url];if(!e){var n=this.style.store.getStyleForDoc(t),i=new L.g(n.rootScope,this.pageWidth(),this.pageHeight(),this.initialFontSize),o=this.counterStore.createCounterListener(t.url),r=this.counterStore.createCounterResolver(t.url,n.rootScope,n.pageScope);e=new he(t,n.cascade,n.rootScope,i,this.primaryFlows,n.validatorSet,o,r),this.stylerMap[t.url]=e}return e},e.prototype.registerInstance=function(t,e){this.pageBoxInstances[t]=e},e.prototype.lookupInstance=function(t){return this.pageBoxInstances[t]},e.prototype.encounteredFlowChunk=function(t,e){var n=this.currentLayoutPosition;if(n){n.flows[t.flowName]?e=n.flows[t.flowName]:n.flows[t.flowName]=e;var i=n.flowPositions[t.flowName];i||(i=new q.i,n.flowPositions[t.flowName]=i);var o=q.w(t.element),r=new q.a(o),a=new q.h(r,t);i.positions.push(a)}},e.prototype.getConsumedOffset=function(t){for(var e=Number.POSITIVE_INFINITY,n=0;n<t.positions.length;n++){for(var i=t.positions[n].chunkPosition.primary,o=i.steps[0].node,r=i.offsetInNode,a=i.after,s=0;o.ownerDocument!=this.xmldoc.document;)s++,o=i.steps[s].node,a=!1,r=0;var l=this.xmldoc.getNodeOffset(o,r,a);l<e&&(e=l)}return e},e.prototype.getPosition=function(t,e){if(!t)return 0;var n=Number.POSITIVE_INFINITY;for(var i in this.primaryFlows){var o=t.flowPositions[i];if(e||o&&0!=o.positions.length||!this.currentLayoutPosition||(this.styler.styleUntilFlowIsReached(i),o=this.currentLayoutPosition.flowPositions[i],t!=this.currentLayoutPosition&&o&&(o=o.clone(),t.flowPositions[i]=o)),o){var r=this.getConsumedOffset(o);r<n&&(n=r)}}return n},e.prototype.dumpLocation=function(t){for(var e in u.b.debug("Location - page",this.currentLayoutPosition.page),u.b.debug("  current:",t),u.b.debug("  lookup:",this.lookupOffset),this.currentLayoutPosition.flowPositions)for(var n=0,i=this.currentLayoutPosition.flowPositions[e].positions;n<i.length;n++){var o=i[n];u.b.debug("  Chunk",e+":",o.flowChunk.startOffset)}},e.prototype.matchPageSide=function(t){switch(t){case"left":case"right":case"recto":case"verso":return new L.s(this.style.pageScope,t+"-page").evaluate(this);default:return!0}},e.prototype.updateStartSide=function(t){for(var e in t.flowPositions){var n=t.flowPositions[e];if(n&&n.positions.length>0){var i=n.positions[0].flowChunk;if(this.getConsumedOffset(n)===i.startOffset){var o=n.positions[0].flowChunk.breakBefore,r=jt.e(n.startSide);n.startSide=jt.a(jt.d(r,o))}}}},e.prototype.selectPageMaster=function(t){var e=this.currentLayoutPosition,n=this.getPosition(e);if(n==Number.POSITIVE_INFINITY)return null;for(var i,o=this.rootPageBoxInstance.children,r=0;r<o.length;r++)if((i=o[r]).pageBox.pseudoName!==Wn){var a=1,s=i.getProp(this,"utilization");s&&s.isNum()&&(a=s.num);var l=this.queryUnitSize("em",!1),u=this.pageWidth()*this.pageHeight(),c=Math.ceil(a*u/(l*l));this.lookupOffset=this.styler.styleUntil(n,c),v.a(e),this.updateStartSide(e),this.layoutPositionAtPageStart=e.clone(),this.initLingering(),this.clearScope(this.style.pageScope);var h=i.getProp(this,"enabled");if(!h||h===X.t._true)return this.pageManager.getPageRulePageMaster(i,t)}throw new Error("No enabled page masters")},e.prototype.flowChunkIsAfterParentFlowForcedBreak=function(t){var e=this.layoutPositionAtPageStart.flows,n=e[t.flowName].parentFlowName;if(n){var i=t.startOffset,o=e[n].forcedBreakOffsets;if(!o.length||i<o[0])return!1;var r=E.i(o.length,function(t){return o[t]>i})-1,a=o[r],s=this.layoutPositionAtPageStart.flowPositions[n],l=this.getConsumedOffset(s);return!(a<l)&&(l<a||!this.matchPageSide(s.startSide))}return!1},e.prototype.setFormattingContextToColumn=function(t,e){var n=this.currentLayoutPosition.flows[e];n.formattingContext||(n.formattingContext=new it.a(null)),t.flowRootFormattingContext=n.formattingContext},e.prototype.layoutDeferredPageFloats=function(t){var e=t.pageFloatLayoutContext,n=e.getDeferredPageFloatContinuations(),i=Y.c("layoutDeferredPageFloats"),o=!1,r=0;return i.loopWithFrame(function(i){if(r!==n.length){var a=n[r++],s=a.float,l=(new j.f).findByFloat(s),u=l.findPageFloatFragment(s,e);if(!u||!u.hasFloat(s))return e.isForbidden(s)||e.hasPrecedingFloatsDeferredToNext(s)?(e.deferPageFloat(a),void i.breakLoop()):void t.layoutPageFloatInner(a,l,null,u).then(function(t){if(t){var n=e.parent.isInvalidated();n?i.breakLoop():(e.isInvalidated()&&!n&&(o=!0,e.validate()),i.continueLoop())}else i.breakLoop()});i.continueLoop()}else i.breakLoop()}).then(function(){o&&e.invalidate(),i.finish(!0)}),i.result()},e.prototype.getLastAfterPositionIfDeferredFloatsExists=function(t,e){if(t.pageFloatLayoutContext.getPageFloatContinuationsDeferredToNext().length>0){if(t.lastAfterPosition){var n=void 0;return e?(n=e.clone()).primary=t.lastAfterPosition:n=new q.a(t.lastAfterPosition),n}return v.a("column.lastAfterPosition === null"),null}return null},e.prototype.layoutColumn=function(t,e){var n=this.currentLayoutPosition.flowPositions[e];if(!n||!this.matchPageSide(n.startSide))return Y.d(!0);n.startSide="any",this.setFormattingContextToColumn(t,e),t.init(),this.primaryFlows[e]&&t.bands.length>0&&(t.forceNonfitting=!1);var i=this,o=Y.c("layoutColumn");return this.layoutDeferredPageFloats(t).then(function(){if(t.pageFloatLayoutContext.isInvalidated())o.finish(!0);else{var r=[],a=[],s=!0;o.loopWithFrame(function(o){if(t.pageFloatLayoutContext.hasContinuingFloatFragmentsInFlow(e))o.breakLoop();else{for(var l=function(){for(var e=0;a.includes(e);)e++;var l=n.positions[e];if(l.flowChunk.startOffset>i.lookupOffset||i.flowChunkIsAfterParentFlowForcedBreak(l.flowChunk))return"break";for(var u=e+1;u<n.positions.length;u++)if(!a.includes(u)){var c=n.positions[u];if(c.flowChunk.startOffset>i.lookupOffset||i.flowChunkIsAfterParentFlowForcedBreak(c.flowChunk))break;c.flowChunk.isBetter(l.flowChunk)&&(l=c,e=u)}var h=l.flowChunk,p=!0;return t.layout(l.chunkPosition,s,n.breakAfter).then(function(u){if(t.pageFloatLayoutContext.isInvalidated())o.breakLoop();else{if(s=!1,l.flowChunk.repeated&&(null===u||h.exclusive)&&r.push(e),h.exclusive)return a.push(e),void o.breakLoop();var c=!!u||!!t.pageBreakType,f=i.getLastAfterPositionIfDeferredFloatsExists(t,u);t.pageBreakType&&f?(l.chunkPosition=f,n.breakAfter=t.pageBreakType,t.pageBreakType=null):(a.push(e),(u||f)&&(l.chunkPosition=u||f,r.push(e)),t.pageBreakType&&(n.startSide=jt.a(t.pageBreakType))),c?o.breakLoop():(t.forceNonfitting=!1,p?p=!1:o.continueLoop())}}),p?(p=!1,{value:void 0}):void 0};n.positions.length-a.length>0;){var u=l();if("object"==typeof u)return u.value;if("break"===u)break}o.breakLoop()}}).then(function(){if(!t.pageFloatLayoutContext.isInvalidated()){n.positions=n.positions.filter(function(t,e){return r.includes(e)||!a.includes(e)}),"column"===n.breakAfter&&(n.breakAfter=null),t.saveDistanceToBlockEndFloats();var e=t.pageFloatLayoutContext.getMaxReachedAfterEdge();t.updateMaxReachedAfterEdge(e)}o.finish(!0)})}}),o.result()},e.prototype.createLayoutConstraint=function(t){var e=this.currentLayoutPosition.page-1,n=this.counterStore.createLayoutConstraint(e);return new Ye.a([n].concat(t.getLayoutConstraints()))},e.prototype.createAndLayoutColumn=function(t,e,n,i,o,r,a,s,l,u,c,h,p,f){var d,g=this,m=t.vertical?t.isAutoWidth&&t.isRightDependentOnAutoWidth:t.isAutoHeight&&t.isTopDependentOnAutoHeight,y=o.element,v=new j.e(s,j.a.COLUMN,null,a,null,null,null),b=g.currentLayoutPosition.clone(),w=Y.c("createAndLayoutColumn");return w.loopWithFrame(function(t){var w=g.createLayoutConstraint(v);if(l>1){var N=g.viewport.document.createElement("div");if(E.F(N,"position","absolute"),y.appendChild(N),(d=new Ye.b(N,p,g.clientLayout,w,v)).forceNonfitting=f,d.vertical=o.vertical,d.snapHeight=o.snapHeight,d.snapWidth=o.snapWidth,o.vertical){var C=r*(c+u)+o.paddingTop;d.setHorizontalPosition(o.paddingLeft,o.width),d.setVerticalPosition(C,c)}else{var S=r*(c+u)+o.paddingLeft;d.setVerticalPosition(o.paddingTop,o.height),d.setHorizontalPosition(S,c)}d.originX=e,d.originY=n}else(d=new Ye.b(y,p,g.clientLayout,w,v)).copyFrom(o);d.exclusions=m?[]:i.concat(),d.innerShape=h,v.setContainer(d),d.width>=0?g.layoutColumn(d,a).then(function(){v.isInvalidated()||v.finish(),d.pageFloatLayoutContext.isInvalidated()&&!s.isInvalidated()?(d.pageFloatLayoutContext.validate(),g.currentLayoutPosition=b.clone(),d.element!==y&&y.removeChild(d.element),t.continueLoop()):t.breakLoop()}):(v.finish(),t.breakLoop())}).then(function(){w.finish(d)}),w.result()},e.prototype.setPagePageFloatLayoutContextContainer=function(t,e,n){(e instanceof Jn||e instanceof mn&&!(e instanceof Kn))&&t.setContainer(n)},e.prototype.getRegionPageFloatLayoutContext=function(t,e,n,i){v.a(e instanceof vn);var o=e.getProp(this,"writing-mode")||null,r=e.getProp(this,"direction")||null;return new j.e(t,j.a.REGION,n,i,null,o,r)},e.prototype.layoutFlowColumnsWithBalancing=function(t,e,n,i,o,r,a,s,l){var u=this,c=u.currentLayoutPosition.clone(),h=u.getRegionPageFloatLayoutContext(r,e,a,s),p=!0;function f(){return u.currentLayoutPosition=c.clone(),u.layoutFlowColumns(t,e,n,i,o,r,h,a,s,l,p).thenAsync(function(t){return t?Y.d({columns:t,position:u.currentLayoutPosition}):Y.d(null)})}return f().thenAsync(function(t){if(!t)return Y.d(null);if(l<=1)return Y.d(t.columns);var n=e.getProp(u,"column-fill")||X.t.balance,i=u.currentLayoutPosition.flowPositions[s];v.a(i);var o=function(t,e,n,i,o,r,a){if(e===X.t.auto)return null;var s=0===a.positions.length,l=r[r.length-1],u=!(!l||!l.pageBreakType);return s||u?new ne(n,i,o,t):e===X.t.balance_all?new re(n,i,o):(v.a(e===X.t.balance),null)}(l,n,f,h,a,t.columns,i);return o?(p=!1,r.lock(),h.lock(),o.balanceColumns(t).thenAsync(function(t){return r.unlock(),r.validate(),h.unlock(),u.currentLayoutPosition=t.position,Y.d(t.columns)})):Y.d(t.columns)})},e.prototype.layoutFlowColumns=function(t,e,n,i,o,r,a,s,l,u,c){var h=this,p=Y.c("layoutFlowColumns"),f=h.currentLayoutPosition.clone(),d=e.getPropAsNumber(h,"column-gap"),g=u>1?e.getPropAsNumber(h,"column-width"):s.width,m=e.getActiveRegions(h),y=e.getProp(h,"shape-inside"),v=O.e(y,0,0,s.width,s.height,h),E=new wi(l,h,h.viewport,h.styler,m,h.xmldoc,h.faces,h.style.footnoteProps,h,t,h.customRenderer,h.fallbackMap,this.documentURLTransformer),b=0,w=null,N=[];return p.loopWithFrame(function(t){h.createAndLayoutColumn(e,n,i,o,s,b++,l,a,u,d,g,v,E,c).then(function(e){return r.isInvalidated()?(N=null,void t.breakLoop()):(!(e.pageBreakType&&"column"!==e.pageBreakType)&&b!==u||a.isInvalidated()||a.finish(),a.isInvalidated()?(b=0,h.currentLayoutPosition=f.clone(),a.validate(),void(a.isLocked()?(N=null,t.breakLoop()):t.continueLoop())):(w=e,N[b-1]=w,w.pageBreakType&&"column"!=w.pageBreakType&&(b=u,"region"!=w.pageBreakType&&(h.pageBreaks[l]=!0)),void(b<u?t.continueLoop():t.breakLoop())))})}).then(function(){p.finish(N)}),p.result()},e.prototype.layoutContainer=function(t,e,n,i,o,r,a){var s=this;e.reset();var l=e.getProp(s,"enabled");if(l&&l!==X.t._true)return Y.d(!0);var u=Y.c("layoutContainer"),c=e.getProp(s,"wrap-flow")===X.t.auto,h=e.getProp(s,"flow-from"),p=s.viewport.document.createElement("div"),f=e.getProp(s,"position");E.F(p,"position",f?f.name:"absolute"),n.insertBefore(p,n.firstChild);var d,g=new q.b(p);g.vertical=e.vertical,g.exclusions=r,e.prepareContainer(s,g,t,s.faces,s.clientLayout),g.originX=i,g.originY=o,i+=g.left+g.marginLeft+g.borderLeft,o+=g.top+g.marginTop+g.borderTop,this.setPagePageFloatLayoutContextContainer(a,e,g);var m=!1;if(h&&h.isIdent())if(s.pageBreaks[h.toString()])a.isInvalidated()||e.finishContainer(s,g,t,null,1,s.clientLayout,s.faces),d=Y.d(!0);else{var y=Y.c("layoutContainer.inner"),b=h.toString(),w=e.getPropAsNumber(s,"column-count");s.layoutFlowColumnsWithBalancing(t,e,i,o,r,a,g,b,w).then(function(n){if(!a.isInvalidated()){var i=n[0];v.a(i),i.element===p&&(g=i),g.computedBlockSize=Math.max.apply(null,n.map(function(t){return t.computedBlockSize})),e.finishContainer(s,g,t,i,w,s.clientLayout,s.faces);var o=s.currentLayoutPosition.flowPositions[b];o&&"region"===o.breakAfter&&(o.breakAfter=null)}y.finish(!0)}),d=y.result()}else{var N=e.getProp(s,"content");if(N&&q.y(N)){var C="span";N.url&&(C="img");var S=s.viewport.document.createElement(C);N.visit(new q.c(S,s,N,s.counterStore.getExprContentListener())),p.appendChild(S),"img"==C&&e.transferSinglUriContentProps(s,S,s.faces),e.transferContentProps(s,g,t,s.faces)}else e.suppressEmptyBoxGeneration&&(n.removeChild(p),m=!0);m||e.finishContainer(s,g,t,null,1,s.clientLayout,s.faces),d=Y.d(!0)}return d.then(function(){if(a.isInvalidated())u.finish(!0);else{if(!e.isAutoHeight||Math.floor(g.computedBlockSize)>0){if(!m&&!c){var l=e.getProp(s,"shape-outside"),h=g.getOuterShape(l,s);r.push(h)}}else if(0==e.children.length)return n.removeChild(p),void u.finish(!0);var f=e.children.length-1;u.loop(function(){for(;f>=0;){var n=e.children[f--],l=s.layoutContainer(t,n,p,i,o,r,a);if(l.isPending())return l.thenAsync(function(){return Y.d(!a.isInvalidated())});if(a.isInvalidated())break}return Y.d(!1)}).then(function(){u.finish(!0)})}}),u.result()},e.prototype.processLinger=function(){var t=this.currentLayoutPosition.page;for(var e in this.currentLayoutPosition.flowPositions)for(var n=this.currentLayoutPosition.flowPositions[e],i=n.positions.length-1;i>=0;i--){var o=n.positions[i];o.flowChunk.startPage>=0&&o.flowChunk.startPage+o.flowChunk.linger-1<=t&&n.positions.splice(i,1)}},e.prototype.initLingering=function(){var t=this.currentLayoutPosition.page;for(var e in this.currentLayoutPosition.flowPositions)for(var n=this.currentLayoutPosition.flowPositions[e],i=n.positions.length-1;i>=0;i--){var o=n.positions[i];o.flowChunk.startPage<0&&o.flowChunk.startOffset<this.lookupOffset&&(o.flowChunk.startPage=t)}},e.prototype.noMorePrimaryFlows=function(t){for(var e in this.primaryFlows){var n=t.flowPositions[e];if(n&&n.positions.length>0)return!1}return!0},e.prototype.layoutNextPage=function(t,e){var n=this,i=t.container===t.bleedBox;n.pageBreaks={},e?(n.currentLayoutPosition=e.clone(),n.styler.replayFlowElementsFromOffset(e.highestSeenOffset)):(n.currentLayoutPosition=new q.j,n.styler.replayFlowElementsFromOffset(-1)),this.lang&&t.bleedBox.setAttribute("lang",this.lang),(e=n.currentLayoutPosition).page++,n.clearScope(n.style.pageScope),n.layoutPositionAtPageStart=e.clone();var r=i?{}:n.pageManager.getCascadedPageStyle(),a=n.selectPageMaster(r);if(!a)return Y.d(null);var s=0;if(!i){t.setAutoPageWidth(a.pageBox.specified.width.value===X.q),t.setAutoPageHeight(a.pageBox.specified.height.value===X.p),n.counterStore.setCurrentPage(t),n.counterStore.updatePageCounters(r,n);var l=Fn(kn(r),this);n.setPageSizeAndBleed(l,t),function(t,e,n,i){var o=!1,r=!1,a=t.marks;if(a){var s=a.value;s.isSpaceList()?s.values.forEach(function(t){t===X.t.crop?o=!0:t===X.t.cross&&(r=!0)}):s===X.t.crop?o=!0:s===X.t.cross&&(r=!0)}if(o||r){var l=n.container,u=l.ownerDocument;v.a(u);var c=e.bleed,h=X.x(An,i),p=X.x(Rn,i),f=X.x(On,i);if(c){var d=t["background-color"];d&&d.value&&(n.bleedBox.style.backgroundColor=d.value.stringValue())}o&&Object.keys(xn).forEach(function(t){var e=xn[t],n=function(t,e,n,i,o,r){var a=i;a<=o+2*L.G.mm&&(a=o+i/2);var s=Math.max(i,a),l=o+s+n/2,u=_n(t,l,l),c=[[0,o+i],[i,o+i],[i,o+i-a]],h=c.map(function(t){return[t[1],t[0]]});e!==xn.TOP_RIGHT&&e!==xn.BOTTOM_RIGHT||(c=c.map(function(t){return[o+s-t[0],t[1]]}),h=h.map(function(t){return[o+s-t[0],t[1]]})),e!==xn.BOTTOM_LEFT&&e!==xn.BOTTOM_RIGHT||(c=c.map(function(t){return[t[0],o+s-t[1]]}),h=h.map(function(t){return[t[0],o+s-t[1]]}));var p=Dn(t,n);p.setAttribute("points",c.map(function(t){return t.join(",")}).join(" ")),u.appendChild(p);var f=Dn(t,n);return f.setAttribute("points",h.map(function(t){return t.join(",")}).join(" ")),u.appendChild(f),e.split(" ").forEach(function(t){u.style[t]=r+"px"}),u}(u,e,h,f,c,p);l.appendChild(n)}),r&&Object.keys(In).forEach(function(t){var e=In[t],n=function(t,e,n,i,o){var r,a,s=2*i;e===In.TOP||e===In.BOTTOM?(r=s,a=i):(r=i,a=s);var l=_n(t,r,a),u=Dn(t,n);u.setAttribute("points","0,"+a/2+" "+r+","+a/2),l.appendChild(u);var c=Dn(t,n);c.setAttribute("points",r/2+",0 "+r/2+","+a),l.appendChild(c);var h,p=Dn(t,n,"circle");switch(p.setAttribute("cx",r/2),p.setAttribute("cy",a/2),p.setAttribute("r",i/4),l.appendChild(p),e){case In.TOP:h=In.BOTTOM;break;case In.BOTTOM:h=In.TOP;break;case In.LEFT:h=In.RIGHT;break;case In.RIGHT:h=In.LEFT}return Object.keys(In).forEach(function(t){var n=In[t];n===e?l.style[n]=o+"px":n!==h&&(l.style[n]="0",l.style["margin-"+n]="auto")}),l}(u,e,h,f,p);l.appendChild(n)})}}(r,l,t,this),s=l.bleedOffset+l.bleed}var u=!i&&a.getProp(n,"writing-mode")||X.t.horizontal_tb;this.pageVertical=u!=X.t.horizontal_tb;var c=a.getProp(n,"direction")||X.t.ltr,h=new j.e(n.rootPageFloatLayoutContext,j.a.PAGE,null,null,null,u,c),p=Y.c("layoutNextPage");return p.loopWithFrame(function(e){n.layoutContainer(t,a,t.bleedBox,s,s,[],h).then(function(){h.isInvalidated()||h.finish(),h.isInvalidated()?(n.currentLayoutPosition=n.layoutPositionAtPageStart.clone(),h.validate(),e.continueLoop()):e.breakLoop()})}).then(function(){if(a.adjustPageLayout(n,t,n.clientLayout),!i){var r=new L.s(a.pageBox.scope,"left-page");t.side=r.evaluate(n)?o.LEFT:o.RIGHT,n.processLinger(),e=n.currentLayoutPosition,Object.keys(e.flowPositions).forEach(function(t){var i=e.flowPositions[t],o=i.breakAfter;!o||"page"!==o&&n.matchPageSide(o)||(i.breakAfter=null)})}n.currentLayoutPosition=n.layoutPositionAtPageStart=null,e.highestSeenOffset=n.styler.getReachedOffset();var s=n.style.store.getTriggersForDoc(n.xmldoc);t.finish(s,n.clientLayout),n.noMorePrimaryFlows(e)&&(e=null),p.finish(e)}),p.result()},e.prototype.setPageSizeAndBleed=function(t,e){this.actualPageWidth=t.pageWidth,this.actualPageHeight=t.pageHeight,this.pageSheetWidth=t.pageWidth+2*t.cropOffset,this.pageSheetHeight=t.pageHeight+2*t.cropOffset,e.container.style.width=this.pageSheetWidth+"px",e.container.style.height=this.pageSheetHeight+"px",e.bleedBox.style.left=t.bleedOffset+"px",e.bleedBox.style.right=t.bleedOffset+"px",e.bleedBox.style.top=t.bleedOffset+"px",e.bleedBox.style.bottom=t.bleedOffset+"px",e.bleedBox.style.padding=t.bleed+"px",e.bleedBox.style.paddingTop=t.bleed+.01+"px"},e}(L.g),Di=function(t){function e(e,n,i,o){var r=t.call(this,e.rootScope,e,n,i,o,e.validatorSet,!i)||this;return r.masterHandler=e,r.insideRegion=!1,r}return Li(e,t),e.prototype.startPageTemplateRule=function(){},e.prototype.startPageMasterRule=function(t,e,n){var i=new Je(this.masterHandler.pageScope,t,e,n,this.masterHandler.rootBox,this.condition,this.owner.getBaseSpecificity());this.masterHandler.pushHandler(new Nn(i.scope,this.masterHandler,i,this.validatorSet))},e.prototype.startWhenRule=function(t){var n=t.expr;null!=this.condition&&(n=L.D(this.scope,this.condition,n)),this.masterHandler.pushHandler(new e(this.masterHandler,n,this,this.regionId))},e.prototype.startDefineRule=function(){this.masterHandler.pushHandler(new H.f(this.scope,this.owner))},e.prototype.startFontFaceRule=function(){var t={};this.masterHandler.fontFaces.push({properties:t,condition:this.condition}),this.masterHandler.pushHandler(new H.h(this.scope,this.owner,null,t,this.masterHandler.validatorSet))},e.prototype.startFlowRule=function(t){var e=this.masterHandler.flowProps[t];e||(e={},this.masterHandler.flowProps[t]=e),this.masterHandler.pushHandler(new H.h(this.scope,this.owner,null,e,this.masterHandler.validatorSet))},e.prototype.startViewportRule=function(){var t={};this.masterHandler.viewportProps.push(t),this.masterHandler.pushHandler(new H.h(this.scope,this.owner,this.condition,t,this.masterHandler.validatorSet))},e.prototype.startFootnoteRule=function(t){var e=this.masterHandler.footnoteProps;if(t){var n=H.q(e,"_pseudos");(e=n[t])||(e={},n[t]=e)}this.masterHandler.pushHandler(new H.h(this.scope,this.owner,null,e,this.masterHandler.validatorSet))},e.prototype.startRegionRule=function(){this.insideRegion=!0,this.startSelectorRule()},e.prototype.startPageRule=function(){var t=new ui(this.masterHandler.pageScope,this.masterHandler,this,this.validatorSet,this.masterHandler.pageProps);this.masterHandler.pushHandler(t),t.startPageRule()},e.prototype.startRuleBody=function(){if(H.b.prototype.startRuleBody.call(this),this.insideRegion){this.insideRegion=!1;var t="R"+this.masterHandler.regionCount++;this.special("region-id",X.r(t)),this.endRule();var n=new e(this.masterHandler,this.condition,this,t);this.masterHandler.pushHandler(n),n.startRuleBody()}},e}(H.b);function Bi(t){var e=t.getAttribute("content");if(!e)return"";for(var n,i={};null!=(n=e.match(/^,?\s*([-A-Za-z_.][-A-Za-z_0-9.]*)\s*=\s*([-+A-Za-z_0-9.]*)\s*/));)e=e.substr(n[0].length),i[n[1]]=n[2];var o=i.width-0,r=i.height-0;return o&&r?"@-epubx-viewport{width:"+o+"px;height:"+r+"px;}":""}var Mi=function(t){function e(e){var n=t.call(this)||this;return n.validatorSet=e,n.regionCount=0,n.fontFaces=[],n.footnoteProps={},n.flowProps={},n.viewportProps=[],n.pageProps={},n.rootScope=new L.m(null),n.pageScope=new L.m(n.rootScope),n.rootBox=new Ze(n.rootScope),n.cascadeParserHandler=new Di(n,null,null,null),n.slave=n.cascadeParserHandler,n}return Li(e,t),e.prototype.error=function(t,e){u.b.warn("CSS parser:",t)},e}(z.a);function Ui(t,e){return e.parseOPSResource(t)}var Vi=function(t){function e(e){var n=t.call(this,Ui,W.b.DOCUMENT)||this;return n.fontDeobfuscator=e,n.styleByKey={},n.styleFetcherByKey={},n.styleByDocURL={},n.triggersByDocURL={},n.validatorSet=null,n.styleSheets=[],n.triggerSingleDocumentPreprocessing=!1,n}return Li(e,t),e.prototype.init=function(t,e){var n=this;this.setStyleSheets(t,e);var i=E.C("user-agent.xml",E.D),o=Y.c("OPSDocStore.init");return this.validatorSet=Me(),ki.get().then(function(){n.load(i).then(function(){n.triggerSingleDocumentPreprocessing=!0,o.finish(!0)})}),o.result()},e.prototype.getStyleForDoc=function(t){return this.styleByDocURL[t.url]},e.prototype.getTriggersForDoc=function(t){return this.triggersByDocURL[t.url]},e.prototype.setStyleSheets=function(t,e){this.clearStyleSheets(),t&&t.forEach(this.addAuthorStyleSheet,this),e&&e.forEach(this.addUserStyleSheet,this)},e.prototype.clearStyleSheets=function(){this.styleSheets.splice(0)},e.prototype.addAuthorStyleSheet=function(t){var e=t.url;e&&(e=E.C(E.n(e),E.h)),this.styleSheets.push({url:e,text:t.text,flavor:z.g.AUTHOR,classes:null,media:null})},e.prototype.addUserStyleSheet=function(t){var e=t.url;e&&(e=E.C(E.n(e),E.h)),this.styleSheets.push({url:e,text:t.text,flavor:z.g.USER,classes:null,media:null})},e.prototype.parseOPSResource=function(t){var e=Y.c("OPSDocStore.load"),n=this,i=t.url,o=i.endsWith("?viv-toc-box");return Ai(t,n).then(function(t){if(t){if(n.triggerSingleDocumentPreprocessing)for(var r=l.b(l.a.PREPROCESS_SINGLE_DOCUMENT),a=0;a<r.length;a++)try{r[a](t.document)}catch(t){u.b.warn("Error during single document preprocessing:",t)}var s=[],c=t.document.getElementsByTagNameNS(E.a.epub,"trigger");for(a=0;a<c.length;a++){var h=c[a],p=h.getAttributeNS(E.a.EV,"observer"),f=h.getAttributeNS(E.a.EV,"event"),d=h.getAttribute("action"),g=h.getAttribute("ref");p&&f&&d&&g&&s.push({observer:p,event:f,action:d,ref:g})}n.triggersByDocURL[i]=s;var m=[],y=E.C("user-agent-page.css",E.D);m.push({url:y,text:'@namespace html "http://www.w3.org/1999/xhtml";\n@namespace fb2 "http://www.gribuser.ru/xml/fictionbook/2.0";\n\nhtml|body, fb2|body {\n  hyphens: -epubx-expr(pref-hyphenate?"auto":"manual");\n}\n\n@-adapt-footnote-area {\n  display: block;\n  margin-block-start: 0.5em;\n  margin-block-end: 0.5em;\n}\n\n@-adapt-footnote-area ::before {\n  display: block;\n  border-block-start-width: 1px;\n  border-block-start-style: solid;\n  border-block-start-color: black;\n  margin-block-end: 0.4em;\n  margin-inline-start: 0;\n  margin-inline-end: 60%;\n}\n\n/* default page master */\n@-epubx-page-master :background-host {\n  @-epubx-partition :layout-host {\n    -epubx-flow-from: body;\n    top: -epubx-expr(header.margin-bottom-edge);\n    bottom: -epubx-expr(page-height - footer.margin-top-edge);\n    left: 0px;\n    right: 0px;\n    column-width: 25em;\n  }\n  @-epubx-partition footer :oeb-page-foot {\n    writing-mode: horizontal-tb;\n    -epubx-flow-from: oeb-page-foot;\n    bottom: 0px;\n    left: 0px;\n    right: 0px;\n  }\n  @-epubx-partition header :oeb-page-head {\n    writing-mode: horizontal-tb;\n    -epubx-flow-from: oeb-page-head;\n    top: 0px;\n    left: 0px;\n    right: 0px;\n  }\n}\n\n@page {\n  @top-left-corner {\n    text-align: right;\n    vertical-align: middle;\n  }\n  @top-left {\n    text-align: left;\n    vertical-align: middle;\n  }\n  @top-center {\n    text-align: center;\n    vertical-align: middle;\n  }\n  @top-right {\n    text-align: right;\n    vertical-align: middle;\n  }\n  @top-right-corner {\n    text-align: left;\n    vertical-align: middle;\n  }\n  @left-top {\n    text-align: center;\n    vertical-align: top;\n  }\n  @left-middle {\n    text-align: center;\n    vertical-align: middle;\n  }\n  @left-bottom {\n    text-align: center;\n    vertical-align: bottom;\n  }\n  @right-top {\n    text-align: center;\n    vertical-align: top;\n  }\n  @right-middle {\n    text-align: center;\n    vertical-align: middle;\n  }\n  @right-bottom {\n    text-align: center;\n    vertical-align: bottom;\n  }\n  @bottom-left-corner {\n    text-align: right;\n    vertical-align: middle;\n  }\n  @bottom-left {\n    text-align: left;\n    vertical-align: middle;\n  }\n  @bottom-center {\n    text-align: center;\n    vertical-align: middle;\n  }\n  @bottom-right {\n    text-align: right;\n    vertical-align: middle;\n  }\n  @bottom-right-corner {\n    text-align: left;\n    vertical-align: middle;\n  }\n}\n\n@media print {\n  @page {\n    margin: 10%;\n  }\n}\n',flavor:z.g.USER_AGENT,classes:null,media:null});var v=t.head;if(!o&&v)for(var b=v.firstChild;b;b=b.nextSibling)if(1==b.nodeType){var w=b,N=w.namespaceURI,C=w.localName;if(N==E.a.XHTML)if("style"==C){var S=w.getAttribute("class"),T=w.getAttribute("media"),x=w.getAttribute("title");m.push({url:i,text:w.textContent,flavor:z.g.AUTHOR,classes:x?S:null,media:T})}else if("link"==C){var I=w.getAttribute("rel");if(S=w.getAttribute("class"),T=w.getAttribute("media"),"stylesheet"==I||"alternate stylesheet"==I&&S){var P=w.getAttribute("href");P=E.C(P,i),x=w.getAttribute("title"),m.push({url:P,text:null,classes:x?S:null,media:T,flavor:z.g.AUTHOR})}}else"meta"==C&&"viewport"==w.getAttribute("name")&&m.push({url:i,text:Bi(w),flavor:z.g.AUTHOR,classes:null,media:null});else if(N==E.a.FB2)"stylesheet"==C&&"text/css"==w.getAttribute("type")&&m.push({url:i,text:w.textContent,flavor:z.g.AUTHOR,classes:null,media:null});else if(N==E.a.SSE&&"property"===C){var A=w.getElementsByTagName("name")[0];if(A&&"stylesheet"===A.textContent){var R=w.getElementsByTagName("value")[0];R&&(P=E.C(R.textContent,i),m.push({url:P,text:null,classes:null,media:null,flavor:z.g.AUTHOR}))}}}if(!o)for(a=0;a<n.styleSheets.length;a++)m.push(n.styleSheets[a]);var O="";for(a=0;a<m.length;a++)O+=m[a].url,O+="^",m[a].text&&(O+=m[a].text),O+="^";var L=n.styleByKey[O];if(L)return n.styleByDocURL[i]=L,void e.finish(t);var k=n.styleFetcherByKey[O];k||(k=new Ue.a(function(){var t=Y.c("fetchStylesheet"),e=0,i=new Mi(n.validatorSet);return t.loop(function(){if(e<m.length){var t=m[e++];return i.startStylesheet(t.flavor),null!==t.text?z.k(t.text,i,t.url,t.classes,t.media).thenReturn(!0):z.l(t.url,i,t.classes,t.media)}return Y.d(!1)}).then(function(){var e=i.cascadeParserHandler.finish();L=new Fi(n,i.rootScope,i.pageScope,e,i.rootBox,i.fontFaces,i.footnoteProps,i.flowProps,i.viewportProps,i.pageProps),n.styleByKey[O]=L,delete n.styleFetcherByKey[O],t.finish(L)}),t.result()},"FetchStylesheet "+i),n.styleFetcherByKey[O]=k,k.start()),k.get().then(function(o){n.styleByDocURL[i]=o,e.finish(t)})}else e.finish(null)}),e.result()},e}(W.a);function Hi(t){return String.fromCharCode(t>>>24&255,t>>>16&255,t>>>8&255,255&t)}function zi(t){return(255&t.charCodeAt(0))<<24|(255&t.charCodeAt(1))<<16|(255&t.charCodeAt(2))<<8|255&t.charCodeAt(3)}function Gi(t){var e=new E.d;e.append(t);var n=55-t.length&63;for(e.append("");n>0;)n--,e.append("\0");e.append("\0\0\0\0"),e.append(Hi(8*t.length)),t=e.toString();for(var i,o=[1732584193,4023233417,2562383102,271733878,3285377520],r=[],a=0;a<t.length;a+=64){for(i=0;i<16;i++)r[i]=zi(t.substr(a+4*i,4));for(;i<80;i++){var s=r[i-3]^r[i-8]^r[i-14]^r[i-16];r[i]=s<<1|s>>>31}var l=o[0],u=o[1],c=o[2],h=o[3],p=o[4],f=void 0;for(i=0;i<80;i++)f=i<20?1518500249+(u&c|~u&h):i<40?1859775393+(u^c^h):i<60?2400959708+(u&c|u&h|c&h):3395469782+(u^c^h),f+=(l<<5|l>>>27)+p+r[i],p=h,h=c,c=u<<30|u>>>2,u=l,l=f;o[0]=o[0]+l|0,o[1]=o[1]+u|0,o[2]=o[2]+c|0,o[3]=o[3]+h|0,o[4]=o[4]+p|0}return o}var Wi="▸",Xi="▾",ji=function(){function t(t,e,n,i,o,r,a,s,l,u){this.store=t,this.url=e,this.lang=n,this.clientLayout=i,this.fontMapper=o,this.rendererFactory=a,this.fallbackMap=s,this.documentURLTransformer=l,this.counterStore=u,this.page=null,this.instance=null,this.pref=L.E(r),this.pref.spreadView=!1}return t.prototype.setAutoHeight=function(t,e){if(0!=e--)for(var n=t.firstChild;n;n=n.nextSibling)if(1==n.nodeType){var i=n;"auto"!=E.t(i,"height","auto")&&(E.F(i,"height","auto"),this.setAutoHeight(i,e)),"absolute"==E.t(i,"position","static")&&(E.F(i,"position","relative"),this.setAutoHeight(i,e))}},t.prototype.makeCustomRenderer=function(t){var e=this.rendererFactory.makeCustomRenderer(t);return function(t,n,i){var o=i.behavior;if(o)switch(o.toString()){case"body-child":t.parentElement.getAttribute("data-vivliostyle-primary-entry")&&(t.querySelector("[role=doc-toc], [role=directory], nav li a, .toc, #toc")||(i.display=X.t.none));break;case"toc-node-anchor":i.color=X.t.inherit,i["text-decoration"]=X.t.none;break;case"toc-node":i.display=X.t.block,i.margin=X.u,i.padding=X.u,i["padding-inline-start"]=new X.i(1.25,"em");break;case"toc-node-first-child":i.display=X.t.inline_block,i.margin=new X.i(.2,"em"),i["vertical-align"]=X.t.top,i.color=X.t.inherit,i["text-decoration"]=X.t.none}if(!o||"toc-node"!=o.toString()&&"toc-container"!=o.toString())return e(t,n,i);var r=t.firstChild;r&&1!==r.nodeType&&""===r.textContent.trim()&&t.replaceChild(t.ownerDocument.createComment(r.textContent),r);var a=n.getAttribute("data-adapt-class");"toc-node"==a&&(s=n.firstChild).textContent!=Wi&&(s.textContent=Wi,E.F(s,"cursor","pointer"),s.addEventListener("click",Yi,!1),s.setAttribute("role","button"),s.setAttribute("aria-expanded","false"),n.setAttribute("aria-expanded","false"),"0px"!==n.style.height&&(s.tabIndex=0));var s,l=n.ownerDocument.createElement("div");if(l.setAttribute("data-adapt-process-children","true"),"toc-node"==o.toString())if((s=n.ownerDocument.createElement("div")).textContent="▹",E.F(s,"margin","0.2em 0 0 -1em"),E.F(s,"margin-inline-start","-1em"),E.F(s,"margin-inline-end","0"),E.F(s,"display","inline-block"),E.F(s,"width","1em"),E.F(s,"text-align","center"),E.F(s,"vertical-align","top"),E.F(s,"cursor","default"),E.F(s,"font-family","Menlo,sans-serif"),l.appendChild(s),E.F(l,"overflow","hidden"),l.setAttribute("data-adapt-class","toc-node"),l.setAttribute("role","treeitem"),"toc-node"==a||"toc-container"==a){E.F(l,"height","0px");var u=t.firstElementChild;u&&"a"===u.localName&&(u.tabIndex=-1)}else n.setAttribute("role","tree");else"toc-node"==a&&(l.setAttribute("data-adapt-class","toc-container"),l.setAttribute("role","group"),l.setAttribute("aria-hidden","true"));return Y.d(l)}},t.prototype.showTOC=function(t,e,n,i,o){var r=this;if(this.page)return Y.d(this.page);var a=this,s=Y.c("showTOC"),l=new q.l(t,t);this.page=l;var u=this.url+"?viv-toc-box";return this.store.load(u).then(function(i){var u=r.store.resources[r.url];u&&u.body&&u.body.getAttribute("data-vivliostyle-primary-entry")&&i.body.setAttribute("data-vivliostyle-primary-entry",!0);var c=a.store.getStyleForDoc(i),h=c.sizeViewport(n,1e5,o);e=new Ti(e.window,h.fontSize,e.root,h.width,h.height);var p=a.makeCustomRenderer(i),f=new _i(c,i,a.lang,e,a.clientLayout,a.fontMapper,p,a.fallbackMap,0,a.documentURLTransformer,a.counterStore);a.instance=f,f.pref=a.pref,f.init().then(function(){f.layoutNextPage(l,null).then(function(){Array.from(l.container.querySelectorAll("[data-vivliostyle-toc-box]>*>*>*>*>*[style*='display: none']")).forEach(function(t){t.setAttribute("aria-hidden","true"),t.setAttribute("hidden","hidden")}),a.setAutoHeight(t,2),s.finish(l)})})}),s.result()},t.prototype.hideTOC=function(){this.page&&(this.page.container.style.visibility="hidden",this.page.container.setAttribute("aria-hidden","true"))},t.prototype.isTOCVisible=function(){return!!this.page&&"visible"===this.page.container.style.visibility},t}();function Yi(t){var e=t.target,n=e.textContent==Wi;e.textContent=n?Xi:Wi;var i=e.parentNode;e.setAttribute("aria-expanded",n?"true":"false"),i.setAttribute("aria-expanded",n?"true":"false");for(var o=i.firstChild;o;){if(1===o.nodeType){var r=o,a=r.getAttribute("data-adapt-class");if("toc-container"===a){if(r.setAttribute("aria-hidden",n?"false":"true"),r.firstChild){o=r.firstChild;continue}}else if("toc-node"===a&&(r.style.height=n?"auto":"0px",r.children.length>=2&&(r.children[1].tabIndex=n?0:-1),r.children.length>=3&&(r.children[0].tabIndex=n?0:-1,!n))){var s=r.children[0];if(s.textContent==Xi){s.textContent=Wi,s.setAttribute("aria-expanded","false"),r.setAttribute("aria-expanded","false"),o=r.children[2];continue}}}for(;!o.nextSibling&&o.parentNode!==i;)o=o.parentNode;o=o.nextSibling}t.stopPropagation()}var qi=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),Ki=function(t){function e(){var e=t.call(this,null)||this;return e.opfByURL={},e.primaryOPFByEPubURL={},e.deobfuscators={},e.documents={},e.fontDeobfuscator=e.makeDeobfuscatorFactory(),e.plainXMLStore=new W.a(Ai,W.b.DOCUMENT),e.jsonStore=W.f(),e}return qi(e,t),e.prototype.makeDeobfuscatorFactory=function(){var t=this;return function(e){return t.deobfuscators[e]}},e.prototype.loadAsPlainXML=function(t,e,n){return this.plainXMLStore.load(t,e,n)},e.prototype.startLoadingAsPlainXML=function(t){this.plainXMLStore.fetch(t)},e.prototype.loadAsJSON=function(t,e,n){return this.jsonStore.load(t,e,n)},e.prototype.startLoadingAsJSON=function(t){this.jsonStore.fetch(t)},e.prototype.loadPubDoc=function(t,e){var n=this,i=Y.c("loadPubDoc");return W.c(t,null,"HEAD").then(function(o){if(o.status>=400)n.loadEPUBDoc(t,e).then(function(e){e?i.finish(e):(u.b.error("Failed to fetch a source document from "+t+" ("+o.status+(o.statusText?" "+o.statusText:"")+")"),i.finish(null))});else if(o.status||o.responseXML||o.responseText||o.responseBlob||o.contentType||/\/[^\/.]+(?:[#?]|$)/.test(t)&&(t=t.replace(/([#?]|$)/,"/$1")),"application/oebps-package+xml"==o.contentType||/\.opf(?:[#?]|$)/.test(t)){var r=t.match(/^((?:.*\/)?)([^\/]*)$/),a=r[1],s=r[2];n.loadOPF(a,s,e).thenFinish(i)}else"application/ld+json"==o.contentType||"application/webpub+json"==o.contentType||"application/audiobook+json"==o.contentType||"application/json"==o.contentType||/\.json(?:ld)?(?:[#?]|$)/.test(t)?n.loadAsJSON(t,!0).then(function(e){if(!e)return u.b.error("Received an empty response for "+t+". This may be caused by the server not allowing cross-origin resource sharing (CORS)."),void i.finish(null);var o=new ao(n,t);o.initWithWebPubManifest(e).then(function(){i.finish(o)})}):n.loadWebPub(t).then(function(o){o?i.finish(o):n.loadEPUBDoc(t,e).then(function(e){e?i.finish(e):(u.b.error("Failed to load "+t+"."),i.finish(null))})})}),i.result()},e.prototype.loadEPUBDoc=function(t,e){var n=this,i=Y.c("loadEPUBDoc");t.endsWith("/")||(t+="/"),e&&this.startLoadingAsJSON(t+"?r=list"),this.startLoadingAsPlainXML(t+"META-INF/encryption.xml");var o=t+"META-INF/container.xml";return this.loadAsPlainXML(o).then(function(o){if(o){for(var r=0,a=o.doc().child("container").child("rootfiles").child("rootfile").attribute("full-path");r<a.length;r++){var s=a[r];if(s)return void n.loadOPF(t,s,e).thenFinish(i)}i.finish(null)}}),i.result()},e.prototype.loadOPF=function(t,e,n){var i=this,o=t+e,r=i.opfByURL[o];if(r)return Y.d(r);var a=Y.c("loadOPF");return i.loadAsPlainXML(o,!0,"Failed to fetch EPUB OPF "+o).then(function(e){e?i.loadAsPlainXML(t+"META-INF/encryption.xml").then(function(s){(n?i.loadAsJSON(t+"?r=list"):Y.d(null)).then(function(n){(r=new ao(i,t)).initWithXMLDoc(e,s,n,t+"?r=manifest").then(function(){i.opfByURL[o]=r,i.primaryOPFByEPubURL[t]=r,a.finish(r)})})}):u.b.error("Received an empty response for EPUB OPF "+o+". This may be caused by the server not allowing cross-origin resource sharing (CORS).")}),a.result()},e.prototype.loadWebPub=function(t){var e=this,n=Y.c("loadWebPub");return this.load(t).then(function(i){if(i)if(i.document.querySelector("a[href='META-INF/'],a[href$='/META-INF/']"))n.finish(null);else{var o=i.document,r=new ao(e,t);o.body&&o.body.setAttribute("data-vivliostyle-primary-entry",!0);var a=o.querySelector("link[rel='publication'],link[rel='manifest'][type='application/webpub+json']");if(a){var s=a.getAttribute("href");if(/^#/.test(s)){var l=E.H(o.getElementById(s.substr(1)).textContent);r.initWithWebPubManifest(l,o).then(function(){n.finish(r)})}else e.loadAsJSON(E.C(a.getAttribute("href"),t)).then(function(t){r.initWithWebPubManifest(t,o).then(function(){n.finish(r)})})}else r.initWithWebPubManifest({},o).then(function(){r.xhtmlToc&&r.xhtmlToc.src===i.url&&(o.querySelector("[role=doc-toc], [role=directory], nav, .toc, #toc")||(r.xhtmlToc=null)),n.finish(r)})}else u.b.error("Received an empty response for "+t+". This may be caused by the server not allowing cross-origin resource sharing (CORS).")}),n.result()},e.prototype.addDocument=function(t,e){var n=Y.c("EPUBDocStore.load"),i=E.I(t);return(this.documents[i]=this.parseOPSResource({status:200,statusText:"",url:i,contentType:e.contentType,responseText:null,responseXML:e,responseBlob:null})).thenFinish(n),n.result()},e.prototype.load=function(e){var n=E.I(e),i=this.documents[n];if(i)return i.isPending()?i:Y.d(i.get());var o=Y.c("EPUBDocStore.load");return(i=t.prototype.load.call(this,n,!0,"Failed to fetch a source document from "+n)).then(function(t){t?o.finish(t):n.startsWith("data:")?u.b.error("Failed to load "+n+". Invalid data."):n.startsWith("http:")&&E.h.startsWith("https:")?u.b.error("Failed to load "+n+'. Mixed Content ("http:" content on "https:" context) is not allowed.'):u.b.error("Received an empty response for "+n+". This may be caused by the server not allowing cross-origin resource sharing (CORS).")}),o.result()},e}(Vi),Qi=function(){function t(){this.id=null,this.src="",this.mediaType=null,this.title=null,this.itemRefElement=null,this.spineIndex=-1,this.compressedSize=0,this.compressed=null,this.epage=0,this.epageCount=0,this.startPage=null,this.skipPagesBefore=null,this.itemProperties=E.o}return t.prototype.initWithElement=function(t,e){this.id=t.getAttribute("id"),this.src=E.C(t.getAttribute("href"),e),this.mediaType=t.getAttribute("media-type");var n=t.getAttribute("properties");n&&(this.itemProperties=E.f(n.split(/\s+/)))},t.prototype.initWithParam=function(t){this.spineIndex=t.index,this.id="item"+(t.index+1),this.src=t.url,this.startPage=t.startPage,this.skipPagesBefore=t.skipPagesBefore},t}();function Zi(t){return t.id}function $i(t){return"1040:"+function(t){for(var e=function(t){for(var e=Gi(t),n=new E.d,i=0;i<e.length;i++)n.append(Hi(e[i]));return n.toString()}(t),n=new E.d,i=0;i<e.length;i++)n.append((256|e.charCodeAt(i)).toString(16).substr(1));return n.toString()}(t)}var Ji={dcterms:"http://purl.org/dc/terms/",marc:"http://id.loc.gov/vocabulary/",media:"http://www.idpf.org/epub/vocab/overlays/#",rendition:"http://www.idpf.org/vocab/rendition/#",onix:"http://www.editeur.org/ONIX/book/codelists/current.html#",xsd:"http://www.w3.org/2001/XMLSchema#"},to="http://idpf.org/epub/vocab/package/#",eo={language:Ji.dcterms+"language",title:Ji.dcterms+"title",creator:Ji.dcterms+"creator",layout:Ji.rendition+"layout",titleType:to+"title-type",displaySeq:to+"display-seq",alternateScript:to+"alternate-script"};function no(t,e){var n={};return function(i,o){var r,a=i.r||n,s=o.r||n;if(t==eo.title&&(r="main"==a[eo.titleType])!=("main"==s[eo.titleType]))return r?-1:1;var l=parseInt(a[eo.displaySeq],10);isNaN(l)&&(l=Number.MAX_VALUE);var u=parseInt(s[eo.displaySeq],10);return isNaN(u)&&(u=Number.MAX_VALUE),l!=u?l-u:t!=eo.language&&e&&(r=(a[eo.language]||a[eo.alternateScript])==e)!=((s[eo.language]||s[eo.alternateScript])==e)?r?-1:1:i.o-o.o}}function io(){var t=window.MathJax;return t?t.Hub:null}var oo,ro={"application/xhtml+xml":!0,"image/jpeg":!0,"image/png":!0,"image/svg+xml":!0,"image/gif":!0,"audio/mp3":!0},ao=function(){function t(t,e){this.store=t,this.pubURL=e,this.opfXML=null,this.encXML=null,this.items=null,this.spine=null,this.itemMap=null,this.itemMapByPath=null,this.uid=null,this.bindings={},this.lang=null,this.epageCount=0,this.prePaginated=!1,this.epageIsRenderedPage=!0,this.epageCountCallback=null,this.metadata={},this.ncxToc=null,this.xhtmlToc=null,this.cover=null,this.fallbackMap={},this.pageProgression=null,this.documentURLTransformer=this.createDocumentURLTransformer(),io()&&(H.H[E.a.MATHML]=!0)}return t.prototype.createDocumentURLTransformer=function(){var t=this;return new(function(){function e(){}return e.prototype.transformFragment=function(t,e){var n=e+(t?"#"+t:"");return"viv-id-"+E.r(n,":")},e.prototype.transformURL=function(e,n){var i=e.match(/^([^#]*)#?(.*)$/);if(i){var o=i[1]||n,r=i[2];if(o&&t.items.some(function(t){return t.src===o}))return"#"+this.transformFragment(r,o)}return e},e.prototype.restoreURL=function(t){"#"===t.charAt(0)&&(t=t.substring(1)),0===t.indexOf("viv-id-")&&(t=t.substring("viv-id-".length));var e=E.J(t,":").match(/^([^#]*)#?(.*)$/);return e?[e[1],e[2]]:[]},e}())},t.prototype.getMetadata=function(){return this.metadata},t.prototype.getPathFromURL=function(t){if(t.startsWith("data:"))return t===this.pubURL?"":t;if(this.pubURL){var e=E.C("",this.pubURL);return t===e||t+"/"===e?"":("/"!=e.charAt(e.length-1)&&(e+="/"),t.substr(0,e.length)==e?decodeURI(t.substr(e.length)):null)}return t},t.prototype.initWithXMLDoc=function(t,e,n,o){var r=this;this.opfXML=t,this.encXML=e;var a=t.doc().child("package"),s=a.attribute("unique-identifier")[0];if(s){var l=t.getElement(t.url+"#"+s);l&&(this.uid=l.textContent.replace(/[ \n\r\t]/g,""))}var u={};for(var c in this.items=a.child("manifest").child("item").asArray().map(function(e){var n=new Qi,i=e;n.initWithElement(i,t.url);var o=i.getAttribute("fallback");return o&&!ro[n.mediaType]&&(u[n.src]=o),!r.xhtmlToc&&n.itemProperties.nav&&(r.xhtmlToc=n),!r.cover&&n.itemProperties["cover-image"]&&(r.cover=n),n}),this.itemMap=E.w(this.items,Zi),this.itemMapByPath=E.w(this.items,function(t){return r.getPathFromURL(t.src)}),u)for(var h=c;T=this.itemMap[u[h]];){if(ro[T.mediaType]){this.fallbackMap[c]=T.src;break}h=T.src}this.spine=a.child("spine").child("itemref").asArray().map(function(t,e){var n=t,i=n.getAttribute("idref"),o=r.itemMap[i];return o&&(o.itemRefElement=n,o.spineIndex=e),o});var p=a.child("spine").attribute("toc")[0];p&&(this.ncxToc=this.itemMap[p]);var f=a.child("spine").attribute("page-progression-direction")[0];f&&(this.pageProgression=function(t){switch(t){case"ltr":return i.LTR;case"rtl":return i.RTL;default:throw new Error("unknown PageProgression: "+t)}}(f));for(var d=e?e.doc().child("encryption").child("EncryptedData").predicate(Ri.withChild("EncryptionMethod",Ri.withAttribute("Algorithm","http://www.idpf.org/2008/embedding"))).child("CipherData").child("CipherReference").attribute("URI"):[],g=a.child("bindings").child("mediaType").asArray(),m=0;m<g.length;m++){var y=g[m].getAttribute("handler");(I=g[m].getAttribute("media-type"))&&y&&this.itemMap[y]&&(this.bindings[I]=this.itemMap[y].src)}if(this.metadata=function(t,e){var n;if(e){for(var i in n={},Ji)n[i]=Ji[i];for(var o=void 0;null!=(o=e.match(/^\s*([A-Z_a-z\u007F-\uFFFF][-.A-Z_a-z0-9\u007F-\uFFFF]*):\s*(\S+)/));)e=e.substr(o[0].length),n[o[1]]=o[2]}else n=Ji;var r=function(t){if(t){var e=t.match(/^\s*(([^:]*):)?(\S+)\s*$/);if(e){var i=e[2]?n[e[2]]:to;if(i)return i+e[3]}}return null},a=1,s=t.childElements().forEachNonNull(function(t){if("meta"==t.localName){var e=r(t.getAttribute("property"));if(e)return{name:e,value:t.textContent,id:t.getAttribute("id"),order:a++,refines:t.getAttribute("refines"),lang:null,scheme:r(t.getAttribute("scheme"))}}else if(t.namespaceURI==E.a.DC)return{name:Ji.dcterms+t.localName,order:a++,lang:t.getAttribute("xml:lang"),value:t.textContent,id:t.getAttribute("id"),refines:null,scheme:null};return null}),l=E.A(s,function(t){return t.refines}),u=function(t){return E.z(t,function(t,e){return t.map(function(t){var e={v:t.value,o:t.order};if(t.schema&&(e.s=t.scheme),t.id||t.lang){var n=l[t.id];if(n||t.lang){if(t.lang){var i={name:eo.language,value:t.lang,lang:null,id:null,refines:t.id,scheme:null,order:t.order};n?n.push(i):n=[i]}var o=E.A(n,function(t){return t.name});e.r=u(o)}}return e})})},c=u(E.A(s,function(t){return t.refines?null:t.name})),h=null;c[eo.language]&&(h=c[eo.language][0].v);var p=function(t){for(var e in t){var n=t[e];n.sort(no(e,h));for(var i=0;i<n.length;i++){var o=n[i].r;o&&p(o)}}};return p(c),c}(a.child("metadata"),a.attribute("prefix")[0]),this.metadata[eo.language]&&(this.lang=this.metadata[eo.language][0].v),this.metadata[eo.layout]&&(this.prePaginated="pre-paginated"===this.metadata[eo.layout][0].v),!n){if(d.length>0&&this.uid){var v=function(t){var e=function(t){for(var e=[],n=0,i=Gi(t);n<i.length;n++){var o=i[n];e.push(o>>>24&255,o>>>16&255,o>>>8&255,255&o)}return e}(t);return function(t){var n,i,o=Y.c("deobfuscator");return t.slice?(n=t.slice(0,1040),i=t.slice(1040,t.size)):(n=t.webkitSlice(0,1040),i=t.webkitSlice(1040,t.size-1040)),W.g(n).then(function(t){for(var n=new DataView(t),r=0;r<n.byteLength;r++){var a=n.getUint8(r);a^=e[r%20],n.setUint8(r,a)}o.finish(W.e([n,i]))}),o.result()}}(this.uid);for(m=0;m<d.length;m++)this.store.deobfuscators[this.pubURL+d[m]]=v}return this.prePaginated&&this.assignAutoPages(),Y.d(!0)}var b=new E.d,w={};if(d.length>0&&this.uid){var N=$i(this.uid);for(m=0;m<d.length;m++)w[d[m]]=N}for(m=0;m<n.length;m++){var C=n[m],S=C.n;if(S){var T,x=decodeURI(S),I=null;(T=this.itemMapByPath[x])&&(T.compressed=0!=C.m,T.compressedSize=C.c,T.mediaType&&(I=T.mediaType.replace(/\s+/g,"")));var P=w[x];(I||P)&&(b.append(S),b.append(" "),b.append(I||"application/octet-stream"),P&&(b.append(" "),b.append(P)),b.append("\n"))}}return r.assignAutoPages(),W.c(o,W.b.DEFAULT,"POST",b.toString(),"text/plain")},t.prototype.assignAutoPages=function(){for(var t=0,e=0,n=this.spine;e<n.length;e++){var i=n[e],o=this.prePaginated?1:Math.ceil(i.compressedSize/1024);i.epage=t,i.epageCount=o,t+=o}this.epageCount=t,this.epageCountCallback&&this.epageCountCallback(this.epageCount)},t.prototype.setEPageCountMode=function(t){this.epageIsRenderedPage=t||this.prePaginated},t.prototype.countEPages=function(t){var e=this;if(this.epageCountCallback=t,this.epageIsRenderedPage)return this.prePaginated&&0==this.epageCount&&this.assignAutoPages(),Y.d(!0);var n=0,i=0,o=Y.c("countEPages");return o.loopWithFrame(function(t){if(i!==e.spine.length){var o=e.spine[i++];o.epage=n,e.store.load(o.src).then(function(i){var r=1800,a=i.lang||e.lang;a&&a.match(/^(ja|ko|zh)/)&&(r/=3),o.epageCount=Math.ceil(i.getTotalOffset()/r),n+=o.epageCount,e.epageCount=n,e.epageCountCallback&&e.epageCountCallback(e.epageCount),t.continueLoop()})}else t.breakLoop()}).thenFinish(o),o.result()},t.prototype.initWithChapters=function(t,e){var n=this;this.itemMap={},this.itemMapByPath={},this.items=[],this.spine=this.items;var i=this.opfXML=new Ii(null,"",(new DOMParser).parseFromString("<spine></spine>","text/xml"));return t.forEach(function(t){var e=new Qi;e.initWithParam(t),v.a(e.id);var o=i.document.createElement("itemref");o.setAttribute("idref",e.id),i.root.appendChild(o),e.itemRefElement=o,n.itemMap[e.id]=e;var r=n.getPathFromURL(t.url);null==r&&(r=t.url),n.itemMapByPath[r]=e,n.items.push(e)}),e?this.store.addDocument(t[0].url,e):Y.d(null)},t.prototype.initWithWebPubManifest=function(t,e){var n=this;t.readingProgression&&(this.pageProgression=t.readingProgression),void 0===this.metadata&&(this.metadata={});var i=e&&e.title||t.name||t.metadata&&t.metadata.title;i&&(this.metadata[eo.title]=[{v:i}]);var o=this.getPathFromURL(this.pubURL);!t.readingOrder&&e&&null!==o&&(t.readingOrder=[encodeURI(o)],Array.from(e.querySelectorAll("[role=doc-toc] a[href],[role=directory] a[href],nav li a[href],.toc a[href],#toc a[href]")).forEach(function(e){var i=E.I(E.C(e.getAttribute("href"),n.pubURL)),o=n.getPathFromURL(i),r=null!==o?encodeURI(o):i;-1==t.readingOrder.indexOf(r)&&t.readingOrder.push(r)}));var r=[],a=0,s=-1;[t.readingOrder,t.resources].forEach(function(e){e instanceof Array&&e.forEach(function(e){var i=t.readingOrder.includes(e),o="string"==typeof e?e:e.url||e.href,l="string"==typeof e?"":e.encodingFormat||e.href&&e.type||"";if(i||"text/html"===l||"application/xhtml+xml"===l||/(^|\/)([^\/]+\.(x?html|htm|xht)|[^\/.]*)([#?]|$)/.test(o)){var u={url:E.C(E.n(o),n.pubURL),index:a++,startPage:null,skipPagesBefore:null};"contents"===e.rel&&-1===s&&(s=u.index),r.push(u)}})});var l=Y.c("initWithWebPubManifest");return this.initWithChapters(r).then(function(){-1!==s&&(n.xhtmlToc=n.items[s]),n.xhtmlToc||(n.xhtmlToc=n.itemMapByPath[o]),l.finish(!0)}),l.result()},t.prototype.getCFI=function(t,e){var n=this.spine[t],i=Y.c("getCFI");return this.store.load(n.src).then(function(t){var o=t.getNodeByOffset(e),r=null;if(o){var a=t.getNodeOffset(o,0,!1),s=e-a,l=new R;l.prependPathFromNode(o,s,!1,null),n.itemRefElement&&l.prependPathFromNode(n.itemRefElement,0,!1,null),r=l.toString()}i.finish(r)}),i.result()},t.prototype.resolveFragment=function(t){var e=this;return Y.b("resolveFragment",function(n){if(t){var i,o=new R;if(o.fromString(t),e.opfXML){var r=o.navigate(e.opfXML.document);if(1!=r.node.nodeType||r.after||!r.ref)return void n.finish(null);var a=r.node,s=a.getAttribute("idref");if("itemref"!=a.localName||!s||!e.itemMap[s])return void n.finish(null);i=e.itemMap[s],o=r.ref}else i=e.spine[0];e.store.load(i.src).then(function(t){var e=o.navigate(t.document),r=t.getNodeOffset(e.node,e.offset,e.after);n.finish({spineIndex:i.spineIndex,offsetInItem:r,pageIndex:-1})})}else n.finish(null)},function(e,n){u.b.warn(n,"Cannot resolve fragment:",t),e.finish(null)})},t.prototype.resolveEPage=function(t){var e=this;return Y.b("resolveEPage",function(n){if(t<=0)n.finish({spineIndex:0,offsetInItem:0,pageIndex:-1});else if(e.epageIsRenderedPage){var i=e.spine.findIndex(function(e){return 0==e.epage&&0==e.epageCount||e.epage<=t&&e.epage+e.epageCount>t});-1==i&&(i=e.spine.length-1);var o=e.spine[i];o&&0!=o.epageCount||(o=e.spine[--i]);var r=Math.floor(t-o.epage);n.finish({spineIndex:i,offsetInItem:-1,pageIndex:r})}else{var a=E.i(e.spine.length,function(n){var i=e.spine[n];return i.epage+i.epageCount>t});a==e.spine.length&&a--;var s=e.spine[a];e.store.load(s.src).then(function(e){(t-=s.epage)>s.epageCount&&(t=s.epageCount);var i=0;if(t>0){var o=e.getTotalOffset();(i=Math.round(o*t/s.epageCount))==o&&i--}n.finish({spineIndex:a,offsetInItem:i,pageIndex:-1})})}},function(e,n){u.b.warn(n,"Cannot resolve epage:",t),e.finish(null)})},t.prototype.getEPageFromPosition=function(t){var e=this.spine[t.spineIndex];if(this.epageIsRenderedPage){var n=e.epage+t.pageIndex;return Y.d(n)}if(t.offsetInItem<=0)return Y.d(e.epage);var i=Y.c("getEPage");return this.store.load(e.src).then(function(n){var o=n.getTotalOffset(),r=Math.min(o,t.offsetInItem);i.finish(e.epage+r*e.epageCount/o)}),i.result()},t}(),so=function(t,e){return{page:t,position:{spineIndex:t.spineIndex,pageIndex:e,offsetInItem:t.offset}}},lo=function(){function t(t,e,n,i,o){this.opf=t,this.viewport=e,this.fontMapper=n,this.pageSheetSizeReporter=o,this.spineItems=[],this.spineItemLoadingContinuations=[],this.tocAutohide=!1,this.pref=L.E(i),this.clientLayout=new Si(e),this.counterStore=new M(t.documentURLTransformer)}return t.prototype.getPage=function(t){var e=this.spineItems[t.spineIndex];return e?e.pages[t.pageIndex]:null},t.prototype.getCurrentPageProgression=function(t){if(this.opf.pageProgression)return this.opf.pageProgression;var e=this.spineItems[t?t.spineIndex:0];return e?e.instance.pageProgression:null},t.prototype.finishPageContainer=function(t,e,n){e.container.style.display="none",e.container.style.visibility="visible",e.container.style.position="",e.container.style.top="",e.container.style.left="",e.container.setAttribute("data-vivliostyle-page-side",e.side);var i=t.pages[n];if(e.isFirstPage=0==t.item.spineIndex&&0==n,t.pages[n]=e,this.opf.epageIsRenderedPage){if(0==n&&t.item.spineIndex>0){var o=this.opf.spine[t.item.spineIndex-1];t.item.epage=o.epage+o.epageCount}t.item.epageCount=t.pages.length,this.opf.epageCount=this.opf.spine.reduce(function(t,e){return t+e.epageCount},0),this.opf.epageCountCallback&&this.opf.epageCountCallback(this.opf.epageCount)}if(i)t.instance.viewport.contentContainer.replaceChild(e.container,i.container),i.dispatchEvent({type:"replaced",target:null,currentTarget:null,preventDefault:null,newPage:e});else{var r=null;if(n>0)r=t.pages[n-1].container.nextElementSibling;else for(var a=t.item.spineIndex+1;a<this.spineItems.length;a++){var s=this.spineItems[a];if(s&&s.pages[0]){r=s.pages[0].container;break}}t.instance.viewport.contentContainer.insertBefore(e.container,r)}this.pageSheetSizeReporter({width:t.instance.pageSheetWidth,height:t.instance.pageSheetHeight},t.instance.pageSheetSize,t.item.spineIndex,t.instance.pageNumberOffset+n)},t.prototype.renderSinglePage=function(t,e){var n=Y.c("renderSinglePage"),i=this.makePage(t,e),o=this;return t.instance.layoutNextPage(i,e).then(function(r){var a=(e=r)?e.page-1:t.layoutPositions.length-1;o.finishPageContainer(t,i,a),o.counterStore.finishPage(i.spineIndex,a);var s=null;if(e){var l=t.layoutPositions[e.page];t.layoutPositions[e.page]=e,l&&t.pages[e.page]&&(e.isSamePosition(l)||(s=o.renderSinglePage(t,e)))}s||(s=Y.d(!0)),s.then(function(){var r=o.counterStore.getUnresolvedRefsToPage(i),s=0;n.loopWithFrame(function(t){if(++s>r.length)t.breakLoop();else{var e=r[s-1];e.refs=e.refs.filter(function(t){return!t.isResolved()}),0!==e.refs.length?o.getPageViewItem(e.spineIndex).then(function(n){if(n){o.counterStore.pushPageCounters(e.pageCounters),o.counterStore.pushReferencesToSolve(e.refs);var r=n.layoutPositions[e.pageIndex];o.renderSinglePage(n,r).then(function(e){o.counterStore.popPageCounters(),o.counterStore.popReferencesToSolve();var n=e.pageAndPosition.position;n.spineIndex===i.spineIndex&&n.pageIndex===a&&(i=e.pageAndPosition.page),t.continueLoop()})}else t.continueLoop()}):t.continueLoop()}}).then(function(){i.container.parentElement||(i=t.pages[a]),i.isLastPage=!e&&t.item.spineIndex===o.opf.spine.length-1,i.isLastPage&&(v.a(o.viewport),o.counterStore.finishLastPage(o.viewport)),n.finish({pageAndPosition:so(i,a),nextLayoutPosition:e})})})}),n.result()},t.prototype.normalizeSeekPosition=function(t,e){var n=t.pageIndex,i=-1;if(n<0){i=t.offsetInItem;var o=E.i(e.layoutPositions.length,function(t){return e.instance.getPosition(e.layoutPositions[t],!0)>i});n=o===e.layoutPositions.length?e.complete?e.layoutPositions.length-1:Number.POSITIVE_INFINITY:o-1}else n===Number.POSITIVE_INFINITY&&-1!==t.offsetInItem&&(i=t.offsetInItem);return{spineIndex:t.spineIndex,pageIndex:n,offsetInItem:i}},t.prototype.findPage=function(t,e){var n=this,i=Y.c("findPage");return n.getPageViewItem(t.spineIndex).then(function(o){if(o){var r,a=null;i.loopWithFrame(function(s){var l=n.normalizeSeekPosition(t,o);r=l.pageIndex,(a=o.pages[r])?s.breakLoop():o.complete?(r=o.layoutPositions.length-1,a=o.pages[r],s.breakLoop()):e?n.renderPage(l).then(function(t){t&&(a=t.page,r=t.position.pageIndex),s.breakLoop()}):i.sleep(100).then(function(){s.continueLoop()})}).then(function(){v.a(a),i.finish(so(a,r))})}else i.finish(null)}),i.result()},t.prototype.renderPage=function(t){var e=this,n=Y.c("renderPage");return e.getPageViewItem(t.spineIndex).then(function(i){if(i){var o=e.normalizeSeekPosition(t,i),r=o.pageIndex,a=o.offsetInItem,s=i.pages[r];s?n.finish(so(s,r)):n.loopWithFrame(function(t){if(r<i.layoutPositions.length)t.breakLoop();else{if(i.complete)return r=i.layoutPositions.length-1,void t.breakLoop();var n=i.layoutPositions[i.layoutPositions.length-1];e.renderSinglePage(i,n).then(function(e){var o=e.pageAndPosition.page;if(n=e.nextLayoutPosition){if(a>=0&&i.instance.getPosition(n)>a)return s=o,r=i.layoutPositions.length-2,void t.breakLoop();t.continueLoop()}else s=o,r=e.pageAndPosition.position.pageIndex,i.complete=!0,t.breakLoop()})}}).then(function(){s=s||i.pages[r];var t=i.layoutPositions[r];s?n.finish(so(s,r)):e.renderSinglePage(i,t).then(function(t){t.nextLayoutPosition||(i.complete=!0),n.finish(t.pageAndPosition)})})}else n.finish(null)}),n.result()},t.prototype.renderAllPages=function(){return this.renderPagesUpto({spineIndex:this.opf.spine.length-1,pageIndex:Number.POSITIVE_INFINITY,offsetInItem:-1},!1)},t.prototype.renderPagesUpto=function(t,e){var n=this,i=Y.c("renderPagesUpto");t||(t={spineIndex:0,pageIndex:0,offsetInItem:0});var o,r=t.spineIndex,a=t.pageIndex,s=0;return e&&(s=r),i.loopWithFrame(function(e){var i={spineIndex:s,pageIndex:s===r?a:Number.POSITIVE_INFINITY,offsetInItem:s===r?t.offsetInItem:-1};n.renderPage(i).then(function(t){o=t,++s>r?e.breakLoop():e.continueLoop()})}).then(function(){i.finish(o)}),i.result()},t.prototype.firstPage=function(t,e){return this.findPage({spineIndex:0,pageIndex:0,offsetInItem:-1},e)},t.prototype.lastPage=function(t,e){return this.findPage({spineIndex:this.opf.spine.length-1,pageIndex:Number.POSITIVE_INFINITY,offsetInItem:-1},e)},t.prototype.nextPage=function(t,e){var n=this,i=this,o=t.spineIndex,r=t.pageIndex,a=Y.c("nextPage");return i.getPageViewItem(o).then(function(t){if(t){if(t.complete&&r==t.layoutPositions.length-1){if(o>=i.opf.spine.length-1)return void a.finish(null);o++,r=0;var s=n.spineItems[o],l=s&&s.pages[0],u=t.pages[t.pages.length-1];l&&u&&l.side==u.side&&(s.pages.forEach(function(t){t.container&&t.container.remove()}),n.spineItems[o]=null,n.spineItemLoadingContinuations[o]=null)}else r++;i.findPage({spineIndex:o,pageIndex:r,offsetInItem:-1},e).thenFinish(a)}else a.finish(null)}),a.result()},t.prototype.previousPage=function(t,e){var n=t.spineIndex,i=t.pageIndex;if(0==i){if(0==n)return Y.d(null);n--,i=Number.POSITIVE_INFINITY}else i--;return this.findPage({spineIndex:n,pageIndex:i,offsetInItem:-1},e)},t.prototype.isRectoPage=function(t,e){var n=t.side===o.LEFT,r=this.getCurrentPageProgression(e)===i.LTR;return!n&&r||n&&!r},t.prototype.getSpread=function(t,e){var n=this,i=Y.c("getCurrentSpread"),r=this.getPage(t);if(!r)return Y.d({left:null,right:null});var a=r.side===o.LEFT;return(this.isRectoPage(r,t)?this.previousPage(t,e):this.nextPage(t,e)).then(function(e){var o=n.getPage(t),r=e&&e.page;r&&r.side===o.side&&(r=null),a?i.finish({left:o,right:r}):i.finish({left:r,right:o})}),i.result()},t.prototype.nextSpread=function(t,e){var n=this.getPage(t);if(!n)return Y.d(null);var i=this.isRectoPage(n,t),o=this.nextPage(t,e);if(i)return o;var r=this;return o.thenAsync(function(t){if(t){if(t.page.side===n.side)return o;var i=r.nextPage(t.position,e);return i.thenAsync(function(t){return t?i:o})}return Y.d(null)})},t.prototype.previousSpread=function(t,e){var n=this.getPage(t);if(!n)return Y.d(null);var i=this.isRectoPage(n,t),o=this.previousPage(t,e),r=n.container.previousElementSibling;if(i){var a=this;return o.thenAsync(function(t){return t?t.page.side===n.side?o:t.page.container!==r?o:a.previousPage(t.position,e):Y.d(null)})}return o},t.prototype.navigateToEPage=function(t,e,n){var i=Y.c("navigateToEPage"),o=this;return this.opf.resolveEPage(t).then(function(t){t?o.findPage(t,n).thenFinish(i):i.finish(null)}),i.result()},t.prototype.navigateToFragment=function(t,e,n){var i=Y.c("navigateToCFI"),o=this;return o.opf.resolveFragment(t).then(function(t){t?o.findPage(t,n).thenFinish(i):i.finish(null)}),i.result()},t.prototype.navigateTo=function(t,e,n){u.b.debug("Navigate to",t);var i=this.opf.getPathFromURL(E.I(t));if(!i){if(this.opf.opfXML&&t.match(/^#epubcfi\(/))i=this.opf.getPathFromURL(this.opf.opfXML.url);else if("#"===t.charAt(0)){var o=this.opf.documentURLTransformer.restoreURL(t);this.opf.opfXML?null==(i=this.opf.getPathFromURL(o[0]))&&(i=o[0]):i=o[0],t=i+(o[1]?"#"+o[1]:"")}if(null==i)return Y.d(null)}var r=this.opf.itemMapByPath[i];if(!r){if(this.opf.opfXML&&i==this.opf.getPathFromURL(this.opf.opfXML.url)){var a=t.indexOf("#");if(a>=0)return this.navigateToFragment(t.substr(a+1),e,n)}return Y.d(null)}var s=Y.c("navigateTo"),l=this;return l.getPageViewItem(r.spineIndex).then(function(i){if(i){var o=i.xmldoc.getElement(t);o?l.findPage({spineIndex:r.spineIndex,pageIndex:-1,offsetInItem:i.xmldoc.getElementOffset(o)},n).thenFinish(s):e.spineIndex!==r.spineIndex?l.findPage({spineIndex:r.spineIndex,pageIndex:0,offsetInItem:-1},n).thenFinish(s):s.finish(null)}else s.finish(null)}),s.result()},t.prototype.makePage=function(t,e){var n=t.instance.viewport,i=n.document.createElement("div");i.setAttribute("data-vivliostyle-page-container","true"),i.setAttribute("role","region"),i.style.position="absolute",i.style.top="0",i.style.left="0",a||(i.style.visibility="hidden",i.setAttribute("aria-hidden","true")),n.layoutBox.appendChild(i);var o=n.document.createElement("div");o.setAttribute("data-vivliostyle-bleed-box","true"),i.appendChild(o);var r=new q.l(i,o);if(r.spineIndex=t.item.spineIndex,r.position=e,r.offset=t.instance.getPosition(e),0===r.offset){var s=this.opf.documentURLTransformer.transformFragment("",t.item.src);o.setAttribute("id",s),r.registerElementWithId(o,s)}if(n!==this.viewport){var l=L.L(this.viewport.width,this.viewport.height,n.width,n.height),u=z.m(null,new G.b(l,null),"");r.delayedItems.push(new q.d(i,"transform",u))}return r},t.prototype.makeObjectView=function(t,e,n,i){var o=e.getAttribute("data"),r=null;if(o){o=E.C(o,t.url);var a=e.getAttribute("media-type");if(!a){var s=this.opf.getPathFromURL(o);if(s){var l=this.opf.itemMapByPath[s];l&&(a=l.mediaType)}}if(a){var u=this.opf.bindings[a];if(u){(r=this.viewport.document.createElement("iframe")).style.border="none";var c=E.y(o),h=E.y(a),p=new E.d;p.append(u),p.append("?src="),p.append(c),p.append("&type="),p.append(h);for(var f=e.firstChild;f;f=f.nextSibling)if(1==f.nodeType){var d=f;if("param"==d.localName&&d.namespaceURI==E.a.XHTML){var g=d.getAttribute("name"),m=d.getAttribute("value");g&&m&&(p.append("&"),p.append(encodeURIComponent(g)),p.append("="),p.append(encodeURIComponent(m)))}}r.setAttribute("src",p.toString());var y=e.getAttribute("width");y&&r.setAttribute("width",y);var v=e.getAttribute("height");v&&r.setAttribute("height",v)}}}return r||(r=this.viewport.document.createElement("span")).setAttribute("data-adapt-process-children","true"),Y.d(r)},t.prototype.makeMathJaxView=function(t,e,n,i){var o=io();if(o){var r=n.ownerDocument,a=r.createElement("span");n.appendChild(a);var s=r.importNode(e,!0);this.resolveURLsInMathML(s,t),a.appendChild(s);var l=o.queue;l.Push(["Typeset",o,a]);var u=Y.c("makeMathJaxView"),c=u.suspend();return l.Push(function(){c.schedule(a)}),u.result()}return Y.d(null)},t.prototype.resolveURLsInMathML=function(t,e){if(null!=t){if(1===t.nodeType&&"mglyph"===t.tagName)for(var n=0,i=Array.from(t.attributes);n<i.length;n++){var o=i[n];if("src"===o.name){var r=E.C(o.nodeValue,e.url);o.namespaceURI?t.setAttributeNS(o.namespaceURI,o.name,r):t.setAttribute(o.name,r)}}t.firstChild&&this.resolveURLsInMathML(t.firstChild,e),t.nextSibling&&this.resolveURLsInMathML(t.nextSibling,e)}},t.prototype.makeSSEView=function(t,e,n,i){var o,r=n?n.ownerDocument:this.viewport.document,a=e.localName;switch(a){case"t":case"tab":case"ec":case"nt":case"fraction":case"comment":case"mark":o="span";break;case"ruby":case"rp":case"rt":o=a;break;default:o="div"}var s=r.createElement(o);return s.setAttribute("data-adapt-process-children","true"),Y.d(s)},t.prototype.makeCustomRenderer=function(t){var e=this;return function(n,i,o){return"object"==n.localName&&n.namespaceURI==E.a.XHTML?e.makeObjectView(t,n,i,o):n.namespaceURI==E.a.MATHML?e.makeMathJaxView(t,n,i,o):n.namespaceURI==E.a.SSE?e.makeSSEView(t,n,i,o):n.dataset&&"true"==n.dataset.mathTypeset?e.makeMathJaxView(t,n,i,o):Y.d(null)}},t.prototype.getPageViewItem=function(t){var e=this;if(-1===t||t>=e.opf.spine.length)return Y.d(null);var n=e.spineItems[t];if(n)return Y.d(n);var i=Y.c("getPageViewItem"),o=this.spineItemLoadingContinuations[t];if(o){var r=i.suspend();return o.push(r),i.result()}o=this.spineItemLoadingContinuations[t]=[];var a=e.opf.spine[t],s=e.opf.store;return s.load(a.src).then(function(r){a.title=r.document.title;var l=s.getStyleForDoc(r),u=e.makeCustomRenderer(r),c=e.viewport,h=l.sizeViewport(c.width,c.height,c.fontSize,e.pref);h.width==c.width&&h.height==c.height&&h.fontSize==c.fontSize||(c=new Ti(c.window,h.fontSize,c.root,h.width,h.height));var p,f=e.spineItems[t-1];null!==a.startPage?p=a.startPage-1:(!(t>0)||f&&f.complete?p=f?f.instance.pageNumberOffset+f.pages.length:0:(p=a.epage||t,e.opf.prePaginated||p%2!=0||p++),null!==a.skipPagesBefore&&(p+=a.skipPagesBefore)),e.counterStore.forceSetPageCounter(p);var d=new _i(l,r,e.opf.lang,c,e.clientLayout,e.fontMapper,u,e.opf.fallbackMap,p,e.opf.documentURLTransformer,e.counterStore,e.opf.pageProgression);d.pref=e.pref;var g=e.opf.metadata&&e.opf.metadata[eo.title];d.pubTitle=g&&g[0]&&g[0].v||"",d.docTitle=a.title||"",d.init().then(function(){n={item:a,xmldoc:r,instance:d,layoutPositions:[null],pages:[],complete:!1},e.spineItems[t]=n,i.finish(n),o.forEach(function(t){t.schedule(n)})})}),i.result()},t.prototype.removeRenderedPages=function(){for(var t=0,e=this.spineItems;t<e.length;t++){var n=e[t];n&&n.pages.splice(0)}this.viewport.clear()},t.prototype.hasAutoSizedPages=function(){for(var t=0,e=this.spineItems;t<e.length;t++){var n=e[t];if(n)for(var i=0,o=n.pages;i<o.length;i++){var r=o[i];if(r.isAutoPageWidth&&r.isAutoPageHeight)return!0}}return!1},t.prototype.hasPages=function(){return this.spineItems.some(function(t){return t&&t.pages.length>0})},t.prototype.showTOC=function(t){var e=this.opf,n=e.xhtmlToc||e.ncxToc;if(this.tocAutohide=t,!n)return Y.d(null);if(this.tocView&&this.tocView.page)return this.tocView.page.container.style.visibility="visible",this.tocView.page.container.setAttribute("aria-hidden","false"),Y.d(this.tocView.page);var i=Y.c("showTOC");this.tocView||(this.tocView=new ji(e.store,n.src,e.lang,this.clientLayout,this.fontMapper,this.pref,this,e.fallbackMap,e.documentURLTransformer,this.counterStore));var o=this.viewport,r=Math.min(350,Math.round(.67*o.width)-16),a=o.height-6,s=o.document.createElement("div");return o.root.appendChild(s),s.style.visibility="hidden",s.style.width=r+10+"px",s.style.maxHeight=a+"px",s.setAttribute("data-vivliostyle-toc-box","true"),s.setAttribute("role","navigation"),this.tocView.showTOC(s,o,r,a,this.viewport.fontSize).then(function(t){s.style.visibility="visible",s.setAttribute("aria-hidden","false"),i.finish(t)}),i.result()},t.prototype.hideTOC=function(){this.tocView&&this.tocView.hideTOC()},t.prototype.isTOCVisible=function(){return!!this.tocView&&this.tocView.isTOCVisible()},t}(),uo=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),co="data-vivliostyle-viewer-status";!function(t){t.SINGLE_PAGE="singlePage",t.SPREAD="spread",t.AUTO_SPREAD="autoSpread"}(oo||(oo={}));var ho,po=function(){function t(t,e,n,i){this.window=t,this.viewportElement=e,this.instanceId=n,this.callbackFn=i,this.pageSheetSizeAlreadySet=!1,this.renderTask=null;var o=this;e.setAttribute("data-vivliostyle-viewer-viewport",!0),a&&e.setAttribute("data-vivliostyle-debug",!0),e.setAttribute(co,"loading");var r=t.document;this.fontMapper=new je(r.head,e),this.init(),this.kick=function(){},this.sendCommand=function(){},this.resizeListener=function(){o.needResize=!0,o.kick()},this.pageReplacedListener=this.pageReplacedListener.bind(this),this.hyperlinkListener=function(t){},this.pageRuleStyleElement=r.getElementById("vivliostyle-page-rules"),this.actions={loadPublication:this.loadPublication,loadXML:this.loadXML,configure:this.configure,moveTo:this.moveTo,toc:this.showTOC},this.addLogListeners()}return t.prototype.init=function(){this.readyState=r.LOADING,this.packageURL=[],this.opf=null,this.haveZipMetadata=!1,this.touchActive=!1,this.touchX=0,this.touchY=0,this.needResize=!1,this.needRefresh=!1,this.viewportSize=null,this.currentPage=null,this.currentSpread=null,this.pagePosition=null,this.fontSize=16,this.zoom=1,this.fitToScreen=!1,this.pageViewMode=oo.SINGLE_PAGE,this.waitForLoading=!1,this.renderAllPages=!0,this.pref=L.F(),this.pageSizes=[]},t.prototype.addLogListeners=function(){var t=this,e=u.a;u.b.addListener(e.DEBUG,function(e){t.callback({t:"debug",content:e})}),u.b.addListener(e.INFO,function(e){t.callback({t:"info",content:e})}),u.b.addListener(e.WARN,function(e){t.callback({t:"warn",content:e})}),u.b.addListener(e.ERROR,function(e){t.callback({t:"error",content:e})})},t.prototype.callback=function(t){t.i=this.instanceId,this.callbackFn(t)},t.prototype.setReadyState=function(t){this.readyState!==t&&(this.readyState=t,this.viewportElement.setAttribute(co,t),this.callback({t:"readystatechange"}))},t.prototype.loadPublication=function(t){m.registerStartTiming("beforeRender"),this.setReadyState(r.LOADING);var e=t.url,n=t.fragment,i=!!t.zipmeta,o=t.authorStyleSheet,a=t.userStyleSheet;this.viewport=null;var s=Y.c("loadPublication"),l=this;return l.configure(t).then(function(){var t=new Ki;t.init(o,a).then(function(){var o=E.C(E.n(e),l.window.location.href);l.packageURL=[o],t.loadPubDoc(o,i).then(function(t){t?(l.opf=t,l.render(n).then(function(){s.finish(!0)})):s.finish(!1)})})}),s.result()},t.prototype.loadXML=function(t){m.registerStartTiming("beforeRender"),this.setReadyState(r.LOADING);var e=t.url,n=t.document,i=t.fragment,o=t.authorStyleSheet,a=t.userStyleSheet;this.viewport=null;var s=Y.c("loadXML"),l=this;return l.configure(t).then(function(){var t=new Ki;t.init(o,a).then(function(){var o=e.map(function(t,e){return{url:E.C(E.n(t.url),l.window.location.href),index:e,startPage:t.startPage,skipPagesBefore:t.skipPagesBefore}});l.packageURL=o.map(function(t){return t.url}),l.opf=new ao(t,""),l.opf.initWithChapters(o,n).then(function(){l.render(i).then(function(){s.finish(!0)})})})}),s.result()},t.prototype.render=function(t){this.cancelRenderingTask();var e=this;return(t?this.opf.resolveFragment(t).thenAsync(function(t){return e.pagePosition=t,Y.d(!0)}):Y.d(!0)).thenAsync(function(){return m.registerEndTiming("beforeRender"),e.resize()})},t.prototype.resolveLength=function(t){var e,n=parseFloat(t);if("string"==typeof t&&(e=t.match(/[a-z]+$/))){var i=e[0];if("em"===i||"rem"===i)return n*this.fontSize;if("ex"===i)return n*L.G.ex*this.fontSize/L.G.em;var o=L.G[i];if(o)return n*o}return n},t.prototype.configure=function(t){if("boolean"==typeof t.autoresize&&(t.autoresize?(this.viewportSize=null,this.window.addEventListener("resize",this.resizeListener,!1),this.needResize=!0):this.window.removeEventListener("resize",this.resizeListener,!1)),"number"==typeof t.fontSize){var e=t.fontSize;e>=5&&e<=72&&this.fontSize!=e&&(this.fontSize=e,this.needResize=!0)}if("object"==typeof t.viewport&&t.viewport){var n=t.viewport,i={marginLeft:this.resolveLength(n["margin-left"])||0,marginRight:this.resolveLength(n["margin-right"])||0,marginTop:this.resolveLength(n["margin-top"])||0,marginBottom:this.resolveLength(n["margin-bottom"])||0,width:this.resolveLength(n.width)||0,height:this.resolveLength(n.height)||0};(i.width>=200||i.height>=200)&&(this.window.removeEventListener("resize",this.resizeListener,!1),this.viewportSize=i,this.needResize=!0)}return"boolean"==typeof t.hyphenate&&(this.pref.hyphenate=t.hyphenate,this.needResize=!0),"boolean"==typeof t.horizontal&&(this.pref.horizontal=t.horizontal,this.needResize=!0),"boolean"==typeof t.nightMode&&(this.pref.nightMode=t.nightMode,this.needResize=!0),"number"==typeof t.lineHeight&&(this.pref.lineHeight=t.lineHeight,this.needResize=!0),"number"==typeof t.columnWidth&&(this.pref.columnWidth=t.columnWidth,this.needResize=!0),"string"==typeof t.fontFamily&&(this.pref.fontFamily=t.fontFamily,this.needResize=!0),"boolean"==typeof t.load&&(this.waitForLoading=t.load),"boolean"==typeof t.renderAllPages&&(this.renderAllPages=t.renderAllPages),"string"==typeof t.userAgentRootURL&&(E.E(t.userAgentRootURL.replace(/resources\/?$/,"")),E.G(t.userAgentRootURL)),"string"==typeof t.rootURL&&(E.E(t.rootURL),E.G(E.h+"resources/")),"string"==typeof t.pageViewMode&&t.pageViewMode!==this.pageViewMode&&(this.pageViewMode=t.pageViewMode,this.needResize=!0),"number"==typeof t.pageBorder&&t.pageBorder!==this.pref.pageBorder&&(this.viewport=null,this.pref.pageBorder=t.pageBorder,this.needResize=!0),"number"==typeof t.zoom&&t.zoom!==this.zoom&&(this.zoom=t.zoom,this.needRefresh=!0),"boolean"==typeof t.fitToScreen&&t.fitToScreen!==this.fitToScreen&&(this.fitToScreen=t.fitToScreen,this.needRefresh=!0),"object"==typeof t.defaultPaperSize&&"number"==typeof t.defaultPaperSize.width&&"number"==typeof t.defaultPaperSize.height&&(this.viewport=null,this.pref.defaultPaperSize=t.defaultPaperSize,this.needResize=!0),this.configurePlugins(t),Y.d(!0)},t.prototype.configurePlugins=function(t){var e=this;l.b(l.a.CONFIGURATION).forEach(function(n){var i=n(t);e.needResize=i.needResize||e.needResize,e.needRefresh=i.needRefresh||e.needRefresh})},t.prototype.pageReplacedListener=function(t){var e=this.currentPage,n=this.currentSpread,i=t.target;n?n.left!==i&&n.right!==i||this.showCurrent(t.newPage):e===t.target&&this.showCurrent(t.newPage)},t.prototype.forCurrentPages=function(t){var e=[];this.currentPage&&e.push(this.currentPage),this.currentSpread&&(e.push(this.currentSpread.left),e.push(this.currentSpread.right)),e.forEach(function(e){e&&t(e)})},t.prototype.removePageListeners=function(){var t=this;this.forCurrentPages(function(e){e.removeEventListener("hyperlink",t.hyperlinkListener,!1),e.removeEventListener("replaced",t.pageReplacedListener,!1)})},t.prototype.hidePages=function(){this.removePageListeners(),this.forCurrentPages(function(t){E.F(t.container,"display","none"),t.container.setAttribute("aria-hidden","true")}),this.currentPage=null,this.currentSpread=null},t.prototype.showSinglePage=function(t){t.addEventListener("hyperlink",this.hyperlinkListener,!1),t.addEventListener("replaced",this.pageReplacedListener,!1),E.F(t.container,"visibility","visible"),E.F(t.container,"display","block"),t.container.setAttribute("aria-hidden","false")},t.prototype.showPage=function(t){this.hidePages(),this.currentPage=t,t.container.style.marginLeft="",t.container.style.marginRight="",this.showSinglePage(t)},t.prototype.showSpread=function(t){if(this.hidePages(),this.currentSpread=t,t.left&&t.right){var e=parseFloat(t.left.container.style.width),n=parseFloat(t.right.container.style.width);e&&n&&e!==n&&(e<n?t.left.container.style.marginLeft=n-e+"px":t.right.container.style.marginRight=e-n+"px")}t.left&&(this.showSinglePage(t.left),t.right?t.left.container.removeAttribute("data-vivliostyle-unpaired-page"):t.left.container.setAttribute("data-vivliostyle-unpaired-page",!0)),t.right&&(this.showSinglePage(t.right),t.left?t.right.container.removeAttribute("data-vivliostyle-unpaired-page"):t.right.container.setAttribute("data-vivliostyle-unpaired-page",!0))},t.prototype.reportPosition=function(){var t=Y.c("reportPosition"),e=this;return v.a(e.pagePosition),e.opf.getCFI(this.pagePosition.spineIndex,this.pagePosition.offsetInItem).then(function(n){var i=e.currentPage;(e.waitForLoading&&i.fetchers.length>0?Ue.c(i.fetchers):Y.d(!0)).then(function(){e.sendLocationNotification(i,n).thenFinish(t)})}),t.result()},t.prototype.createViewport=function(){var t=this.viewportElement;if(this.viewportSize){var e=this.viewportSize;return t.style.marginLeft=e.marginLeft+"px",t.style.marginRight=e.marginRight+"px",t.style.marginTop=e.marginTop+"px",t.style.marginBottom=e.marginBottom+"px",new Ti(this.window,this.fontSize,t,e.width,e.height)}return new Ti(this.window,this.fontSize,t)},t.prototype.resolveSpreadView=function(t){switch(this.pageViewMode){case oo.SINGLE_PAGE:return!1;case oo.SPREAD:return!0;case oo.AUTO_SPREAD:default:return t.width/t.height>=1.45&&t.width>800}},t.prototype.updateSpreadView=function(t){this.pref.spreadView=t,this.viewportElement.setAttribute("data-vivliostyle-spread-view",t.toString())},t.prototype.sizeIsGood=function(){var t=this.createViewport(),e=this.resolveSpreadView(t),n=this.pref.spreadView!==e;return this.updateSpreadView(e),!(this.viewportSize||!this.viewport||this.viewport.fontSize!=this.fontSize||(n||t.width!=this.viewport.width||t.height!=this.viewport.height)&&(n||t.width!=this.viewport.width||t.height==this.viewport.height||!/Android|iPhone|iPad|iPod/.test(navigator.userAgent))&&(!this.opfView||!this.opfView.hasPages()||this.opfView.hasAutoSizedPages()||(this.viewport.width=t.width,this.viewport.height=t.height,this.needRefresh=!0,0)))},t.prototype.setPageSize=function(t,e,n,i){this.pageSizes[i]=t,this.setPageSizePageRules(e,n,i)},t.prototype.setPageSizePageRules=function(t,e,n){if(!this.pageSheetSizeAlreadySet&&this.pageRuleStyleElement){var i="";Object.keys(t).forEach(function(e){i+="@page "+e+"{margin:0;size:";var n=t[e];i+=n.width+"px "+n.height+"px;}"}),this.pageRuleStyleElement.textContent=i,this.pageSheetSizeAlreadySet=!0}},t.prototype.removePageSizePageRules=function(){this.pageRuleStyleElement&&(this.pageRuleStyleElement.textContent="",this.pageSheetSizeAlreadySet=!1)},t.prototype.reset=function(){var t=!1,e=!1;this.opfView&&(t=this.opfView.isTOCVisible(),e=this.opfView.tocAutohide,this.opfView.hideTOC(),this.opfView.removeRenderedPages()),this.removePageSizePageRules(),this.viewport=this.createViewport(),this.viewport.resetZoom(),this.opfView=new lo(this.opf,this.viewport,this.fontMapper,this.pref,this.setPageSize.bind(this)),t&&this.sendCommand({a:"toc",v:"show",autohide:e})},t.prototype.showCurrent=function(t,e){this.needRefresh=!1,this.removePageListeners();var n=this;return this.pref.spreadView?this.opfView.getSpread(this.pagePosition,e).thenAsync(function(e){return n.showSpread(e),n.setSpreadZoom(e),n.currentPage=t,Y.d(null)}):(this.showPage(t),this.setPageZoom(t),this.currentPage=t,Y.d(null))},t.prototype.setPageZoom=function(t){var e=this.getAdjustedZoomFactor(t.dimensions);this.viewport.zoom(t.dimensions.width,t.dimensions.height,e)},t.prototype.setSpreadZoom=function(t){var e=this.getSpreadDimensions(t);this.viewport.zoom(e.width,e.height,this.getAdjustedZoomFactor(e))},t.prototype.getAdjustedZoomFactor=function(t){return this.fitToScreen?this.calculateZoomFactorToFitInsideViewPort(t):this.zoom},t.prototype.getSpreadDimensions=function(t){var e=0,n=0;return t.left&&(e+=t.left.dimensions.width,n=t.left.dimensions.height),t.right&&(e+=t.right.dimensions.width,n=Math.max(n,t.right.dimensions.height)),t.left&&t.right&&(e+=2*this.pref.pageBorder,e+=Math.abs(t.left.dimensions.width-t.right.dimensions.width)),{width:e,height:n}},t.prototype.queryZoomFactor=function(t){if(!this.currentPage)throw new Error("no page exists.");switch(t){case ho.FIT_INSIDE_VIEWPORT:var e=void 0;return this.pref.spreadView?(v.a(this.currentSpread),e=this.getSpreadDimensions(this.currentSpread)):e=this.currentPage.dimensions,this.calculateZoomFactorToFitInsideViewPort(e);default:throw new Error("unknown zoom type: "+t)}},t.prototype.calculateZoomFactorToFitInsideViewPort=function(t){var e=this.viewport.width/t.width,n=this.viewport.height/t.height;return Math.min(e,n)},t.prototype.cancelRenderingTask=function(){this.renderTask&&this.renderTask.interrupt(new fo),this.renderTask=null},t.prototype.resize=function(){if(this.needResize=!1,this.needRefresh=!1,this.sizeIsGood())return Y.d(!0);var t=this;this.setReadyState(r.LOADING),this.cancelRenderingTask();var e=Y.a().getScheduler().run(function(){return Y.b("resize",function(n){t.opf?(t.renderTask=e,m.registerStartTiming("render (resize)"),t.reset(),t.pagePosition&&(0==t.pagePosition.pageIndex&&0==t.pagePosition.offsetInItem||(t.pagePosition.pageIndex=-1)),t.opf.setEPageCountMode(t.renderAllPages),t.opfView.renderPagesUpto(t.pagePosition,!t.renderAllPages).then(function(i){i?(t.pagePosition=i.position,t.showCurrent(i.page,!0).then(function(){t.setReadyState(r.INTERACTIVE),t.opf.countEPages(function(e){var n={t:"nav",epageCount:e,first:t.currentPage.isFirstPage,last:t.currentPage.isLastPage,metadata:t.opf.metadata,docTitle:t.opf.spine[t.pagePosition.spineIndex].title};(t.currentPage.isFirstPage||0==t.pagePosition.pageIndex&&t.opf.spine[t.pagePosition.spineIndex].epage)&&(n.epage=t.opf.spine[t.pagePosition.spineIndex].epage),t.callback(n)}).then(function(){t.reportPosition().then(function(i){(t.renderAllPages?t.opfView.renderAllPages():Y.d(null)).then(function(){t.renderTask===e&&(t.renderTask=null),m.registerEndTiming("render (resize)"),t.renderAllPages&&t.setReadyState(r.COMPLETE),t.callback({t:"loaded"}),n.finish(i)})})})})):n.finish(!1)})):n.finish(!1)},function(t,e){if(!(e instanceof fo))throw e;m.registerEndTiming("render (resize)"),u.b.debug(e.message)})});return Y.d(!0)},t.prototype.sendLocationNotification=function(t,e){var n=Y.c("sendLocationNotification"),i={t:"nav",first:t.isFirstPage,last:t.isLastPage,metadata:this.opf.metadata,docTitle:this.opf.spine[t.spineIndex].title},o=this;return this.opf.getEPageFromPosition(o.pagePosition).then(function(t){i.epage=t,i.epageCount=o.opf.epageCount,e&&(i.cfi=e),o.callback(i),n.finish(!0)}),n.result()},t.prototype.getCurrentPageProgression=function(){return this.opfView?this.opfView.getCurrentPageProgression(this.pagePosition):null},t.prototype.moveTo=function(t){var e,n=this;if(this.readyState!==r.COMPLETE&&"next"!==t.where&&this.setReadyState(r.LOADING),"string"==typeof t.where){var i;switch(t.where){case"next":i=this.pref.spreadView?this.opfView.nextSpread:this.opfView.nextPage;break;case"previous":i=this.pref.spreadView?this.opfView.previousSpread:this.opfView.previousPage;break;case"last":i=this.opfView.lastPage;break;case"first":i=this.opfView.firstPage;break;default:return Y.d(!0)}i&&(e=function(){return i.call(n.opfView,n.pagePosition,!n.renderAllPages)})}else if("number"==typeof t.epage){var o=t.epage;e=function(){return n.opfView.navigateToEPage(o,n.pagePosition,!n.renderAllPages)}}else{if("string"!=typeof t.url)return Y.d(!0);var a=t.url;e=function(){return n.opfView.navigateTo(a,n.pagePosition,!n.renderAllPages)}}var s=Y.c("moveTo");return e.call(n.opfView).then(function(t){var e;if(t){n.pagePosition=t.position;var i=Y.c("moveTo.showCurrent");e=i.result(),n.showCurrent(t.page,!n.renderAllPages).then(function(){n.reportPosition().thenFinish(i)})}else e=Y.d(!0);e.then(function(t){n.readyState===r.LOADING&&n.setReadyState(r.INTERACTIVE),s.finish(t)})}),s.result()},t.prototype.showTOC=function(t){var e=!!t.autohide,n=t.v,i=this.opfView.isTOCVisible(),o=e!=this.opfView.tocAutohide&&"hide"!=n;if(i){if("show"==n&&!o)return Y.d(!0)}else if("hide"==n)return Y.d(!0);if(i&&"show"!=n)return this.opfView.hideTOC(),Y.d(!0);var r=this,a=Y.c("showTOC");return this.opfView.showTOC(e).then(function(t){t&&(o&&(t.listeners={}),e&&t.addEventListener("hyperlink",function(){r.opfView.hideTOC()},!1),t.addEventListener("hyperlink",r.hyperlinkListener,!1)),a.finish(!0)}),a.result()},t.prototype.runCommand=function(t){var e=this,n=t.a||"";return Y.b("runCommand",function(i){var o=e.actions[n];o?o.call(e,t).then(function(){e.callback({t:"done",a:n}),i.finish(!0)}):(u.b.error("No such action:",n),i.finish(!0))},function(t,e){u.b.error(e,"Error during action:",n),t.finish(!0)})},t.prototype.initEmbed=function(t){var e=go(t),n=null,i=this;Y.e(function(){var t=Y.c("commandLoop"),o=Y.a().getScheduler();return i.hyperlinkListener=function(t){var e=t,n="#"===e.href.charAt(0)||i.packageURL.some(function(t){return e.href.substr(0,t.length)==t});if(n){t.preventDefault();var r={t:"hyperlink",href:e.href,internal:n};o.run(function(){return i.callback(r),Y.d(!0)})}},t.loopWithFrame(function(t){if(i.needResize)i.resize().then(function(){t.continueLoop()});else if(i.needRefresh)i.currentPage&&i.showCurrent(i.currentPage).then(function(){t.continueLoop()});else if(e){var o=e;e=null,i.runCommand(o).then(function(){t.continueLoop()})}else{var r=Y.c("waitForCommand");n=r.suspend(self),r.result().then(function(){t.continueLoop()})}}).thenFinish(t),t.result()}),i.kick=function(){var t=n;t&&(n=null,t.schedule(!0))},i.sendCommand=function(t){return!e&&(e=go(t),i.kick(),!0)},this.window.adapt_command=i.sendCommand},t}();(ho||(ho={})).FIT_INSIDE_VIEWPORT="fit inside viewport";var fo=function(t){function e(){var n=t.call(this)||this;return n.name="RenderingCanceledError",n.message="Page rendering has been canceled",Object.setPrototypeOf(n,e.prototype),n.stack=(new Error).stack,n}return uo(e,t),e}(Error);function go(t){return"string"==typeof t?E.H(t):t}var mo=i;function yo(t){var e={};return Object.keys(t).forEach(function(n){var i=t[n];switch(n){case"autoResize":e.autoresize=i;break;case"pageBorderWidth":e.pageBorder=i;break;default:e[n]=i}}),e}var vo,Eo=function(){function t(t,e){var n;this.settings=t,this.initialized=!1,n=t.debug,a=n,this.viewer_=new po(t.window||window,t.viewportElement,"main",this.dispatcher.bind(this)),this.options={autoResize:!0,fontSize:16,pageBorderWidth:1,renderAllPages:!0,pageViewMode:wo.AUTO_SPREAD,zoom:1,fitToScreen:!1,defaultPaperSize:void 0},e&&this.setOptions(e),this.eventTarget=new E.c,Object.defineProperty(this,"readyState",{get:function(){return this.viewer_.readyState}})}return t.prototype.setOptions=function(t){var e=Object.assign({a:"configure"},yo(t));this.viewer_.sendCommand(e),Object.assign(this.options,t)},t.prototype.dispatcher=function(t){var e={type:t.t},n=t;Object.keys(n).forEach(function(t){"t"!==t&&(e[t]=n[t])}),this.eventTarget.dispatchEvent(e)},t.prototype.addListener=function(t,e){this.eventTarget.addEventListener(t,e,!1)},t.prototype.removeListener=function(t,e){this.eventTarget.removeEventListener(t,e,!1)},t.prototype.loadDocument=function(t,e,n){t||this.eventTarget.dispatchEvent({type:"error",content:"No URL specified"}),this.loadDocumentOrPublication(t,null,e,n)},t.prototype.loadPublication=function(t,e,n){t||this.eventTarget.dispatchEvent({type:"error",content:"No URL specified"}),this.loadDocumentOrPublication(null,t,e,n)},t.prototype.loadDocumentOrPublication=function(t,e,n,i){var o=n||{};function r(t){return t?t.map(function(t){return{url:t.url||null,text:t.text||null}}):void 0}var a=r(o.authorStyleSheet),s=r(o.userStyleSheet);i&&Object.assign(this.options,i);var l=Object.assign({a:t?"loadXML":"loadPublication",userAgentRootURL:this.settings.userAgentRootURL,url:bo(t)||e,document:o.documentObject,fragment:o.fragment,authorStyleSheet:a,userStyleSheet:s},yo(this.options));this.initialized?this.viewer_.sendCommand(l):(this.initialized=!0,this.viewer_.initEmbed(l))},t.prototype.getCurrentPageProgression=function(){return this.viewer_.getCurrentPageProgression()},t.prototype.resolveNavigation=function(t){switch(t){case vo.LEFT:return this.getCurrentPageProgression()===mo.LTR?vo.PREVIOUS:vo.NEXT;case vo.RIGHT:return this.getCurrentPageProgression()===mo.LTR?vo.NEXT:vo.PREVIOUS;default:return t}},t.prototype.navigateToPage=function(t,e){t===vo.EPAGE?this.viewer_.sendCommand({a:"moveTo",epage:e}):this.viewer_.sendCommand({a:"moveTo",where:this.resolveNavigation(t)})},t.prototype.navigateToInternalUrl=function(t){this.viewer_.sendCommand({a:"moveTo",url:t})},t.prototype.isTOCVisible=function(){return this.viewer_.opfView&&this.viewer_.opfView.opf&&(this.viewer_.opfView.opf.xhtmlToc||this.viewer_.opfView.opf.ncxToc)?!!this.viewer_.opfView.isTOCVisible():null},t.prototype.showTOC=function(t,e){var n=null==t?"toggle":t?"show":"hide";this.viewer_.sendCommand({a:"toc",v:n,autohide:e})},t.prototype.queryZoomFactor=function(t){return this.viewer_.queryZoomFactor(t)},t.prototype.getPageSizes=function(){return this.viewer_.pageSizes},t}();function bo(t){function e(t){return"number"==typeof t?t:null}function n(t){return"string"==typeof t?{url:t,startPage:null,skipPagesBefore:null}:{url:t.url,startPage:e(t.startPage),skipPagesBefore:e(t.skipPagesBefore)}}return Array.isArray(t)?t.map(n):t?[n(t)]:null}!function(t){t.PREVIOUS="previous",t.NEXT="next",t.LEFT="left",t.RIGHT="right",t.FIRST="first",t.LAST="last",t.EPAGE="epage"}(vo||(vo={}));var wo=oo,No={Viewer:Eo,PageViewMode:wo,ZoomType:ho};m.forceRegisterEndTiming("load_vivliostyle"),e.default={constants:s,plugin:l.c,profile:y,viewer:No}}]).default}),o=(n=i)&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n;i.vivliostyle;class r{constructor(t,{title:e="",printCallback:n=(t=>t.print()),hideIframe:i=!0,removeIframe:o=!0}){this.htmlDoc=t,this.title=e,this.printCallback=n,this.hideIframe=i,this.removeIframe=o}init(){this.iframe=document.createElement("iframe"),this.hideIframe&&(this.iframe.style.width=0,this.iframe.style.height=0,this.iframe.style.borderWidth=0),this.window=window,this.window.printInstance=this,this.iframe.srcdoc=`<!DOCTYPE html>\n        <html data-vivliostyle-paginated="true">\n            <head>\n                <meta charset='utf-8'/>\n                <meta name='viewport' content='width=device-width, initial-scale=1.0'/>\n                <title>${this.title}</title>\n                <style>${t}</style>\n                <style>${e}</style>\n                <style>\n                    html[data-vivliostyle-paginated] {\n                        width: 100%;\n                        height: 100%;\n                    }\n                    html[data-vivliostyle-paginated] body,\n                    html[data-vivliostyle-paginated] [data-vivliostyle-viewer-viewport] {\n                        width: 100% !important;\n                        height: 100% !important;\n                    }\n                    html[data-vivliostyle-paginated],\n                    html[data-vivliostyle-paginated] body {\n                        margin: 0;\n                        padding: 0;\n                    }\n                </style>\n                <style id='vivliostyle-page-rules'></style>\n            </head>\n            <body onload='parent.printInstance.runInIframe(window)'>\n                <div id="vivliostyle-viewer-viewport"></div>\n            </body>\n        </html>`,document.body.appendChild(this.iframe)}runInIframe(t){return this.iframeWin=t,this.preparePrint().then(()=>this.browserPrint()).then(()=>this.cleanUp())}preparePrint(){this.iframeWin.document.title=this.title;const t=new Blob([this.htmlDoc],{type:"text/html"}),e=URL.createObjectURL(t),n=new o.viewer.Viewer({viewportElement:this.iframeWin.document.body.firstElementChild,window:this.iframeWin},{defaultPaperSize:{width:794,height:1122}});return new Promise(t=>{n.addListener("readystatechange",()=>{"complete"===n.readyState&&t()}),n.loadDocument({url:e})})}browserPrint(){this.printCallback(this.iframeWin)}cleanUp(){delete this.window.printInstance,this.removeIframe&&this.iframe.parentElement.removeChild(this.iframe)}}document.getElementById("print").addEventListener("click",()=>{const t=document.getElementById("html").value,e=document.getElementById("css").value,n=document.getElementById("title").value;!function(t,e){new r(t,e).init()}(`\n        <!doctype html>\n        <html>\n            <head>\n                <title>${n}</title>\n                <style>${e}</style>\n            <head>\n            <body>${t}</body>\n        </html>`,{title:n,printCallback:t=>{t.document.querySelectorAll("[data-vivliostyle-page-container]").length;t.print()},hideIframe:!0,removeIframe:!0})})}();
//# sourceMappingURL=bundle.js.map
